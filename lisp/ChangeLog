2002-06-12  Miles Bader  <miles@gnu.org>

	* emacs-lisp/byte-lexbind.el, emacs-lisp/macroexp.el: New files.

	* subr.el (functionp): Function removed (now a subr).
	* help-fns.el (describe-function-1): Handle interpreted closures.

2002-06-11  Richard M. Stallman  <rms@gnu.org>

	* format.el (format-alist): Document new element PRESERVE.
	(format-write-file): Implement PRESERVE elt for a format.

	* files.el (make-auto-save-file-name): Rename local `filename' to
	`file-name'.

2002-06-10  Richard M. Stallman  <rms@gnu.org>

	* progmodes/ebrowse.el (ebrowse-draw-tree-fn): Use copy-sequence.
	(ebrowse-copy-list): Function deleted.

	* eshell/em-unix.el (eshell/diff): Use copy-sequence.

	* eshell/esh-mode.el (eshell-mode, eshell-mode): Use copy-sequence.

	* eshell/esh-util.el (eshell-copy-list): Function deleted.
	(eshell-sublist): Use copy-sequence.
	(eshell-copy-tree): Make it an alias for copy-tree.

	* emacs-lisp/cl.el (copy-list): Moved back from subr.el.

	* subr.el (copy-list): Moved to cl.el.
	(copy-tree): Don't use copy-list or cl-pop.

2002-06-10  Miles Bader  <miles@gnu.org>

	Make comint use text properties for highlighting instead of overlays:
	* comint.el (comint-last-output-overlay): Variable removed.
	(comint-send-input, comint-output-filter): Use text properties
	instead of overlays.
	(comint-insert-clicked-input): Rewrite to work with text
	properties as well as overlays
	(comint-snapshot-last-prompt): Snapshot using text properties.
	(comint-get-old-input-default, comint-extract-string): Don't copy
	text properties. 

	* simple.el (line-move-finish): Inhibit field motion when
	computing `line-end'.

	* files.el (revert-buffer): Correct typo: variable name is
	`buffer-file-format', not `buffer-file-formats'.

	* comint.el (comint-send-input, comint-output-filter): Use the
	`font-lock-face' property instead of `face'.  Don't check the
	highlight-enabling variables anymore.
	(comint-highlight-input, comint-highlight-prompt): Variables
	removed.
	
	* faces.el (display-supports-face-attributes-p): New function.
	(face-spec-set-match-display): Support `supports' predicate.
	(italic): Try underlining for displays that don't support real italics.
	* cus-edit.el (custom-display): Add support for `supports' predicate.
	* term/tty-colors.el (color-name-rgb-alist): Use 16-bit RGB values
	instead of 8-bit, for consistency with the rest of emacs.
	(tty-color-canonicalize): Only copy COLOR if we need to change it.
	(tty-color-approximate): Scale values from `color-name-rgb-alist'
	appropriately.  Return the whole color description, rather than
	just the RGB values.
	(tty-color-standard-values): New function.  Code mostly taken from
	`tty-color-translate'.
	(tty-color-translate, tty-color-values): Use `tty-color-desc' to
	do all the work.
	(tty-color-desc): Do color lookup here instead of calling
	`tty-color-translate' and `tty-color-by-index'; this is now the
	main place to do it.

2002-06-09  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-style.el (c-set-style, c-set-style-1): Added
	another state for the `dont-override' flag where it only keeps
	globally set variables.

2002-06-08  Colin Walters  <walters@gnu.org>

	* descr-text.el (describe-text-properties): Sort the output by the
	size of the values.  Put `font-lock-face' property on property
	names.
	(toplevel): Provide `descr-text'.

	* international/mule-diag.el (describe-char-after): When there are
	text properties, require `descr-text', and just call
	`describe-text-properties'.

	* international/mule.el (sgml-html-meta-auto-coding-function): New
	function.
	(auto-coding-from-file-contents): Delete; merge functionality into
	`set-auto-coding'.
	(set-auto-coding): Move tests from `auto-coding-functions' so that
	they have a lower priority than coding: tags.  Put
	`auto-coding-regexp-alist' tests before coding: tag tests.
	(sgml-xml-auto-coding-function): Simply `intern' the match, and
	test if it's a valid coding system.
	(auto-coding-functions): Add `sgml-html-meta-auto-coding-function'.

2002-06-08  Colin Walters  <walters@verbum.org>

	* subr.el (copy-list): Moved here from cl.el.
	(copy-tree): Renamed here from `cl-copy-tree' in cl-extra.el.
	
	* emacs-lisp/cl-extra.el (cl-copy-tree): Moved to `copy-tree' in
	subr.el.  Add a defalias with the old name.
	
	* emacs-lisp/cl.el (copy-list): Moved to subr.el.

	* replace.el (occur-mode): Don't set up categories.  Do set
	`font-lock-defaults', and be sure to set `font-lock-core-only'.
	(occur-1): Pass `list-matching-lines-face' and
	`list-matching-lines-buffer-name-face'.
	(occur-engine): Use `font-lock-face' instead of categories.

	* info.el (Info-mode): Don't set up categories.  Do set
	`font-lock-defaults', and be sure to set `font-lock-core-only'.
	(Info-fontify-menu-headers): Use `font-lock-face' instead of
	categories.
	(Info-fontify-node): Ditto.

	* ibuffer.el (ibuffer-category-alist): Delete.
	(ibuffer-get-category): Delete.
	(ibuffer-compile-make-eliding-form): Use `font-lock-face' instead
	of categories.
	(ibuffer-compile-format): Don't treat `name' category specially.
	(ibuffer-column name): Use `font-lock-face'.
	(filename-and-process): Ditto.
	(ibuffer-buffer-name-category): Renamed to
	`ibuffer-buffer-name-face'.  Don't use categories.
	(ibuffer-update-title-and-summary): Use `font-lock-face'.
	(ibuffer-insert-filter-group): Ditto.
	(ibuffer-mode): Don't set up categories.  Do set
	`font-lock-defaults', and be sure to set `font-lock-core-only'.
	(ibuffer-compile-format): Don't pass third argument
	to column functions.
	(filename-and-process): Ditto.	
	
	* ibuf-macs.el (define-ibuffer-column): Don't create a third
	argument for the generated function.

	* font-core.el (font-lock-category-alist): Delete.
	(turn-on-font-lock-if-enabled): Don't use it.
	(font-lock-symbol-category-alist): Delete.
	(font-lock-default-function): Use new `char-property-alias-alist'
	to make `font-lock-face' an alias for `face' when font-lock mode
	is enabled.
	(font-lock-core-only): New variable.
	(font-lock-set-defaults): Use it.

2002-06-08  Richard M. Stallman  <rms@gnu.org>

	* files.el (find-file-noselect-1): Undo previous change.

	* bookmark.el (bookmark-file-or-variation-thereof): Doc fix.

2002-06-07  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-file-or-variation-thereof): Just use
	Info-suffix-list, as suggested by Stefan Monnier.

2002-06-05  Eli Zaretskii  <eliz@is.elta.co.il>

	* select.el (xselect-convert-to-string): If VALUE is a string,
	return a cons of TYPE and the string.

2002-06-05  Pavel Jan,Bm(Bk  <Pavel@Janik.cz>

	* language/cyrillic.el (cyrillic-alternativnyj-decode-table):
	Fix the table to contain correct characters.

2002-06-04  Richard M. Stallman  <rms@gnu.org>

	* simple.el: Don't require cl.

2002-06-03  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-do-shell-command): Doc fix in autoload.

	* info.el (Info-extract-pointer): Ignore Info-header-line.

	* progmodes/cc-mode.el (c-postprocess-file-styles):
	Do nothing except in CC modes.

	* international/mule-cmds.el (select-safe-coding-system):
	When computing auto-cs, narrow to FROM...TO.
	Put save-excursion outside save-restriction.
	New arg FILE; use that for set-auto-coding.

2002-06-01  Richard M. Stallman  <rms@gnu.org>

	* simple.el (choose-completion-string-functions): Doc fix.
	(choose-completion-string): Add doc string.

2002-06-01  Kim F. Storm  <storm@cua.dk>

	* simple.el: Reworked previous change.
	(choose-completion-string1): Merged back into choose-completion-string.
	(choose-completion-string): Run choose-completion-string-functions
	after checking for proper minibuffer window.  Added mini-p arg to
	the hook functions.  Insert choice if all hook functions return nil.
	(choose-completion-string-functions): Doc update.

2002-06-01  Sam Steingold  <sds@gnu.org>

	* files.el (auto-mode-alist): Strip trailing ".in" from the file
	name when deciding the mode (for config.h.in, Makefile.in etc).

2002-06-01  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/prolog.el (prolog-mode-syntax-table): Add flags to
	?/ and ?* entries to support /* */ style comments.
	(prolog-font-lock-keywords): New var.
	(prolog-mode): Enable font-locking; set `font-lock-defaults'.

2002-06-01  Kim F. Storm  <storm@cua.dk>

	* simple.el (choose-completion-string-functions): New special hook.
	(choose-completion-string1): Renamed from choose-completion-string.
	(choose-completion-string): Run choose-completion-string-functions
	until success, and only call choose-completion-string1 if it fails.

2002-05-31  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/ispell.el (autoloaded toplevel): Don't use
	ispell-library-directory without checking that it's bound.

2002-05-31  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--last-deleted-region-pos)
	(cua--last-deleted-region-text): New aux variables.
	(cua-delete-region): Set them.
	(cua-repeat-replace-region): Use them to find the replacement text.

2002-05-31  Juanma Barranquero  <lektu@terra.es>

	* emulation/viper-cmd.el (viper-smart-suffix-list, viper-ask-level):
	Fix typos.

2002-05-31  Kim F. Storm  <storm@cua.dk>

	* progmodes/compile.el (grep-tree-command, grep-tree-files-aliases)
	(grep-tree-ignore-CVS-directories, grep-tree-ignore-case):
	New custom variables.
	(grep-compute-defaults): Compute grep-tree-command's default value.
	(grep-expand-command-macros): New aux function.
	(grep-tree-last-regexp, grep-tree-last-files): New aux variables.
	(grep-tree): New command like grep-find but extended prompting.

2002-05-30  Richard M. Stallman  <rms@gnu.org>

	* files.el (find-file-default): Add defvar for var already used.

	* menu-bar.el (menu-bar-showhide-fringe-menu): Use defvar.

	* subr.el (open-network-stream, open-network-stream-nowait)
	(open-network-stream-server, process-kill-without-query):
	Moved from simple.el.

	* simple.el (open-network-stream, open-network-stream-nowait)
	(open-network-stream-server, process-kill-without-query):
	Moved to subr.el.

	* simple.el (byte-compiling-files-p): Function deleted.

	* textmodes/ispell.el (ispell-library-directory): Renamed from
	ispell-library-path.  If Ispell is not installed, init to nil.
	(check-ispell-version): Doc fix.
	(ispell-menu-map): Get rid of byte-compiling-files-p hackery;
	initialize this unconditionally when ispell-menu-map-needed is t.
	Local `path' renamed to `dir'.

2002-05-30  Miles Bader  <miles@gnu.org>

	* calc/calc.el (calc-show-banner): New variable.
	(calc-refresh): Only show banner if `calc-show-banner' is non-nil.
	(calc-mode-var-list): Add `calc-show-banner'.
	* calc/calc-ext.el (calc-init-extensions): Add binding for `d@'.
	(calc-toggle-banner): New function.
	* calc/calc-help.el (calc-d-prefix-help): Add `@'.

2002-05-29  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/cl-indent.el (common-lisp-indent-function-1):
	When recognizing a def... construct, make that indentation
	tentative, so that it can be overridden if the list in question
	is not actually an expression.
	(common-lisp-indent-call-method): New subroutine.

	* emacs-lisp/bytecomp.el (batch-byte-compile-file):
	Delete the output file if we get a file-error.

	* tooltip.el (tooltip-mouse-motions-active): New variable.
	(tooltip-activate-mouse-motions): Don't kill track-mouse local
	if it was not made by us.

	* mouse.el (mouse-set-font): Avoid misleading error message
	if user makes no selection.

	* info.el (Info-setup-header-line): Don't hide the links line.

	* files.el (find-file-noselect-1): Return the buffer we created
	even if it has been killed within `after-find-file'.

	* files.el (auto-mode-alist): Use ada-mode for .ad[bs].dg files.

2002-05-29  Kim F. Storm  <storm@cua.dk>

	* simple.el (open-network-stream-server): Pass on optional args
	sentinel and filter to make-network-process (from Luke Gorrie).

2002-05-28  Colin Walters  <walters@gnu.org>

	* textmodes/sgml-mode.el (xml-mode): New alias for `sgml-mode'.

	* emacs-lisp/bytecomp.el (byte-compile-last-line): Deleted.
	(byte-compile-delete-first): New function.
	(byte-compile-read-position): New variable.
	(byte-compile-last-position): New variable.
	(byte-compile-current-buffer): New variable.
	(byte-compile-log-1): Use it.
	(byte-compile-set-symbol-position): New function.
	(byte-compile-obsolete, byte-compile-callargs-warn)
	(byte-compile-arglist-warn, byte-compile-arglist-warn)
	(byte-compile-print-syms, byte-compile-file-form-defmumble)
	(byte-compile-check-lambda-list, byte-compile-lambda)
	(byte-compile-form, byte-compile-variable-ref)
	(byte-compile-subr-wrong-args, byte-compile-negation-optimizer)
	(byte-compile-condition-case, byte-compile-defun)
	(byte-compile-defvar, byte-compile-autoload)
	(byte-compile-lambda-form): Use it.
	(byte-compile-from-buffer): Set it, and bind
	`read-with-symbol-positions' and `read-symbol-positions-list'.

	* emacs-lisp/bytecomp.el (byte-compile-debug): New variable.

2002-05-28  Kim F. Storm  <storm@cua.dk>

	* files.el (read-directory-name): New function.
	(cd): Use it instead of read-file-name.

2002-05-27  Kim F. Storm  <storm@cua.dk>

	* simple.el (push-mark-command): Added optional NOMSG arg.

	* emulation/cua-base.el (cua-set-mark): Align pop to mark
	behaviour with standard set-mark-command.
	(cua--pre-command-handler): Use push-mark-command.
	(cua-repeat-replace-region): Improve functionality when
	repeated after moving point or changing buffer.

2002-05-26  Colin Walters  <walters@verbum.org>

	* startup.el (command-line): Use `when', `unless'.
	(command-line-1): New argument "--nosplash".  Handle it.

	* startup.el (inhibit-splash-screen): New variable alias for
	`inhibit-startup-message'.

	* replace.el (perform-replace): Document return value.  Use `pop'.

2002-05-26  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-previous-block, f90-next-block): New names,
	and slightly changed behaviour, for `f90-previous-block-start' and
	`f90-next-block-end'.
	(f90-beginning-of-subprogram, f90-end-of-subprogram): Simplify.

2002-05-26  Simon Josefsson  <jas@extundo.com>

	* fringe.el (set-fringe-mode): Work when updating
	`default-frame-alist'.

2002-05-26  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--repeat-replace-text): New variable.
	(cua-repeat-replace-region): New command.
	(cua--init-keymaps): Bind it to M-v in cua--cua-keys-keymap.
	Misc improvements to the commantary.

2002-05-26  Simon Josefsson  <jas@extundo.com>

	* fringe.el (fringe-query-style): New fringe style "minimal".

2002-05-24  Simon Josefsson  <jas@extundo.com>

	* rot13.el (rot13-translate-table): New variable.
	(rot13, rot13-string, rot13-region): New functions.

2002-05-25  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-add-stmt-syntax): Fixed some cases
	of wrong anchoring, e.g. for else-if compounds.

2002-05-25  Miles Bader  <miles@gnu.org>

	* menu-bar.el (menu-bar-showhide-fringe-menu-customize-left)
	(menu-bar-showhide-fringe-menu-customize-right)
	(menu-bar-showhide-fringe-menu-customize-disable):
	Use proper calling convention for `customize-set-value'.
	Require `fringe' before setting variable.

2002-05-25  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--self-insert-char-p): New function.

	* emulation/cua-gmrk.el (cua--init-global-mark):  Install default
	binding in cua--global-mark-keymap using cua--self-insert-char-p
	to handle all global self inserting characters in gmark mode.

	* emulation/cua-rect.el (cua--init-rectangles): Install default
	binding in cua--rectangle-keymap using cua--self-insert-char-p
	to handle all global self inserting characters in rectangle mode.

2002-05-24  Stefan Monnier  <monnier@cs.yale.edu>

	* net/ange-ftp.el (read-file-name-internal): Remove the
	`ange-ftp' property.
	(ange-ftp-real-read-file-name-internal): Remove.

2002-05-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el: (f90-end-of-subprogram): Remove the final
	`forward-line'.
	(f90-end-of-block, f90-beginning-of-block, f90-next-block-end)
	(f90-previous-block-start): New navigation commands.

2002-05-20  Simon Josefsson  <jas@extundo.com>

	* fringe.el: New file.

	* menu-bar.el (menu-bar-options-save): Add fringe-mode.
	(menu-bar-showhide-fringe-menu): New menu.
	(menu-bar-showhide-menu): Add Fringe sub-menu.

2002-05-23  Colin Walters  <walters@verbum.org>

	* replace.el (occur-engine): Include all text properties except
	mouse-face on the newline at the end of occurences.

2002-05-23  Kim F. Storm  <storm@cua.dk>

	* apropos.el (apropos-true-hit, apropos-false-hit-symbol)
	(apropos-false-hit-str, apropos-true-hit-doc): New functions.
	(apropos-command, apropos-value, apropos-documentation-internal)
	(apropos-documentation-check-doc-file)
	(apropos-documentation-check-elc-file): Use them to filter out
	false matches where only one keyword matches, but more than once.

	* apropos.el (apropos-show-scores, apropos-orig-regexp)
	(apropos-all-regexp, apropos-synonyms, apropos-words)
	(apropos-all-words): New variables.
	(aprpos-words-to-regexp, apropos-rewrite-regexp)
	(apropos-calc-scores, apropos-score-str, apropos-score-doc)
	(apropos-score-symbol): New functions.
	(apropos-command, apropos, apropos-value, apropos-documentation):
	Allow keywords in addition to regexp. Added scoring.
	(apropos-documentation-check-doc-file)
	(apropos-documentation-check-elc-file): Added scoring.
	(apropos-print): Sort according to score.

2002-05-22  Colin Walters  <walters@cis.ohio-state.edu>

	* info.el (Info-mode-hook): Change `font-lock-mode' to
	`turn-on-font-lock'.

	* font-core.el (font-lock-function): New variable.
	(font-lock-default-function): New function, created from
	`font-lock-mode'.
	(font-lock-mode): Just funcall `font-lock-function'.
	(font-lock-symbol-category-alist): New variable.

2002-05-22  Markus Rost  <rost@math.ohio-state.edu>

	* files.el (file-newest-backup): Use file-name-sans-versions.

	* diff.el (diff-latest-backup-file): Replace the main code by
	a call of file-newest-backup.

2002-05-22  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-guess-indent): Look further into
	the buffer.

2002-05-21  Stefan Monnier  <monnier@cs.yale.edu>

	* net/ange-ftp.el (ange-ftp-allow-child-lookup): Re-enable since
	the last patch works around the wu-ftpd misfeature that prompted
	the disabling of this optimization.

2002-05-21  Colin Walters  <walters@gnu.org>

	* international/mule.el (make-coding-system): Doc fixes.

	* international/mule.el (auto-coding-functions): New variable.
	(auto-coding-from-file-contents): Use it.
	(set-auto-coding): Update docs.
	(sgml-xml-auto-coding-function): New function.

	* international/mule-util.el (truncate-string-to-width):
	New optional argument `ellipsis'.  Add commented-out test suite, and
	change coding to iso-2022-7bit.

2002-05-21  Colin Walters  <walters@verbum.org>

	* font-lock.el (font-lock-defaults, font-lock-defaults-alist)
	(font-lock-multiline, font-lock-fontified, font-lock-mode)
	(turn-on-font-lock, font-lock-add-keywords, global-font-lock-mode)
	(font-lock-global-modes): Moved to font-core.el.
	(font-lock-set-defaults-1): Partially moved to font-core.el.

	* font-core.el: New file, with functions taken from font-lock.el.
	(font-lock-category-alist): New variable.
	(font-lock-mode): Use it.
	(font-lock-set-defaults): Partially taken from font-lock.el.
	Only load font-lock.el when necessary.

	* loadup.el: Add font-core.el.

	* replace.el (occur-mode-hook): New variable.
	(occur-fontify-region-function): Deleted.
	(occur-mode): Don't use it.  Set up `font-lock-category-alist'
	instead.
	(occur-fontify-on-property): Deleted.
	(occur-engine): Use categories from `font-lock-category-alist'.

	* info.el (Info-fontify): Deleted.
	(Info-select-node): Don't use it.
	(Info-mode-hook): New variable.
	(Info-mode): Set up categories.
	(Info-fontify-menu-headers, Info-fontify-node): Use categories.

	* ibuffer.el (ibuffer-formats): Update docs.
	(ibuffer-category-alist): New variable.
	(ibuffer-get-category): New function.
	(ibuffer-compile-make-eliding-form): Use category property instead
	of face.
	(ibuffer-compile-format): Pass current ibuffer buffer to column
	functions too.
	(ibuffer-buffer-name-category): New function.
	(ibuffer-compile-format): If the current column is a `name'
	column, figure out the appropriate category to put on it.
	(filename-and-process): Use category property.
	(ibuffer-fontify-region-function): Deleted.
	(ibuffer-unfontify-region-function): Deleted.
	(ibuffer-update-title-and-summary): Use category properties.
	(ibuffer-insert-filter-group): Ditto.
	(ibuffer-mode): Set up category properties.

2002-05-21  Colin Walters  <walters@debian.org>

	* replace.el (occur-engine): Increment globalcount all at once
	after searching a buffer.
	(occur-mode-map): Don't escape plain "o".

	* ibuf-macs.el (define-ibuffer-column): Add third argument
	`ibuffer-buf'.

	* ibuffer.el (toplevel): Require font-lock, to get the face
	definitions.
	(ibuffer-use-fontification): Deleted.
	(column filename-and-process): New column.
	(ibuffer-formats): Use it by default.
	(ibuffer-name-map, ibuffer-mode-name-map)
	(ibuffer-filter-group-map): Don't set parent to `ibuffer-mode-map'.
	(ibuffer-do-save, ibuffer-do-toggle-modified)
	(ibuffer-do-toggle-read-only, ibuffer-do-delete)
	(ibuffer-do-kill-on-deletion-marks): Include name in definition.
	(ibuffer): New optional argument `formats'.

2002-05-21  Eli Zaretskii  <eliz@is.elta.co.il>

	* indent.el (indent-rigidly): Mention how to remove all indentation.

2002-05-21  Colin Walters  <walters@gnu.org>

	* international/mule-diag.el (describe-char-after): Order display
	of text properties by the size of their value, for clarity.

2002-05-20  Stefan Monnier  <monnier@cs.yale.edu>

	* net/ange-ftp.el (ange-ftp-generate-root-prefixes)
	(ange-ftp-file-name-completion): Don't cons unnecessarily.
	(ange-ftp-send-cmd): Always `cd' before doing `ls'.

	* wid-edit.el (widget-color-complete):
	* progmodes/etags.el (tags-complete-tags-table-file):
	* progmodes/cpp.el (cpp-choose-symbol): Don't cons unnecessarily.

	* textmodes/outline.el (outline-reveal-toggle-invisible):
	Reverse the meaning of the second arg.

	* reveal.el (reveal-post-command): Reverse the semantics of
	reveal-toggle-invisible and support isearch-open-invisible-temporary.

2002-05-20  Markus Rost  <rost@math.ohio-state.edu>

	* mail/sendmail.el (mail-recover-1): Remove (debug).
	(mail-signature): Fix :type.
	(mail-default-directory): New user option.
	(mail, mail-recover):  Use that option.

2002-05-20  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* international/mule.el (auto-coding-alist): Use emacs-mule
	for auto-save files.

2002-05-20  Miles Bader  <miles@gnu.org>

	* files.el (find-file-read-args): Don't trash existing value of
	`minibuffer-setup-hook', just add our hook to it.

2002-05-19  Markus Rost  <rost@math.ohio-state.edu>

	* international/ucs-tables.el (unify-8859-on-encoding-mode)
	(unify-8859-on-decoding-mode): Change :version attributes to strings.

	* simple.el (yank-excluded-properties): Change :version attribute
	to a string.

	* dired.el (dired-view-command-alist): Change :version attribute
	to a string.

	* xscheme.el (xscheme-start-hook): Change :version attribute to a
	string.

	* find-dired.el (find-dired): Implement revert-buffer-function.

	* mail/emacsbug.el (report-emacs-bug-hook): Do another save-excursion.

2002-05-19  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-match-end, f90-break-line): Simplify a bit.
	(f90-get-present-comment-type): Fix earlier change.
	(f90-comment-indent): Doc fix.
	(f90-equal-symbols, f90-looking-at-do, f90-looking-at-select-case)
	(f90-looking-at-if-then): Remove lets.
	(f90-looking-at-where-or-forall): Handle if split over lines.
	(f90-change-keywords): Doc fix.

2002-05-19  Richard M. Stallman  <rms@gnu.org>

	* indent.el (indent-region): Make COLUMN arg optional.

	* files.el (find-file-read-args): New function.
	(find-file, find-file-other-window, find-file-other-frame)
	(find-file-read-only, find-file-read-only-other-window)
	(find-file-read-only-other-frame): Use it.

	* custom.el (custom-load-symbol): Verify that LOADED is a string.

	* arc-mode.el (archive-zip-use-pkzip): Variable deleted.
	(archive-zip-extract, archive-zip-expunge, archive-zip-update)
	(archive-zip-update-case): Use locate-file to decide whether
	to use pkzip.
	(archive-zip-extract): Test for pkzip in value of archive-zip-extract.

	* files.el (locate-file): Doc fix.

2002-05-19  John Paul Wallington  <jpw@shootybangbang.com>

	* mail/rmail.el (rmail-show-message-hook): Offer `goto-address'
	as an option.

2002-05-18  Stefan Monnier  <monnier@cs.yale.edu>

	* uniquify.el (uniquify-rationalize-file-buffer-names):
	Always strip the trailing / even if the file is not a directory.

2002-05-18  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-mode-syntax-table, f90-mode-map): Do the
	initialization in the defvar.
	(f90-font-lock-on, f90-font-lock-off): Add 'menu-alias property.
	(f90-font-lock-1, f90-font-lock-2, f90-font-lock-3)
	(f90-font-lock-4): Move the doc strings.
	(f90-menu-bar-menu): New internal variable to hold the top-level menu.
	(f90-change-case-menu, f90-font-lock-menu): Minor code changes.
	(f90-mode-abbrev-table): Initialize in the defvar, with
	define-abbrev-table.

2002-05-18  Eli Zaretskii  <eliz@is.elta.co.il>

	* tar-mode.el (tar-octal-time): Fix last change.

2002-05-18  Markus Rost  <rost@math.ohio-state.edu>

	* mail/emacsbug.el (report-emacs-bug-text-prompt): New variable.
	(report-emacs-bug): Store the prompt in
	`report-emacs-bug-text-prompt'.  Move Configuration/Important
	settings information after the user's report.
	(report-emacs-bug-hook): Unclutter by deleting the content of
	`report-emacs-bug-text-prompt'.

2002-05-17  Thomas Morgan <tlm@pocketmail.com>

	* forms.el (forms-jump-record, forms-insert-record)
	(forms-delete-record): Calculate lines from the beginning of the
	accessible portion rather than from the beginning of the buffer.

2002-05-16  Eli Zaretskii  <eliz@is.elta.co.il>

	* ps-mule.el (eval-and-compile): Add a trivial replacement for a
	possibly missing encode-char.
	(ps-mule-font-info-database-bdf): Add associations for Unicode
	fonts.  Doc fix.
	(ps-mule-font-info-database-ps-bdf): Doc fix.
	(ps-mule-encode-ucs2): New function for encoding Unicode characters.

	* tar-mode.el (tar-octal-time): Fix the last argument of logior.

2002-05-16  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	Find funs defined with defun-cvs-mode.
	(find-function-space-re): New const.  Skips comments as well.
	(find-function-regexp, find-variable-regexp): Use it.

	* pcvs.el (cvs-cmd-do): Accept non-CVS dirs with CVS-ctrl'd subdirs.
	(cvs-mode-add-change-log-entry-other-window): Work on multiple files.
	(cvs-mode-set-flags): Don't cons unnecessarily.

2002-05-16  Colin Walters  <walters@debian.org>

	* menu-bar.el (menu-bar-tools-menu) <calculator>: Renamed to
	"Simple Calculator".
	(menu-bar-tools-menu) <calc>: New.

2002-05-16  Juanma Barranquero  <lektu@terra.es>

	* progmodes/hideshow.el (hs-adjust-block-beginning): Fix typo.

	* filesets.el (filesets-ormap): Fix typo.

	* faces.el (describe-face): Fix typo.

2002-05-15  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/easymenu.el (easy-menu-make-symbol):
	Don't treat (lambda () ...) as an expression.

2002-05-15  John Paul Wallington  <jpw@shootybangbang.com>

	* replace.el (occur-read-primary-args): Handle a bare 'C-u' correctly.

2002-05-15  Eli Zaretskii  <eliz@is.elta.co.il>

	* emacs-lisp/easymenu.el (easy-menu-add): Doc fix.

2002-05-14  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-directive-re): New name for
	fortran-preprocessor-re.  All usage updated.
	(fortran-calculate-indent): Give directives zero indentation.

2002-05-14  Jason Rumney  <jasonr@gnu.org>

	* emacs-lisp/easymenu.el (easy-menu-name-match): Match both
	displayed text and internal name as string.

2002-05-14  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-rect.el (cua--rectangle-operation):
	Don't highlight empty lines in rectangles.

	* emulation/keypad.el: Improved commentary.
	(keypad-setup, keypad-shifted-setup): Added choice to setup
	Numeric keypad with decimal key; value is selected character.
	(keypad-decimal-key, keypad-shifted-decimal-key): Removed options.
	(keypad-numlock-setup, keypad-numlock-shifted-setup): New options.
	(keypad-setup):  Arg list changed to support the new options.

2002-05-14  Richard M. Stallman  <rms@gnu.org>

	* dabbrev.el (dabbrev-case-distinction): New option.
	(dabbrev--try-find): Handle dabbrev-case-distinction.
	(dabbrev--search): Clean up the code.
	(dabbrev-upcase-means-case-search): Doc fix.
	(dabbrev-case-replace): Fix custom tags and docs.

2002-05-14  Jochen K,A|(Bpper  <jochen@jochen-kuepper.de>

	* calc/calc-units.el (math-standard-units): Update from CODATA.

2002-05-14  Stefan Monnier  <monnier@cs.yale.edu>

	* skeleton.el (skeleton-transformation): Default to `identity'.
	(skeleton-insert): Use `move-after' markers and `insert' rather
	than rely on insert-before-markers.
	(skeleton-internal-1): Handle `> \n' specially so that the newline
	is inserted before the first line is indented.

2002-05-14  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-tag):
	Default skeleton-transformation to `identity'.

2002-05-14  Francesco Potorti`  <pot@gnu.org>

	* shell.el (shell-mode): Make second part of initialisation
	depend on whether comint-input-ring is empty, rather than depend
	on it being nil.

2002-05-14  Richard M. Stallman  <rms@gnu.org>

	* files.el (make-auto-save-file-name):
	Delete the auto-save file after make-temp-file creates it.

2002-05-13  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-enable-cursor-indications): Default off.
	(cua-mode): Print Enabled/Disabled messages if interactive.
	Disable delete-selection-mode and pc-selection-mode when cua-mode
	is enabled; reenable if cua-mode is turned off.
	Remember setting of transient-mark-mode when cua-mode is enabled;
	restore if cua-mode is disabled.

2002-05-13  Richard M. Stallman  <rms@gnu.org>

	* mail/emacsbug.el (report-emacs-bug): Change the "English please" msg.

2002-05-13  Colin Walters  <walters@gnu.org>

	* ibuf-ext.el (ibuffer-format-filter-group-data): New function.

	* ibuffer.el (ibuffer-insert-filter-group): New argument filter-string.
	(ibuffer-redisplay-engine): Handle it.

	* add-log.el (add-log-mailing-address): Can be a list, too.
	(add-change-log-entry): If `add-log-mailing-address' is a list,
	then handle it.

2002-05-12  Colin Walters  <walters@debian.org>

	* replace.el (occur-1): New optional argument `buf-name'.
	(occur-revert-function): Use it.

	(occur-1): Handle plurals.

	(occur-engine): If there are no more matches, then finish
	searching the current buffer.

2002-05-12  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/ange-ftp.el (ange-ftp-try-passive-mode)
	(ange-ftp-passive-host-alist): Change :version attributes to be
	strings.

2002-05-12  Markus Rost  <rost@math.ohio-state.edu>

	* emacs-lisp/checkdoc.el (checkdoc-minor-mode): Define it with
	define-minor-mode.

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	Handle more whitespace/newline combinations in symbol definitions.

2002-05-12  Eli Zaretskii  <eliz@is.elta.co.il>

	* w32-vars.el (w32)
	* vc-cvs.el (vc-cvs-global-switches)
	(vc-cvs-sticky-date-format-string, vc-cvs-sticky-tag-display)
	* textmodes/sgml-mode.el (sgml-xml-mode)
	* ruler-mode.el (ruler-mode)
	* replace.el (query-replace-skip-read-only)
	* progmodes/fortran.el (fortran-preprocessor-re)
	* net/ange-ftp.el (ange-ftp-passive-host-alist)
	* mail/sendmail.el (mail-use-dsn)
	* faces.el (mode-line-inactive, minibuffer-prompt)
	* add-log.el (add-log-always-start-new-record): Change all
	post-21.1 :version attributes to 21.4.

2002-05-12  Richard M. Stallman  <rms@gnu.org>

	* mail/smtpmail.el (smtpmail-mail-address): New variable.
	(smtpmail-send-it): Bind and use that instead of `mail-address'.
	(smtpmail-via-smtp): Likewise.

	* ansi-color.el (ansi-color-get-face): Avoid add-to-list on local var.
	(ansi-color-apply-sequence): Avoid duplicates in combined face list.

	* dired-aux.el (dired-show-file-type): Use -- to say FILE's not option.

	* subr.el (functionp): Catch errors in indirect-function.

2002-05-12  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/ldap.el (ldap-search-internal): Unfold folded lines before
	parsing.

	* cus-edit.el (customize-set-value): Rename `var' to `variable'
	and `val' to `value'.
	(customize-save-variable): Rename `var' to `'variable.

2002-05-12  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-preprocessor-re): New variable.
	Use it for font-locking and indentation.
	(fortran-previous-statement, fortran-next-statement): Make them
	skip over preprocessor lines.
	(fortran-calculate-indent): Use fortran-preprocessor-re.

2002-05-10  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-enable-cua-keys)
	(cua-enable-register-prefix): Added value for `other' choice.

2002-05-10  Eli Zaretskii  <eliz@is.elta.co.il>

	* menu-bar.el (menu-bar-showhide-scroll-bar-menu)
	(menu-bar-showhide-menu): Use display-graphic-p, not window-system.
	(menu-bar-showhide-menu) <showhide-menu-bar, showhide-tool-bar>:
	Run a named function.
	(showhide-menu-bar, showhide-toolbar): Invoke customize-mark-as-set.
	(menu-bar-showhide-menu) <column-number-mode, line-number-mode>:
	Fix help text.

2002-05-10  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-mode): Misc. changes to use
	emulation-mode-map-alists instead of minor-mode-map-alist.

2002-05-09  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-show-message):
	Catch error in check-coding-system.

	* progmodes/compile.el (compilation-error-regexp-alist):
	New element to recognize Python error messages.

	* shell.el (shell-replace-by-expanded-directory):
	If there's already a / at the end, don't add one.

2002-05-09  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer-mode-map): Add :enable guards for
	`ibuffer-filter-disable', `ibuffer-pop-filter',
	`ibuffer-or-filter', `ibuffer-negate-filter',
	`ibuffer-decompose-filter', `ibuffer-save-filters',
	`ibuffer-switch-to-saved-filters', `ibuffer-delete-saved-filters',
	`ibuffer-save-filter-groups',
	`ibuffer-switch-to-saved-filter-groups',
	`ibuffer-delete-saved-filter-groups'.

	* ibuf-ext.el (ibuffer-do-occur): Default to 0 context lines.

2002-05-09  Markus Rost  <rost@math.ohio-state.edu>

	* woman.el (woman-menu):  Move symbol before the comment so that
	find-function-search-for-symbol finds it.

2002-05-10  Miles Bader  <miles@gnu.org>

	* facemenu.el (list-colors-display): Don't use
	`display-color-cells' unless the display class is one for which
	that info is relevant.

2002-05-09  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-send-it): Use user-mail-address from
	calling buffer.
	(smtpmail-auth-credentials): Bump :version to 21.4 (21.3 will not
	have the patch).

2002-05-09  Kim F. Storm  <storm@cua.dk>

	* wid-edit.el (checkbox): New check-mark image.

2002-05-08  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* filesets.el (filesets-running-xemacs): Fix last change.

2002-05-08  Markus Rost  <rost@math.ohio-state.edu>

	* help-fns.el (describe-function-1): If the source is
	`loaddefs.el', look for the real source.  This is necessary only
	for defaliases.

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	Add autoload cookie.
	(find-function-regexp):  Include
	"\(quote " to match the defaliases in loaddefs.el.

	* filesets.el (filesets-conditional-sort): Use copy-sequence,
	not copy-list.
	(filesets-menu-path, filesets-menu-before, filesets-menu-in-menu):
	Defvar them to nil if running in Emacs.

2002-05-08  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* textmodes/flyspell.el (make-flyspell-overlay): Add help text
	to flyspell overlays.

	* info.el (Info-mode-map): Bind `c' to Info-copy-current-node-name.

2002-05-08  Richard M. Stallman  <rms@gnu.org>

	* diff.el (diff-regexp-alist): Doc fix.

	* mail/smtpmail.el (netrc-machine, netrc-get): Add autoloads.

2002-05-08  Simon Marshall  <simon@gnu.org>

	* msb.el (msb-menu-bar-update-buffers): Fixed frame menu to use
	the frame name as the car of a menu entry, rather than the frame.

2002-05-08  Juanma Barranquero  <lektu@terra.es>

	* rfn-eshadow.el (read-file-name-electric-shadow-mode): Fix typos
	in docstring.

2002-05-07  Colin Walters  <walters@verbum.org>

	* replace.el (occur-unfontify-region-function): Delete.
	(occur-mode): Don't use it.
	(occur-engine): Respect `keep-props'.
	(occur-accumulate-lines): If we're moving forward, decrement;
	don't increment, and vice versa.

2002-05-08  Toru Tomabechi  <Toru.Tomabechi@orient.unil.ch>

	* language/tibet-util.el (tibetan-canonicalize-for-unicode-alist)
	(tibetan-canonicalize-for-unicode-regexp): New variables.
	(tibetan-canonicalize-for-unicode-region): New function.
	(tibetan-strict-unicode): New variable.
	(tibetan-pre-write-canonicalize-for-unicode): New function.

2002-05-07  Markus Rost  <rost@math.ohio-state.edu>

	* net/ange-ftp.el (ange-ftp-re-read-dir): Don't hide it behind
	the autoload-cookie.  Remove comment.

	* ffap.el (ffap): Don't hide it behind the autoload-cookie.

	* rect.el (close-rectangle): Don't hide it behind the
	autoload-cookie.

2002-05-07  Juanma Barranquero  <lektu@terra.es>

	* windmove.el (windmove-default-keybindings): Add optional
	parameter to allow using a modifier other than 'shift.

2002-05-07 Thomas Link <t.link@gmx.at>

	* filesets.el:
	(filesets-external-viewers): Fix customization problem.
	(filesets-some): Replaces cl's `some'.  Calls changed.
	(filesets-member): Replaces cl's `member*'.  Calls changed.
	(filesets-ormap): New function.

2002-05-07  John Paul Wallington  <jpw@shootybangbang.com>

	* ibuffer.el (toplevel): Specialize `ibuffer-mode-groups-popup'
	menu items.

2002-05-07  Colin Walters  <walters@gnu.org>

	* ibuf-ext.el (ibuffer-pop-filter-group): Doc fix.
	(ibuffer-clear-filter-groups): Likewise.
	(ibuffer-kill-filter-group): Likewise.
	(ibuffer-kill-line): Likewise.
	(ibuffer-read-filter-group-name): New function.
	(ibuffer-jump-to-filter-group): Use it.
	(ibuffer-kill-filter-group): Likewise.
	(ibuffer-yank-filter-group): Likewise.
	(ibuffer-decompose-filter-group): New function.

	* ibuffer.el (ibuffer-mode-map): Bind it.  Add :enable guard
	around `ibuffer-filters-to-filter-group' menu item.  Fix :enable
	guards for `ibuffer-pop-filter-group' and
	`ibuffer-clear-filter-groups'.

2002-05-06  Markus Rost  <rost@math.ohio-state.edu>

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	Use with-syntax-table.

2002-05-06  Francesco Potorti`  <pot@gnu.org>

	* mail/rmail.el (rmail-font-lock-keywords): Highlight Resent-[Ff]rom:.

2002-05-05  Markus Rost  <rost@math.ohio-state.edu>

	* time-stamp.el (time-stamp-format): Doc fix: escape open
	parenthesis in column 0.

2002-05-04  Richard M. Stallman  <rms@gnu.org>

	* toolbar/tool-bar.el (tool-bar-local-item-from-menu):
	Handle both cases: when the menu item has cached info
	and when it doesn't.

	* filesets.el (filesets-browse-dir-function): Renamed from ...-fn.
	(filesets-open-file-function, filesets-save-buffer-function): Likewise.
	(filesets-tree-max-level): Doc fix.
	(filesets-commands, filesets-external-viewers)
	(filesets-ingroup-patterns): Mark as risky.
	(filesets-cache-hostname-flag): Doc fix.
	(filesets-menu-cache-file): Doc fix.  Mark as risky.
	(filesets-menu-before, filesets-menu-path, filesets-menu-in-menu):
	Don't defcustom them if running in Emacs.

2002-05-04  Thomas Link <t.link@gmx.at>

	* filesets.el (filesets-ingroup-collect-files):
	Fix problem with inclusion groups' :scan-depth property.

2002-05-04  Colin Walters  <walters@verbum.org>

	* ibuf-ext.el (ibuffer-kill-filter-group): Test for killing
	"Default" group earlier.  Push killed group on
	`ibuffer-filter-group-kill-ring'.
	(ibuffer-kill-line): Document.  Don't push killed group ourselves.
	(ibuffer-yank-filter-group): Renamed from `ibuffer-yank'.
	(ibuffer-insert-filter-group-before): New function, broken out
	from `ibuffer-yank'.
	(ibuffer-yank): Now just call `ibuffer-yank-filter-group'.

	* ibuffer.el (ibuffer-mode-operate-menu, ibuffer-mode-mark-menu)
	(ibuffer-mode-view-menu): Unused variables; deleted.
	(ibuffer-find-file): Pass wildcard flag to `find-file' correctly.

2002-05-04  John Paul Wallington  <jpw@shootybangbang.com>

	* ibuffer.el (ibuffer-mode-groups-popup): New variable.
	(toplevel): Bind filter group menu entries in it.  Add :enable
	forms for some menu items.
	(toplevel): Bind [down-mouse-3] in `ibuffer-mode-filter-group-map'
	to `ibuffer-mouse-popup-menu'.
	(ibuffer-mouse-popup-menu): Test whether or not we're on a filter
	group name, and if so, pop up a filter group menu.

2002-05-04  Jason Rumney  <jasonr@gnu.org>

	* mwheel.el (mwheel-event-button): Translate mouse-wheel events.
	(mwheel-scroll): Recognize nil scroll amount as documented.

	* term/w32-win.el (mouse-wheel-scroll-line)
	(mouse-wheel-scroll-screen): Remove.
	([mouse-wheel], [C-mouse-wheel], [S-mouse-wheel]): Use mwheel-scroll.

	* w32-vars.el: (mouse-wheel-scroll-amount): Removed.

2002-05-04  Markus Rost  <rost@math.ohio-state.edu>

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	Bind case-fold-search when searching.

2002-05-04  Eli Zaretskii  <eliz@is.elta.co.il>

	* apropos.el (apropos-print): Fix the reference to mouse-2.

2002-05-04  Daniel Pfeiffer  <occitan@esperanto.org>

	* play/mpuz.el (mpuz-switch-to-window): Set buffer-read-only directly.

2002-05-04  Kim F. Storm  <storm@cua.dk>

	* cus-edit.el (custom-buffer-verbose-help): New variable.
	(custom-buffer-create-internal): Remove verbose introduction
	in customization buffer when it is nil.

2002-05-03  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (select-safe-coding-system):
	Don't offer coding systems that use locking shift.
	Ask for confirmation if chosen coding system disagrees with
	a `coding:' spec in the file.

2002-05-03  John Wiegley  <johnw@gnu.org>

	* eshell/esh-var.el (eshell-modify-global-environment): Added this
	customization variable, which will cause any "export" commands
	within any eshell buffer to modify the global Emacs environment.
	It defaults to nil, which means that such commands will only
	modify that Eshell buffer's environment.
	(eshell-var-initialize): Initialize `eshell-modify-global-environment'.

	* eshell/em-cmpl.el (eshell-command-completions-alist):
	Improve default completion targets for objdump, nm and readelf.

2002-05-03  Colin Walters  <walters@verbum.org>

	* play/gamegrid.el (gamegrid-user-score-file-directory): New variable.
	(gamegrid-add-score-with-update-game-score):
	Use `shared-game-score-directory'.  Correctly handle non-setuid case.

2002-05-02  Colin Walters  <walters@verbum.org>

	* replace.el (occur-mode-map): Bind "q" to `delete-window'.
	(occur-1): If one of the buffers we're searching is the *Occur*
	buffer itself, handle it by creating a temporary buffer.  If any
	of the buffers being searched are killed, note that in the search
	result message.  Also, set local variables before we possibly kill
	the buffer.

2002-05-02  Kim F. Storm  <storm@cua.dk>

	* menu-bar.el (menu-bar-make-toggle): Added optional PROPS arg.
	(menu-bar-options-save): Added cua-mode.
	(menu-bar-options-menu): Added toggle for cua-mode.
	Disable toggle for transient-mark-mode if cua-mode is enabled.

	* emulation/cua-base.el (cua-inhibit-cua-keys): New buffer-local
	variable.

2002-05-01  Richard M. Stallman  <rms@gnu.org>

	* help.el (view-todo): New function.
	(help-map): Bind C-h C-t to view-todo.
	(help-for-help): Change the text.

2002-05-01  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el: Yet more doc string, commment and whitespace
	changes.
	(f90-imenu-flag): New name for internal variable f90-imenu.
	(f90-blocks-re, f90-program-block-re, f90-end-if-re)
	(f90-no-break-re): Use regexp-opt.
	(f90-end-type-re): Add closing "\\>".
	(f90-indent-region): Correctly indent comments embedded in
	continued lines.
	(f90-indent-new-line): Make it indent the current line, as it should.
	(f90-line-continued, f90-get-present-comment-type)
	(f90-looking-at-if-then, f90-indent-line, f90-indent-new-line)
	(f90-indent-region, f90-indent-subprogram, f90-do-auto-fill)
	(f90-join-lines, f90-fill-region, f90-match-end, f90-insert-end)
	(f90-change-keywords): Minor code tidying.

	* progmodes/fortran.el (fortran-strip-sequence-nos): Rename from
	typo `fortran-strip-sqeuence-nos'.

2002-05-01  Eli Zaretskii  <eliz@is.elta.co.il>

	* simple.el (clone-indirect-buffer-other-window): Fix a typo in
	pop-up-window.

2002-05-01  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--pre-command-handler):
	Only interpret delete-selection property if mark-active.
	(cua-mode): Fixed require in defcustom.

2002-05-01  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* calendar/cal-menu.el (cal-menu-x-popup-menu): Fix argument of
	error call.

2002-05-01  Colin Walters  <walters@verbum.org>

	* textmodes/tex-mode.el (tex-validate-buffer):
	Use `occur-revert-arguments' instead of setting `occur-nlines' and
	`occur-buffer'.  Don't test for `input-pending-p' in loop.
	Set text property `occur-target' instead of `occur'.

2002-04-30  John Wiegley  <johnw@gnu.org>

	* align.el (align-region): Fixed the fix to align-region, because
	the "name" argument was appearing twice.

2002-05-01  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-decl-1): Better way
	to handle protection labels, one which doesn't get confused by
	inherit colons.

	* progmodes/cc-engine.el (c-end-of-decl-1): Don't treat
	functions that have "class" or "struct" in the return type as
	classes or structs.

2002-04-30  Kim F. Storm  <storm@cua.dk>

	* menu-bar.el (menu-bar-custom-menu): Change "Recently Changed
	Options" to "New Options..."; rephrase tooltip.
	Rephrase tooltip for "Specific Option...".
	Added "Saved Options" item.  [from Simon Marshall]

2002-04-30  Richard M. Stallman  <rms@gnu.org>

	* time.el (display-time-mail-directory)
	(display-time-mail-function): Doc fixes.

	* ediff-hook.el: Remove autoload cookies.

	* language/tibetan.el (tibetan-obsolete-glyphs): Now in tibet-util.el.

	* language/tibet-util.el (tibetan-obsolete-glyphs): From tibetan.el.

	* align.el (align-region): Fix call to `message'.
	Check that (car rule) is a symbol.

	* autoinsert.el (auto-insert-directory): Doc fix.

	* facemenu.el (describe-text-at and stuff): Moved to descr-text.el.

	* descr-text.el: New file, broken out of facemenu.el.

	* emacs-lisp/advice.el (documentation): Add ad-define-subr-args call.

2002-04-29  Markus Rost  <rost@math.ohio-state.edu>

	* mail/emacsbug.el (report-emacs-bug-hook):
	Use replace-match only if search was successful.

2002-04-29  Richard M. Stallman  <rms@gnu.org>

	* net/zone-mode.el (zone-mode): Add write-file-hooks hook locally.

	* mail/emacsbug.el (report-emacs-bug-hook): Don't fail completely
	if the user edits the Emacs version number in the text.

	* filesets.el (filesets-running-xemacs): Make defvar unconditional.
	(filesets-ingroup-files): Renamed from filesets-ingroup-paths.
	(filesets-error): Simplify definition and make conditional
	on filesets-running-xemacs.
	(filesets-find-file-using): Renamed from fsfind-file-using.

2002-04-29  Stefan Monnier  <monnier@cs.yale.edu>

	* info.el (Info-find-in-tag-table-1, Info-read-subfile): Use point-min.
	(Info-read-node-name-1): Complete file names.
	(Info-complete-menu-item): Don't cons unnecessarily.

	* files.el (locate-file): New fun.
	(locate-file-completion): Rename from load-completion and generalize.
	(load-library): Use it.
	(make-auto-save-file-name): Expand caddr.

	* newcomment.el (comment-fill-column): New var.
	(comment-indent): Use it.
	(comment-or-uncomment-region): New fun.
	(comment-dwim): Use it.

2002-04-29  Colin Walters  <walters@verbum.org>

	* ibuf-ext.el (ibuffer-kill-filter-group): Call `delete' function.
	(ibuffer-kill-line): Copy the filter group data structure when killing.
	(ibuffer-yank): Handle case where we're yanking on the default
	group correctly.
	(ibuffer-delete-saved-filter-groups): Doc fix.

	* play/gamegrid.el (gamegrid-add-score-with-update-game-score):
	Test whether or not update-game-score is setuid, and do the right
	thing.

2002-04-29  Kim F. Storm  <storm@cua.dk>

	* subr.el (remove-yank-excluded-properties): New helper function.
	(insert-for-yank, insert-buffer-substring-as-yank): Use it.

	* simple.el (yank-excluded-properties): Added help-echo to list.

2002-04-29  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* autoinsert.el (auto-insert-directory): Doc fix.

	* progmodes/f90.el: Add/change doc strings for many inline
	functions.  Whitespace changes.
	(f90-indent-line-no, f90-update-line): Minor code changes.

2002-04-29  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el: New file.

	* emulation/cua-rect.el: New file.

	* emulation/cua-gmrk.el: New file.

	* emulation/keypad.el: New file.

2002-04-29  Triet Hoai Lai  <thlai@ee.usyd.edu.au>

	* language/vietnamese.el (viet-tcvn-decode-table, ccl-decode-tcvn)
	(ccl-encode-tcvn, ccl-encode-tcvn-font, vietnamese-tcvn):
	New Vietnamese coding system.

	* language/viet-util.el: Update Commentary section.

2002-04-29  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* filesets.el (filesets-data): Doc fix.
	(filesets-running-xemacs): Define even when compiling.

	* recentf.el (recentf-cancel-dialog): Remove dot at the end of
	sentence.

2002-04-29  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (fill-context-prefix): Fix last change with
	yet-another-approach.

2002-04-28  Markus Rost  <rost@math.ohio-state.edu>

	* net/ange-ftp.el (ange-ftp-passive-host-alist)
	(ange-ftp-bs2000-additional-pubsets):  Fix custom type.

	* files.el (small-temporary-file-directory): Fix custom type.

2002-04-28  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-xemacs-flag): New variable.
	(f90-mark-subprogram-overlay): New variable.
	(f90-mark-subprogram): Now it highlights the subprogram.
	(f90-font-lock-keywords-1, f90-font-lock-keywords-2):
	Fix highlighting of various "type" forms.

2002-04-28  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer-mode): Additional documentation on filter
	groups.

2002-04-28  John Paul Wallington  <jpw@shootybangbang.com>

	* ibuf-ext.el (ibuffer-set-filter-groups-by-mode): Don't make an
	ibuffer-mode filter group if `ibuffer-view-ibuffer' is nil.

2002-04-28  Richard M. Stallman  <rms@gnu.org>

	* mail/sendmail.el (mail-recover-1): Decrease non-random-len
	by 1 for the newly-readded #.

	* files.el (make-auto-save-file-name): Specify # as suffix
	in the non-file-visiting case.

	* subr.el (make-temp-file): New arg SUFFIX.

	* filesets.el: New file.

	* replace.el (occur-accumulate-lines): Avoid incf and decf.
	(occur-engine-add-prefix): New function.
	(occur-engine): Avoid using macrolet, incf and decf.
	Use occur-engine-add-prefix instead.
	Rename `l' to `lines' and `c' to `matches'.

	* replace.el (occur-engine, occur-mode-mouse-goto)
	(occur-mode-find-occurrence, occur-mode-goto-occurrence)
	(occur-mode-goto-occurrence-other-window)
	(occur-mode-display-occurrence): A position is just a marker,
	not a list.

	* replace.el (occur-revert-arguments):
	Renamed from occur-revert-properties.  All uses changed.

2002-04-28  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* recentf.el (recentf-menu-before): Use string to specify path in
	the menu.

	* international/mule-cmds.el (read-language-name): Take care of
	non-list values.

2002-04-27  Richard M. Stallman  <rms@gnu.org>

	* custom.el (custom-load-symbol): Moved from cus-edit.el.
	(custom-load-recursion): Likewise.

	* cus-edit.el (custom-load-symbol): Moved to custom.el.
	(custom-load-recursion): Likewise.

	* progmodes/ada-xref.el (ada-add-ada-menu): Menu pseudo-keys
	generated by easymenu are now lowercase.

2002-04-27  Richard M. Stallman  <rms@gnu.org>

	* menu-bar.el (menu-bar-update-buffers): Add menu items
	Next Buffer and Previous Buffer.

	* simple.el (next-buffer, prev-buffer): New commands.
	Bind C-x left and C-x right to them.

	* info.el (Info-header-line): Mark it as risky-local-variable.

	* subr.el (insert-for-yank): Replace `category' property
	with whatever properties it stands for.

	* subr.el (member-ignore-case): Ignore non-strings in LIST.

2002-04-27  Miles Bader  <miles@gnu.org>

	* faces.el (read-face-name): Format the prompt correctly when
	there's no default.

2002-04-26  Andrew Choi  <akochoi@shaw.ca>

	* term/mac-win.el: Don't call ediff-toggle-multiframe.
	Set default directory.  Set process-connection-type to nil.

2002-04-26  Richard M. Stallman  <rms@gnu.org>

	* loadup.el: Explicitly load cus-face and timer.

	* isearch.el: Don't require timer.

	* faces.el: Don't require cus-face.

	* cus-edit.el (customize-face): Use read-face-name
	and handle multiple faces.
	(customize-face-other-window): Make it work similarly.

	* faces.el (read-face-name): New defaulting features.
	New args STRING-DESCRIBING-DEFAULT and MULTIPLE.
	(list-faces-display): Use the face, not its name string,
	as arg when running customize-face.
	Put a `read-face-name' prop on the entire line.
	(describe-face): Handle multiple faces via read-face-name.

	* textmodes/tex-mode.el (tex-start-options): New variable.
	(tex-start-commands): New variable.
	(tex-start-options-string): Variable deleted.
	(tex-start-tex): Use tex-start-options and tex-start-commands,
	not tex-start-options-string.
	(tex-command): Doc fix.

2002-04-26  Sam Steingold  <sds@gnu.org>

	* mail/smtpmail.el (smtpmail-try-auth-methods): When `host' is
	not in the authinfo/netrc, keep `cred' at nil.

2002-04-26  Gerd Moellmann  <gerd@gnu.org>

	* find-file.el: Remove Ada-specific example code.

2002-04-25  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-hooks.el: Put back the autoloads.

2002-04-25  Colin Walters  <walters@verbum.org>

	* ibuffer.el (define column process): Use `ibuffer-aif'.

	* ibuf-ext.el (ibuffer-saved-filter-groups): Don't include broken
	defaults.
	(ibuffer-yank): Be sure to `setq' after we use `nconc'.
	(ibuffer-save-filter-groups): Correctly structure filter groups.
	(ibuffer-switch-to-saved-filter-groups): Correctly extract filter
	groups.

2002-04-25  Simon Josefsson  <jas@extundo.com>

	* mail/sendmail.el (mail-use-dsn): New variable to request
	delivery status notification from MTA.
	(sendmail-send-it): Use it.

	* mail/smtpmail.el (smtpmail-queue-counter): New variable.
	(smtpmail-send-it): Use it to construct new queue filenames
	(needed if you send more than one message per second, which is
	possible if you use Gnus Agent).

	* mail/smtpmail.el (smtpmail-auth-credentials): Support netrc
	files as well.
	(smtpmail-try-auth-methods): Support netrc data.
	(netrc-parse): Autoload netrc.

2002-04-25  Colin Walters  <walters@verbum.org>

	* replace.el (multi-occur-by-filename-regexp): Doc fix.
	(occur-engine): Go to `point-min'.  Make nlines argument actually
	mean number of context lines.  Handle it.  Pad digits to the right.

	* ibuf-ext.el (ibuffer-filtering-groups): Renamed to
	`ibuffer-filter-groups'.  All users updated.
	(ibuffer-show-empty-filter-groups): New variable.
	(ibuffer-saved-filter-groups): New variable.
	(ibuffer-maybe-save-stuff): Renamed from
	`ibuffer-maybe-save-saved-filters'.  Callers updated.
	Handle `ibuffer-saved-filter-groups'.
	(ibuffer-hidden-filtering-groups): Renamed to
	`ibuffer-hidden-filter-groups'.
	(ibuffer-filter-group-kill-ring): New variable.
	(ibuffer-save-with-custom): Doc fix.
	(ibuffer-set-filter-groups-by-mode): New function.
	(ibuffer-clear-filter-groups): New function.
	(ibuffer-current-filter-groups-with-position): Renamed from
	`ibuffer-current-filter-groups'.  Callers updated.
	(ibuffer-kill-filter-group): New function.
	(ibuffer-kill-line): New function.
	(ibuffer-yank): New function.
	(ibuffer-save-filter-groups): New function.
	(ibuffer-delete-saved-filter-groups): New function.
	(ibuffer-switch-to-saved-filter-groups): New function.
	(ibuffer-mark-on-buffer): Add optional arguments for adding a
	specific mark, and marking on a specific group.

	* ibuffer.el (ibuffer-formats): Doc fix.
	(ibuffer-mode-map): Bind <up> to `ibuffer-backward-line'.
	Bind new functions from ibuf-ext.el.  Add menu entries for them.
	Remove superfluous tooltips.
	(ibuffer-toggle-marks): If on a group name, then toggle marks just
	in that group.
	(ibuffer-mark-interactive): Handle filter groups.
	(ibuffer-mark-forward, ibuffer-unmark-forward)
	(ibuffer-mark-for-delete, ibuffer-unmark-backward)
	(ibuffer-mark-for-delete-backwards): Update docs.
	(ibuffer-current-filter-groups): Moved to ibuf-ext.el, and renamed
	to `ibuffer-current-filter-groups-with-position'.
	(ibuffer-redisplay-engine): Handle `ibuffer-show-empty-filter-groups'.
	(ibuffer-mode): Add some documentation about filter groups.

2002-04-25  Andreas Schwab  <schwab@suse.de>

	* find-dired.el (find-name-dired): Don't quote pattern twice.

2002-04-26  Miles Bader  <miles@gnu.org>

	* cus-edit.el (customize-face, customize-face-other-window):
	Use default instead of initial-input for suggested face.

2002-04-25  Gerd Moellmann  <gerd@gnu.org>

	* cus-edit.el (customize-face-other-window, customize-face):
	Interactively, when point is on text with a face, suggest to
	customize that face.

2002-04-25  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el: General tidy-up of commentary and some doc
	strings.

2002-04-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* scroll-all.el (scroll-all-function-all) New function to do the
	actual work.
	(scroll-all-scroll-down-all, scroll-all-scroll-up-all,
	scroll-all-page-down-all, scroll-all-page-up-all,
	scroll-all-beginning-of-buffer-all, scroll-all-end-of-buffer-all):
	Make them use scroll-all-function-all.

	* progmodes/f90.el (f90-get-beg-of-line): Removed and replaced
	with line-beginning-position.
	(f90-get-end-of-line): Removed and replaced with line-end-position.
	(f90-match-piece): Removed and replaced with match-string.
	(f90-current-indentation): Remove `current-column'.
	(f90-get-present-comment-type): Use match-string rather than
	buffer-substring.
	(f90-match-end): Use line-beginning-position, line-end-position
	rather than beginning-of-line, end-of-line.
	(f90-startup-message): Variable removed.

2002-04-24  Colin Walters  <walters@verbum.org>

	* replace.el (occur-accumulate-lines): Add optional argument
	`no-props'.  Handle it.
	(occur-engine): Use it.

	* ibuf-ext.el (toplevel): Remove byte-compile-dynamic.  Try to set
	up autoloads manually.
	(ibuffer-split-list): New function.
	(ibuffer-filtering-groups): New variable.
	(ibuffer-hidden-filtering-groups): New variable.
	(ibuffer-mouse-toggle-filter-group): New function.
	(ibuffer-toggle-filter-group): New function.
	(ibuffer-toggle-filter-group-1): New function.
	(ibuffer-forward-filter-group): New function.
	(ibuffer-backward-filter-group): New funtion.
	(ibuffer-generate-filter-groups): New function.
	(ibuffer-filters-to-filter-group): New function.
	(ibuffer-pop-filter-group): New function.
	(ibuffer-jump-to-filter-group): New function.
	(ibuffer-do-occur): Just use `occur-read-primary-args'

	* ibuffer.el (ibuffer-filter-group-name-face): New.
	(ibuffer-mode-map): Bind and add menu entries for most new
	functions; also, bind the arrow keys to the movement functions.
	(ibuffer-mode-filter-group-map): New.
	(ibuffer-mouse-toggle-mark): Handle group names.
	(ibuffer-mouse-visit-buffer): Error if the current buffer is killed.
	(ibuffer-skip-properties): New function.
	(ibuffer-backward-line, ibuffer-forward-line): Optionally skip
	group names.  Also, handle new properties.
	(ibuffer-visit-buffer, ibuffer-visit-buffer-other-window):
	Move error handling to `ibuffer-current-buffer'.
	(ibuffer-visit-buffer-other-frame, ibuffer-bury-buffer): Ditto.
	(ibuffer-visit-tags-table, ibuffer-do-view-1): Ditto.
	(ibuffer-toggle-marks): Add optional group argument.
	(ibuffer-mark-interactive): Skip group names.
	(ibuffer-current-buffer): Clean up error handling.
	(ibuffer-fontify-region-function): Fontify group names.
	(ibuffer-map-lines): Add extra group argument.  Handle it.
	(ibuffer-current-filter-groups): New function.
	(ibuffer-redisplay): Handle hidden filtering groups.
	(ibuffer-sort-bufferlist): New function, taken from
	`ibuffer-insert-buffers-and-marks'.
	(ibuffer-insert-filter-group): New function.
	(ibuffer-redisplay-engine): Renamed from
	`ibuffer-insert-buffers-and-marks'.  Handle new filtering groups.
	(ibuffer): Add filter-groups argument.  Handle it.
	Use `save-selected-window'.
	(ibuffer-mode): Make `ibuffer-filtering-groups' and
	`ibuffer-hidden-filtering-groups' buffer-local.

	* ibuf-macs.el (ibuffer-save-marks): Call `ibuffer-redisplay-engine'.

2002-04-24  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/easymenu.el (easy-menu-intern): Downcase before interning.
	(easy-menu-define-key-intern): Function deleted; callers intern
	and then call easy-menu-define-key.
	(easy-menu-do-add-item): Explicitly intern the key, but not BEFORE.
	(easy-menu-define-key): Use easy-menu-name-match to match BEFORE.
	(easy-menu-name-match): New function.
	(add-submenu): New function.
	(easy-menu-get-map-look-for-name): Use easy-menu-name-match.

2002-04-24  Eli Zaretskii  <eliz@is.elta.co.il>

	* menu-bar.el (menu-bar-adv-search-menu)
	(menu-bar-adv-search-menu): Improve the help text.

2002-04-24  Simon Josefsson  <jas@extundo.com>

	* net/netrc.el: New file.

2002-04-24  Thomas DeWeese <tdeweese@rochester.rr.com>

	* term/x-win.el (x-select-text, x-cut-buffer-or-selection-value):
	Check if any of the available selection sources has new content
	and if so it will return that content.

2002-04-24  Miles Bader  <miles@gnu.org>

	* menu-bar.el (buffers-menu-show-directories)
	(buffers-menu-show-status): New variables.
	(menu-bar-update-buffers-1): Use them.

2002-04-24  Martin Stjernholm  <mast@lysator.liu.se>

	* progmodes/cc-cmds.el (c-mask-comment): More fixes when used
	from `c-do-auto-fill' and point is at or near the limit of the
	comment.  Fixed bug when the prefix from `c-guess-fill-prefix'
	is longer than the text on the first line of the comment when
	it's masked.

2002-04-24  Miles Bader  <miles@gnu.org>

	* menu-bar.el (menu-bar-update-buffers-1): Make sure
	`uniquify-buffer-name-style' is bound.

2002-04-23  Colin Walters  <walters@verbum.org>

	* replace.el (toplevel): Require `cl' while compiling.
	(occur-buffer, occur-nlines): Delete.
	(occur-revert-properties): Rename to `occur-revert-properties'.
	(occur-mode): Handle it.  Set up font lock.
	(occur-revert-function): Simply apply `occur-1'.
	(occur-mode-find-occurence, occur-mode-mouse-goto)
	(occur-mode-goto-occurrence-other-window)
	(occur-mode-display-occurrence): Handle buffer property.
	(list-matching-lines-face): Use defcustom.
	(list-matching-lines-buffer-name-face): New variable.
	(occur-accumulate-lines): Renamed from `ibuffer-accumulate-lines',
	in ibuffer.el.
	(occur-read-primary-args): Move out of `occur'.
	(occur): Delete.  Now simply call `occur-1'.
	(multi-occur, multi-occur-by-filename-regexp): New functions.
	(occur-1): New function.
	(occur-engine): Renamed from `ibuffer-occur-engine' to replace the
	previous implementation of `occur'; taken from ibuf-ext.el.
	(occur-fontify-on-property): New function.
	(occur-fontify-region-function, occur-unfontify-region-function):
	New functions.

	* ibuffer.el (ibuffer-accumulate-lines): Moved to replace.el.

	* ibuf-ext.el (ibuffer-depropertize-string): Delete.
	(ibuffer-occur-match-face): Delete.
	(ibuffer-occur-props, ibuffer-occur-mode): Delete.
	(ibuffer-occur-mouse-display-occurence): Delete.
	(ibuffer-occur-goto-occurence, ibuffer-occur-display-occurence)
	(ibuffer-do-occur-1, ibuffer-occur-revert-buffer-function): Delete.
	(ibuffer-occur-engine): Moved to replace.el.
	(ibuffer-do-occur): Simply call `occur-1'.

	* play/gamegrid.el (gamegrid-add-score-with-update-game-score):
	Handle the case where we're already viewing the score file.

2002-04-23  Andreas Schwab  <schwab@suse.de>

	* menu-bar.el (menu-bar-goto-menu): Fix bindings for next-tag and
	next-tag-otherw.

2002-04-23  Miles Bader  <miles@gnu.org>

	* menu-bar.el (menu-bar-update-buffers-1): Don't display a
	directory separator if there's no directory.  Don't display
	directories at all if uniquify is active.  Some code cleanup.
	(uniquify-buffer-name-style): Declare (but don't initialize).

	* menu-bar.el (menu-bar-update-buffers): Don't use constant lists
	for command menu entries, since the low-level menu code modifies
	them.  Cache the resulting list.
	(menu-bar-buffers-menu-command-entries): New variable.

	* menu-bar.el (menu-bar-update-buffers): Add `Select Named Buffer'.
	Add separator line before commands
	Remove old crufty code that tried to line things up by adding
	spaces to entries (it doesn't work).
	Move `Frames' submenu after the normal buffers, and add a
	separator line before it.
	(menu-bar-buffers-menu-list-buffers-entry): Variable removed.

2002-04-22  Richard M. Stallman  <rms@gnu.org>

	* files.el (after-find-file): Use %s to output MSG.

	* dired.el (dired-mouse-find-file-other-window):
	Handle events that move out of the window.

2002-04-23  Martin Stjernholm  <mast@lysator.liu.se>

	* progmodes/cc-cmds.el (c-mask-comment): Fixed bug where point
	was moved to the following line when it was at the first line
	of a block comment where comment-start-skip matched to eol.

2002-04-22  Richard M. Stallman  <rms@gnu.org>

	* simple.el (line-move-finish): Find beg and end of line
	before calling line-move-to-column.  Do consider intangible
	when finding the end.  Take more care in analyzing the results
	of intangibility after line-move-to-column.

2002-04-22  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* international/mule-diag.el (list-input-methods-1): Doc fix
	(LEIM is now part of the standard distribution).

	* tmm.el (tmm-completion-prompt): Doc fix.

	* hilit-chg.el (global-highlight-changes): Capitalize status texts.

2002-04-22  Edward M. Reingold  <reingold@emr.cs.iit.edu>

	* diary-lib.el (include-other-diary-files): Allow modifying
	included buffer, to turn off selective display.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-mode.el: (c-define-abbrev-table): New function to
	pass the SYSTEM-FLAG to `define-abbrev' in a way that works in
	emacsen that doesn't support it.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el, progmodes/cc-engine.el,
	progmodes/cc-styles.el, progmodes/cc-vars.el
	(c-guess-basic-syntax, c-lineup-topmost-intro-cont):
	Find correct anchor for statement-cont in top level constructs.
	Analyze variable initializations in top level constructs as
	topmost-intro-cont instead of statement-cont.  That is an
	incompatible change but it gives better consistency.  The new
	lineup function c-lineup-topmost-intro-cont' compensates for
	it and is now put on topmost-intro-cont by default.

	* progmodes/cc-align.el, progmodes/cc-engine.el,
	progmodes/cc-langs.el (c-lineup-argcont): Lineup function
	contributed by Kevin Ryde.

	(c-in-gcc-asm-p): Function to recognize asm statements.
	Contributed by Kevin Ryde.

	(c-opt-asm-stmt-key): New language variable to recognize the
	beginning of asm statements.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-guess-basic-syntax):
	Detect variable declarations after class and struct declarations
	correctly.  Fixed limit error when finding the anchor for
	template-args-cont and topmost-intro-cont.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-beginning-of-defun)
	(c-declaration-limits): Find the "line oriented" declaration
	start too, just like the "line oriented" end is found.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-vars.el (c-offsets-alist): A more sane default
	for `inexpr-statement'.  This is not compatible, though.
	I think the benefit of a good default style outweights that in
	this case.  Besides, `inexpr-statement' is not very common.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-delete-forward):
	Fix silly bug that caused it to delete backwards in hungry delete
	mode.  (It's amazing that this bug hasn't been reported.)

	* progmodes/cc-cmds.el (c-declaration-limits, c-mark-function):
	Extracted the code to get the declaration limits from
	`c-mark-function' to a new `c-declaration-limits'.

	(c-indent-defun): Use the same method to get the limits of the
	declaration or macro as `c-mark-function'.

	* progmodes/cc-engine.el (c-beginning-of-decl-1): Handle brace
	list initializers correctly (but costly; it ought to be
	integrated into `c-beginning-of-statement-1').

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el, progmodes/cc-engine.el
	(c-beginning-of-defun, c-end-of-defun, c-mark-function):
	Rewritten to detect the declaration limits better.
	Now handles K&R argdecls, class definitions followed by variables etc.

	(c-in-knr-argdecl): Broke out the K&R argdecl test in
	`c-beginning-of-decl-1' to this new function.

	(c-end-of-statement-1, c-end-of-decl-1):
	Replace `c-end-of-statement-1' with `c-end-of-decl-1', which correctly
	handles declarations that continue after the block.

	* progmodes/cc-engine.el (c-syntactic-re-search-forward):
	Added an option to restrict matching to the top level of the
	current paren sexp.

	* progmodes/cc-langs.el (c-opt-block-decls-with-vars-key):
	New regexp to recognize declarations that continue after the block.

	(c-syntactic-eol): New regexp to match a "syntactic" eol.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-guess-basic-syntax): Fixed a bug
	that often caused the backward limit to be lost at the top
	level.  This improves performance a bit.

	* progmodes/cc-engine.el (c-syntactic-re-search-forward):
	New function that works like `re-search-forward' but only returns
	matches in syntactically significant text.

	* progmodes/cc-engine.el: Fixed a faster and more accurate way
	to recognize K&R argdecls.

	(c-beginning-of-decl-1): New function that put point at the
	beginning of the declaration.  It handles K&R argdecl blocks.

	(c-guess-basic-syntax): Replaced the `knr-argdecl' recognition
	code with one that doesn't depend on the current indentation.
	The anchor position for `knr-argdecl' has also changed, but in
	a way that is unlikely to cause compatibility problems.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-defs.el, progmodes/cc-engine.el
	(c-forward-comment): `forward-comment' in XEmacs skips over
	line continuations in the backward direction.  Correct for
	that.  Also made this a defun since it has grown too large now
	to be a defsubst.

	* progmodes/cc-langs.el: More convenient and decentralized
	setup of the language specific variables.  The regexp-opt
	mangling is also done at compile time now.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-indent-line-or-region):
	Call `c-indent-line' directly instead of through
	`indent-according-to-mode' so that this function always
	indents syntactically.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Fixed a bug
	where a class beginning with a nested class could cause an
	infinite loop (the state outside the narrowed out class is
	never used now).

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el, progmodes/cc-cmds.el,
	progmodes/cc-engine.el, progmodes/cc-vars.el: Fixes so that
	the context sensitive analysis inside macros is restricted to
	the bodies of #define's; other things, like #if expressions,
	never have anything in common with their surroundings.
	The old `cpp-macro-cont' syntax is now used in situations where
	the syntactic analysis isn't applicable, and a new syntactic
	element `cpp-define-intro' is used to add indentation in
	#define bodies.

	(c-lineup-cpp-define): New name for `c-lineup-macro-cont' to
	better reflect its use.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Ignore line
	continuation backslashes in the detection of `arglist-cont-nonempty'.

	* progmodes/cc-align.el: Use the vector form in the return
	value in all cases where lineup functions return absolute columns.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-add-stmt-syntax)
	(c-guess-basic-syntax): Anchor `brace-list-intro' and
	`bracec-list-close' better for brace lists nested inside expressions.

	* progmodes/cc-engine.el, progmodes/cc-langs.el,
	progmodes/cc-mode.el, progmodes/cc-styles.el: Cleaned up the
	various language specific variables and their initialization.
	The keyword regexps are now lists that are combined with
	regexp-opt.  Some variables have changed names to fit better
	with the naming convention.

	* progmodes/cc-defs.el, progmodes/cc-vars.el
	(c-buffer-is-cc-mode): The value is the mode symbol of the
	original CC Mode mode.

	(c-major-mode-is): Compare against the buffer local variable
	`c-buffer-is-cc-mode', which is faster than using `derived-mode-class'.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-forward-syntactic-ws)
	(c-backward-syntactic-ws, c-forward-token-1)
	(c-backward-token-1, c-in-literal, c-literal-limits)
	(c-collect-line-comments, c-literal-type, c-on-identifier)
	(c-guess-basic-syntax): These functions are now considered part
	of the "CC Mode API" and may be used by other code.
	That's signified by making their documentation into docstrings.

	(c-whack-state, c-hack-state, c-skip-case-statement-forward):
	Removed these internal functions since they aren't used.

	(c-forward-to-cpp-expression): Classified this function as internal.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-langs.el (c-ObjC-class-key, c-Java-class-key):
	Simplified these regexps; the class keywords they contain
	ought to be enough to avoid false matches, so checking for
	following identifiers etc is just unnecessary (and might also
	fail for oddly formatted code).

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el, progmodes/cc-cmds.el
	(c-forward-comment-lc): New function that behaves like
	`c-forward-comment', with the exception that line
	continuations are treated as whitespace.

	(c-beginning-of-statement): Use `c-forward-comment-lc', to
	work correctly in macros and other places where line
	continuations should be treated as whitespace.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Analyze a
	normal label in a switch block as a case label, to get
	consistent lineup with the case labels.

	* progmodes/cc-engine.el (c-backward-syntactic-ws): Fixed bug
	in skipping over a macro that ends with an empty line.

	* progmodes/cc-styles.el: Require cc-align since styles added
	with `c-add-style' often contains references to functions
	defined there, and so the `c-valid-offset' check might
	otherwise complain on them.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el, progmodes/cc-mode.texi,
	progmodes/cc-vars.el: Added two new lineup functions:

	(c-lineup-knr-region-comment): A new lineup function to get
	(what most people think is) better indentation of comments in
	the "K&R region" between the function header and its body.

	(c-lineup-gcc-asm-reg): New lineup function for better
	indentation inside gcc asm blocks.  Contributed by Kevin Ryde.

	(c-offsets-alist): Use `c-lineup-gcc-asm-reg' and
	`c-lineup-knr-region-comment' in the default offset
	configuration, since these two functions have little impact
	outside their intended use, and they generally do the right
	thing when they kick in.

	* progmodes/cc-engine.el (c-guess-continued-construct)
	(c-guess-basic-syntax): Handle nested functions in all
	languages, not just Pike.  In C and C++ there's a gcc
	extension for this, and it also gives better treatment of
	macros that are followed by blocks.

	* progmodes/cc-langs.el (c-symbol-key): Made this variable
	mode specific, to handle Pike special symbols like `== better.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el, progmodes/cc-engine.el,
	progmodes/cc-vars.el (c-report-syntactic-errors): A new
	variable to control the syntactic error messages.  It defaults
	to off; since CC Mode ignores most syntactic errors it might
	as well ignore them all for the sake of consistency.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-looking-at-inexpr-block):
	Optimization.  Can give a noticeable speedup if there's a
	large preceding function or class body.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el, progmodes/cc-cmds.el: Use more
	efficient and correct insertion functions in many places.
	Always inherit text properties correctly if the text is
	permanent.  Also do it for speed in temporary insertions,
	since I figure it's less work to continue the surrounding text
	properties than to break them.

	* progmodes/cc-styles.el (c-read-offset): Unbind SPC in the
	completion to make it easier to enter lists.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-beginning-of-defun): Fixed bug where
	c-state-cache was clobbered.

	* progmodes/cc-cmds.el, progmodes/cc-engine.el
	(c-calculate-state): Moved from cc-cmds.el to cc-engine.el due
	to dependency.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-parse-state): Ignore unbalanced
	open parens in macros (if point isn't in the same one).

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-context-open-line): New function
	that is the `open-line' equivalent to `c-context-line-break'.

	* progmodes/cc-mode.el (c-mode-base-map): Compatibility fix
	for Emacs 21 since `indent-new-comment-line' has been changed
	to `comment-indent-new-line' there.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el, progmodes/cc-langs.el
	(c-stmt-delim-chars, c-stmt-delim-chars-with-comma):
	New variables containing the character sets used to recognize
	statement/declaration boundaries.  These variables might help
	to support languages like javascript and awk, where newlines
	sometimes delimits statements.

	(c-crosses-statement-barrier-p): Use `c-stmt-delim-chars' as
	the set of statement delimiting characters, to allow it to be
	changed dynamically and per-mode.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-looking-at-bos)
	(c-looking-at-inexpr-block, c-add-stmt-syntax)
	(c-guess-basic-syntax): Treat blocks directly inside function
	calls like "bare" statements inside function calls, and not
	like in-expression statements.  This to make indentation of
	such blocks consistent with other statements inside macro calls.

	* progmodes/cc-engine.el (c-guess-basic-syntax):
	Made arglist-cont anchor correctly in arglists that contain statements.

	* progmodes/cc-engine.el (c-guess-basic-syntax):
	Fixed consistent anchoring of defun-block-intro in defuns in code
	blocks (can only occur in Pike).

	* progmodes/cc-engine.el (c-looking-at-inexpr-block)
	(c-looking-at-inexpr-block-backward): Changed the arguments to
	require containing sexps and paren state, for better efficiency.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el, progmodes/cc-engine.el,
	progmodes/cc-vars.el: Improved anchoring of statement and
	handling of labels in front of substatements.

	(c-guess-continued-construct, c-guess-basic-syntax):
	Improved and unified anchoring at statements.  Statements beginning
	with comments or labels are now avoided, by going out of
	blocks and containing statements if necessary.  This nesting
	handling also fixes the case when there's a statement after a
	block open brace.  Added the syntactic symbol `substatement-label'.

	(c-electric-colon): Map the new `substatement-label' to
	`label' when consulting `c-hanging-colons-alist'.

	(c-offsets-alist): Added substatement-label.  Updated the
	comments for the new anchoring positions at statements.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Use more sane
	anchor points for knr-argdecl-intro and access-label.
	They used to refer to some point on the same line, a bug which was
	neutralized by a kludge in `c-get-syntactic-indentation' which
	ignored such anchor points.

	(c-get-syntactic-indentation): Removed the kludge that was
	necessary due to buggy anchor points.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Do not check
	the absence of a comma before arglist-close (case 7A) in any
	language, since there's nothing better to do that case anyway.
	Added special case to make in-expression statements be
	recognized as normal arglist-cont if we're directly in a macro
	arglist, for consistency with other "bare" statements.

	* progmodes/cc-engine.el (c-looking-at-bos): Added optional
	limit arg for backward searches.

	* progmodes/cc-engine.el (c-looking-at-inexpr-block):
	Anchor gcc in-expression statements at the surrounding open
	parenthesis.  Treat a class body as an in-expression class if
	it's used in an object clone expression in Pike.

	* progmodes/cc-engine.el (c-get-offset)
	(c-get-syntactic-indentation): Allow several anchor positions
	in the list of syntactic symbols.  Only the first is used as
	the base for the offset calculation.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-indent-defun): Indent the current
	macro if inside one at the top level.  Do not throw an error
	if used at the top level outside a macro.

	* progmodes/cc-cmds.el (c-backslash-region): Do tab width
	alignment only if the backslashes can't be aligned with
	surrounding backslashes.

	* progmodes/cc-engine.el (c-end-of-macro): New function.

	* progmodes/cc-engine.el (c-least-enclosing-brace):
	Rewritten to not be destructive.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-context-line-break): Only do a macro
	line break when point is inside the content of it; if it's in
	the cpp keyword a normal line break is done.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Do not add
	cpp-macro-cont inside the argument list to a #define.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-defs.el (c-forward-comment): Implemented a
	kludge to avoid the problem most forward-comment incarnations
	have with `\' together with comment parsing.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-check-state-cache): Fixed bug
	which could cause the state returned by `c-parse-state' to
	lack a closed paren element.  That in turn could result in
	very long searches, since it's common that they start from the
	last preceding close brace.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-statement-1): Do not
	treat else-if as a single continuation, since that'd make it
	hard to get the right anchor point when there's a line break
	between the two keywords.  This change causes else-clause to
	be anchored on the closest preceding else-if and not always on
	the starting if, but that doesn't affect the indentation for
	any reasonably sane style.  Also introduced a noerror flag.

	(c-beginning-of-closest-statement): Removed;
	c-beginning-of-statement-1 now avoids the problem this one solved.

	* progmodes/cc-engine.el (c-guess-continued-construct)
	(c-guess-basic-syntax): Better and more uniform anchor points
	for 'statement-cont and 'substatement.  The effect is
	noticeable mostly when there's a label on the same line as the
	beginning of the statement, or when there are more stuff
	before the start of the statement.

	* progmodes/cc-engine.el (c-looking-at-inexpr-block):
	Added flag to disable looking at the type of the surrounding paren
	since that confuses c-beginning-of-statement-1 and a couple of
	other places.

	* progmodes/cc-engine.el (c-guess-basic-syntax):
	Avoid stepping to the previous statement in case 18.
	Improvements in recognition of statement blocks on the top level.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-statement-1)
	(c-crosses-statement-barrier-p): Rewritten to get a well
	defined and documented behavior.  This fixes some tricky cases
	in recognition of do-while constructs.

	(c-backward-to-start-of-do, c-backward-to-start-of-if):
	Removed; use c-beginning-of-statement-1 instead.

	(c-guess-continued-construct, c-guess-basic-syntax):
	Various fixes to not depend on the bugs previously in
	c-beginning-of-statement-1.  Cleanups in cases 18 and 17 to
	use the new behavior of c-beginning-of-statement-1 better.
	Fixed recognition of catch blocks inside macros.

	* progmodes/cc-engine.el (c-backward-syntactic-ws): Fixed bug
	in skipping over a macro.

	* progmodes/cc-langs.el (c-label-kwds): New variable to
	contain the appropriate c-*-label-kwds value.

	* progmodes/cc-vars.el (defcustom-c-stylevar): Fixed value
	evaluation bug that caused the widget for
	c-block-comment-prefix to bug out.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-guess-basic-syntax):
	Improved recognition of statements: They are now recognized in
	contexts where they normally can't occur, e.g. on the top level or
	in function call arguments.  This is mainly useful to recognize
	statements in macros at the top level, and in arguments to
	macros.  The cases has been moved around quite a bit, and case
	10 has been copied to case 18.  (The cases has not been
	renumbered because of this.)

	(c-guess-continued-construct): New function which has the
	rules which are common between cases 10 and 18.

	* progmodes/cc-engine.el (c-beginning-of-statement-1)
	(c-backward-to-start-of-do, c-backward-to-start-of-if):
	Fixes so that they really obey the passed limits.

	(c-safe-position): Return nil if the state doesn't contain a
	suitable position.

	(c-guess-basic-syntax): Fixes some too short limits in calls
	to c-beginning-of-statement-1.  Some fixes for top level
	analysis in ObjC mode.

	* progmodes/cc-engine.el (c-beginning-of-statement-1):
	Fixed bug in do-while statements where the body is not a block.

	* progmodes/cc-styles.el (c-set-style):
	Reset c-special-indent-hook to its global value if in override mode.
	Fixes problem where functions on that hook remained after
	style switch.

	* progmodes/cc-engine.el (c-evaluate-offset, c-get-offset):
	Use c-benign-error to report the c-strict-syntax-p error.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el, progmodes/cc-defs.el,
	progmodes/cc-cmds.el, progmodes/cc-engine.el, cc-vars.el:
	Several fixes to treat macros as code and not literals and to
	handle line continuations transparently.

	(c-skip-ws-forward, c-skip-ws-backward): New macros to skip
	through whitespace and line continuations, but not comments
	and macros.

	(c-in-literal): No longer recognizes macros as literals by
	default. An extra flag argument is required to do that.

	(c-macro-start, c-query-macro-start)
	(c-query-and-set-macro-start): Added a cache for the macro
	start position.

	(c-forward-syntactic-ws, c-backward-syntactic-ws): Fixes for
	more speed when limits are given.  Workaround for bad behavior
	in forward-comment in some emacsen when it hits a buffer limit
	with a large repeat count.

	(c-lineup-macro-cont): Improved behavior when
	c-syntactic-indentation-in-macros is nil.

	(c-syntactic-indentation-in-macros, c-backslash-max-column)
	(c-auto-align-backslashes): New customization variables to
	control macro handling.

	* progmodes/cc-menus.el (cc-imenu-c++-generic-expression):
	Fixes to handle line continuations.

	* progmodes/cc-defs.el, progmodes/cc-styles.el
	(c-get-style-variables, c-set-offset): Report style errors
	with message and ding instead of error signal.  This to avoid
	interrupted mode init if there's some style problem.

	(c-benign-error): New macro to report errors that doesn't need
	to interrupt the operation.

	* progmodes/cc-defs.el (c-point): Added eonl and eopl positions.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace, c-indent-region):
	Removed most of the c-state-cache fiddling, since the global
	state cache now handles this.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Fixed bug
	when there's an open paren at the very first char of the
	visible buffer region.

	* progmodes/cc-engine.el (c-parse-state, c-check-state-cache):
	Cache the state globally and invalidate it below every buffer
	change with the new after change function
	`c-check-state-cache'.  This gives a considerable performance
	boost when editing large functions or classes.

	* progmodes/cc-engine.el (c-whack-state-after): Slight optimization.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el, progmodes/cc-langs.el,
	progmodes/cc-align.el: Improvements to syntactic analysis
	inside macros:

	(c-block-stmt-1-kwds, c-block-stmt-2-kwds): New variables used
	by `c-guess-basic-syntax'.

	(c-parse-state): Fixed bug with braces inside macros when
	using cached state info.

	(c-forward-to-cpp-expression): New function to aid in
	syntactic analysis inside macros.

	(c-beginning-of-statement-1, c-backward-syntactic-ws):
	Fixes to work better inside macros.

	(c-forward-syntactic-ws): Whitespace between the # and the
	command should be allowed in preprocessor directives.

	(c-lineup-macro-cont): New lineup function to get context
	sensitive indentation inside macros.

	(c-offsets-alist): Made `c-lineup-macro-cont' the default for
	cpp-macro-cont.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-statement-1)
	(c-forward-syntactic-ws): Fixes to handle continued lines.

	(c-backward-to-start-of-if, c-guess-basic-syntax):
	Do syntactic analysis inside macros.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-indent-region): Did a speedup made
	possible by the more flexible state cache.

	* progmodes/cc-engine.el (c-parse-state, c-whack-state-before)
	(c-whack-state-after, c-hack-state)
	(c-narrow-out-enclosing-class, c-guess-basic-syntax):
	Improved the state cache system.  It now can use partial info from
	an old cached state to calculate a new one at a different
	position.  Removed some kludges to avoid the state cache.
	The new functions `c-whack-state-before' and `c-whack-state-after'
	replace the now obsolete `c-whack-state'.

	* progmodes/cc-engine.el (c-beginning-of-statement-1):
	Optimized backing through a macro.  This can speed things up
	quite a bit when there are long macros before point.

	(c-beginning-of-macro): Do not ignore the limit.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-continued-statement):
	Fixed a bug where the keyword wasn't reindented correctly if
	followed by another keyword or identifier.

	* progmodes/cc-engine.el (c-parse-state): Ignore closed brace
	pairs that are in macros.  Fixes some cases where e.g. the
	second of two "do { } while (0)" macros after each other
	indented differently.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-macro)
	(c-forward-syntactic-ws): Recognize "#!" as a preprocessor
	directive when it begins a line, to allow for script
	interpreter lines like "#!/usr/bin/pike" at the beginning of
	the file.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-looking-at-inexpr-block):
	Recognize brace blocks inside a parenthesis expression as
	inexpr-statement.  Useful when writing statements as macro arguments.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-fill-paragraph, c-do-auto-fill)
	(c-mask-comment): Broke out the comment masking code from
	`c-fill-paragraph' to a new function `c-mask-comment', to be
	able to do the same thing in `c-do-auto-fill'.  This should
	make auto-fill-mode behave better.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace, c-electric-paren):
	Check `executing-macro' to avoid blinking parens when macros
	are executed.

	* progmodes/cc-mode.el, progmodes/cc-styles.el
	(c-setup-filladapt): Moved from cc-mode.el to cc-styles.el for
	consistency with `c-setup-paragraph-variables' (which was
	placed there due to the dependency from `c-set-style').

	* progmodes/cc-styles.el, progmodes/cc-vars.el: Fixed bug with
	incomplete initialization from the style variable fallbacks if
	there already is a style called "user" defined when CC Mode
	starts up for the first time.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el, progmodes/cc-vars.el
	(c-comment-indent, c-indent-comment-alist): Added new variable
	`c-indent-comment-alist' to allow better control over
	`c-comment-indent'.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el (c-lineup-C-comments): Try to match
	both `comment-start-skip' and the comment prefix on the
	current line with the comment starter, so that we line up
	comments which matches `c-comment-prefix-regexp' on the first
	line (after the `/') without the need to make
	`comment-start-skip' match whatever `c-comment-prefix-regexp' matches.

	* progmodes/cc-mode.el, progmodes/cc-styles.el (c-common-init)
	(c-set-style-1, c-setup-paragraph-variables): Moved the
	variable initialization based on `c-comment-prefix-regexp' to
	a new function `c-setup-paragraph-variables', which is now
	used both at mode init and when a style that sets
	`c-comment-prefix-regexp' is activated.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-member-init-list):
	Better handling of C++ template args to avoid confusion with
	`<' and `>' used as operators in member init expressions.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-most-enclosing-brace)
	(c-least-enclosing-brace): Added optional second arg to limit
	the search to before a certain point.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Fixed bug
	which could cause incorrect analysis if a cached state is used
	(usually only happens when an electric key reindents a line).

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-defs.el (c-forward-comment): More idiosyncrasy
	insulation.  This time for XEmacs 21.

	* progmodes/cc-engine.el, progmodes/cc-langs.el:
	Improved handling of inheritance lists:

	(c-beginning-of-inheritance-list): Rewritten to use a more
	syntactically correct method that doesn't get confused by
	badly placed linebreaks and comments.

	(c-guess-basic-syntax): Several fixes to the handling of
	inheritance lists in combination with templates.  'inher-intro
	is now anchored on the start of the class declaration and not
	the indentation of the current line.  Switched places on cases
	5D.3 and 5D.4 and made them use more syntactically correct methods.

	(c-inher-key): Removed since the code in
	`c-guess-basic-syntax' now uses token-based search.

	* progmodes/cc-cmds.el, progmodes/cc-mode.el (c-mode-menu):
	Added a submenu to access some toggles.

	(c-toggle-syntactic-indentation): New function to toggle the
	variable `c-syntactic-indentation'.

	* progmodes/cc-styles.el (c-set-style): Improved the error
	message for incorrect offsets a bit.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-indent-exp): Don't require that the
	sexp follows point immediately, instead find the closest
	following open paren that ends on another line.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el (c-lineup-cascaded-calls):
	New indentation function.

	* progmodes/cc-engine.el (c-beginning-of-macro): Bugfix for
	directives with whitespace between the '#' and the name.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-forward-syntactic-ws)
	(c-backward-syntactic-ws): Handle line continuations as
	whitespace.  Don't move past a macro if that'd take us past
	the limit.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-macro)
	(c-forward-syntactic-ws): Multiline strings begin with `#"' in
	Pike, and that shouldn't be confused with a preprocessor directive.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el: Extended the kludge to interoperate
	with the delsel and pending-del packages wrt to the new
	function `c-electric-delete-forward'.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-indent-exp): Keep the indentation of
	the block itself, i.e. only indent the contents in it.

	* progmodes/cc-styles.el (c-set-style): Use the default
	argument to completing-read instead of initial-contents, if
	the function is recent enough to support it.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-mode.el (c-mode-help-address):
	Removed bug-gnu-emacs@gnu.org from the receiver list for bug reports.
	I've almost never seen a bug reported this way that should go
	to that list, but it's rather common that the reports concern
	the combination CC Mode and XEmacs instead.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-paren): Fixed bug when both
	brace-elseif-brace and brace-catch-brace are active and
	there's a "else if"-block before the catch block.

	* progmodes/cc-menus.el (cc-imenu-c++-generic-expression):
	Detect function headers that span lines.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace)
	(c-electric-semi&comma, c-electric-colon, c-electric-paren):
	Check for last on line only for doing the auto-newline-mode
	stuff, not for the reindentation.

	* progmodes/cc-cmds.el (c-electric-brace): Fixed bugs in the
	handling of c-syntactic-indentation: When it's nil, indent the
	new lines but don't reindent the current one.  Reindent the
	line only when the inserted brace comes first on it, instead
	of last.

	* progmodes/cc-cmds.el (c-electric-brace)
	(c-electric-semi&comma): Fixed two places where
	c-syntactic-indentation wasn't heeded.

	* progmodes/cc-cmds.el (c-electric-pound): Don't be electric
	inside a macro.

	* progmodes/cc-engine.el (c-backward-to-start-of-if): Try a
	little harder to find a fallback position when an orphan else
	is found.  Fixed case where an else following a do-while
	statement could be associated with an if inside the do-while.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-guess-fill-prefix): Tuned the dwim
	for the fallback to add a single space after the comment prefix.

	* progmodes/cc-cmds.el (c-indent-new-comment-line): Somewhat better
	behavior in some special cases, especially for single-line comments.
	Avoid breaking up a comment starter or ender.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-outline-level): Applied patch from
	the Emacs sources to make this work in invisible text.

	* progmodes/cc-langs.el (c-switch-label-key): Fixed regexp to
	not be confused by a later ':' on the same line as the label.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el, progmodes/cc-mode.el
	(c-electric-delete, c-electric-delete-forward):
	Split `c-electric-delete' into two functions where
	`c-electric-delete-forward' always deletes forward and
	`c-electric-delete' only contains the code necessary for
	XEmacs to choose between backward and forward deletion.
	`c-electric-delete-forward' is now bound to C-d to get the
	electric behavior on that key too.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-fill-paragraph): Fixed bogus direct
	use of c-comment-prefix-regexp, which caused an error when
	it's a list.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-mode.el, progmodes/cc-vars.el (c-common-init)
	(c-default-style): Removed the hardcoded switch to "java" style
	in Java mode.  It's instead taken care of by the default value
	for c-default-style.

2002-04-22  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-align.el (c-lineup-math): Fix bug where lineup
	was triggered by equal signs in string literals.

2002-04-21  Kim F. Storm  <storm@cua.dk>

	* subr.el (insert-buffer-substring-no-properties): New function.
	(insert-buffer-substring-as-yank): New function.

2002-04-21  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* scroll-all.el (minor-mode-alist): Fix usage of `scroll-all-mode'.
	(scroll-all-page-down-all, scroll-all-page-up-all) Remove `fkey-'
	prefix from scroll commands.  Ignore end-of-buffer errors from
	other windows.
	(scroll-all-check-to-scroll): Remove `fkey-' prefix from scroll
	commands.
	(scroll-all-beginning-of-buffer-all, scroll-all-end-of-buffer-all):
	New functions.

	* files.el: (auto-mode-alist): .f95 files in f90-mode.

	* progmodes/fortran.el: (fortran-beginning-do): Make regexp match
	a DO statement irrespective of numeric label.

2002-04-20  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* files.el (auto-save-file-name-transforms): Doc fix.
	Add third element to "uniquify" filenames.
	(make-auto-save-file-name): Use new element of
	auto-save-file-name-transforms.
	* startup.el (command-line): Add third element to
	auto-save-file-name-transforms.

2002-04-19  Stefan Monnier  <monnier@cs.yale.edu>

	* files.el (file-name-non-special): Don't mangle the 0'th arg and the
	return value of file-name-completion and file-name-all-completions.

2002-04-19  Glenn Morris <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el: Update maintainer.
	(f90-line-continued): Recognize blank/comment lines embedded in
	continuation lines.
	(f90-looking-at-program-block-start): No extra indentation after
	function or subroutine keyword appears in single quotes.

2002-04-19  Miles Bader  <miles@gnu.org>

	* custom.el (customize-mark-to-save, customize-mark-as-set)
	(custom-quote): Moved here from `cus-edit.el'.
	* cus-edit.el (customize-mark-to-save, customize-mark-as-set)
	(custom-quote): Moved to `custom.el'.

2002-04-18  Richard M. Stallman  <rms@gnu.org>

	* facemenu.el (list-text-properties-at): Command deleted.

	* rect.el (insert-rectangle): Use insert-for-yank.

	* register.el (insert-register): Use insert-for-yank.
	(describe-register-1): Discard text props in yank-excluded-properties.

	* toolbar/tool-bar.el (tool-bar-local-item-from-menu):
	Fix parts in construction of `menu-item' item at end.

	* mail/mailabbrev.el (mail-mode-abbrev-table): Delete defvar.

	* subr.el (insert-for-yank): New function.

	* simple.el (yank-excluded-properties): New user option.
	(yank-pop, yank): Use insert-for-yank.

2002-04-19  Kim F. Storm  <storm@cua.dk>

	* simple.el (pop-to-mark-command): Do not set this-command.
	(set-mark-command): Always jump to mark when called with arg.

2002-04-18  Francesco Potorti`  <pot@gnu.org>

	* comint.el (comint-watch-for-password-prompt): Remove whitespace
	at the beginning of password prompts.

2002-04-18  Andrew Innes  <andrewi@gnu.org>

	* facemenu.el: Remove require of wid-edit.

2002-04-17  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer-visit-buffer): Optionally allow reducing to
	one window.
	(ibuffer-visit-buffer-1-window): Simply call `ibuffer-visit-buffer'.
	(ibuffer-current-state-list): Reinstate optional argument; now
	just call `point' inside the mapping function.

2002-04-17  Francesco Potorti`  <pot@gnu.org>

	* dired-aux.el (dired-star-subst-regexp)
	(dired-quark-subst-regexp): New constants.
	(dired-do-shell-command, dired-shell-stuff-it): Use them.
	(dired-do-shell-command): Raise an error if both `*' and `?'
	substitution marks are used in the same command.
	(dired-shell-stuff-it): Substitute all instances of `*' and `?'
	in a command given via dired-do-shell-command.

	* comint.el (comint-password-prompt-regexp): Match "Repeat passphrase".

2002-04-16  Jason Rumney  <jasonr@gnu.org>

	* international/mule-cmds.el (locale-preferred-coding-systems):
	Add "jpn".

2002-04-16  Eli Zaretskii  <eliz@is.elta.co.il>

	* term.el (term-emulate-terminal): Fix last change.

2002-04-16  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* bindings.el (mode-line-mode-menu): Update names to reflect
	latest changes.

2002-04-16  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-at-indentation-p): Move to fix
	compilation error.

2002-04-16  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper-ex.el: Patch by Samuel Padgett. Copyright papers received.
	(viper-ex-print-buf-name): New variable.
	(viper-ex-print-buf): New variable.
	(ex-token-alist): Invoke ex-print on ":print" Ex commands.
	(ex-g-marks): New variable.
	(ex-print): New function.
	(ex-print-display-lines): New function.

	* viper.el (viper-set-hooks): Add window-setup-hook, which sets
	the cursor color.

	* ediff-util.el (ediff-cleanup-mess): Delete ctl window on exit
	when the window is not in its own frame.
	(ediff-clone-buffer-for-region-comparison): More robust window
	arrangement while prompting for regions to compare.
	(ediff-make-cloned-buffer): Use generate-new-buffer-name.
	(ediff-inferior-compare-regions): Deleted unused vars
	ctl-buf and quit-now.

2002-04-15  Richard M. Stallman  <rms@gnu.org>

	* facemenu.el (facemenu-add-new-face): Use this only for faces.
	Delete arg MENU.
	(facemenu-add-new-color): New function.
	(facemenu-set-foreground, facemenu-set-background):
	Use facemenu-add-new-color.

2002-04-15  Eli Zaretskii  <eliz@is.elta.co.il>

	* ediff-init.el (ediff-current-diff-face-A)
	(ediff-current-diff-face-B, ediff-current-diff-face-C)
	(ediff-current-diff-face-Ancestor, ediff-fine-diff-face-A)
	(ediff-fine-diff-face-B, ediff-fine-diff-face-C)
	(ediff-fine-diff-face-Ancestor, ediff-even-diff-face-A)
	(ediff-even-diff-face-B, ediff-even-diff-face-C)
	(ediff-even-diff-face-Ancestor, ediff-odd-diff-face-A)
	(ediff-odd-diff-face-B, ediff-odd-diff-face-C)
	(ediff-odd-diff-face-Ancestor): Add special color definitions for
	tty and MS-DOS displays.

2002-04-15  Andrew Innes  <andrewi@gnu.org>

	* facemenu.el: Require wid-edit.

2002-04-15  Miles Bader  <miles@gnu.org>

	* faces.el (highlight): Force foreground to be black on a tty, so
	this face is readable on a dark-background tty.
	* wid-edit.el (widget-field-face, widget-single-line-field-face):
	Likewise.

2002-04-14  Kim F. Storm  <storm@cua.dk>

	* simple.el (pop-to-mark-command, push-mark-command): New commands.
	(set-mark-command): Use them.
	Enhanced functionality when command is repeated:
	- If first command set the mark (no prefix arg), repeat temporarily
	enables transient-mark-mode.
	- If first command jumped to mark off ring (with argument),
	repeat (with or without arg) jump to next mark off ring.
	- Use C-u C-u prefix to set mark after jump.
	(exchange-point-and-mark): Temporarily enable transient-mark-mode
	if prefix arg.

2002-04-14  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* speedbar.el (speedbar-tag-hierarchy-method)
	(speedbar-toggle-updates, speedbar-toggle-images): Doc fixes.

2002-04-14  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-parse-tag-backward): Fix to work at
	beginning of buffer.

2002-04-14  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* speedbar.el (speedbar-generic-item-info)
	(speedbar-sort-tags): Doc fix.
	(speedbar-add-supported-extension): Fix typo in interactive spec.

2002-04-13  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer-forward-line): Just skip header if we're
	only moving one line forward.
	(ibuffer-map-lines): Preserve point position even if we delete
	lines.  Only call mapping functions with buffer and mark
	arguments; the other two were unused.
	(ibuffer-redisplay, ibuffer-update): Always skip special areas.

	* ibuf-macs.el, ibuf-ext.el: Update callers of `ibuffer-map-lines'.

	* calc/calc-bin.el (math-format-radix-float): Use `when'.

	* calc/calc.el (math-format-number): Load `calc-ext' before we
	call `math-group-float'.

	* play/gamegrid.el (gamegrid-add-score-with-update-game-score):
	Renamed from `gamegrid-add-score'.
	(gamegrid-add-score-insecure): Restored from the old
	`gamegrid-add-score'.
	(gamegrid-add-score): Just dispatch on `system-type' to one of the
	previous two functions.

2002-04-13  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* iswitchb.el: Update commentary to include new function
	iswitchb-exclude-nonmatching.

2002-04-12  John Wiegley  <johnw@gnu.org>

	* eshell/esh-ext.el (eshell-script-interpreter): Fix for CRLF
	operating systems to the regexp used to detect a script's interpreter.

2002-04-12  Eli Zaretskii  <eliz@is.elta.co.il>

	* frame.el (frames-on-display-list): Use `equal' to compare the
	`display' frame parameter to the argument DISPLAY.

2002-04-12  Dave Love  <fx@gnu.org>

	* help.el (string-key-binding): Deal with margin events.

2002-04-12  Francesco Potorti`  <pot@gnu.org>

	* comint.el (comint-password-prompt-regexp): Match " SMB password".

2002-04-11  Stefan Monnier  <monnier@cs.yale.edu>

	* sort.el (sort-reorder-buffer): Don't assume point-min == 1.

	* xt-mouse.el (xterm-mouse-mode): Use define-minor-mode.

	* emacs-lisp/lucid.el (device-class, buffer-syntactic-context)
	(buffer-syntactic-context-depth): New funs.

	* emacs-lisp/edebug.el (edebug-eval-defun): Don't use defconst
	on variables.

	* emacs-lisp/debug.el (debug-on-entry): Use push.
	(debugger-make-xrefs): Don't assume point-min == 1.

	* progmodes/cc-engine.el (c-backward-to-start-of-if):
	Don't assume point-min == 1.

	* progmodes/etags.el (etags-verify-tags-table, etags-snarf-tag)
	(etags-list-tags, etags-tags-apropos, select-tags-table):
	Don't assume point-min == 1.

2002-04-12  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-guess-indent): New function.

2002-04-11  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (fill-context-prefix): Fix up last change.

	* simple.el (line-move): Use memq rather than or.
	(transpose-sexps): Don't presume as much of forward-sexp's behavior.
	(do-auto-fill): Use fill-move-to-break-point.
	(syntax-code-table): Remove.

	* textmodes/fill.el (canonically-space-region): Obey sentence-end.
	Don't add spaces at end of sentences at end of line.
	(fill-move-to-break-point): Make sure the result is always greater
	than linebeg, so we ensure forward progress.
	(fill-region-as-paragraph): Compare to `to' rather than eobp.
	(fill-paragraph): Don't rebind fill-paragraph-function.

2002-04-11  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* menu-bar.el (menu-bar-adv-search-menu): Add incremental search.

2002-04-11  Andreas Schwab  <schwab@suse.de>

	* files.el (file-name-non-special): Handle return value of t from
	`file-name-completion'.

2002-04-10  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (fill-context-prefix): Match the two prefixes
	differently to avoid pathological exponential-time case.
	(adaptive-fill-regexp): Add ! and %.
	(fill-delete-prefix): Remove indentation while removing prefix.
	(fill-delete-newlines): Obey sentence-end.
	(fill-move-to-break-point, fill-newline): New functions extracted
	from fill-region-as-paragraph.
	(fill-region-as-paragraph): Use them.
	Don't fiddle with fill-indent-according-to-mode.

2002-04-10  Colin Walters  <walters@verbum.org>

	* play/snake.el (snake-score-file): Default to just "snake-scores".

	* play/tetris.el (tetris-score-file): Likewise.

	* play/gamegrid.el (gamegrid-add-score): Rewrite from scratch to
	use `update-game-score'.

	* ibuffer.el (ibuffer-canonicalize-state-list): Delete unused function.
	(ibuffer-current-buffers-with-marks): Don't call `buffer-list'
	ourselves; take it as an argument.  Caller updated.
	(ibuffer-mode): Make mode-class special.

2002-04-10  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-view-command-alist): New variable.
	(dired-view-file): Use external viewers for some files names.

	* mouse.el (mouse-drag-region-1): Display region highlight
	only in the selected window.

	* subr.el (remove-hook): When there are no more local hooks,
	kill the buffer-local value.

	* isearch.el (isearch-mode): Don't call make-frame-visible
	if frame is already visible.

	* cus-face.el (custom-face-attributes): Fix typo in `ultra-bold'.

2002-04-09  Emmanuel Briot  <briot@act-europe.fr>

	* progmodes/ada-prj.el: Add support for the new project file
	fields: gnatfind-opt, debug-pre-cmd and debug-post-cmd.  Fix
	widget handling for Emacs 21.  ada-mode now only supports a single
	active project file, instead of one per buffer.  This is far less
	confusing.

	* progmodes/ada-stmt.el: Menu changed from Statements to Templates.
	(ada-func-or-proc-name): Get real subprogram name, after change in
	ada-mode.el.

	* progmodes/ada-xref.el: Ada-mode no longer supports a different
	project file per buffer.  This was too complex.  Instead, there is
	now a single active project file at any given time, and the user
	can switch the active one through the Ada menu.  This revision
	also provides better handling of the Windows command line, and the
	various available shells on that platform.  ada-mode is now fully
	integrated with the GNU visual debugger gvd, see
	http://libre.act-europe.fr.
	(ada-prj-default-comp-opt): Use the new GNAT switch -gnatQ.
	This is only available with GNAT 3.14.
	(ada-prj-gnatfind-switches, ada-cd-command): New variable.
	(ada-quote-cmd): New function.
	(ada-initialize-runtime-library): Get the location of the actual
	runtime the compiler will be using, including support for
	cross-platform environments.
	(ada-treat-cmd-string): Add support for the new variable
	${full_current} add support for debug-pre-cmd and debug-post-cmd,
	two commands to run just prior to running the debugger, and just
	after starting it.  This provide better support for cross-platform
	and remote debugging.
	(ada-get-absolute-dir): Remove, replace with expand-file-name.
	(ada-gdb-application): New parameter executable-name.
	(ada-get-ali-file-name): Better handling of separate packages.
	Checkin on behalf of the ada-mode maintainer.

	* progmodes/ada-mode.el (ada-case-exception-file)
	(ada-indent-handle-comment-special): New variables.
	(ada-case-exception-substring): New variable.  Casing exceptions
	can now also be defined for substrings, in addition to full
	identifier names.  This provides more flexibility.
	(ada-align-list): New fun, provide support for align.el in ada-mode.
	(ada-procedure-start-regexp): Add support for operators and
	generic formal subprograms and packages.
	(ada-imenu-comment-re): New variable.
	(ada-imenu-generic-expression): Add support for protected types.
	(ada-mode): Set comment-start only after running ada-mode-hook, so
	that the user can change ada-comment-start in the hook.
	Add support for ispell in comments.  Add support for align.el.
	(ada-save-exception-file, ada-create-case-exception-substring)
	(ada-adjust-case-substring): New functions.
	(ada-get-current-indent): Properly handles keywords with uppercases.
	(ada-goto-matching-end): Rewritten, fixes problems in the handling
	of nested blocks.
	(ada-untab-hard): Do not touch the contents of comments and strings.

2002-04-09  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-lexical-context):
	Use sgml-parse-tag-backward to find start point.
	(sgml-looking-back-at): Doc fix.

2002-04-09  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* isearch.el (isearch-message-prefix): Use minibuffer-prompt face
	for prompt.

2002-04-08  Stefan Monnier  <monnier@cs.yale.edu>

	* autorevert.el (auto-revert-mode, global-auto-revert-mode):
	Use define-minor-mode.
	(auto-revert-buffers): Use with-current-buffer.
	Avoid changing the minor modes.

	* international/iso-acc.el (iso-accents-accent-key): Use `vector'
	rather than char-to-string since last-input-char can be any event.

	* international/titdic-cnv.el (tit-dictionary):
	Use defvar for non-constants.

	* progmodes/cwarn.el (global-cwarn-mode): Use define-minor-mode.
	(global-cwarn-mode): Use easy-mmode-define-global-mode.
	(cwarn-font-lock-keywords): New function.
	Replaces cwarn-font-lock-remove-keywords cwarn-font-lock-add-keywords.
	(cwarn-font-lock-match): New macro.
	(cwarn-font-lock-match-assignment-in-expression)
	(cwarn-font-lock-match-dangerous-semicolon)
	(cwarn-font-lock-match-reference): Use it.

	* progmodes/cperl-mode.el (cperl-make-face, cperl-force-face):
	Use defvar rather than defconst since it's meant to be settable.
	(cperl-syntax-done-to): Don't hardcode 1 as (point-min).
	(cperl-fix-line-spacing): Add missing \ in [ t].

	* loadup.el: Call ucs-unify-8859 directly rather than
	unify-8859-on-encoding-mode.
	(fns-*.el): Don't use it anymore.  Keep the load-history in purespace.

	* textmodes/sgml-mode.el (sgml-comment-indent-new-line): New fun.
	(sgml-mode): Use it for comment-line-break-function.

2002-04-08  Jason Rumney  <jasonr@gnu.org>

	* international/mule-cmds.el (reset-language-environment):
	Handle coding-systems not being defined yet.

2002-04-08  Sam Steingold  <sds@gnu.org>

	* vc-cvs.el (vc-cvs-valid-version-number-p): New function.
	(vc-cvs-checkin): Use it.

2002-04-08  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* files.el (display-time-string): Fix last change.

2002-04-07  Sam Steingold  <sds@gnu.org>

	* vc-cvs.el (vc-cvs-checkin): Pass the required argument to `error'.

2002-04-07  Jason Rumney  <jasonr@gnu.org>

	* international/mule-cmds.el (set-default-coding-systems)
	(reset-language-environment): Preserve eols on
	default-process-coding-system.
	(coding-system-change-text-conversion): Fix case where CODING is nil.

2002-04-07  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* subr.el (play-sound): Move here from simple.el.

	* simple.el (play-sound): Move to subr.el.

2002-04-06  Richard M. Stallman  <rms@gnu.org>

	* files.el (display-time-string-forms): Mark as risky.

	* enriched.el (enriched-decode-foreground, enriched-decode-background):
	Use proper format for desired elts of `face' property.
	Don't test display-color-p; make the properties unconditionally.

	* progmodes/compile.el (compilation-error-regexp-alist):
	New alternatives for FILE:LINE.COL and for ranges of columns and lines.

2002-04-06  Per Abrahamsen  <abraham@dina.kvl.dk>

	* progmodes/cc-vars.el (c-block-comment-prefix): Specify :value
	for customization type.
	Reported by Mattias Fredsberg <mattias.fredsberg@active-tv.com>.

2002-04-06  Mike Williams  <mdub@bigfoot.com>

	* textmodes/xml-lite.el: Remove.

2002-04-05  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* simple.el (play-sound): New function (uses play-sound-internal).

2002-04-04  Richard M. Stallman  <rms@gnu.org>

	* files.el (mode-line-format, mode-line-modified)
	(mode-line-mule-info, mode-line-buffer-identification)
	(mode-line-modes, mode-line-position): Explicitly mark as risky.
	(hack-one-local-variable): Don't recognize "mode-line-..." as risky.

	* calendar/solar.el (solar-northern-spring-or-summer-season): Doc fix.

	* mail/mailabbrev.el (mail-abbrev-make-syntax-table):
	Use (syntax-table), not old-syntax-table.

	* enriched.el (enriched-decode-foreground)
	(enriched-decode-background): Don't call facemenu-get-face.

2002-04-04  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el: Add missing require.
	(sgml-lexical-context): Fix up CDATA detection for boundary cases.

2002-04-03  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* pcvs.el (cvs-mode-previous-line, cvs-mode-next-line): Move to
	spot indicated by text property `cvs-goal-column', if present.

	* pcvs-info.el (cvs-fileinfo-pp): Use text property
	`cvs-goal-column' to indicate position of file name (if present).

2002-04-03  Richard M. Stallman  <rms@gnu.org>

	* mail/mailabbrev.el (mail-abbrev-complete-alias):
	Call mail-abbrev-make-syntax-table.

	* format.el (format-deannotate-region): Doc fix.

	* enriched.el (enriched-face-ans): Delete special treatment
	for fg:... and bg:... faces.
	(enriched-decode-foreground): Return a list that specifies
	the foreground color, rather than creating a face.
	(enriched-decode-background): Likewise.

	* shell.el (shell-mode): Don't reinit comint-input-ring
	if that was already done.

2002-04-03  Edward M. Reingold  <reingold@emr.cs.iit.edu>

	* solar.el (solar-spring-or-summer-season): Delete.
	(solar-northern-spring-or-summer-season): New variable.
	(solar-sunrise-and-sunset, solar-moment, solar-sunrise-sunset):
	Rewrite.

	* solar.el (diary-sabbath-candles-minutes): New variable.
	(diary-sabbath-candles): Use it instead of fixed 18 minutes.

	* calendar.el (update-calendar-mode-line): Force mode-line update.
	Make date under the cursor available as `date' in
	calendar-mode-line-format.
	Eval items in calendar-mode-line-format list.

	* cal-tex.el (cal-tex-hook, cal-tex-year-hook, cal-tex-month-hook)
	(cal-tex-week-hook, cal-tex-daily-hook): Add doc strings.

	* cal-tex.el (cal-tex-latexify-list): Fix doc string.

	* cal-tex.el (cal-tex-insert-day-names): LaTeXify day names.
	(cal-tex-cursor-week-iso, cal-tex-week-hours, cal-tex-weekly4-box)
	(cal-tex-cursor-filofax-2week, cal-tex-cursor-filofax-week)
	(cal-tex-daily-page, cal-tex-mini-calendar): LaTeXify day names.

	* cal-tex.el: Change all instances (interactive "P") to
	(interactive "p").
	(cal-tex-cursor-month): Add hfill and newline at end of month that
	ended on Saturday.
	(cal-tex-preamble): Change to LaTeX2e.
	(cal-tex-cursor-filofax-year): Don't use default month names in
	LaTeX macros in case user changes them.
	(cal-tex-month-name): New function.  Used throughout in case user
	has done something funny with month names.

	* cal-hebrew.el (holiday-rosh-hashanah-etc): Spelling correction.
	(diary-rosh-hodesh): Spelling correction.

2002-04-03  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-lexical-context)
	(sgml-parse-tag-backward): Extend support for CDATA to include
	conditional sections.

2002-04-03  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* cus-start.el: Rename `autoselect-window' to
	`mouse-autoselect-window'.

2002-04-02  Richard M. Stallman  <rms@gnu.org>

	* files.el (hack-one-local-variable):
	Clear text props from string value.

2002-04-02  Stefan Monnier  <monnier@cs.yale.edu>

	* progmodes/f90.el (f90-keywords-re, f90-keywords-level-3-re)
	(f90-procedures-re, f90-operators-re, f90-hpf-keywords-re):
	Use regexp-opt.
	(f90-keywords-re, f90-keywords-level-3-re): Add `pure' and `elemental'
	from F95.
	(f90-procedures-re): Add `null' and `cpu_time' from F95.
	(f90-font-lock-keywords-1): Minor reorganization so we don't need
	`override' any more.
	(f90-font-lock-keywords-3): Use `keep' rather than `override'.
	(f90-indent-subprogram): Use indent-region.
	(f90-break-line): Use indent-according-to-mode.

2002-04-02  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el (sgml-close-tag): Rename from
	sgml-insert-end-tag. Simplify by using sgml-lexical-context.
	(sgml-get-context): Remove use of sgml-inside-tag-p.
	(sgml-inside-tag-p): Remove.
	(sgml-looking-back-at): Short-circuit at beg of buffer.
	(sgml-lexical-context, sgml-calculate-indent): Add support for
	CDATA sections.

2002-04-01  Stefan Monnier  <monnier@cs.yale.edu>

	* help.el (help-key-description): New fun.
	(describe-key-briefly, describe-key): Use it and
	this-single-command-raw-keys plus new arg `untranslated'.

	* textmodes/sgml-mode.el (sgml-at-indentation-p, sgml-tag)
	(sgml-parse-tag-name, sgml-looking-back-at, sgml-parse-tag-backward)
	(sgml-inside-tag-p, sgml-get-context, sgml-show-context)
	(sgml-insert-end-tag): New funs taken from xml-lite.el.
	(sgml-calculate-indent): Use them.
	(sgml-slash-matching): Rename from sgml-slash.
	(sgml-slash): Copied from xml-lite and changed to use
	sgml-slash-matching and sgml-quick-keys.

	* international/mule-cmds.el (standard-keyboard-coding-systems):
	Add koi8-u and koi8-r.

	* eshell/.cvsignore: New file.

	* eshell/esh-groups.el: Remove.

	* progmodes/tcl.el: Change maintainer.
	(tcl-electric-hash-style): Change default to nil.
	(tcl-imenu-generic-expression): Use tcl-proc-regexp.
	(tcl-do-auto-fill): Remove.
	(tcl-auto-fill-mode): Rewrite using comment-auto-fill-only-comments.

2002-04-01  Mike Williams  <mdub@bigfoot.com>

	* textmodes/sgml-mode.el: Doc fixes.
	(sgml-mode): Set indent-line-function to sgml-indent-line.
	(sgml-calculate-indent): Add an explicit check for 'text syntax,
	to protect against future enhancements to sgml-lexical-context.
	(sgml-empty-tag-p, sgml-unclosed-tag-p): New funcs.

	* textmodes/xml-lite.el: Removed much redundant stuff.
	(xml-lite-parse-tag-backward): Simplify parsing by assuming we
	always start within text. Make use of sgml-unclosed-tag-p.

2002-04-01  Ville Skytt,Ad(B  <ville.skytta@xemacs.org>

	* tcl.el (tcl-imenu-generic-expression): New value.
	(tcl-imenu-create-index-function): Function deleted.
	(tcl-mode): Check for filladapt-mode.
	Use tcl-imenu-generic-expression instead of
	tcl-imenu-create-index-function.
	(inferior-tcl-mode): Doc fix.
	Change not legally significant.

2002-04-01  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* cus-start.el: Rename `x-autoselect-window' to `autoselect-window'.

	* window.el (handle-select-window): New function.
	Update copyright.

2002-04-01  Richard M. Stallman  <rms@gnu.org>

	* info.el (info-tool-bar-map): Use tool-bar-local-item-from-menu.

	* toolbar/tool-bar.el (tool-bar-local-item): Renamed from
	tool-bar-add-item, and new arg MAP.
	(tool-bar-add-item): Now calls tool-bar-local-item.
	(tool-bar-local-item-from-menu): Renamed from
	tool-bar-add-item-from-menu, and new arg IN-MAP.
	(tool-bar-add-item-from-menu): Now calls tool-bar-local-item-from-menu.

	* help-fns.el (help-with-tutorial): Allow various ways
	to specify the text in the [...] line, in handling the <...> line.

	* progmodes/idlw-rinfo.el (idlwave-system-routines):
	WOLRDTITLE => WORLDTITLE.  SUPRESS_VALUE => SUPPRESS_VALUE.

	* subr.el (redraw-modeline): Define alias.

2002-03-31  Richard M. Stallman  <rms@gnu.org>

	* files.el (file-expand-wildcards): Use save-match-data.

	* files.el (format-alist): Mark as risky.

	* simple.el (kill-new): Doc fix.

	* emacs-lisp/byte-opt.el (side-effect-free-fns)
	(side-effect-and-error-free-fns): Add many functions, remove some.

2002-03-30  Richard M. Stallman  <rms@gnu.org>

	* menu-bar.el (menu-bar-tools-menu): Rename gdb item to say GDB.

2002-03-30  Eli Zaretskii  <eliz@gnu.org>

	* font-lock.el (save-buffer-state): Fix last change.

	* files.el (auto-save-file-name-transforms): Fix last change.

	* startup.el (command-line): Fix last change.

2002-03-29  Richard M. Stallman  <rms@gnu.org>

	* subr.el (play-sound-file): Moved to simple.el.

	* simple.el (play-sound-file): Moved from subr.el, made unconditional.

2002-03-29  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer-mark-interactive): Use `ibuffer-forward-line'
	instead of `forward-line'.
	(ibuffer-forward-line): Be sure to skip over special properties
	before moving, too.

	* calc/calc.el (calc-was-split): Var deleted.
	(calc): Remove reference to it.
	(calc): Ditto.
	(calc-quit): Ditto.
	(calc-init-base): Ditto.

	* calc/calc-misc.el (calc-delete-windows-keep): Function deleted.

2002-03-29  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/sgml-mode.el (sgml-lexical-context): Return (text . START)
	instead of nil when point is outside of any tag.
	(sgml-beginning-of-tag): Adjust to the change.
	(sgml-calculate-indent): Use the new info returned by
	sgml-lexical-context.  Try to handle unclosed tags.

	* textmodes/xml-lite.el (xml-lite-get-context): Don't stop parsing
	at unclosed tags unless it is at indentation.
	Kill nested unclosed tags.
	(xml-lite-calculate-indent, xml-lite-indent-line): Remove.
	(xml-lite-mode): Use sgml-indent-line instead.

2002-03-29  Eli Zaretskii  <eliz@is.elta.co.il>

	* files.el (auto-save-file-name-transforms): Don't run "\\2" via
	expand-file-name.

	* startup.el (command-line): Recompute auto-save-file-name-transforms
	using the updated value of temporary-file-directory.

2002-03-29  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/xml-lite.el (xml-lite-get-context): Allow stopping
	even with an empty context.  Don't save excursion any more.
	Don't complain about unmatched start-tags in sgml-unclosed-tags.
	Ignore end-tags in sgml-empty-tags.
	(xml-lite-get-context, xml-lite-calculate-indent)
	(xml-lite-insert-end-tag): Save excursion around xml-lite-get-context.
	(xml-lite-indent-line): Use back-to-indentation.

	* textmodes/sgml-mode.el (sgml-basic-offset): New var.
	(sgml-name-re, sgml-attrs-re): New consts.
	(sgml-tag-name-re, sgml-start-tag-regex, sgml-font-lock-keywords-1)
	(sgml-mode): Use them.
	(sgml-lexical-context): Default to (point-min) if nothing else works.
	(sgml-calculate-indent): Indent slightly differently.
	(sgml-indent-line): Use back-to-indentation.
	(sgml-parse-dtd): New function.
	(sgml-unclosed-tags): New var.
	(html-mode): Set it.

2002-03-29  Simon Marshall  <simon.marshall@misys.com>

	* font-lock.el (save-buffer-state): Use make-symbol to bind `modified'.

2002-03-29  Richard M. Stallman  <rms@gnu.org>

	* dired-aux.el (dired-do-query-replace-regexp, dired-do-search):
	Use FILTER arg in dired-get-marked-files to exclude directories.
	(dired-nondirectory-p): New function.

	* dired.el (dired-get-marked-files): New arg FILTER
	allows selection of some files.

	* progmodes/tcl.el (tcl-imenu-create-index-function): Doc fix.

2002-03-29  Eric M. Ludlam  <eric@siege-engine.com>

	* speedbar.el (speedbar-default-directory-list): Made robust
	against deleted directories.

2002-03-28  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-toggle-marks): Renamed from dired-do-toggle.
	Bindings changed.

	* progmodes/compile.el (compilation-handle-exit):
	If compilation-window-height is 0, display status in echo area.

	* simple.el (line-move-to-column): Don't call move-to-column if COL=0.

	* rect.el (replace-rectangle): Add autoload.

	* files.el: Mark many more variables as risky.
	(hack-one-local-variable): Recognize several additional
	patterns as risky.

	* bindings.el (mode-line-mule-info): Use :propertize, not :eval.

2002-03-28  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/xml-lite.el (xml-lite-in-string-p):
	Use sgml-lexical-context.
	(xml-lite-parse-tag-backward): Use sgml-tag-syntax-table.
	(xml-lite-get-context): Check that open/close tags match.
	Don't stop scanning while we're ignoring matching tags.

	* textmodes/sgml-mode.el (sgml-make-syntax-table): New fun.
	(sgml-mode-syntax-table): Use it.
	(sgml-tag-syntax-table, sgml-tag-name-re): New const.
	(sgml-tags-invisible): Use it.
	(sgml-lexical-context): New fun.
	(sgml-maybe-end-tag, sgml-beginning-of-tag): Use it.
	(sgml-quote): Accept \n as entity reference terminator.
	(sgml-calculate-indent, sgml-indent-line): New funs.

2002-03-28  Andre Spiegel  <spiegel@gnu.org>

	* vc-cvs.el (vc-cvs-global-switches): New user option.
	(vc-cvs-command): New function.  Update all callers of
	`vc-do-command' in vc-cvs.el to use this instead.

2002-03-27  Andrew Innes  <andrewi@gnu.org>

	* makefile.w32-in (bootstrap-clean-SH): Use for loop, instead of
	relying on shell globbing.

2002-03-27  Colin Walters  <walters@debian.org>

	* ibuffer.el (ibuffer-help-buffer-modes): New variable.
	(ibuffer-fontification-alist): Use it.
	(ibuffer-backward-line): Handle `ibuffer-summary' area.
	(ibuffer-forward-line): Ditto.

	* ibuf-ext.el (sorter mode-name): Doc fix.
	(ibuffer-mark-help-buffers): Use `ibuffer-help-buffer-modes'.
	(operation query-replace): Use new `noerror' arg for
	`query-replace-read-args'.
	(operation query-replace-regexp): Ditto.

2002-03-27  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/xml-lite.el: Fix copyright notice.
	(xml-lite-basic-offset): Rename from xml-lite-indent-offset.
	(xml-lite-indent-comment-offset): Remove.
	(xml-lite-calculate-indent): Use new name.  Use natural alignment
	for comments.
	(xml-lite-in-string-p): Simplify.

2002-03-27  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* allout.el (outline-layout): Doc fix.

2002-03-27  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/xml-lite.el: Don't require `custom'.
	(xml-lite-parse-tag-name): Properly treat non-ASCII chars.
	(xml-lite-parse-tag-backward): Obey sgml-empty-tags.
	(xml-lite-get-context): Drop nested tags not just for comments.
	(xml-lite-indent-line): Be more careful about moving point.
	(xml-lite-insert-end-tag, xml-lite-slash):
	Use indent-according-to-mode instead of xml-lite-indent-line.
	(xml-lite-mode): Make xml-lite-orig-indent-line-function buffer-local.
	Set sgml-xml-mode.  Don't call force-mode-line-update.
	(xml-lite-mode-map): Don't bind TAB.

2002-03-27  Zoltan Kemenczy  <zoltan@ieee.org>

	* gud.el (gud-jdb-sourcepath): New variable, saves jdb -sourcepath
	parameter value.
	(gud-jdb-build-source-files-list): Comment clarification.
	(gud-jdb-massage-args): Reworked into loop-based argument list
	processing in order to support -classpath and -sourcepath argument
	processing.
	(gud-jdb-find-source-using-classpath): Prepend gud-jdb-sourcepath
	to gud-jdb-classpath to obtain search list.
	(gud-jdb-parse-classpath-string): Remove any trailing slashes from
	directory names in classpath/sourcepath lists, update comment.
	(jdb): Add setting of gud-jdb-sourcepath, update comment.
	(gud-find-class): Add gud-jdb-sourcepath use, and correct
	behaviour for the case when classpath is not used--backward
	compatibility fix.

2002-03-27  Eli Zaretskii  <eliz@is.elta.co.il>

	* Makefile.in (compile, compile-always): Don't try to compile
	non-existent files or files in empty directories.

2002-03-26  Michael Ernst  <mernst@alum.mit.edu>

	* compare-w.el (compare-windows-whitespace): Match all whitespace.

	* emacs-lisp/shadow.el (list-load-path-shadows): Only ignore last
	copy of standard Lisp directories.

	* tar-mode.el (tar-header-block-summarize, tar-get-descriptor):
	Support "next has longname" link type.

2002-03-26  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/xml-lite.el (xml-lite-at-indentation-p): Move.
	(xml-lite-in-string-p, xml-lite-looking-back-at, xml-lite-looking-at):
	New functions.
	(forward-xml-tag, backward-xml-tag, beginning-of-xml-tag)
	(end-of-xml-tag): Remove.
	(xml-lite-get-context): Better handling of comments.
	(xml-lite-calculate-indent): Use xml-lite-in-string-p.
	(xml-lite-parse-tag-backward): Rewrite.

2002-03-26  Juanma Barranquero  <lektu@terra.es>

	* makefile.w32-in (WINS): Add the toolbar directory.

2002-03-26  Richard M. Stallman  <rms@gnu.org>

	* subr.el (substring-no-properties): Function deleted (now in C).

2002-03-25  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* mwheel.el (mouse-wheel-mode): Use global-set-key and
	global-unset-key.

2002-03-24  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-resend): Call mail-abbrev-make-syntax-table.

	* progmodes/etags.el (tags-query-replace): Pass t for NOERROR
	to query-replace-read-args.

	* progmodes/compile.el (compilation-forget-errors):
	Don't adjust compilation-parsing-end if it's nil.

	* replace.el (query-replace-read-args): New optional arg NOERROR.
	(perform-replace): Use save-window-excursion around recursive edit.

2002-03-24  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer): If the user has `ibuffer-use-other-window'
	non-nil, then always use another window.

2002-03-24  Gerd Moellmann  <gerd@gnu.org>

	* subr.el (macro-declaration-function): New function.  Set the
	variable macro-declaration-function to it.

	* emacs-lisp/bytecomp.el (byte-compile-file-form-defmumble):
	Handle declarations in macro definitions.

2002-03-24  Eli Zaretskii  <eliz@is.elta.co.il>

	* facemenu.el (facemenu-get-face): Remove unused variable `foreground'.

	* enriched.el (enriched-face-ans): Support FACE of the form
	(:foreground COLOR) and (:background COLOR).
	(enriched-decode-foreground, enriched-decode-background): Set the
	fore- and background colors of the faces we create, since facemenu
	doesn't.

2002-03-24  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* mwheel.el (mouse-wheel-mode): Use the result of
	current-global-map instead of the variable `global-map'.

2002-03-23  Richard M. Stallman  <rms@gnu.org>

	* mail/mailabbrev.el (mail-abbrev-make-syntax-table): New subroutine
	broken out of sendmail-pre-abbrev-expand-hook.
	(sendmail-pre-abbrev-expand-hook): Use it.

2002-03-22  Stefan Monnier  <monnier@cs.yale.edu>

	* Makefile.in (finder-inf.el): Remove.
	(finder-data): Don't depend on finder-inf.el any more.
	(compile, compile-always): Handle the case where some files
	from DONTCOMPILE are missing (it tried to compile them).
	(bootstrap-clean): Use src/emacs only if executable.
	(bootstrap): Update subdirs.el and finder-inf.el.

	* finder.el: Don't load finder-inf.el during byte-compilation.

	* vc-cvs.el (vc-cvs-registered, vc-cvs-dir-state-heuristic):
	Don't consider cvs-removed files as under VC control.
	VC wouldn't handle them properly anyway and it confuses
	vc-file-not-found-hook.

	* emacs-lisp/bytecomp.el (batch-byte-compile-if-not-done):
	Add autoload cookie.

2002-03-22  Eli Zaretskii  <eliz@is.elta.co.il>

	* calendar/calendar.el (calendar): Doc fix.

2002-03-22  Juanma Barranquero  <lektu@terra.es>

	* play/gomoku.el (gomoku-font-lock-O-face): Convert to use `defface'.
	(gomoku-font-lock-X-face): Likewise.
	(gomoku-font-lock-keywords): Use faces instead of variables.

2002-03-21  Stefan Monnier  <monnier@cs.yale.edu>

	* Makefile.in (bootstrap): Make sure subdirs.el is ready.

2002-03-21  Kim F. Storm  <storm@cua.dk>

	* simple.el (open-network-stream, open-network-stream-nowait)
	(open-network-stream-server): Use featurep to test for
	supported networking features.

2002-03-21  Thien-Thi Nguyen  <ttn@gnu.org>

	* mail/emacsbug.el (report-emacs-bug-hook): Remove submitter
	directions as the last action.

2002-03-21  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* startup.el (fancy-splash-tail, normal-splash-screen):
	Update copyright.

	* novice.el (disabled-command-hook): Clarify output text to match
	prompt.

2002-03-20  Jason Rumney  <jasonr@gnu.org>

	* frame.el (display-images-p): Do not explicitly check display type.

2002-03-20  pmr-sav  <pmr-sav@hamm.pajato.com>

	* mail-utils.el:
	Eliminate compilation warnings due to `rfc822-addresses'.
	(rmail-dont-reply-to): Eliminate `pos' as a free variable for a
	warning free compile.

2002-03-20  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-diff.el (ediff-install-fine-diff-if-necessary):
	Take the current highlighting style into account.
	(ediff-forward-word-function,ediff-whitespace,ediff-word-1)
	(ediff-word-2,ediff-word-3,ediff-word-4): Make them buffer local.

	* ediff-init.el (ediff-patch-job): New macro.

	* ediff-mult.el (ediff-make-new-meta-list-header): New API function.
	(ediff-intersect-directories): Use ediff-make-new-meta-list-header.

	* ediff-ptch.el (ediff-map-patch-buffer):
	Use ediff-make-new-meta-list-header.
	(ediff-fixup-patch-map): Use the meta-list API from ediff-mult.el.

	* ediff-util.el (ediff-toggle-hilit): Fix toggling of highliting.
	(ediff-select-difference): Take highlighting style into account.
	(ediff-clone-buffer-for-region-comparison): New function.
	(ediff-inferior-compare-regions): Added comparison of current diff
	regions.

	* ediff.el (ediff-clone-buffer-for-region-comparison)
	(ediff-clone-buffer-for-window-comparison): Moved to ediff-util.el.

2002-03-19  pmr-sav  <pmr-sav@hamm.pajato.com>

	* mail-utils.el (rmail-dont-reply-to):
	Overhaul to correctly apply the regular
	expressions in the variable `rmail-dont-reply-to-names' to the list of
	destination addresses.  Contributed by lorentey@elte.hu.

	* rmail.el (rmail-dont-reply-to-names):
	Modify the documentation to make it email
	address centric rather than login name centric.  Contributed by
	lorentey@elte.hu.

2002-03-18  Colin Walters  <walters@verbum.org>

	* ibuf-ext.el (ibuffer-toggle-sorting-mode): Remove `find-if' so
	we don't require `cl' at runtime.
	(sorting mode mode-name): Don't take the symbol-name of a string.

	* ibuffer.el (ibuffer-set-mark): Go back to the beginning of the
	line after setting the mark.
	(ibuffer-insert-buffers-and-marks): Invert the test for
	`ibuffer-sorting-reversep'.

2002-03-18  Stefan Monnier  <monnier@cs.yale.edu>

	* international/ucs-tables.el (unify-8859-on-decoding-mode)
	(unify-8859-on-encoding-mode): Remove autoload cookie.

2002-03-18  Andre Spiegel  <spiegel@gnu.org>

	* vc-rcs.el (vc-rcs-register): Fix handling of
	vc-[rcs-]register-switches.
	(vc-rcs-checkin-switches, vc-rcs-checkout-switches):
	Variables removed, since they weren't used yet.

	* vc-cvs.el (vc-cvs-register): Fix handling of
	vc-[cvs-]register-switches.

	* vc-sccs.el (vc-sccs-register): Fix handling of
	vc-[sccs-]register-switches.

2002-03-18  Stefan Monnier  <monnier@cs.yale.edu>

	* loadup.el ("emacs-lisp/backquote"): Load earlier.
	("international/ucs-tables"): Load and turn on
	unify-8859-on-encoding-mode unconditionally.
	(emacs-version): Use `defconst' rather than `setq'.

	* eshell/esh-ext.el (eshell-binary-suffixes): Use exec-suffixes.

2002-03-18  Richard M. Stallman  <rms@gnu.org>

	* menu-bar.el (menu-bar-options-menu): Cope if
	text-mode-hook is not a list.

2002-03-17  Richard M. Stallman  <rms@gnu.org>

	* emulation/pc-select.el (pc-selection-mode):
	Alter the existing global map, don't replace it.

	* files.el (list-directory): Set default-directory at the end.

	* dabbrev.el (dabbrev--goto-start-of-abbrev):
	Put a limit on field-beginning search.

2002-03-17  Simon Josefsson  <jas@extundo.com>

	* net/browse-url.el (browse-url-mosaic-pidfile): New variable.
	(browse-url-mosaic): Use it.

	* net/browse-url.el (browse-url-filename-alist): Don't begin
	docstring with *, you don't want to set this one with M-x set-variable.

	* net/browse-url.el: Put * in user option doc strings.

2002-03-17  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/sgml-mode.el (sgml-xml-mode): Renamed from sgml-xml.
	(sgml-xml-guess): Simplify.
	(sgml-mode-common): Remove (move into sgml-mode).
	(sgml-mode): Add code from sgml-mode-common.
	Remove redundant setting of indent-line-function.
	Don't set skeleton-transformation when in XML mode.

	* international/mule-diag.el (describe-char-after):
	Use `internal-describe-syntax-value' again (got lost somewhere).

	* international/ucs-tables.el (ucs-unify-8859, ucs-fragment-8859):
	Use unify-8859-on-decoding-mode.
	(unify-8859-on-decoding-mode): Also set translation-table-for-input.
	(ucs-insert): Give an error if the unicode char can't be created.

	* pcvs-parse.el (cvs-parse-table): Be a bit more lenient.
	(cvs-parse-status): Handle the "used to have a conflict" marker.

2002-03-17  Kim F. Storm  <storm@cua.dk>

	The following changes are related to the enhanced network process
	support.

	* simple.el: Update copyright.
	(clone-process): Use make-network-process to clone network
	processes.  Get command list via (process-contact ... t).
	Use set-process-query-on-exit-flag and process-query-on-exit-flag
	instead of process-kill-without-query.
	(open-network-stream): Replaces C-version from process.c.
	(open-network-stream-nowait, open-network-stream-server): New funs.
	(process-kill-without-query): Replaces C-version from process.c.

	* files.el: Update copyright.
	(save-buffers-kill-emacs): Also check for active server
	processes.  Use process-query-on-exit-flag.  Only list processes
	which has the query-on-exit flag set in connection with user query.

	* shadowfile.el: Update copyright.
	(shadow-save-buffers-kill-emacs): Also check for active server
	processes.  Use process-query-on-exit-flag.

2002-03-16  Simon Marshall  <simon.marshall@misys.com>

	* imenu.el (imenu-menubar-modified-tick): Renamed from
	imenu-update-menubar-modified-tick.
	(imenu-update-menubar): Update imenu-menubar-modified-tick
	whenever outer condition succeeds.

	* lazy-lock.el (save-buffer-state):
	Bind inhibit-modification-hooks and buffer-file-truename
	instead of before-change-functions and after-change-functions.

2002-03-16  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/codepage.el (codepage-setup): Don't define a
	codepage if it is already defined.

	* textmodes/po.el (po-content-type-charset-alist): Convert the
	car of each association to a string.
	(po-find-file-coding-system-guts): If the charset matches a name
	of a codepage, set up that codepage and return it as a coding
	system to decode the file.
	(po-find-charset): Search for the Charset= header even if we've
	read less than 4KB.
	<top-level>: Remove the setup for all known codepages: it seems
	to cause crashes in the CCL driver.

2002-03-16  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* textmodes/bibtex.el (bibtex-sort-ignore-string-entries)
	(bibtex-entry-field-alist): Doc fix.

2002-03-16  Richard M. Stallman  <rms@gnu.org>

	* progmodes/cperl-mode.el (cperl-imenu--function-name-regexp-perl):
	Move definition above cperl-outline-regexp.

	* bindings.el (mode-line-mule-info): In computing help-echo prop,
	avoid using save-window-excursion.  And compile the function.

2002-03-15  Stefan Monnier  <monnier@cs.yale.edu>

	* files.el (load-completion): New function.
	(load-library): Use it.

2002-03-15  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* calendar/cal-french.el (calendar-goto-french-date): Fix prompt
	to match the actual code.

2002-03-15  Eli Zaretskii  <eliz@is.elta.co.il>

	* textmodes/po.el (po-find-file-coding-system-guts):
	Use with-temp-buffer instead of po-with-temp-buffer.

	* international/mule-conf.el (file-coding-system-alist): Add an
	association for PO files.

	* textmodes/po.el: New file.

2002-03-15  Gerd Moellmann  <gerd@gnu.org>

	* emacs-lisp/cl-indent.el (common-lisp-loop-part-indentation):
	Fix simple loop indentation.

2002-03-14  Miles Bader  <miles@gnu.org>

	* net/rlogin.el (rlogin-mode): Use `define-derived-mode'.

2002-03-14  Richard M. Stallman  <rms@gnu.org>

	* textmodes/picture.el (picture-insert)
	(picture-clear-column, picture-draw-rectangle):
	Use move-to-column, not move-to-column-force.

	* dired.el (dired-readin): Clear out undo list.
	(dired-fun-in-all-buffers): Definition moved from dired-aux.el.
	(dired-delete-entry): New function.
	(dired-internal-do-deletions): Use dired-fun-in-all-buffers
	and dired-delete-entry, to update this buffer (and others).

	* dired-aux.el (dired-fun-in-all-buffers): Moved to dired.el.

	* facemenu.el (facemenu-add-new-face):
	Pass region args to facemenu-set-face, when there is a region.
	(facemenu-set-foreground, facemenu-set-background)
	(facemenu-add-face): Doc fixes.

	* progmodes/cperl-mode.el (cperl-outline-regexp): Move definition up.

2002-03-14  Miles Bader  <miles@gnu.org>

	* emacs-lisp/debug.el: Require `button'.
	(debugger-mode-map): Set the parent keymap to `button-buffer-map',
	to get TAB and <backtab> bindings.

	* net/rlogin.el (rlogin-carriage-filter): Function removed.
	(rlogin): Don't install the `rlogin-carriage-filter' filter, as
	comint removes carriage returns itself now.

	* rfn-eshadow.el (rfn-eshadow-update-overlay):
	Bind `inhibit-point-motion-hooks' to t while messing around, to avoid
	getting hosed by our own intangible property.

2002-03-13  Stefan Monnier  <monnier@cs.yale.edu>

	* progmodes/fortran.el (fortran-mode): Set comment-padding to "$$$".
	Add fortran-comment-line-start-skip to comment-start-skip.
	(fortran-comment-indent): Keep whole-line comments in column 0.
	(fortran-find-comment-start-skip): New arg `all'.
	If ALL is nil, make sure we only match comment-start-skip if we
	can't match fortran-comment-line-start-skip.
	Fix bug that made it return t but without moving point when
	matching '!'! (a false-comment followed by a real comment).
	(fortran-indent-comment): Use new `all' argument above.
	Be careful not to add an incorrect comment-starter like "C"
	in comment-column.
	(fortran-split-line): When splitting a comment, reuse the comment
	starter from the current line rather than fortran-comment-line-start.
	(fortran-indent-line, fortran-auto-fill): Simplify thanks to the
	cleaner behavior of fortran-find-comment-start-skip.
	(fortran-fill): Don't be confused by ! inside a comment.
	(fortran-break-line): Minor cleanup and simplification.

2002-03-13  Francesco Potorti`  <pot@gnu.org>

	* progmodes/etags.el (tag-exact-file-name-match-p)
	(tag-file-name-match-p, tag-partial-file-name-match-p): Use a
	simpler regexp.

2002-03-12  Colin Walters  <walters@debian.org>

	* ibuffer.el (ibuffer-redisplay-current): Don't move point when
	redisplaying a line.

2002-03-12  Jan D.  <Jan.Djarv@mbox200.swipnet.se>

	* term/x-win.el (emacs-session-restore): Take previous id as
	an argument.
	(emacs-session-save): Add comment that return t means cancel shutdown

	* startup.el (command-line): Must check that x-session-previous-id
	is bound also, for non-X platforms.

2002-03-12  Gerd Moellmann  <gerd@gnu.org>

	* emacs-lisp/cl-indent.el (lisp-loop-keyword-indentation)
	(lisp-loop-forms-indentation, lisp-simple-loop-indentation):
	New user options.
	(extended-loop-p, common-lisp-loop-part-indentation): New functions.
	(common-lisp-indent-function-1): Renamed from
	common-lisp-indent-function.
	(common-lisp-indent-function): Handle loop forms specially.
	(lisp-indent-defmethod): Use car/cdr instead of first/rest.
	(lisp-backquote-indentation): New user option.

2002-03-12  Francesco Potorti`  <pot@gnu.org>

	* progmodes/etags.el (tag-exact-file-name-match-p)
	(tag-file-name-match-p, tag-partial-file-name-match-p):
	Assume that the header of a tags section has either a number
	or nothing after the last comma.

2002-03-11  Richard M. Stallman  <rms@gnu.org>

	* imenu.el (imenu-update-menubar-modified-tick): New variable.
	(imenu-update-menubar): Don't call imenu--make-index-alist
	if buffer has not changed since last time.

	* desktop.el (desktop-buffer-handlers): Doc fix.
	(desktop-buffer-file): Explicitly return BUF.

	* paren.el (show-paren-function): Move back in other direction
	to verify the match is correct.

	* mail/supercite.el (sc-select-attribution): Accept whatever value
	we get in CHOICE; there is no value meaning "try again".

2002-03-11  Colin Walters  <walters@verbum.org>

	* shell.el (toplevel): Revert previous change to use pcomplete.
	(shell-mode): Ditto.
	(shell-pcomplete-setup-done): Remove.
	(shell-pcomplete): Ditto.
	(shell-pcomplete-reverse): Ditto.

	* comint.el: Remove documentation on setting up pcomplete.

2002-03-11  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* font-lock.el (java-font-lock-extra-types): Add "URL" as separate
	item.  Doc fix.

	* image.el (image-type-from-file-header): Make temporary buffer
	unibyte.

	* subr.el (add-to-list): Doc fix.

2002-03-11  Miles Bader  <miles@gnu.org>

	* pcomplete.el (pcomplete-entries): Expand environment variables
	in filename.

2002-03-10  Daniel Pfeiffer  <occitan@esperanto.org>

	* play/mpuz.el: Use defface instead of facemenu-get-face.

2002-03-10  Jan D.  <Jan.Djarv@mbox200.swipnet.se>

	* startup.el (command-line): Add call to emacs-session-restore if
	both x-session-id and x-session-previous-id are strings.

	* term/x-win.el (x-handle-smid): New function.
	(emacs-session-filename): New function.
	(emacs-session-save): New function.
	(emacs-save-session-functions): New variable.
	(emacs-session-restore): New function.

2002-03-09  Eli Zaretskii  <eliz@is.elta.co.il>

	* simple.el (shell-command-on-region): Call push-mark with
	non-nil second arg, to suppress the "Mark set" message.

2002-03-08  Richard M. Stallman  <rms@gnu.org>

	* textmodes/picture.el (picture-forward-column): New arg `interactive'
	is non-nil for an interactive call.  Use instead of interactive-p.
	(picture-backward-column): Likewise.

	* tar-mode.el (tar-untar-buffer): New function.

	* info.el (Info-fontify-node): Bind up-clicks, not down-clicks.
	Put the mouse-face on the entire xref, like the local keymap.

	* find-dired.el (find-name-dired): Use shell-quote-argument.

2002-03-08  Daniel Pfeiffer  <occitan@esperanto.org>

	* play/mpuz.el (mpuz-unsolved-face, mpuz-solved-face)
	(mpuz-trivial-face, mpuz-text-face, mpuz-solve-when-trivial)
	(mpuz-allow-double-multiplicator): New options for nicer look and
	new features.
	(mpuz-put-number-on-board, mpuz-paint-number, mpuz-solve): New funs.
	(mpuz-check-all-solved, mpuz-random-puzzle)
	(mpuz-paint-statistics, mpuz-paint-digit, mpuz-close-game)
	(mpuz-show-solution): Functions streamlined and removed french
	style space before punctuation, added face support and optional
	solving of trivial results.

2002-03-07  Colin Walters  <walters@verbum.org>

	* ibuf-macs.el (define-ibuffer-column): Add :summarizer property.

	* ibuffer.el (ibuffer-update-mode-name): Substitute "view time"
	instead of "recency" for clarity.
	(ibuffer-compile-format): Document more.  Handle new "summarizer"
	columns.
	(ibuffer-fontify-region-function): Ditto.
	(ibuffer-insert-buffer-line): Ditto.
	(ibuffer-map-lines): Ditto.
	(ibuffer-insert-buffers-and-marks): Ditto.
	(ibuffer-update-title-and-summary): Renamed from
	`ibuffer-update-title'.  Handle "summarizer" columns.
	(ibuffer-clear-summary-columns): New function.

	* ibuf-ext.el (ibuffer-filter-format-alist): Add type and group.

2002-03-07  Gerd Moellmann  <gerd@gnu.org>

	* progmodes/ebrowse.el (ebrowse-view/find-file-and-search-pattern):
	Use the other-window instead of the other-frame functions when
	the window is dedicated.

2002-03-06  ShengHuo ZHU  <zsh@cs.rochester.edu>

	* textmodes/bibtex.el (bibtex-make-field): Call bibtex-find-text
	with SILENT so that a new field can be added.

2002-03-06  Eli Zaretskii  <eliz@is.elta.co.il>

	* files.el (make-auto-save-file-name): Make sure the produced file
	name does not contain characters that are invalid for DOS/Windows
	filesystems.

	* dos-fns.el, w32-fns.el (make-auto-save-file-name):
	Remove replacement functions.

2002-03-06  Gerd Moellmann  <gerd@gnu.org>

	* font-lock.el (lisp-font-lock-keywords-2): Highlight keywords of
	the form `:x'.

	* vc.el (vc-branch-part): Add autoload cookie.  This function can
	be called from vc-rcs-find-most-recent-rev when visiting a file
	checked into RCS in a CVS sandbox.

2002-03-06  Andreas Schwab  <schwab@suse.de>

	* progmodes/hideif.el: Augment expression parser to handle
	conditional expressions.
	(hif-token-regexp): Also match `?' and `:'.
	(hif-tokenize): Handle `?' and ':' as tokens.
	(hif-expr): Parse conditional expressions.
	(hif-or-expr): Parse `||' expressions.
	(hif-and-expr): Renamed from hif-term.
	(hif-conditional): New function to evaluate a conditional
	expression.

2002-03-06  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* language/czech.el ("Czech"): Fix the documentation.

	* language/slovak.el ("Slovak"): Likewise.

2002-03-05  ShengHuo ZHU  <zsh@cs.rochester.edu>

	* xml.el (xml-parse-attlist): Accept empty strings.

2002-03-05  Eli Zaretskii  <eliz@is.elta.co.il>

	* mouse.el (mouse-show-mark): Remove the no-highlight alternative:
	all terminals now support highlighting of some kind.

	* language/european.el (mac-roman): Fix the safe-chars property.

2002-03-05  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-transfer-file): Use `make-temp-file'.
	(vc-default-update-changelog): Remove conditional use of
	`make-temp-name'.

	* vc-cvs.el (vc-cvs-diff-tree): Fix typo in parameter names.

2002-03-05  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-init.el: Comments.

	* ediff-hook.el: Got rid of autoloads. Not needed, since the hook
	is loaded.

	* ediff-mult.el (ediff-intersect-directories)
	(ediff-prepare-meta-buffer,ediff-get-directory-files-under-revision):
	Cleanup.
	(ediff-draw-dir-diffs): Now supports the "C" command in directory
	difference buffer.
	(ediff-dir-diff-copy-file): New function that implements copying
	of files from one Ediff dir to another
	(ediff-bury-dir-diffs-buffer): Kills the buffer instead.
	(ediff-append-custom-diff): Better error msgs.

	* ediff-util.el (ediff-compute-custom-diffs-maybe): Buglet fix.
	(ediff-inferior-compare-regions): Use
	ediff-clone-buffer-for-region-comparison. Better and simpler interface.

	* ediff.el (ediff-directories-internal): Cleanup.
	(ediff-clone-buffer-for-region-comparison): Better interface.

2002-03-04  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Use "P" in interactive spec of minor mode commands.

2002-03-04  Stefan Monnier  <monnier@cs.yale.edu>

	* faces.el (face-spec-choose): Allow `t' to appear before the end.
	(mode-line, tool-bar, minibuffer-prompt, region, fringe, bold, italic)
	(bold-italic, underline, highlight, secondary-selection, fixed-pitch)
	(variable-pitch, trailing-whitespace): Don't use the old-style entries.
	(mode-line-inactive, header-line): Move the `t' section to the
	beginning so the `:inherit' setting can be shared.

2002-03-04  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/snmp-mode.el: Require tempo when compiling to prevent
	warnings.  Update copyright notice.

	* help.el (describe-key-briefly, describe-key): Interpret `undefined'
	like not defined at all.

2002-03-03  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/sgml-mode.el: Change maintainer to FSF.
	(sgml-start-tag-regex, sgml-font-lock-keywords-1, sgml-mode-common)
	(sgml-tags-invisible, sgml-beginning-of-tag):
	Allow _ : and non-ASCII in tag names, as required for XML.
	(sgml-name-char): Don't assume anything about charsets handled by
	encode-char.

	* textmodes/tex-mode.el (tex-guess-main-file): Handle the case
	where one of the buffers is narrowed.

	* hexl.el (hexlify-command, dehexlify-command): Remove.
	(hexlify-buffer, dehexlify-buffer): Use call-process-region
	rather than shell-command-on-region.

	* newcomment.el (comment-forward): Use forward-comment to skip
	over whitespace (or comments) even when comment-use-syntax is nil.

	* progmodes/cperl-mode.el (cperl-menu): Add "-emacs" to the version.

	* textmodes/xml-lite.el: New file.

2002-03-03  Richard M. Stallman  <rms@gnu.org>

	* textmodes/artist.el (artist-system): Use make-temp-file.

	* progmodes/ps-mode.el (ps-run-make-tmp-filename): Use make-temp-file.

	* mail/sendmail.el (mail-recover-1): Increase non-random-len
	by 1 since we changed make-auto-save-file-name to add one
	fewer character to the buffer name.
	(mail-recover): Really show point at the right place
	in the *Directory* buffer.

	* files.el (make-auto-save-file-name): Use make-temp-file.

	* terminal.el (te-create-terminfo): Use make-temp-file
	to create the source file in a safe way.

2002-03-03  Eli Zaretskii  <eliz@is.elta.co.il>

	* cus-start.el: Rename automatic-hscroll-step and
	automatic-hscroll-margin into hscroll-step and hscroll-margin.

	* frame.el (auto-hscroll-mode): Renamed from automatic-hscrolling.
	(automatic-hscrolling): Now a defvaralias for auto-hscroll-mode.

	* mouse.el (mouse-region-delete-keys): Add deletechar.

2002-03-03  Sam Steingold  <sds@gnu.org>

	* play/snake.el (snake-score-file): Fixed parens (broken by the
	last patch).
	* play/tetris.el (tetris-score-file): Ditto.

2002-03-03  Richard M. Stallman  <rms@gnu.org>

	* play/tetris.el (tetris-score-file): Put in home dir, not in /tmp.

	* play/snake.el (snake-score-file): Put in home dir, not in /tmp.

	* play/gamegrid.el (gamegrid-set-font, gamegrid-setup-face)
	(gamegrid-make-mono-tty-face): Fix usage of condition-case.

2002-03-03  Thien-Thi Nguyen  <ttn@gnu.org>

	* calendar/diary-lib.el (list-diary-entries): Use `buffer-substring'
	instead of `buffer-substring-no-properties' to support enriched mode.

2002-03-02  Richard M. Stallman  <rms@gnu.org>

	* find-dired.el (find-grep-dired): Call shell-quote-argument.
	Specify the -e option.
	Rename arg to `regexp'.

2002-03-02  Milan Zamazal  <pdm@zamazal.org>

	* textmodes/tildify.el (tildify-string-alist): Add entry for xml-mode.

2002-03-02  Miles Bader  <miles@gnu.org>

	* mwheel.el (mwheel-scroll): Remove `double' and `triple' from the
	event-modifiers before looking up in `mouse-wheel-scroll-amount'.
	If there's no applicable modifiers entry in the alist in
	`mouse-wheel-scroll-amount', fall back to the default, not to
	nil (which causes full screen scrolls).

2002-03-01  Andreas Schwab  <schwab@suse.de>

	* textmodes/texnfo-upd.el (texinfo-start-menu-description):
	Remove extra paren in regexp.

2002-03-01  Eli Zaretskii  <eliz@is.elta.co.il>

	* mouse.el (mouse-show-mark): Use display-mouse-p, not
	display-graphic-p, to decide whether to move point or use the
	highlighting.

2002-02-28  Colin Walters  <walters@verbum.org>

	* eshell/esh-var.el (eshell-parse-variable-ref): Use `make-temp-file'.

	* calc/calc-graph.el (calc-gnuplot-tempfile): Don't expand against
	`temporary-file-directory'; we now do that in `calc-graph-file-cache'.
	(calc-temp-file-name): Use `make-temp-file'.

2002-02-28  Richard M. Stallman  <rms@gnu.org>

	* font-lock.el (java-font-lock-extra-types):
	Match java.net.URL, etc.

2002-02-28  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* hexl.el (hexl-options): Doc fix.
	Update Commentary section.

	* textmodes/sgml-mode.el (sgml-specials, sgml-quick-keys):
	Doc fixes.

2002-02-28  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-revert-buffer): If the buffer is not saved, prompt
	the user to do that first.
	(vc-update): New function.

	* vc-hooks.el (vc-menu-map): New entry "Update to Latest Version",
	which calls vc-update.  Use the term "Base Version" instead of
	"Last Version" for the entries "Revert" and "Compare".

2002-02-28  Kim F. Storm  <storm@cua.dk>

	* simple.el (shell-command-on-region): Report non-zero exit
	status in mode line instead of buffer.

2002-02-27  Richard M. Stallman  <rms@gnu.org>

	* comint.el (comint-preoutput-filter-functions): Doc fix.
	(comint-output-filter-functions, comint-input-filter-functions)
	(comint-redirect-filter-functions): Likewise.

	(comint-redirect-preoutput-filter): Do the local-hook
	handling of t when running comint-redirect-filter-functions.
	(comint-output-filter): Likewise for comint-preoutput-filter-functions.

2002-02-26  Richard M. Stallman  <rms@gnu.org>

	* paths.el (remote-shell-program): Add doc string.

2002-02-26  Colin Walters  <walters@debian.org>

	* ibuf-ext.el (sorter mode-name): New.
	(ibuffer-do-occur): Don't quote ibuffer-marked-char.

	* calc/calc-ext.el (calc-scroll-left): Call scroll-left
	interactively, so they do something.
	(calc-scroll-right): Ditto.

2002-02-26  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/mule.el (ctext-pre-write-conversion): Handle the
	case when FROM is a string, and when we are called from
	build_annotations_2.

2002-02-26  Richard M. Stallman  <rms@gnu.org>

	* rect.el (clear-rectangle-line): Reindent to the same column
	that move-to-column reached when it tried to go to endcol.

	* icomplete.el (icomplete-exhibit): Use minibuffer-prompt-end.

2002-02-26  Ivar Rummelhoff  <ivarru@math.uio.no>

	* winner.el (winner-boring-buffers, winner-set): A window which
	displays a buffer whose name is in the list
	`winner-boring-buffers', will no longer be restored by `winner-undo'.
	(winner-sorted-window-list): Used to improve comparison between
	window configurations.
	(winner-win-data): Simplified and moved.
	(winner-conf): Simplified (now uses `winner-win-data').
	(winner-change-fun, winner-save-old-configurations)
	(winner-save-(un)conditionally, winner-redo): Changes made while in
	the minibuffer will be ignored.  (Such changes are undone upon
	exit for the minibuffer, anyway.)
	(winner-set-conf): Preserve selected window whenever possible.
	(winner-make-point-alist): Simplified.
	(winner-mode, winner-save-unconditionally): Save current window
	configuration on entering minibuffer.
	(minor-mode-alist): Don't add winner-mode to `minor-mode-alist',
	since it does not change the overall behavior of Emacs.

2002-02-26  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/mule-conf.el (compound-text): Renamed back from
	compound-text-no-extensions.
	(ctext-no-compositions): Remove the mime-charset property.
	(compound-text-with-extensions): Renamed from compound-text.
	(x-ctext-with-extensions, ctext-with-extensions): Renamed aliases.

2002-02-26  Juanma Barranquero  <lektu@terra.es>

	* faces.el (list-faces-display): Fix typo.

2002-02-25  Richard M. Stallman  <rms@gnu.org>

	* frame.el (focus-follows-mouse): Doc fix.

2002-02-26  Miles Bader  <miles@gnu.org>

	* mwheel.el (mouse-wheel-mode): Pass vectors instead of symbols
	to `define-key', since it no longer accepts the latter.

2002-02-25  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (mouse-wheel-scroll-line): Use car of
	mouse-wheel-scroll-amount.

	* w32-vars.el (mouse-wheel-scroll-amount): Use same definition as
	mwheel.el.

	* language/japanese.el (iso-2022-jp-2): Add init-bol flag.

2002-02-25  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-diff-switches-list): Fix prev change, making the macro
	consistent with the others that take a backend name as a symbol.

	* vc-cvs.el, vc-rcs.el, vc-sccs.el: Fix calls to vc-diff-switches-list.

2002-02-25  Kim F. Storm  <no-spam@cua.dk>

	* comint.el (comint-replace-by-expanded-filename): Do nothing if
	comint-match-partial-filename returns nil.

	* shell.el (shell-pcomplete-setup-done): New variable.
	(shell-pcomplete): Use it instead of shell-pcomplete-setup-p.
	(shell-pcomplete-reverse): Ditto.

2002-02-25  Per Abrahamsen  <abraham@dina.kvl.dk>

	* ps-print.el (ps-print-printer): Added `lpr' customize group member.

2002-02-25  Juanma Barranquero  <lektu@terra.es>

	* subr.el (save-match-data): Doc fix.

	* ielm.el (ielm-prompt): Allow customization; make it read-only.

2002-02-25  Kim F. Storm  <storm@cua.dk>

	* shell.el (shell-mode-map): Add "Complete" header so completion
	menu is shown on the menu bar in shell mode.

2002-02-25  Stefan Monnier  <monnier@cs.yale.edu>

	* ielm.el (ielm-match-data): New var.
	(inferior-emacs-lisp-mode): Make it buffer-local.
	(ielm-eval-input): Use it to preserve match-data between inputs.

2002-02-24  Juanma Barranquero  <lektu@terra.es>

	* ielm.el (inferior-emacs-lisp-mode): Use hexl for the dummy process.

2002-02-24  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-unlispify-remove-prefixes): Add to
	`custom-buffer' customize group.

2002-02-23  Kim F. Storm  <storm@cua.dk>

	* help.el (where-is): Use remap-command.

	* help-fns.el (describe-function-1): Use remap-command.

	* subr.el (global-set-key, local-set-key): Undo 2002-02-06
	change (no longer accept a symbol for the KEY argument).

2002-02-23  Colin Walters  <walters@debian.org>

	* calc/calcalg3.el (calc-invent-variables): Convert integer to string.
	* calc/calcalg2.el (math-solve-get-sign): Ditto.

	* ibuffer.el (ibuffer-compile-format): Don't uselessly bind `pt'
	in generated function.

	* ibuf-ext.el (ibuffer-old-time): Change to hours.
	(ibuffer-mark-old-buffers): Handle it.

	* shell.el (shell-pcomplete, shell-pcomplete-reverse): New functions.
	(toplevel): Bind them.
	(shell-mode): Don't set `comint-dynamic-complete-functions'; it is
	not necessary now that we use pcomplete.

	* comint.el: Document how use new pcomplete completion facility.

2002-02-23  Richard M. Stallman  <rms@gnu.org>

	* mail/rmailsum.el (rmail-summary-output): Properly advance
	to next message, by calling rmail-summary-goto-msg.

	* net/browse-url.el (browse-url-galeon): Specify --existing
	for an existing window.  Use --noraise rather than --no-raise.
	Don't use -x.

2002-02-22  Eli Zaretskii  <eliz@is.elta.co.il>

	* progmodes/etags.el (find-tag-noselect, find-tag)
	(find-tag-other-window, find-tag-other-frame, find-tag-regexp):
	Fix a typo in doc strings.

2002-02-20  Deepak Goel  <deego@glue.umd.edu>

	* play/snake.el (snake-velocity-queue, snake-update-velocity)
	(snake-final-x-velocity, snake-final-y-velocity):
	New variable and functions.  Store user's keypresses
	into a queue and pop from the queue each subsequent turn.
	(snake-update-game, snake-move-left)
	(snake-move-right, snake-move-up, snake-move-down, snake-active-p)
	(snake-start-game): Use that queue.
	(snake-use-glyphs-flag): Renamed from snake-use-glyphs.
	(snake-use-color-flag): Likewise.
	(snake-mode): Rename uses of those variables.

2002-02-22  Eli Zaretskii  <eliz@is.elta.co.il>

	Support for ICCCM  Extended Segments in X selections:

	* international/mule-conf.el (ctext-no-compositions): New coding
	system.
	(compount-text-no-extensions): Renamed from compound-text.
	(x-ctext-no-extensions, ctext-no-extensions): Aliases for
	compound-text-no-extensions.
	(compound-text): Redefined using post-read and pre-write conversions.

	* international/mule.el (non-standard-icccm-encodings-alist)
	(non-standard-designations-alist): New variables.
	(ctext-post-read-conversion, ctext-pre-write-conversion):
	New functions.

2002-02-21  Jonathan Kamens  <jik@kamens.brookline.ma.us>

	* vc.el (vc-default-init-version): Update documentation to
	indicate that the backend can override the default init version.
	(vc-register): Use the backend init-version function, if it
	exists, to determine the initial version of a file.
	(vc-diff-switches-list): Don't symbol-quote backend, since it's
	already a symbol.  Don't fail if vc-BACKEND-diff-switches isn't bound.

	* vc-hooks.el (vc-mode-line): Set vc-mode to nil if the file is
	not version-controlled.  This is necessary, e.g., if the file has
	just been reverted, and thus was previously under version control
	but isn't any longer.
	(vc-find-file-hook): Likewise.

2002-02-21  Martin Lorentzson  <Martin.Lorentzson@telia.com>

	* vc-cvs.el (vc-cvs-sticky-date-format-string): New variable.
	(vc-cvs-sticky-tag-display): New variable.
	(vc-cvs-mode-line-string): Add sticky-tag to the mode-line.
	(vc-cvs-checkin): If the input revision is a valid symbolic tag
	name, we create it as a branch, commit and switch to it.
	(vc-cvs-retrieve-snapshot): Set file-property sticky-tag.
	(vc-cvs-valid-symbolic-tag-name-p): New function.
	(vc-cvs-parse-sticky-tag): New function.
	(vc-cvs-parse-entry): Added parsing of sticky tags.

2002-02-21  Per Abrahamsen  <abraham@dina.kvl.dk>

	* toolbar/tool-bar.el (tool-bar-mode): Revert the :init-value to
	nil, and then explicitly set the standard-value to t.

2002-02-20  Sam Steingold  <sds@gnu.org>

	* textmodes/flyspell.el (flyspell-mode): Autoload the variable
	since it is used in the menu bar.

2002-02-20  Richard M. Stallman  <rms@gnu.org>

	* simple.el (shell-command-on-region): Display the exit status
	when a command fails.

	* subr.el (add-hook): Doc fix.

	* frame.el (other-frame): Doc fix.

	* simple.el (yank): Clear `field' property.

2002-02-20  Tom Tromey  <tromey@cachet>

	* progmodes/tcl.el (tcl-do-fill-paragraph): Find and fill on more
	natural paragraph boundaries.  Don't fail at beginning of buffer.

2002-02-20  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* tar-mode.el (tar-next-line, tar-previous-line): Add doc string,
	call the argument "arg" to match plain next-line and
	previous-line.  From Kevin Ryde <user42@zip.com.au>.

2002-02-19  Sam Steingold  <sds@gnu.org>

	* mwheel.el (mouse-wheel-scroll-amount): Can specify different
	scroll amounts for different modifiers now.
	(mwheel-scroll): Handle the new `mouse-wheel-scroll-amount'
	format properly.
	(mouse-wheel-mode): Ditto.

2002-02-19  Eli Zaretskii  <eliz@is.elta.co.il>

	* textmodes/bibtex.el (bibtex-parse-keys): Put save-match-data
	around function body.

	* net/browse-url.el (browse-url-maybe-new-window): Reverse the
	sense of the comparison, to match the doc strings of functions
	that use this macro.

2002-02-19  Per Abrahamsen  <abraham@dina.kvl.dk>

	* facemenu.el (describe-text-mode-map): Removed bootstrap kludge.

	* toolbar/tool-bar.el (tool-bar-mode): Made the standard value t.
	* menu-bar.el (menu-bar-mode): Ditto.

2002-02-18  Andreas Schwab  <schwab@suse.de>

	* replace.el (query-replace-regexp-eval): Doc fix.

2002-02-18  Colin Walters  <walters@verbum.org>

	* calc/calcalg2.el (math-solve-get-int): Convert return value from
	`math-get-from-counter' to a string before calling `concat' on it.

	* calc/calc-maint.el (calc-split-manual): Look for calc.texi.
	(calc-public-autoloads): Obsolete; remove.
	(calc-private-autoloads): Ditto.
	(calc-add-autoloads): Ditto.

	* calc/calc-macs.el (calc-with-default-simplification): Use &rest
	for body.

2002-02-17  Jason Rumney  <jasonr@gnu.org>

	* w32-win.el (x-option-alist, x-long-option-alist)
	(x-switch-definitions): Remove, use command-line-x-option-alist
	instead to be consistent with X.
	(x-handle-initial-switch): New function.

2002-02-17  Eli Zaretskii  <eliz@is.elta.co.il>

	* faces.el (mode-line-inactive, header-line): Add the :inherit
	attribute for the tty case.

2002-02-17  stanislav shalunov  <shalunov@internet2.edu>

	* mail/uce.el (uce-reply-to-uce): Fix incorrect behavior when
	invoked from Rmail with full headers displayed.

2002-02-17  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* emacs-lisp/lisp.el (mark-defun): Don't leave multiple marks
	when repeated.
	* textmodes/paragraphs.el (mark-paragraph): Ditto.

2002-02-17  Per Abrahamsen  <abraham@dina.kvl.dk>

	* menu-bar.el (menu-bar-showhide-menu): Added speedbar.
	(menu-bar-tools-menu): Removed speedbar.

	* textmodes/ispell.el (ispell-menu-map): Added `customize-ispell'
	and `flyspell-mode' entries.

	* textmodes/flyspell.el (flyspell): Add to ispell group.

2002-02-17  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* emacs-lisp/lisp.el (mark-sexp): Don't leave multiple marks when
	repeated.
	(mark-defun): Mark more if repeated.

2002-02-17  Colin Walters  <walters@verbum.org>

	* ibuf-ext.el (ibuffer-toggle-sorting-mode): Make it work.

	* ibuffer.el (ibuffer-truncate-lines): New option.
	  (ibuffer-mode):  Use it.

2002-02-17  Kim F. Storm  <storm@cua.dk>

	* cus-start.el: Add mouse-highlight.

2002-02-16  Eli Zaretskii  <eliz@is.elta.co.il>

	* Makefile.in (DONTCOMPILE): Remove cus-start.el.

	* cus-start.el: Add automatic-hscroll-margin and
	automatic-hscroll-step.

2002-02-16  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* cus-start.el (x-autoselect-window): Allow customization.

	* eshell/em-alias.el (eshell-alias-initialize): Do not use
	make-local-hook.

	* eshell/em-cmpl.el (eshell-cmpl-initialize): Likewise.

	* eshell/em-dirs.el (eshell-dirs-initialize): Likewise.

	* eshell/em-glob.el (eshell-glob-initialize): Likewise.

	* eshell/em-hist.el (eshell-hist-initialize): Likewise.

	* eshell/em-pred.el (eshell-pred-initialize): Likewise.

	* eshell/em-prompt.el (eshell-prompt-initialize): Likewise.

	* eshell/em-rebind.el (eshell-rebind-initialize): Likewise.

	* eshell/em-smart.el (eshell-smart-initialize): Likewise.

	* eshell/em-unix.el (eshell-unix-initialize): Likewise.

	* eshell/esh-cmd.el (eshell-cmd-initialize): Likewise.

	* eshell/esh-ext.el (eshell-ext-initialize): Likewise.

	* eshell/esh-io.el (eshell-io-initialize): Likewise.

	* eshell/esh-mode.el (eshell-mode): Likewise.

	* eshell/esh-test.el (eshell-show-usage-metrics): Likewise.

	* eshell/esh-var.el (eshell-var-initialize): Likewise.

	* progmodes/idlw-shell.el (idlwave-shell-mode): Likewise.

	* progmodes/idlwave.el (idlwave-mode): Likewise.

	* textmodes/reftex-sel.el (reftex-select-label-mode)
	(reftex-select-bib-mode): Likewise.

2002-02-16  John Wiegley  <johnw@gnu.org>

	* eshell/em-hist.el (eshell-hist-initialize): When in the
	minibuffer, use the global value of `eshell-history-ring', and
	never save it to disk, or ask to save it to disk.  This allows
	users of session.el to control whether its global state should be
	persisted or not.
	(eshell-add-command-to-history): Don't write Eshell's history out
	to disk, let the governing mode control that upon exit.

2002-02-16  Eli Zaretskii  <eliz@is.elta.co.il>

	* eshell/eshell.el (eshell-command): Before reading from the
	minibuffer, add eshell-add-command-to-history to
	minibuffer-exit-hook, and remove it after read-from-minibuffer
	returns.

	* eshell/em-hist.el (eshell-add-input-to-history): New function,
	with most of the code from eshell-add-to-history.
	(eshell-add-command-to-history): New function, to record in
	eshell-history the commands run via eshell-command.
	(eshell-add-to-history): Call eshell-add-command-to-history to do
	most of the work.

2002-02-16  John Wiegley  <johnw@gnu.org>

	* eshell/esh-ext.el (eshell-external-command): Added a fix for
	XEmacs' new dired.el, which adds a global entry in the
	`file-name-handler-alist'.

2002-02-16  John Wiegley  <johnw@gnu.org>

	* align.el (align-region): Added a missing name argument.

2002-02-16  John Wiegley  <johnw@gnu.org>

	* eshell/esh-ext.el (eshell-script-interpreter): Allow whitespace
	after the #! of a shell interpretor specification.

2002-02-15  Richard M. Stallman  <rms@gnu.org>

	* help.el (describe-key-briefly): Make output in INSERT case
	look just like what is displayed in the normal case.

2002-02-15  Andreas Schwab  <schwab@suse.de>

	* textmodes/tex-mode.el (tex-font-lock-keywords-2):
	Require non-letter after specials.

2002-02-15  Eli Zaretskii  <eliz@is.elta.co.il>

	* menu-bar.el (menu-bar-tools-menu): Add an item for Calculator.

2002-02-15  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* simple.el (mark-word): Mark more if repeated.
	* textmodes/paragraphs.el (mark-paragraph): Ditto.
	(mark-end-of-sentence): Ditto.

2002-02-15  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (widgetp): Made it more robust.

2002-02-14  Per Abrahamsen  <abraham@dina.kvl.dk>

	* facemenu.el (describe-text-done): New function.
	(describe-text-mode-map): New variable.
	(describe-text-mode-hook): New option.
	(describe-text-mode): New function.
	(describe-text-widget): New function.
	(describe-text-sexp): New function.
	(describe-text-properties): New function.
	(describe-text-category): New command.
	(describe-text-at): New command.
	(facemenu-menu): Replace `list-text-properties-at' with
	`describe-text-at' in the menu.

	* wid-edit.el (widgetp): New function.
	* wid-edit.el (widget-keymap, widget-insert, widget-setup): Autoload.

	* emacs-lisp/pp.el (pp-to-string): Autoloaded.

	* wid-browse.el: Removed version and x-url keywords.

2002-02-13  Kim F. Storm  <storm@cua.dk>

	* cus-start.el (mode-line-in-non-selected-windows):
	Allow customization.

2002-02-13  Richard M. Stallman  <rms@gnu.org>

	* textmodes/bibtex.el (bibtex-parse-buffers-stealthily):
	Tell bibtex-parse-keys to output no progress messages.

2002-02-12  Eli Zaretskii  <eliz@is.elta.co.il>

	* progmodes/pascal.el (pascal-imenu-generic-expression):
	Add menu-title and fix parentheses.

2002-02-12  Per Abrahamsen  <abraham@dina.kvl.dk>

	* menu-bar.el (menu-bar-options-save): Removed `truncate-lines'.
	(menu-bar-options-menu): Don't set default value for `truncate-lines'.

2002-02-12  Per Abrahamsen  <abraham@dina.kvl.dk>

	* menu-bar.el (menu-bar-options-save): Only save
	`current-language-environment' and `default-input-method' when
	marked as customized.

	* international/mule-cmds.el
	(setup-specified-language-environment):
	Mark `current-language-environment' as customized.
	(set-input-method): Mark `default-input-method' as customized when
	called interactively.
	(toggle-input-method): Ditto.

2002-02-11  Colin Walters  <walters@verbum.org>

	* ibuffer.el (ibuffer-switch-format): Supply required argument for
	`ibuffer-current-formats'.

2002-02-11  Miles Bader  <miles@gnu.org>

	* faces.el (mode-line-inactive): Add dark-background variant.

2002-02-11  Per Abrahamsen  <abraham@dina.kvl.dk>

	* toolbar/tool-bar.el (tool-bar-mode): Removed standard value.
	* menu-bar.el (menu-bar-mode): Ditto.
	* cus-edit.el (customize-mark-to-save): Always save variables
	without a standard value.

	* menu-bar.el (menu-bar-make-toggle): Made it aware of customize.
	(menu-bar-options-save): Ditto.
	(menu-bar-showhide-menu): Ditto.
	(menu-bar-options-menu): Ditto.
	(menu-bar-scroll-bar-right, menu-bar-scroll-bar-left)
	(menu-bar-scroll-bar-none): Remove.
	(menu-bar-showhide-scroll-bar-menu): Use customize aware lambda
	expressions instead.

	* cus-edit.el (customize-set-value): Return value.
	(customize-set-variable): Ditto.
	(customize-save-variable): Ditto.
	(customize-set-variable): Load dependencies before setting value.
	(custom-load-symbol): Autoload it.
	(customize-mark-as-set): New function.

2002-02-11  Eli Zaretskii  <eliz@is.elta.co.il>

	* cus-start.el: Don't warn about "x-*" symbols when building a
	non-GUI version.

2002-02-11  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* strokes.el (strokes-do-stroke, strokes-do-complex-stroke):
	Doc fix.
	(strokes-help): Do not use doubled with-output-to-temp-buffer.
	Fix the help string.
	(strokes-prompt-user-save-strokes): Fix typo.
	(strokes-list-strokes): Use proper exit-action argument for
	view-buffer.  Update copyright notice.

	* international/mule-diag.el: Various doc and message fixes.
	(non-iso-charset-alist): Add mac-roman.  Don't add entries for
	codepages already present.
	(list-block-of-chars): Display space for null entries in
	translation table.  Display tab specially.
	(list-non-iso-charset-chars): Check for null charsets.  Use pop
	for clarity.  Don't break 8-bit sets into sections between ranges.
	(list-charset-chars): Avoid indent-tabs-mode.
	(describe-char-after): Maybe use the text property for syntax
	table information.  Maybe report char-code-property-table info.
	Maybe report character's unicode.  Tweak printing of list info.
	(list-input-methods): Add xref buttons.
	(dump-charsets, dump-codings): Deleted (obsolete).
	From Dave Love <fx@gnu.org>.

2002-02-10  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* menu-bar.el (menu-bar-showhide-menu): Rename functions for toggling.

2002-02-10  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper-util.el (viper-read-key-sequence): Fix so it'll read
	fast key sequences in emacs native mode
	(viper-events-to-keys): Delete.

	* viper.el (describe-key, describe-key-briefly): Get rid of
	viper-events-to-keys.

	* ediff-init.el (ediff-has-gutter-support): Steven Turnbull's patch.

	* ediff-wind.el (ediff-setup-control-frame):
	Use ediff-has-gutter-support.

	* ediff-util.el (ediff-dispose-of-variant-according-to-user):
	check if buff is alive.

	* ediff.el: Typo in comment.

2002-02-09  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* menu-bar.el (menu-bar-options-save): Take care of
	line-number-mode and column-number-mode variables.
	(menu-bar-showhide-menu): New menu-items "Show Line Number" and
	"Show Column Number" in "Show/Hide" menu.

2002-02-09  Richard M. Stallman  <rms@gnu.org>

	* mail/mailabbrev.el (mail-mode-map): Use eval-after-load to change it.

2002-02-09  Kim F. Storm  <storm@cua.dk>

	* faces.el (mode-line-inactive): New face for mode-line for
	non-selected windows.
	(mode-line): Doc fix: Only used for selected window.

2002-02-08  Eli Zaretskii  <eliz@is.elta.co.il>

	* calendar/cal-menu.el (calendar-mode-map): Change the menu item's
	name to "Insert Diary Entry".

2002-02-08  Stefan Monnier  <monnier@cs.yale.edu>

	* font-lock.el (save-buffer-state): Use restore-buffer-modified-p.
	(c-font-lock-syntactic-face-function): Accept doxygen-style comments.

2002-02-08  Richard M. Stallman  <rms@gnu.org>

	* textmodes/text-mode.el (text-mode-hook-identify): Define as no-op.

2002-02-08  Andreas Schwab  <schwab@suse.de>

	* calc/calc.el (calcDigit-key): Use minibuffer-prompt-end instead
	of point-min.

2002-02-08  Eli Zaretskii  <eliz@is.elta.co.il>

	* net/ange-ftp.el (ange-ftp-process-handle-line)
	(ange-ftp-set-xfer-size): If the file's size is a float, divide
	by 1024 instead of using ash.

	* international/mule-cmds.el (select-safe-coding-system):
	State the buffer's name in the message popped in the *Warning* buffer,
	and make sure the offending buffer is displayed.

2002-02-07  Markus Rost  <rost@math.ohio-state.edu>

	* ffap.el (ffap-newsgroup-p): Test for non-nil symbol-value of htb.

2002-02-07  Richard M. Stallman  <rms@gnu.org>

	* terminal.el (terminal-map): Define [menu-bar] so global def is seen.

	* register.el (list-registers): New command.
	(describe-register-1): New subroutine, taken out of view-register.

	* emacs-lisp/copyright.el (copyright-regexp):
	Delete the unibyte copyright symbol; it's redundant.
	Fix a spazz in the multibyte encoding here.

2002-02-07  Dave Love  <fx@gnu.org>

	* language/cyril-util.el (cyrillic-encode-koi8-r-char)
	(cyrillic-encode-alternativnyj-char): Get translation tables from
	symbol properties, not as variables.
	(standard-display-cyrillic-translit): Include unicodes.

2002-02-06  Kim F. Storm  <storm@cua.dk>

	* help.el (where-is): Report remapped commands.

	* help-fns.el (describe-function-1): Ditto.

	* subr.el (global-set-key, local-set-key): Accept a symbol for the
	KEY argument (like define-key).

2002-02-06  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* textmodes/flyspell.el (flyspell-insert-function): Doc fix.

2002-02-06  Richard M. Stallman  <rms@gnu.org>

	* mail/mailabbrev.el: Require sendmail only at compile time.
	(mail-mode-header-syntax-table): Var deleted.
	(mail-abbrev-syntax-table): Init to nil, will compute when needed.
	(sendmail-pre-abbrev-expand-hook): Only temporarily change
	local-abbrev-table and the syntax table.
	Compute mail-abbrev-syntax-table if that has not been done.

	* progmodes/compile.el (grep-compute-defaults): Definition moved up.

	* emacs-lisp/debug.el (debugger-frame-offset): Var deleted.
	(debugger-frame-number): Figure out the offset directly.
	(debugger-setup-buffer): Don't use debugger-frame-offset.
	(debugger-frame, debugger-frame-clear): Likewise.
	(debugger-jump): Don't alter debugger-frame-offset.

	* emacs-lisp/checkdoc.el (checkdoc-this-string-valid-engine):
	Replace foo-p as var name with foo-flag, not foo-p-flag.

	* hilit-chg.el (highlight-changes-active-string): Default to +Chg.
	(highlight-changes-passive-string): Default to -Chg.
	(highlight-changes-global-modes): Doc fix.

	* dired.el (dired-get-filename): Add /: when appropriate
	to avoid taking a local name as remote.

	* files.el (file-name-non-special): Add special handling for
	file-name-sans-versions, file-name-completion, and
	file-name-all-completions.

	* isearch.el (isearch-update): Don't update display in kbd macro.
	(isearch-lazy-highlight-new-loop): Do nothing in kbd macro.

	* subr.el (force-mode-line-update): Doc fix.

	* subr.el (atomic-change-group, prepare-change-group)
	(activate-change-group, accept-change-group, cancel-change-group):
	New functions.

	* simple.el (undo-get-state, undo-revert-to-state): Fns deleted.
	(transpose-subr-1): Use atomic-change-group.

	* subr.el (add-minor-mode): Include the mode's lighter string
	in the minor mode menu item name.

	* mail/rmail.el (rmail-toggle-header): Avoid possibly slow call to
	rmail-count-screen-lines starting from (point-min).

	* startup.el (use-fancy-splash-screens-p): Need 19 lines,
	beyond the image height, to use the fancy splash screen.

	* textmodes/text-mode.el (text-mode-hook-identify): Function deleted.
	(text-mode): Set text-mode-variant here.

2002-02-06  Eli Zaretskii  <eliz@is.elta.co.il>

	* play/pong.el (pong-height): Don't use height that exceeds the
	frame height.
	(pong-border-options): Make the border colors slightly more bright.

	* play/gamegrid.el (gamegrid-display-type): Treat any
	color-capable display as color-x, if display-color-p is fboundp.
	(gamegrid-make-color-x-face): Don't call gamegrid-color twice.
	(gamegrid-make-color-tty-face): Use the value of color, not the
	symbol itself.  Don't call gamegrid-color.

2002-02-05  Eli Zaretskii  <eliz@is.elta.co.il>

	* gud.el (gud-refresh): Call recenter only after we are sure we
	are in the right window.

2002-02-05  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (customize-mark-to-save): New function.
	* menu-bar.el (menu-bar-options-save): Rewrote.

2002-02-05  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* cus-start.el (x-use-underline-position-properties):
	Allow customization.

2002-02-04  Simon Josefsson  <jas@extundo.com>

	* dired.el (dired-load-hook, dired-mode-hook)
	(dired-before-readin-hook, dired-after-readin-hook): Defcustom.

2002-02-03  Colin Walters  <walters@verbum.org>

	* ibuf-ext.el (ibuffer-filter-format-alist)
	(ibuffer-cached-filter-formats, ibuffer-compiled-filter-formats):
	New variables.
	* ibuffer.el (ibuffer): Remove link; the "home page" for ibuffer
	is now the Emacs CVS tree.
	(ibuffer-formats): Doc fix.
	(ibuffer-active-formats-name, ibuffer-current-formats): New functions.
	(ibuffer-current-format): Use them.
	(ibuffer-recompile-formats, ibuffer-check-formats)
	(ibuffer-switch-format, ibuffer-update-title):
	Add support for ibuffer-filter-format-alist.
	(define-ibuffer-column process): Remove unncessary consing.

	* ibuf-macs.el (define-ibuffer-column): Add beginnings of support
	for a summary column.

2002-02-03  Andreas Schwab  <schwab@suse.de>

	* window.el (save-selected-window): Move macro before first use.
	(balance-windows): Fix misplaced parenthesis.

2002-02-03  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* calculator.el (calculator-displayers): Doc fixes.

2002-02-03  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* menu-bar.el (menu-bar-help-menu): Use different text for tool-tip.
	(menu-bar-options-save): Save also the value of `display-time-mode'.
	(showhide-date-time): New function.
	(menu-bar-showhide-menu): New menu-item "Date and time".

2002-02-03  Eli Zaretskii  <eliz@is.elta.co.il>

	* mail/rmail.el (rmail): Use find-buffer-visiting instead of
	get-file-buffer to check for rmail buffer existence.

	* term.el (term-emulate-terminal): Extract proper command string
	which is supplied to term-command-hook.

2002-02-03  Richard M. Stallman  <rms@gnu.org>

	* international/quail.el (quail-help): Don't call help-setup-xref.

	* international/mule-cmds.el (describe-input-method):
	Call help-setup-xref here.
	(describe-current-input-method): Doc fix.

	* novice.el (disabled-command-hook): Clarify output text.
	Indent the paragraph from the command's doc string.

	* dabbrev.el (dabbrev--goto-start-of-abbrev):
	Exit loop on beginning of field rather than bobp.

2002-02-02  Eli Zaretskii  <eliz@is.elta.co.il>

	* mail/uce.el (uce-reply-to-uce): Prune the headers before copying
	the message text into the *mail* buffer, and restore the pruned
	state after that.

	* mail/rmail.el (rmail-redecode-body): Prune the headers before
	looking for X-Coding-System header, and restore the pruned state
	before returning.

2002-02-02  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* cus-edit.el (customize-save-variable): Fix typo in prompt.

	These changes integrate new version of flyspell.el from its
	maintainer, Manuel Serrano:

	* textmodes/flyspell.el (flyspell-issue-message-flag): New user option.
	(flyspell-mode-on, flyspell-notify-misspell)
	(flyspell-small-region, flyspell-external-point-words)
	(flyspell-large-region): Use it
	(flyspell-before-incorrect-word-string)
	(flyspell-after-incorrect-word-string): New user options.
	(make-flyspell-overlay): Use them.
	(flyspell-version): New function.
	(flyspell-incorrect-face, flyspell-duplicate-face): Adapt face
	definitions to use :weight.
	(flyspell-insert-function): New user option.
	(flyspell-auto-correct-word, flyspell-correct-word)
	(flyspell-xemacs-correct): Use it.
	(flyspell-define-abbrev): New function.
	(flyspell-auto-correct-word, flyspell-correct-word)
	(flyspell-xemacs-correct): Use it.
	(make-flyspell-overlay): Use `evaporate' property.
	(flyspell-auto-correct-word, flyspell-correct-word): Remove overlay.
	(flyspell-emacs-popup): Use `session' instead of `accept'.
	(flyspell-auto-correct-previous-pos): New variable.
	(flyspell-auto-correct-previous-hook)
	(flyspell-auto-correct-previous-word): New functions.

2002-02-02  Eli Zaretskii  <eliz@is.elta.co.il>

	* novice.el (enable-command): If Emacs was invoked as "emacs -q",
	don't alter the user's ~/.emacs.
	(disable-command): If user-init-file is nil or does not exist,
	default to "~/.emacs" (~/_emacs on DOS and, maybe, Windows).
	But don't alter the init file if Emacs was invoked as "emacs -q"

2002-02-01  Stefan Monnier  <monnier@cs.yale.edu>

	* mail/sendmail.el (mail-mode): Undo half of last change.

	* indent.el (indent-for-tab-command): Remove spurious code.

	* hi-lock.el (hi-lock-find-patterns): Save restriction.

2002-02-01  Eli Zaretskii  <eliz@is.elta.co.il>

	* calendar/time-date.el: Moved from lisp/gnus.

	* calendar/parse-time.el: Ditto.

2002-01-31  Richard M. Stallman  <rms@gnu.org>

	* international/iso-acc.el (iso-languages): Fix ", " in French.

	* cus-start.el (history-length): Specify customization for it.

	* emacs-lisp/debug.el (debugger-setup-buffer):
	When an eval-buffer frame was reading from a buffer,
	insert indication of the buffer position.
	(debugger-frame-number): Ignore ;;;-comment lines in backtrace.
	(debugger-frame-clear, debugger-frame): Error on non-frame line.

	* simple.el (shell-command-on-region): Err if no mark
	before reading the command string.

	* hl-line.el (hl-line-highlight, hl-line-unhighlight):
	Definitions moved down after hl-line-mode var's definition.

	* hilit-chg.el (hilit-chg-fixup): Don't alter overlay if not ours.
	(hilit-chg-set-face-on-change): Rename arg.
	(hilit-chg-make-ov): Detect error earlier.

	* ediff-hook.el: Delete autoload cookies.

	* comint.el (comint-scroll-show-maximum-output): Default is t.

	* emacs-lisp/bytecomp.el (batch-byte-compile): New arg noforce.
	(batch-byte-compile-if-not-done): New function.

	* Makefile.in (compile): New target.
	(compile-always): Renamed from compile-files.
	(compile-after-backup): Renamed from compile.
	(bootstrap): Depend on compile-always, not compile-files.

	* emulation/pc-select.el (pc-select-save-and-set-mode):
	Properly use MODE-VAR.

2002-01-29  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* menu-bar.el (menu-bar-help-menu): Change menu-item "Show Emacs
	Version" to "About Emacs".
	(menu-bar-options-save): Add `default-frame-alist'
	to saved variables.
	(menu-bar-showhide-scroll-bar-menu): Use frame-parameters instead
	of the variable `scroll-bar-mode'.

	* startup.el (normal-splash-screen, display-splash-screen):
	New functions (separated from command-line-1).
	(command-line-1): Use them.

2002-01-28  Eli Zaretskii  <eliz@is.elta.co.il>

	* calendar/calendar.el (generate-calendar-month): Doc fix.

2002-01-27  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* time.el (display-time-mail-directory): New option.
	(display-time-mail-function): Update doc-string.
	(display-time-mail-icon): Use XPM image when available.
	(display-time-string-forms): Use more descriptive text as
	help-echo property.
	(display-time-mail-check-directory): New function.
	(display-time-update): Use it.

	* menu-bar.el (menu-bar-showhide-scroll-bar-menu):
	Quote `window-system'.

	* tmm.el (tmm-get-keymap): Honour :visible in `menu-item'.
	Add Keywords header.  Update Commentary section.
	Update copyright notice.

	* menu-bar.el (menu-bar-scroll-bar-right)
	(menu-bar-scroll-bar-left, menu-bar-scroll-bar-none)
	(showhide-menu-bar): New functions.
	(menu-bar-showhide-menu): New submenu "Show/Hide".
	(menu-bar-showhide-scroll-bar-menu): "Scroll-bar" submenu of
	"Show/Hide".
	Update copyright notice.

2002-01-27  Eli Zaretskii  <eliz@is.elta.co.il>

	* lazy-lock.el (lazy-lock-mode): Add a reference to jit-lock.

2002-01-26  Evgeny Roubinchtein  <evgenyr@cs.washington.edu>

	* pc-select.el (pc-selection-mode-hook)
	(pc-select-saved-settings-alist, pc-select-map)
	(pc-select-saved-global-map, pc-select-key-bindings-alist)
	(pc-select-default-key-bindings, pc-select-extra-key-bindings)
	(pc-select-meta-moves-sexps-key-bindings)
	(pc-select-tty-key-bindings, pc-select-old-M-delete-binding):
	New variables.
	(pc-select-define-keys, pc-select-restore-keys): New functions.
	(pc-select-add-to-alist, pc-select-save-and-set-var)
	(pc-select-save-and-set-mode, pc-select-restore-var)
	(pc-select-restore-mode): New macros.
	(pc-selection-mode): Completely rewrote the body of the function;
	the main goal was to make pc-selection-mode "turn-off"-able, like
	other minor modes.  Use define-minore-mode instead of just a
	defun.  Store the key bindings into four alists:
	pc-select-default-key-bindings, pc-select-extra-key-bindings,
	pc-select-meta-moves-sexps-key-bindings, and
	pc-select-tty-key-bindings; then have the pc-select-define-keys
	function walk those alists instead of calling define-key
	repeatedly.  When the mode is turned on, set the
	keybindings in global-map and remember the old keybindings; when
	the mode is turned off, restore the previously-saved keybindings.
	(pc-selection-mode defcustom): Reflect the fact that the mode is
	now "turn-off"-able.

2002-01-26  Eli Zaretskii  <eliz@is.elta.co.il>

	* eshell/esh-cmd.el (eshell-eval-command): If eshell-resume-eval
	returns t, don't treat that as an error.

2002-01-25  Jason Rumney  <jasonr@gnu.org>

	* faces.el (face-font-registry-alternatives) [windows-nt]:
	Add ms-oemlatin as an alternative for iso8859-1.

2002-01-25  Stefan Monnier  <monnier@cs.yale.edu>

	* pcvs.el (cvs-reread-cvsrc): Distinguish between an empty list of
	args and the absence of an entry.  Don't add -f each time.

2002-01-25  Eli Zaretskii  <eliz@is.elta.co.il>

	* emacs-lisp/cl-seq.el (mismatch): Doc fix.

	Support for more than 8 colors on character terminals:

	* term/rxvt.el: New file.

	* Makefile.in (DONTCOMPILE): Remove term/xterm.el.

	* term/xterm.el (xterm-standard-colors): New variable.
	(xterm-rgb-convert-to-16bit, xterm-register-default-colors)
	(xterm-rxvt-set-background-mode): New functions.
	(toplevel): Call xterm-register-default-colors,
	xterm-rxvt-set-background-mode, and tty-set-up-initial-frame-faces.
	Add support for more keys from xterm's terminfo entry.

	* facemenu.el (list-colors-display): If the argument is nil, don't
	show more colors that the number returned by display-color-cells.

	* term/pc-win.el (msdos-color-values): Reverse the order of the
	colors, since tty-color-define now preserves the registration order.

	* w32-fns.el (w32-tty-standard-colors): Reverse the order.

	* term/tty-colors.el (tty-standard-colors): Reverse the order.
	(tty-register-default-colors): New function; code moved from
	startup.el's command-line.
	(tty-modify-color-alist): Use nconc instead of cons, to preserve
	the order the colors where registered.

	* frame.el (display-color-cells): Use tty-display-color-cells.

	* startup.el (command-line): Call tty-register-default-colors.

2002-01-25  Richard M. Stallman  <rms@gnu.org>

	* subr.el (remove): Doc fix.

2002-01-24  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compilation-handle-exit):
	Add a compilation-handle-exit property to the "finished" message.
	(compilation-parse-errors): Stop parsing when that property is seen.

	* subr.el (substring-no-properties): New function.
	(copy-without-properties): Function deleted.

	* term/x-win.el (x-handle-geometry): Put sizes on both
	initial-frame-alist and default-frame-alist.

	* cus-edit.el (custom-save-all): Bind file-precious-flag to t
	for saving .emacs.

	* files.el (basic-save-buffer-2): Ignore file-error in delete-file.

	* calendar/calendar.el (generate-calendar-month): Doc fix.

2002-01-23  Richard M. Stallman  <rms@gnu.org>

	* play/tetris.el (tetris): New defgroup.
	(tetris-use-glyphs, tetris-use-color, tetris-draw-border-with-glyphs)
	(tetris-default-tick-period): Convert to defcustom.
	Added * in docstring to indicate user variable.
	(tetris-update-speed-function, tetris-mode-hook, tetris-tty-colors)
	(tetris-x-colors, tetris-buffer-name, tetris-buffer-width)
	(tetris-buffer-height, tetris-width, tetris-height)
	(tetris-top-left-x, tetris-top-left-y): Convert to defcustom.

2002-01-22  Stefan Monnier  <monnier@cs.yale.edu>

	* mail/sendmail.el (mail-mode): ">" is not a supercite-style prefix
	and is already matched by adaptive-fill-regexp.

2002-01-22  Richard M. Stallman  <rms@gnu.org>

	* bindings.el (mode-line-copied-mode-name): New variable.
	(mode-line-mode-name): Don't modify mode-name itself!
	Instead, make a copy and reuse it.

	* subr.el (copy-without-properties): New function.

	* progmodes/sh-script.el (sh-set-shell): Doc fix.

	* net/ange-ftp.el (ange-ftp-canonize-filename): Avoid duplicate
	slash if DIR is just slash.

	* progmodes/perl-mode.el (perl-mode-abbrev-table): Restore definition.

2002-01-21  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/copyright.el (copyright-regexp): Fix previous change.

	* net/ange-ftp.el (ange-ftp-bs2000-posix-hook-installed):
	Move defvar up.

	* textmodes/ispell.el (ispell-help): Clean up echo area if user quits.

	* ibuffer.el: Don't require ibuf-ext at load time.
	(ibuffer): Require ibuf-ext here.

2002-01-21  Francesco Potorti`  <pot@gnu.org>

	* generic-x.el (apache-conf-generic-mode): Highlight the first
	word in a line even if preceded by blanks.

2002-01-21  Richard M. Stallman  <rms@gnu.org>

	* window.el (window-body-height): Handle minibuffer window specially.
	Otherwise, don't return less than 1.

2002-01-20  Thomas Dorner  <Thomas.Dorner@start.de>

	* ange-ftp.el: Added support for BS2000, and for raw ftp
	login commands (needed in some circumstances).
	(ange-ftp-raw-login): New custom var.
	(ange-ftp-normal-login): Perform login with raw ftp commands, if
	ange-ftp-raw-login is set and account password is needed.
	(ange-ftp-host-type, ange-ftp-guess-host-type): Handle BS2000 hosts.
	(ange-ftp-bs2000-filename-pubset-regexp)
	(ange-ftp-bs2000-filename-username-regexp)
	(ange-ftp-bs2000-filename-prefix-regexp)
	(ange-ftp-bs2000-name-template): New consts.
	(ange-ftp-bs2000-short-filename-regexp)
	(ange-ftp-bs2000-fix-name-regexp-reverse)
	(ange-ftp-bs2000-fix-name-regexp): New consts.
	(ange-ftp-bs2000-special-prefix): New custom var.
	(ange-ftp-fix-name-for-bs2000)
	(ange-ftp-fix-dir-name-for-bs2000): New funs.
	(ange-ftp-bs2000-host-regexp, ange-ftp-bs2000-posix-host-regexp)
	(ange-ftp-bs2000-posix-hook-installed): New vars.
	(ange-ftp-parse-bs2000-filename, ange-ftp-parse-bs2000-listing)
	(ange-ftp-bs2000-host, ange-ftp-bs2000-posix-host)
	(ange-ftp-add-bs2000-host, ange-ftp-add-bs2000-posix-host): New funs.
	(ange-ftp-bs2000-filename-regexp): New const.
	(ange-ftp-bs2000-additional-pubsets): New custom var.
	(ange-ftp-bs2000-cd-to-posix): New fun.

2002-01-20  Colin Walters  <walters@verbum.org>

	* ibuffer.el: (toplevel) Require `ibuf-ext', which is now compiled
	with `byte-compile-dynamic'.
	(ibuffer-default-directory, toplevel): Doc files.

2002-01-20  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* tempo.el (tempo-define-template): Doc fix.

	* scroll-bar.el (scroll-bar-mode): Make argument optional.

2002-01-20  Jason Rumney  <jasonr@gnu.org>

	* w32-vars.el: New file.

	* loadup.el [windows-nt]: Load it.

	* w32-fns.el, term/w32-win.el: Move user variables to w32-vars.el
	and make them defcustoms.

	* term/w32-win.el (mouse-set-font): Use w32-list-proportional-fonts.

2002-01-19  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* language/tibet-util.el (tibetan-decompose-region)
	(tibetan-decompose-string): Fix typo in docstring.

	* ruler-mode.el (ruler-mode): New keyword.  Fix :version.

2002-01-18  Richard M. Stallman  <rms@gnu.org>

	* comint.el (comint-redirect-send-command-to-process):
	Restore previous current buffer.

	* window.el (window-body-height): New function.

2002-01-18  Zoltan Kemenczy  <kemenczy@rogers.com>

	* gud.el (easy-mmode-defmap): Enable "Up Stack", "Down Stack", and
	"Finish Function" menu map entries for jdb mode.
	(gud-jdb-use-classpath): New customization variable.
	(gud-jdb-command-name): Add customization.
	(gud-jdb-classpath, gud-marker-acc-max-length): New variables.
	(gud-jdb-classpath-string): New variable.
	(gud-jdb-source-files, gud-jdb-class-source-alist): Add doc strings.
	(gud-jdb-build-source-files-list): Likewise.
	(gud-jdb-massage-args): Record any command argument classpath
	string in `gud-jdb-classpath-string'.
	(gud-jdb-lowest-stack-level): New function, finds bottom of current
	java call stack in jdb output.
	(gud-jdb-find-source-using-classpath, gud-jdb-find-source)
	(gud-jdb-parse-classpath-string): New functions.
	(gud-jdb-marker-filter): Search/detect classpath information in
	jdb's output.  marker regexp updated to match oldjdb and jdb output
	formats.  Expand search for source files to include new/old methods
	using new functions above.  Do not allow `gud-marker-acc' to grow
	without bound.
	(jdb): Set classpath information (if available) as jdb is started.
	Change `gud-break' and `gud-remove'
	to use new %c ("class") escape in format strings.
	Add `gud-finish', `gud-up', `gud-down' command string functions, and
	add them to the local menu map.  Update `comint-prompt-regexp' for
	jdb and oldjdb.  If attaching to an already running java VM and
	configured to use classpath, send command to query for classpath,
	else use previous method for finding and parsing java
	sources.  Set `gud-jdb-find-source' function accordingly.
	(gud-mode): Doc fix.
	(gud-format-command): Add support for new %c ("class") escape.
	(gud-find-class): New function in support of %c escape.

2002-01-17  Richard M. Stallman  <rms@gnu.org>

	* ibuf-ext.el: Enable byte-compile-dynamic.

2002-01-17  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el: Restore conditional require of fontset.

2002-01-16  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-drag-region-1): Renamed from mouse-drag-region,
	more or less.
	(mouse-drag-region): New function.  For a click in the echo area,
	show *Messages*.

	* ibuf-ext.el: Delete the autoloads for functions defined with
	ibuffer-specific commands.

	* help.el (describe-distribution): Really call view-file.

	* net/ange-ftp.el (ange-ftp-passive-mode): New arg PROC.
	(ange-ftp-get-process): Pass that arg.

	* comint.el (comint-simple-send): Fix previous change.

	* net/telnet.el (telnet-simple-send): Fix previous change.

	* progmodes/sql.el (sql-escape-newlines-and-send)
	(sql-query-placeholders-and-send): Fix previous change.

2002-01-16  Colin Walters  <walters@verbum.org>

	* ibuf-ext.el, ibuf-macs.el, ibuffer.el (toplevel): Remove X-RCS,
	URL, Compatibility headers.  Update copyright notice.
	* ibuf-macs.el (toplevel): Require `cl' when compiling.

2002-01-16  Andrew Choi  <akochoi@cse.cuhk.edu.hk>

	* startup.el (command-line): Set EOL mnemonics for the Mac.

2002-01-16  Andreas Schwab  <schwab@suse.de>

	* mail/feedmail.el (feedmail): Fix :link spec.

2002-01-16  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/ldap.el (ldap-ldapsearch-prog): Default to OpenLDAP version
	2 ldapsearch.

	* net/eudc.el: New maintainer.  Change author's address.
	(eudc-pre-select-window-configuration, eudc-insertion-marker):
	Variables removed.
	(eudc-insert-selected): Function removed.
	(eudc-select): Reimplemented.
	(eudc-expand-inline): Delete the strings only after its expansion
	is chosen not before.

	* net/eudcb-ph.el (eudc-ph-open-session): Remove XEmacs case.
	Minor coding style fixes.

	* net/eudcb-ldap.el: New maintainer.  Change author's address.
	(eudc-attribute-display-method-alist): Display mail with
	eudc-display-mail.

	* net/eudcb-bbdb.el, net/eudc-export.el, net/eudc-hotlist.el,
	* net/eudc-vars.el: New maintainer.  Change author's address.

	* net/eudc-bob.el: New maintainer.  Change author's address.
	(eudc-bob-mail-keymap): New keymap for e-mail addresses.
	(eudc-display-mail): New function.
	(eudc-bob-play-sound-at-point): Remove XEmacs case.

2002-01-15  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/autoload.el (make-autoload):
	Don't handle define-ibuffer-column, define-ibuffer-filter,
	define-ibuffer-sorter, and define-ibuffer-op.

2002-01-14  Richard M. Stallman  <rms@gnu.org>

	* calendar/calendar.el (diary-date-forms): Doc fix.

2002-01-14  Eli Zaretskii  <eliz@is.elta.co.il>

	* startup.el (command-line): Register the default tty colors even
	if the terminal doesn't seem to support colors.
	<tty-long-option-alist>: New option --color.
	(tty-handle-args): Parse the --color arg.

	* term/tty-colors.el (tty-color-mode-alist): New variable.

2002-01-14  Stefan Monnier  <monnier@cs.yale.edu>

	* net/ange-ftp.el (ange-ftp-root-dir-p): New function.
	(ange-ftp-file-name-all-completions, ange-ftp-file-name-completion):
	Use it.
	(ange-ftp-hook-function): Preserve match-data.
	(ange-ftp-insert-directory): Typo.
	(ange-ftp-shell-command): Check if regexp matched.

2002-01-13  Richard M. Stallman  <rms@gnu.org>

	* international/mule-cmds.el: help-map bindings moved to help.el.

	* help.el (view-echo-area-messages): New function.
	(help-map): Add `e' binding.  Delete obsolete `d' binding.
	Change old Info bindings C-f, C-k and C-i to F, K, S.
	Move view-emacs-FAQ from F to C-f.
	Move view-emacs-problems from P to C-e.
	Bindings moved here from mule-cmds.el.
	C-l binding for describe-language-environment deleted
	(help-for-help): Update for all these changes.

	* emacs-lisp/copyright.el (copyright-regexp): Make (C) optional.

2002-01-13  Dave Love  <fx@gnu.org>

	* emacs-lisp/copyright.el: Doc fixes.
	(copyright-regexp): Add Latin-9 copyright sign.
	Match comment delimiters in year lists.
	(copyright-current-year): Initialize to load-time year.

2002-01-13  Andreas Schwab  <schwab@suse.de>

	* dired-aux.el (dired-do-shell-command): Doc fix.

2002-01-13  Jan Djarv  <Jan.Djarv@mbox200.swipnet.se>

	* startup.el (command-line-x-option-alist): New options "-fs",
	"-fw", "-fh", "--fullscreen", "--fullwidth", and "--fullheight".

	* term/x-win.el (x-handle-initial-switch): New function.

2002-01-13  Colin Walters  <walters@debian.org>

	* emacs-lisp/autoload.el (make-autoload): Handle define-ibuffer-column,
	define-ibuffer-filter, define-ibuffer-sorter, and define-ibuffer-op.

	* emacs-lisp/lisp-mode.el (toplevel): Ditto.

	* ibuffer.el, ibuf-ext.el, ibuf-macs.el: New files.

2002-01-12  Richard M. Stallman  <rms@gnu.org>

	* net/browse-url.el (browse-url-grail):
	Use browse-url-maybe-new-window.

	* net/telnet.el (telnet-simple-send):
	Handle comint-input-sender-no-newline like comint-simple-send.

	* progmodes/sql.el (sql-query-placeholders-and-send):
	Handle comint-input-sender-no-newline like comint-simple-send.
	(sql-escape-newlines-and-send): Likewise.

	* comint.el (comint-input-sender): Doc fix.
	(comint-input-sender-no-newline): New variable.
	(comint-simple-send): If comint-input-sender-no-newline,
	don't output newline, but maybe send eof.
	(comint-send-input): New arg NO-NEWLINE.
	(comint-send-eof): Call comint-send-eof with NO-NEWLINE.

2002-01-12  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* textmodes/flyspell.el (flyspell-check-pre-word-p):
	Prevent delaying when executing keyboard macros.

2002-01-12  Richard M. Stallman  <rms@gnu.org>

	* simple.el (line-move): If we can't move enough lines,
	go to beginning or end of line.

	* help-mode.el (help-xref-go-back): Restore POSITION in proper buffer
	and proper window.

	* help.el (describe-mode): Call help-setup-xref in the help buffer.
	Switch buffers only after calling `help-buffer'.

	* dired-aux.el (dired-shell-stuff-it): Substitute for * or ?
	only when they are surrounded by whitespace.
	Use dired-mark-separator when adding one file name to a command.
	(dired-do-shell-command): Verify that * is surrounded by whitespace.
	Ask for confirmation if * or ? is not surrounded by whitespace.
	(dired-bunch-files): Re-reverse the partial file list when it is used.

2002-01-12  Richard M. Stallman  <rms@gnu.org>

	* comint.el (comint-dynamic-list-completions): Repeating the command
	after displaying a completion list scrolls the list.

2002-01-12  Eli Zaretskii  <eliz@is.elta.co.il>

	* files.el (find-file-noselect): Don't consider a buffer as
	visiting a file literally if it is in hexl-mode.

	* faces.el (minibuffer-prompt): A better face definition for MS-DOS.

2002-01-11  Richard M. Stallman  <rms@gnu.org>

	* startup.el (initial-scratch-message): Fix custom type, add group.

	* mail/rmail.el (rmail-decode-babyl-format): Disable undo
	around the decode-coding-region call.

	* emacs-lisp/lisp.el (lisp-complete-symbol): Repeating the command
	after displaying a completion list scrolls the list.

2002-01-11  Eli Zaretskii  <eliz@is.elta.co.il>

	* version.el (emacs-version): Bump to 21.2.50.

2002-01-10  Thien-Thi Nguyen  <ttn@giblet.glug.org>

	* play/zone.el (zone-timeout): New var.
	(zone-hiding-modeline): New macro.
	(zone-call): New func.

	(zone): Init `modeline-hidden-level' symbol property.
	Use `zone-call' instead of `funcall'.

	(zone-pgm-whack-chars): Use `make-string' (fix bug introduced in 1.7).

	(zone-pgm-stress): Use `zone-hiding-modeline'.

	(zone-pgm-stress-destress): New zone program.

2002-01-10  Eli Zaretskii  <eliz@is.elta.co.il>

	* faces.el (minibuffer-prompt): Special face definition for MS-DOS.

2002-01-09  Richard M. Stallman  <rms@gnu.org>

	* startup.el (fancy-splash-screens): Set tab-width in correct buffer.

2002-01-09  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper.el (viper-set-hooks): Zap viper-unfriendly bindings in
	flyspell-mouse-map.

2002-01-08  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/regexp-opt.el (regexp-opt): Bind max-specpdl-size.

	* emacs-lisp/eldoc.el (eldoc-minor-mode-string): Fix custom type.

	* textmodes/flyspell.el (flyspell-mode-line-string): Fix custom type.

2002-01-08  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* progmodes/ada-mode.el (ada-initialize-properties, ada-mode):
	Do not use make-local-hook.

2002-01-08  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/quail.el (quail-start-translation)
	(quail-start-conversion): Bind last-command-event, last-command,
	and this-command in the first let.  This fixes the change from
	2000-08-30.

2002-01-08  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-hook.el: Add an autoload cookie.

2002-01-08  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/eudcb-ph.el, net/ldap.el: New maintainer.  New e-mail
	address of the author.

2002-01-08  Richard M. Stallman  <rms@gnu.org>

	* replace.el (occur-mode-goto-occurrence-other-window): New command.
	(occur-mode-map): Bind `o' to that.

2002-01-07  Michael Kifer  <kifer@cs.stonybrook.edu>

	* viper-init.el (viper-cond-compile-for-xemacs-or-emacs):
	new macro that replaces viper-emacs-p and viper-xemacs-p in many
	cases. Used to reduce the number of warnings.

	* viper-cmd.el: Use viper-cond-compile-for-xemacs-or-emacs.
	(viper-standard-value): Move here from viper.el.
	(viper-set-unread-command-events): Move to viper-util.el
	(viper-check-minibuffer-overlay): Make sure
	viper-minibuffer-overlay is moved to cover the entire input field.

	* viper-util.el:  use viper-cond-compile-for-xemacs-or-emacs.
	(viper-read-key-sequence, viper-set-unread-command-events)
	(viper-char-symbol-sequence-p, viper-char-array-p): Moved here.

	* viper-ex.el: Use viper-cond-compile-for-xemacs-or-emacs.

	* viper-keym.el: Use viper-cond-compile-for-xemacs-or-emacs.

	* viper-mous.el: Use viper-cond-compile-for-xemacs-or-emacs.

	* viper-macs.el (viper-char-array-p, viper-char-symbol-sequence-p)
	(viper-event-vector-p): Move to viper-util.el

	* viper.el (viper-standard-value): Move to viper-cmd.el.
	Use viper-cond-compile-for-xemacs-or-emacs.

	* ediff-help.el: Use ediff-cond-compile-for-xemacs-or-emacs.

	* ediff-hook.el: Use ediff-cond-compile-for-xemacs-or-emacs.

	* ediff-init.el (ediff-cond-compile-for-xemacs-or-emacs):
	New macro designed to be used in many places where ediff-emacs-p or
	ediff-xemacs-p was previously used.  Reduces the number of warnings.
	Use ediff-cond-compile-for-xemacs-or-emacs in many places in lieu
	of ediff-xemacs-p.
	(ediff-make-current-diff-overlay, ediff-highlight-diff-in-one-buffer)
	(ediff-convert-fine-diffs-to-overlays, ediff-empty-diff-region-p)
	(ediff-whitespace-diff-region-p, ediff-get-region-contents):
	Move to ediff-util.el.
	(ediff-event-key): Moved here.

	* ediff-merge.el: Got rid of unreferenced variables.

	* ediff-mult.el: Use ediff-cond-compile-for-xemacs-or-emacs.

	* ediff-util.el: Use ediff-cond-compile-for-xemacs-or-emacs.
	(ediff-cleanup-mess): Improve the way windows are set up after
	quitting ediff.
	(ediff-janitor): Use ediff-dispose-of-variant-according-to-user.
	(ediff-dispose-of-variant-according-to-user): New function
	designed to be smarter and also understands indirect buffers.
	(ediff-highlight-diff-in-one-buffer)
	(ediff-unhighlight-diff-in-one-buffer)
	(ediff-unhighlight-diffs-totally-in-one-buffer)
	(ediff-highlight-diff, ediff-highlight-diff)
	(ediff-unhighlight-diff, ediff-unhighlight-diffs-totally)
	(ediff-empty-diff-region-p, ediff-whitespace-diff-region-p)
	(ediff-get-region-contents, ediff-make-current-diff-overlay):
	Moved here.
	(ediff-format-bindings-of): New function by Hannu Koivisto
	<azure@iki.fi>.
	(ediff-setup): Make sure the merge buffer is always widened and
	modifiable.
	(ediff-write-merge-buffer-and-maybe-kill): Refuse to write the
	result of a merge into a file visited by another buffer.
	(ediff-arrange-autosave-in-merge-jobs): Check if the merge file
	is visited by another buffer and ask to save/delete that buffer.
	(ediff-verify-file-merge-buffer): New function to do the above.

	* ediff-vers.el: Load ediff-init.el at compile time.

	* ediff-wind.el: Use ediff-cond-compile-for-xemacs-or-emacs.

	* ediff.el (ediff-windows, ediff-regions-wordwise)
	(ediff-regions-linewise): Use indirect buffers to improve
	robustness and make it possible to compare regions of the same
	buffer (even overlapping regions).
	(ediff-clone-buffer-for-region-comparison)
	(ediff-clone-buffer-for-window-comparison): New functions.
	(ediff-files-internal): Refuse to compare identical files.
	(ediff-regions-internal): Get rid of the warning about comparing
	regions of the same buffer.

	* ediff-diff.el (ediff-convert-fine-diffs-to-overlays): Moved here.
	Plus the following fixes courtesy of Dave Love: Doc fixes.
	(ediff-word-1): Use word class and move - to the
	front per regexp documentation.
	(ediff-wordify): Bind forward-word-function outside loop.
	(ediff-copy-to-buffer): Use insert-buffer-substring rather than
	consing buffer contents.
	(ediff-goto-word): Move syntax table setting outside loop.

2002-01-07  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-copy-filename-as-kill): Call kill-append
	if following a kill command.

	* help-fns.el (describe-variable, describe-function):
	Do save-excursion.

2002-01-06  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/ldap.el (ldap-search-internal): Skip error message from
	ldapsearch.  Allow listing attribute names only.  Do not open
	non-existent files.

	* net/eudcb-ldap.el (eudc-ldap-get-field-list): Do not try to
	call non-existent function.

	* net/eudc.el (top-level): Revert previous change.

	* net/net-utils.el (nslookup-font-lock-keywords): Defvar font-lock
	variables to prevent warning from byte-compiler.

	* net/eudc.el (top-level): Use eudc-xemacs-p instead of
	string-match on emacs-version again.

	* enriched.el (enriched-make-annotation): Fix the change from
	2002-01-05.
	(enriched-handle-display-prop): Return proper values.

	* net/eudcb-ldap.el (eudc-attribute-display-method-alist):
	Use proper attribute name labeledUri instead of deprecated labeledUrl.

2002-01-05  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/eudc-hotlist.el (eudc-edit-hotlist): Avoid error when
	editing an empty hotlist.

	* net/ldap.el (ldap-search-internal): Make the buffer unibyte.
	Use buffer-string instead of buffer-substring for the whole buffer.

	* net/eudc-vars.el (eudc-external-viewers): Do not use xv, it is
	not free.

	* net/eudc-bob.el (eudc-bob-can-display-inline-images)
	(eudc-bob-display-jpeg): Use fboundp instead of boundp.
	(eudc-bob-save-object): Make the buffer unibyte.
	(eudc-bob-generic-keymap): Add new keybinding `!' to pipe the
	object to external program.

2002-01-05  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-branch-part): Return nil if there's no `.'
	(vc-default-previous-version): Renamed from vc-previous-version.
	New args BACKEND and FILE.  Return nil for revision numbers
	without a `.'
	(vc-version-diff): Call vc-BACKEND-previous-version.
	(vc-steal-lock): Steal lock before composing mail, so that no mail
	is sent when the stealing goes wrong.  And we'll actually see the
	error in that case now.
	(vc-finish-steal): Removed.

	* vc-rcs.el (vc-rcs-steal-lock): Do a real checkout after stealing
	the lock, so that we see expanded headers.
	(vc-rcs-trunk-p, vc-rcs-branch-part, vc-rcs-branch-p)
	(vc-rcs-minor-part, vc-rcs-previous-version): Removed.  These are
	available from vc.el.  Updated all callers.

2002-01-05  Richard M. Stallman  <rms@gnu.org>

	* enriched.el (enriched-make-annotation): Doc fix.

	* format.el (format-replace-strings, format-subtract-regions)
	(format-annotate-region, format-annotate-location)
	(format-annotate-atomic-property-change)
	(format-annotate-single-property-change): Doc fixes.

2002-01-05  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el: Require fontset unconditionally.
	(w32-handle-scroll-bar-event): Remove.

2002-01-04  Lars Magne Ingebrigtsen  <larsi@gnus.org>

	* emacs-lisp/copyright.el (copyright-regexp): Allow multi-line
	copyrights to be updated.

2002-01-04  Eli Zaretskii  <eliz@is.elta.co.il>

	* textmodes/texinfo.el (texinfo-insert-@end): Fix the change from
	2001-10-24.

	* mail/sendmail.el (mail-recover-1, mail-recover): Doc fix.

2002-01-04  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* net/ldap.el (ldap-host-parameters-alist): Remove duplicated entry.
	(ldap-ignore-attribute-codings): Change the default value to allow
	encoding/decoding of attributes.
	(ldap-coding-system): Use UTF-8 as the coding-system.  Doc fix.

2002-01-03  Richard M. Stallman  <rms@gnu.org>

	* files.el (basic-save-buffer): Undo previous change.

	* calendar/diary-lib.el (diary-block): Doc fix.

	* custom.el (defcustom): Fix syntax of previous change.

2002-01-03  Per Abrahamsen  <abraham@dina.kvl.dk>

	* custom.el (defcustom): Documented :tag, :link and :load.

2002-01-03  Eli Zaretskii  <eliz@is.elta.co.il>

	* mail/sendmail.el (mail-recover-1): New function.
	(mail-recover): Switch to the *mail* buffer right away.
	Use buffer-auto-save-file-name instead of calling
	make-auto-save-file-name.  Call dired-noselect instead of invoking
	`ls' directly.  Bind coding-system-for-read to emacs-mule-unix
	before reading the auto-save file.  If the buffer's auto-save file
	does not exist, call mail-recover-1 to allow recovery from past
	auto-saved drafts.

2002-01-03  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* time.el (display-time-load-average-threshold): Fix defcustom
	(add type and group).

	* net/ange-ftp.el (ange-ftp-shell-command): Remove port
	specification from the hostname.

2002-01-02  Richard M. Stallman  <rms@gnu.org>

	* facemenu.el (facemenu-active-faces):
	Use face-attributes-as-vector, not face-attributes-vector.

2002-01-02  Chris Hanson  <cph@aarau.ai.mit.edu>

	* xscheme.el: Eleven years of updates on a private copy.

	Extensive changes to support multiple xscheme buffers:
	(run-scheme): Break up into new functions to facilitate starting
	processes in other buffers.
	(xscheme-start, xscheme-read-command-line): New functions.
	(start-scheme, select-scheme)
	(default-xscheme-runlight)
	(global-set-scheme-interaction-buffer)
	(local-set-scheme-interaction-buffer)
	(local-clear-scheme-interaction-buffer)
	(exit-scheme-interaction-mode)
	(verify-xscheme-buffer): New functions.
	(xscheme-process-name, xscheme-buffer-name)
	(xscheme-runlight): New internal vars.
	(default-xscheme-runlight): New const.
	(xscheme-start-process): Add args for the process/buffer names.
	(reset-scheme): Pass process/buffer names.
	(scheme-interaction-mode): Initialize new local vars.
	(reset-scheme, xscheme-send-string-2, xscheme-process-running-p)
	(xscheme-select-process-buffer, xscheme-process-buffer)
	(xscheme-send-region, xscheme-send-char, xscheme-send-interrupt)
	(xscheme-goto-output-point, xscheme-write-message-1): Use new
	var xscheme-process-name.
	(xscheme-start-process): Initialize xscheme-process-name and
	xscheme-buffer-name in the process buffer.  Pass buffer name to
	xscheme-modeline-initialize.
	(xscheme-modeline-initialize): Add argument to specify buffer name
	for mode-line vars.
	(xscheme-process-sentinel): Make sure sentinel is run in the
	process buffer so it sees its local vars.
	(xscheme-process-filter-initialize, xscheme-set-runlight):
	More elaborate logic to handle multiple-buffer mode lines.

	(xscheme-enter-input-wait): Re-enable control-G handler upon
	entering input wait.

	(scheme-interaction-mode): Add arg to preserve local vars.
	(xscheme-enter-interaction-mode)
	(xscheme-enter-debugger-mode): Preserve local vars.
	(xscheme-start-process): Clobber local vars.

	(scheme-interaction-mode-commands): Allow end user to add commands
	to scheme-interaction-mode keymap.
	(scheme-interaction-mode-commands-alist): New variable.

	(xscheme-send-string): Don't use insert-before-markers.

	Implement a per-buffer kill ring:
	(xscheme-insert-expression)
	(xscheme-rotate-yank-pointer, xscheme-yank)
	(xscheme-yank-pop, xscheme-yank-push): New functions.
	(xscheme-expressions-ring)
	(xscheme-expressions-ring-yank-pointer)
	(xscheme-expressions-ring-max): New variables.
	(xscheme-send-string-1): Call xscheme-insert-expression to save
	expression in ring.
	(xscheme-yank-previous-send): Now an alias for xscheme-yank.
	(xscheme-previous-send): Deleted variable.

	(xscheme-send-string-2, xscheme-send-char, xscheme-send-proceed)
	(xscheme-send-control-g-interrupt): Use process-send-string rather
	than send-string.

	(xscheme-send-region): Insert a newline after an expression that
	is submitted in the interaction buffer, for consistency with
	recent changes to Edwin.

	(xscheme-delete-output): New function mimics comint-delete-output.
	(xscheme-last-input-end): New internal variable.
	(xscheme-process-filter-output): Update xscheme-last-input-end.

	(xscheme-send-control-g-interrupt): Make sure that
	xscheme-control-g-disabled-p is looked up in the right buffer.

	(xscheme-enable-control-g): Clear C-g message if visible.
	(xscheme-control-g-message-string): New internal var.
	(xscheme-send-control-g-interrupt): Use new var.

	(xscheme-send-control-g-interrupt, xscheme-send-interrupt):
	Delay after sending interrupt in order to work around race condition.

	(xscheme-send-control-g-interrupt, xscheme-send-interrupt)
	(xscheme-send-char): Use xscheme-send-char rather than send-string
	to send single char.

	(xscheme-process-filter, xscheme-process-filter-alist):
	Add support for evaluating expressions outside of the call-excursion.
	(xscheme-process-filter:string-action-noexcursion): New func.

	(xscheme-write-value): Change output string to match that used by
	Edwin.

	(xscheme-coerce-prompt): Don't write a space after a command
	prompt.  The PROMPT-FOR-COMMAND- procedures will take care of this
	for us.

	(reset-scheme): Delete process after killing it.

2002-01-02  Eli Zaretskii  <eliz@is.elta.co.il>

	* bindings.el (function-key-map): Don't bind shifted keypad
	numeric keys.

2002-01-02  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* enriched.el (enriched-handle-display-prop): Remove unused variables.
	(enriched-mode): Doc fix.

2002-01-02  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/ucs-tables.el (ucs-8859-8-alist): Comment away
	Hebrew points.

2002-01-01  Richard M. Stallman  <rms@gnu.org>

	* jka-compr.el (jka-compr-write-region): If START = nil, use whole buf.

2001-12-31  Richard M. Stallman  <rms@gnu.org>

	* comint.el, cus-edit.el, diff-mode.el, enriched.el, font-lock.el:
	* generic-x.el, info.el, log-view.el, pcvs-info.el, speedbar.el:
	* wid-edit.el, woman.el, calendar/calendar.el, textmodes/flyspell.el:
	* emulation/viper-init.el, eshell/em-ls.el, progmodes/antlr-mode.el:
	* progmodes/cperl-mode.el, progmodes/idlwave.el:
	* progmodes/sh-script.el, progmodes/vhdl-mode.el:
	Adapt face definitions to use :weight and :slant.

	* ps-print.el (ps-font-lock-face-attributes): Use :weight and :slant.

	* cus-edit.el (custom-face-edit-fix-value): Delete `assert' call.

	* font-lock.el (initializing from font-lock-face-attributes):
	Use :weight and :slant, not :bold and :italic.

2001-12-31  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-face-edit-fix-value): New function.
	(custom-face-edit): Use it, to convert :italic and :bold to new forms.

2001-12-30  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* progmodes/octave-mod.el (octave-abbrev-table):
	* progmodes/idlwave.el (idlwave-mode-abbrev-table):
	* progmodes/fortran.el (fortran-mode-abbrev-table):
	* progmodes/f90.el (f90-mode-abbrev-table):
	* progmodes/vhdl-mode.el (vhdl-mode-abbrev-table-init):
	* progmodes/sql.el (sql-mode-abbrev-table): Mark all the
	predefined abbrevs as "system" abbrevs.

2001-12-30  Richard M. Stallman  <rms@gnu.org>

	* info.el (Info-fontify-node): For a **** underline line, put the
	invisible and intangible props on the following newline, but not
	on the previous newline or the last char of the previous line.

	* faces.el (face-set-after-frame-default): Don't change `default' face.

	* faces.el (minibuffer-prompt): Adopt some default colors.

	* replace.el (query-replace-read-args): Immediate error if read-only.

	* textmodes/makeinfo.el (makeinfo-compilation-sentinel):
	Display the output buffer in a more intelligent way.

2001-12-30  Eli Zaretskii  <eliz@is.elta.co.il>

	* ls-lisp.el (insert-directory): Modify the "total" line wording,
	in accordance with files.el's insert-directory.

2001-12-29  Richard M. Stallman  <rms@gnu.org>

	* files.el (basic-save-buffer): If a before-write hook displays
	an echo area message, pause before calling basic-save-buffer-1.

2001-12-29  Markus Rost  <rost@math.ohio-state.edu>

	* textmodes/reftex-global.el (reftex-query-replace-document)
	(reftex-change-label): Doc fix.

	* dired-aux.el (dired-do-query-replace-regexp): Doc fix.

	* progmodes/etags.el (tags-query-replace): Doc fix.

2001-12-29  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compile-internal): Fix previous change.

2001-12-28  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-drag-mode-line-1): When dragging a mode line upward,
	shrink the windows above as necessary to get space.
	(mouse-drag-move-window-bottom, mouse-drag-window-above): New fns.

	* net/ange-ftp.el (ange-ftp-allow-child-lookup): Always return nil.
	This fixes a bug that treated all files as directories.
	(ange-ftp-insert-directory): Explicitly follow symlinks.

	* international/iso-transl.el (iso-transl-char-map) Eliminate the
	alias symbols--put the translated sequences here directly.

	* progmodes/cc-mode.el (c-mode-abbrev-table)
	(c++-mode-abbrev-table, objc-mode-abbrev-table)
	(java-mode-abbrev-table, pike-mode-abbrev-table):
	Mark all the predefined abbrevs as "system" abbrevs.

	* mail/sendmail.el (mail-envelope-from): Fix custom type.
	(sendmail-send-it): Check mail-specify-envelope-from
	and mail-envelope-from in the mail buffer at start.

2001-12-28  Simon Josefsson  <jas@extundo.com>

	* mail/sendmail.el (mail-envelope-from): Fix :type.
	(sendmail-send-it): Copy `mail-envelope-from' from calling buffer.

2001-12-28  Richard M. Stallman  <rms@gnu.org>

	* net/ldap.el (ldap-search-internal): Handle <file://...> in results.

	* simple.el (line-move-invisible): New subroutine.
	(line-move-to-column): New subroutine--smarter about advancing over
	invisible parts of a line, or lines, but only as long as hpos grows.
	(line-move-finish): New subroutine: repeatedly processes desired
	column, intangibility, and fields.
	(line-move): Use those subroutines.
	When moving lines downward, skip invisible text first rather than last.

2001-12-27  Richard M. Stallman  <rms@gnu.org>

	* international/mule-diag.el (describe-char-after):
	Describe the text properties of the char after point.

	* help.el (describe-key): Doc fix.

2001-12-26  Markus Rost  <rost@math.ohio-state.edu>

	* find-dired.el (find-dired-sentinel): Precede exit message by
	two spaces, to match the regexp in dired-between-files.

2001-12-28  Miles Bader  <miles@gnu.org>

	* wid-edit.el (widget-toggle-value-create): Don't eval actual
	images (which are lists too).

2001-12-27  Eli Zaretskii  <eliz@is.elta.co.il>

	* language/european.el: Fix the doc string of "Latin-5" language
	environment.

2001-12-26  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-mode-map): New keymap,
	defined as before 2001-11-09.
	(add-minor-mode call): Specify the keymap.

	* progmodes/compile.el (compile-internal):
	Set TERM variable in process-environment.

2001-12-25  Richard M. Stallman  <rms@gnu.org>

	* help-mode.el (help-xref-on-pp): Catch and ignore errors in scanning
	the buffer.

	* startup.el (command-line): Convert command line args
	to Emacs internal representation using locale-coding-system.

2001-12-25  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/fontset.el: Don't require ind-util when compiling.

2001-12-25  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* emulation/tpu-edt.el (tpu-reset-screen-size):
	Use set-frame-height and set-frame-width instead of set-screen-height
	and set-screen-width.

	* vt-control.el (vt-wide, vt-narrow): Use set-frame-width instead
	of obsolete set-screen-width.

	* locate.el (locate): Remove dot at the end of error argument.

	* emerge.el (emerge-show-file-name): Use frame-height instead of
	obsolete screen-height.

	* mail/mh-utils.el (mh-show-msg): Likewise.
	(mh-handle-process-error): Use frame-width instead of obsolete
	screen-width.

2001-12-25  Richard M. Stallman  <rms@gnu.org>

	* window.el (balance-windows): Use new PRESERVE-BEFORE arg
	to enlarge-window.  Use save-selected-window.  Don't try
	to resize windows that end at the bottom "level".
	Retry changing the sizes until the windows get the desired sizes.
	Discount the minibuffer when computing total height available.

	* emacs-lisp/debug.el (debugger-mode-map): Bind C-m, not `RET'.
	(debugger-make-xrefs): Only make a button for the first symbol
	on any line.

2001-12-24  Eli Zaretskii  <eliz@is.elta.co.il>

	* term/internal.el (dos-cpNNN-setup, dos-codepage-setup):
	Call IT-setup-unicode-display here instead of adding it to
	dos-codepage-setup-hook, so that Unicode display tables are set
	before dos-codepage-setup-hook runs.

2001-12-24  Richard M. Stallman  <rms@gnu.org>

	* net/net-utils.el (ftp-mode-abbrev-table): Don't define it.
	(nslookup-mode-abbrev-table): Don't define it.
	(smbclient-mode-abbrev-table): Don't define it.
	(ftp-mode): Don't use ftp-mode-abbrev-table; don't enable Abbrev mode.
	(nslookup-mode, smbclient-mode): Likewise.
	(network-connection-service-abbrev-alist): Variable deleted.
	(network-connection-mode-setup): Don't set up abbrev table.

	* faces.el (minibuffer-prompt): New face.
	(minibuffer-prompt-properties): Add `face' property.

	* replace.el (occur-mode-display-occurrence): New function.
	(occur-mode-map): Bind C-o to it.

2001-12-24  Michael Kifer  <kifer@cs.sunysb.edu>

	* viper-cmd.el (viper-change-state): Got rid of make-local-hook.
	(viper-special-read-and-insert-char): Make C-m work right in the r
	comand.
	(viper-buffer-search-enable): Fixed format string.

	* viper-ex.el (ex-token-alist): Use ex-set-visited-file-name
	instead of viper-info-on-file.
	(ex-set-visited-file-name): New function.

	* viper.el (viper-emacs-state-mode-list): Added mail-mode.

	* ediff-mult.el (ediff-meta-mark-equal-files): Added optional
	action argument.

	* ediff-init.el: Fixed some doc strings.

	* ediff-util.el (ediff-after-quit-hook-internal): New variable.
	Got rid of make-local-hook.

	* ediff-wind.el (ediff-setup-control-frame): Got rid of
	make-local-hook.

2001-12-23  Richard M. Stallman  <rms@gnu.org>

	* term/x-win.el (x-handle-geometry): Put height and width
	on default-frame-alist, left and top on initial-frame-alist.
	* term/w32-win.el (x-handle-geometry): Likewise.

	* sort.el (sort-reorder-buffer): Copy all to a temp buffer first.

	* play/yow.el (yow): Use an arg to distinguish interactive calls,
	not interactive-p.

2001-12-22  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* emacs-lisp/elint.el (elint-unknown-builtin-args):
	Remove mocklisp entries.

	* subr.el (insert-string): Moved from mocklisp.c, reimplemented in
	Lisp.  Obsoleted.

	* emulation/mlconvert.el: File removed.

	* emulation/mlsupport.el: Moved to obsolete.

	* obsolete/mlsupport.el: Moved there from lisp/emulation.

	* emacs-lisp/find-gc.el (source-files): Remove mocklisp.c.

	* emacs-lisp/byte-opt.el (byte-optimize-form-code-walker):
	Remove mocklisp case.

	* help-fns.el (describe-function-1): Remove mocklisp function case.

2001-12-22  Miles Bader  <miles@gnu.org>

	* textmodes/refill.el (refill-mode): Don't barf when redundantly
	turning refill-mode off.

2001-12-22  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* time.el (display-time-load-average-threshold): New variable.
	(display-time-update): Use it.

	These changes allow cycling through past 1, 5 and 15 minutes
	load-average displayed in the mode-line.

	* time.el (display-time-default-load-average): New customizable option.
	(display-time-load-average): New variable.
	(display-time-cycle-load-average): New function.
	(display-time-update): Use them.

2001-12-21  Richard M. Stallman  <rms@gnu.org>

	* apropos.el (apropos-print): SPACING is now nil or a separator string.
	(apropos-documentation, apropos-value): Pass a suitable string.

2001-12-21  Eli Zaretskii  <eliz@is.elta.co.il>

	* dired.el (dired-free-space-program, dired-free-space-args):
	Aliases for back-compatibility.

	* info.el (Info-select-node): If Info-use-header-line is nil, set
	header-line-format to nil.
	(Info-fontify-node): Don't put a keymap text property on the
	heading if we are not going to display the header line.  Remove
	any such text properties left over from past visits to this node.

	* ls-lisp.el (insert-directory): Insert the amount of free disk
	space, like files.el's insert-directory does.

	* files.el (directory-free-space-program):
	Mention file-system-info in the doc string.
	(get-free-disk-space): New function; code moved from insert-directory.
	(insert-directory): Call get-free-disk-space to get the amount of
	free space.

2001-12-21  Richard M. Stallman  <rms@gnu.org>

	* help.el (view-order-manuals, view-emacs-news, describe-copying)
	(describe-distribution, describe-project): Use view-file.

	* emacs-lisp/cl-indent.el (define-modify-macro): Better indent spec.

	* net/ange-ftp.el (ange-ftp-file-modtime): Use save-match-data.

	* emacs-lisp/easy-mmode.el (define-minor-mode):
	Make no arg by default in an interactive call,
	so that repeating the command toggles again.

	* emacs-lisp/lisp-mode.el (eval-defun-1): Cope with atoms as args.

2001-12-21  Christoph Wedler  <Christoph.Wedler@sap.com>

	* antlr-mode.el: More sophisticated indentation of cpp directive.
	(antlr-indent-at-bol-alist): New user option.
	(antlr-indent-line): Use it.
	(antlr-indent-style): New user option.
	(antlr-mode): Use it.
	(antlr-indent-item-regexp): Customize.

	* antlr-mode.el: Syntax highlighting changes.
	(antlr-font-lock-literal-regexp): New user option.
	(antlr-font-lock-syntax-face): New face used for :, |, ....
	(antlr-font-lock-default-face): New face.
	(antlr-font-lock-additional-keywords): Use them.

	* antlr-mode.el: New command to insert options -- variables.
	(antlr-mode-map): New binding [C-c C-o].
	(antlr-mode-menu): New submenus.
	(antlr-options-use-submenus): New user option.
	(antlr-tool-version): New user option.
	(antlr-options-auto-colon): New user option.
	(antlr-options-style): New user option.
	(antlr-options-push-mark): New user option.
	(antlr-options-assign-string): New user option.
	(antlr-options-headings): New variable.

	* antlr-mode.el: New command to insert options -- specific.
	(antlr-options-alists): New variable.
	(antlr-read-value): New function.
	(antlr-read-boolean): New function.
	(antlr-language-option-extra): New function.
	(antlr-language-limit-n-regexp): Change default to higher LIMIT.
	(antlr-c++-mode-extra): New function.
	(antlr-grammar-tokens): New function.
	(antlr-imenu-create-index-function): New optional argument.

	* antlr-mode.el: New command to insert options -- functions.
	(antlr-insert-option): New command.
	(antlr-insert-option-interactive): New function.
	(antlr-options-menu-filter): New function.
	(antlr-option-kind): New function.
	(antlr-scan-lists): New alias.
	(antlr-scan-lists-internal): New function.
	(antlr-skip-file-prelude): Hack for special SKIP-COMMENT.
	(antlr-option-level): New function.
	(antlr-syntactic-grammar-depth): New function.
	(antlr-option-location): New function.
	(antlr-insert-option-do): New function.
	(antlr-option-spec): New function.
	(antlr-version-string): New function.
	(antlr-insert-option-existing): New function.
	(antlr-insert-option-space): New function.
	(antlr-insert-option-area): New function.

	* antlr-mode.el: New electric keys ":;|&(){}", TAB works better
	with narrowing.  Menu change.  Miscellaneous.
	(antlr-mode-menu): Include "Indent Region" and "Customize Antlr".
	(antlr-mode-map): New bindings for characters in ":;|&(){}".
	(antlr-electric-character): New command.
	(antlr-class-header-regexp): New variable.
	(antlr-font-lock-additional-keywords): Use it.
	(antlr-imenu-create-index-function): Use it.
	(antlr-file-dependencies): Use it.
	(antlr-indent-line): Also works with restrictions.
	(antlr-indent-command): Interactive spec - changes the buffer.
	(antlr-language-for-option): Deletia.
	(antlr-language-option): New function, defined instead.
	(antlr-mode): Use it.

2001-12-21  Eli Zaretskii  <eliz@is.elta.co.il>

	* jka-compr.el (jka-compr-partial-uncompress): Use null-device
	instead of a literal /dev/null.

	* Makefile.in (distclean): Remove Makefile in the build
	directory, not in the source directory.

2001-12-21  Simon Josefsson  <jas@extundo.com>.

	* mail/smtpmail.el (smtpmail-send-queued-mail):
	Use with-temp-buffer instead of find-file-noselect, and bind
	coding-system-for-read to no-conversion when reading the queued
	messages.  (Simon's code modified slightly by Eli Zaretskii.)

2001-12-20  Werner Lemberg  <wl@gnu.org>

	* international/mule-diag.el (describe-coding-system)
	(print-coding-system-briefly): Make printed output have a similar
	format as describe-character-set.

2001-12-20  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* play/blackbox.el (bb-member): Remove, use member instead.
	(bb-delete): Remove, use delete instead.
	Update copyright notice.  Defvar for bb-board, bb-x, bb-y,
	bb-score, bb-detour-count and bb-balls-placed.
	Propertize results of rays.

2001-12-19  Karl Fogel  <kfogel@red-bean.com>

	* isearch.el (isearch-forward, isearch-edit-string): Make doc
	strings mention keybinding for `isearch-yank-word-or-char',
	rather than `isearch-yank-word', since the former is bound now
	and the latter is not.
	(isearch-yank-word-or-char): Fix formatting.

2001-12-19  Werner Lemberg  <wl@gnu.org>

	* language/czech.el, language/european.el, language/slovak.el:
	More fixes for language info doc strings.

2001-12-19  Eli Zaretskii  <eliz@is.elta.co.il>

	* loadup.el: Add "language" to the load-path.

2001-12-19  Richard M. Stallman  <rms@gnu.org>

	* international/mule-cmds.el (describe-language-environment):
	Fix calls to help-xref-button.

2001-12-19  Miles Bader  <miles@gnu.org>

	* international/fontset.el: Require `ind-util' when compiling.

2001-12-18  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* language/ethio-util.el (ethio-modify-vowel): Use char-to-string
	instead of decompose-composite-char.

2001-12-18  Richard M. Stallman  <rms@gnu.org>

	* simple.el (eval-expression-print-level)
	(eval-expression-print-length): Doc fixes.

	* international/mule-diag.el (describe-character-set):
	Fix the arg to help-xref-button.

	* files.el (directory-free-space-program): New variable.
	(directory-free-space-args): New variable.
	(insert-directory): Use those two variables for getting free space.
	Use file-system-info instead, if that is defined.

	* dired.el (dired-free-space-program): Variable deleted.
	(dired-free-space-args): Variable deleted.
	(dired-insert-directory): Don't try to determine free space.

	* files.el (font-lock-defaults): Add risky-local-variables prop.
	(hack-one-local-variable): Treat various font-lock variables as risky.

2001-12-18  Werner Lemberg  <wl@gnu.org>

	* language/chinese.el, language/cyrillic.el:
	* language/czech.el, language/european.el, language/greek.el:
	* language/hebrew.el, language/indian.el, language/japanese.el:
	* language/korean.el, language/lao.el, language/slovak.el:
	* language/thai.el, language/tibetan.el, language/vietnamese.el:
	Improve documentation strings of coding systems and language infos.

2001-12-18  Werner LEMBERG  <wl@gnu.org>

	Add support for EUC-TW decoding/encoding.

	* language/china-util.el (big5-to-flat-code, flat-code-to-big5)
	(euc-to-flat-code, flat-code-to-euc, expand-euc-big5-alist):
	New auxiliary functions to build `big5-to-cns'.
	(big5-to-cns): New translation alist.

	* language/chinese.el: Added new coding system `euc-tw' and its
	alias `euc-taiwan'.
	Updated language `Chinese-CNS' to include euc-tw encoding also.
	(ccl-decode-euc-tw, ccl-encode-euc-tw): New functions for handling
	euc-tw.

2001-12-18  Dave Love  <fx@gnu.org>

	* loadup.el: Add language/utf-8-lang, language/georgian.

	* image-file.el (image-file-name-extensions): Add pnm.  Doc fix.
	(image-file-name-regexps): Doc fix.

	* server.el (server-unload-hook): New function.

	* emacs-lisp/lisp-mnt.el (lm-copyright-prefix): Group the leader.
	(lm-crack-copyright): Cope with multi-line copyright `lines'.

	* simple.el (newline): Doc fix.
	(eval-expression-print-level, eval-expression-print-length): Doc
	fix.  Amend :type.
	(next-line, previous-line): Make arg optional.
	(newline): Doc fix.

	* Makefile.in (DONTCOMPILE): Add various language files.

	* international/quail.el (quail-input-string-to-events): Don't use
	string-to-list.

	* progmodes/f90.el (f90-break-line): Avoid infinite recursion
	calling `newline'.

2001-12-17  Richard M. Stallman  <rms@gnu.org>

	* comint.el (comint-dynamic-list-input-ring-select): New function.
	Switches back to the old window configuration.
	(comint-dynamic-list-input-ring): Bind RET to that function.
	(comint-dynamic-list-input-ring-window-conf): New variable.

2001-12-17  Werner Lemberg  <wl@gnu.org>

	* international/mule-conf.el: Improve documentation strings of
	character sets.

2001-12-16  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-copy-filename-as-kill): Moved from dired-x.el.
	(dired-mode-map): Bind w to dired-copy-filename-as-kill.

	* dired-x.el (dired-copy-filename-as-kill): Moved to dired.el.

	* autoinsert.el (auto-insert-alist): Redo finding C and C++ headers.
	Add a DESCRIPTION for the makefile item.

	* find-file.el (ff-other-file-name): New function.

2001-12-16  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/quail.el (quail-input-string-to-events): Fix last
	change.

2001-12-16  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-edit-string): When we set isearch-string
	to the default, also set isearch-message.

	* subr.el (temp-buffer-show-hook, temp-buffer-setup-hook): Add defvars.

	* startup.el (command-line-1): Display startup screen
	even if there are command line args.
	Add a note about how to go to editing your files.
	(fancy-splash-head): Add a note about how to go to your files.
	(fancy-splash-outer-buffer): New variable.
	(fancy-splash-screens): Bind variable fancy-splash-outer-buffer.

	* subr.el (with-temp-message): At the end, always discard
	the temp message, even by clearing the echo area.

	* progmodes/sh-script.el (sh-mode): Run sh-mode-hook.

2001-12-16  Stefan Monnier  <monnier@cs.yale.edu>

	* log-view.el (log-view-message-re, log-view-current-tag):
	Recognize Subversion's log output format.

	* international/fontset.el: Build the list L at compile time.

	* language/ind-util.el (mapthread): Make a closure.

2001-12-15  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-start-hscroll): New variable.
	(isearch-mode): Set isearch-start-hscroll.
	(isearch-update): Restore original hscrolling if possible.

	* isearch.el (isearch-edit-string):
	Treat isearch-yank-word-or-char specially, like isearch-yank-word.

	* emacs-lisp/debug.el (debugger-previous-backtrace): New variable.
	(debugger-make-xrefs): Optimize by (1) using skip-syntax-forward
	rather than regexp search and (2) copying text properties
	already set up on text unchanged from the previous backtrace.

	* case-table.el (set-case-syntax-pair):
	Detect invalid calls and signal an error.

2001-12-15  Richard M. Stallman  <rms@gnu.org>

	* language/ind-util.el (range): Function deleted.
	(indian-regexp-of-hashtbl-keys): Renamed from `regexp-of-hashtbl-keys'.
	All calls changed.

	* language/devan-util.el (devanagari-range): Renamed from `range'.
	All calls changed.
	(devanagari-regexp-of-hashtbl-keys):
	Renamed from `regexp-of-hashtbl-keys'.  All calls changed.

2001-12-15  Dave Love  <fx@gnu.org>

	* language/ind-util.el: Don't require cl.
	(indian-glyph-char, indian-glyph-max-char)
	(indian-char-glyph): Moved from indian.el
	(indian--puthash-char, mapthread): Don't quote lambda.
	(indian--map): New function.
	(indian--puthash-v, indian--puthash-c, indian--puthash-m)
	(indian--puthash-cv): Use it.

	* language/indian.el (indian-glyph-char, indian-glyph-max-char)
	(indian-char-glyph): Moved to ind-util.el

	* language/devan-util.el (devanagari-post-read-conversion):
	New function.

	* language/georgian.el: New file.

	* international/mule-cmds.el (locale-language-names): Add various
	entries.  Remove utf-8 special case.
	(locale-charset-language-names, locale-preferred-coding-systems):
	Add utf-8 case.
	(set-language-environment): Process required-features earlier.

	* international/quail.el (quail-keyboard-layout-alist):
	Add pc105-uk.
	(quail-keyboard-layout-type): Fix :type.
	(quail-choose-completion-string): Simplify.
	(quail-update-leim-list-file): Don't get fooled by commented-out code.
	(quail-input-string-to-events): Run events through
	translation-table-for-input.

	* international/mule-conf.el (translation-table-for-input):
	New variable.
	(latin-iso8859-14): Amend description.
	(file-coding-system-alist): Add entry for utf-8.

	* language/utf-8-lang.el: New file.

	* international/code-pages.el: New file.

	* language/hebrew.el ("Windows-1255"): New language.

	* language/european.el ("Welsh", "Latin-7", "Lithuanian")
	("Latvian"): New languages.

2001-12-14  Stefan Monnier  <monnier@cs.yale.edu>

	* xml.el: Use setq rather than (set 'foo bar).
	Use push+nreverse rather than append.
	(xml-node-name, xml-node-attributes, xml-node-children):
	Use defsubst rather than macros.
	(xml-parse-region): Handle a nil return value from xml-parse-tag.
	(xml-parse-tag): Don't skip white space.  Return nil for a comment.
	Concat the two strings surrounding a comment into a single string.

	* newcomment.el (comment-indent): Jump to the middle of empty comments.

2001-12-14  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* select.el (xselect-convert-to-class, xselect-convert-to-name):
	Document.

2001-12-14  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-checkout-model, vc-state, vc-workfile-version):
	Return nil if FILE is not registered.
	(vc-check-master-templates, vc-default-make-version-backups-p):
	Doc fix.

2001-12-13  David Ponce  <david@dponce.com>

	* ruler-mode.el (ruler-mode-extra-left-cols): Remove.
	(ruler-mode-left-fringe-cols): New macro.
	(ruler-mode-right-fringe-cols): New macro.
	(ruler-mode-left-scroll-bar-cols): New macro.
	(ruler-mode-right-scroll-bar-cols): New macro.
	(ruler-mode-ruler): Use above new macros.

2001-12-13  Richard M. Stallman  <rms@gnu.org>

	* files.el (set-auto-mode): Fix previous change.

2001-12-13  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/easymenu.el (easy-menu-intern): New fun.
	(easy-menu-do-define, easy-menu-convert-item-1)
	(easy-menu-define-key-intern, easy-menu-get-map): Use it.
	(easy-menu-return-item): Only return nil if there is no binding.

2001-12-13  Rajesh Vaidheeswarran  <rv@gnu.org>

	* whitespace.el (whitespace-version): 3.2
	* whitespace.el (whitespace-force-mode-line-update): Replace with
	`whitespace-mode-line-update', which is an alias to the correct
	function in various emacsen.
	* whitespace.el (whitespace-{un,}highlight-the-space):
	Add colorized highlighting of the bogus whitespaces in a buffer/file,
	using the `whitespace-highlight-face' if
	`whitespace-display-spaces-in-color' is set.

2001-12-13  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/mule.el (set-auto-coding): Don't search for
	"unibyte:" or "coding:" if set-auto-mode-1 returns nil.

2001-12-13  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* mail/mailabbrev.el (mail-abbrevs-setup): Do not use make-local-hook.

	* mail/rmail.el (rmail-fontify-buffer-function): Likewise.

	* mail/rmailsum.el (rmail-summary-mode): Likewise.

2001-12-13  Richard M. Stallman  <rms@gnu.org>

	* simple.el (undo): Always set this-command to `undo',
	so that the next undo after an error will not begin redoing.

	* simple.el (shell-command): Doc fix.
	(shell-command-on-region): If there is output an an error,
	add "...Shell command failed" to the output.

2001-12-13  David Ponce  <david@dponce.com>

	* ruler-mode.el	(ruler-mode-left-fringe-cols): Variable removed.
	(ruler-mode-left-fringe-cols): Function replaced by more efficient
	implementation `ruler-mode-extra-left-cols'.
	(ruler-mode-ruler): Use above new function.  Take into account
	that the fringe areas can now be resized.

2001-12-12  Richard M. Stallman  <rms@gnu.org>

	* international/characters.el (Unicode): Comment out
	the specifications for kelvin and angstrom signs.

	* international/mule.el (make-translation-table-from-vector):
	Allow null elements in VEC.

	* international/ucs-tables.el (unify-8859-on-encoding-mode)
	(unify-8859-on-decoding-mode): Swap the code in their bodies.
	Add :version.

2001-12-11  Richard M. Stallman  <rms@gnu.org>

	* derived.el (derived-mode-p): Function moved to subr.el.

	* subr.el (derived-mode-p): Moved here from derived.el.

	* international/mule.el (set-auto-coding): Use set-auto-mode-1.

	* files.el (set-auto-mode-1): New subroutine, broken out of
	set-auto-mode.
	(set-auto-mode, hack-local-variables-prop-line): Use that.

2001-12-11  Dave Love  <fx@gnu.org>

	* language/thai-util.el, language/thai.el: Add Unicode equivalents.

	* language/european.el: Remove autoload cookies.  Fix registration
	of diacritic composition function.

2001-12-11  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* calendar/todo-mode.el: Require time-stamp.

	* net/zone-mode.el (zone-mode): Don't use make-local-hook.

2001-12-11  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/authors.el (authors-aliases): Delete "Richard Stallmao".

	* textmodes/ispell.el (ispell-buffer-local-parsing):
	Match xml like sgml.

	* emacs-lisp/advice.el (ad-compile-function):
	Byte compile the function under another (uninterned) name.

	* gud.el (gdb): Define and bind gud-jump.

	* font-lock.el (font-lock-mode):
	Put our function at the end of after-change-functions.

	* ediff-diff.el (ediff-cmp-options): Doc fix.

	* comint.el (comint-password-prompt-regexp): Match "UNIX Password".

2001-12-10  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-yank-word-or-char): New function.
	(isearch-mode-map): Bind C-w to that.

	* menu-bar.el (menu-bar-mode): Make arg optional.

	* simple.el (line-move): Cope if next-single-property-change
	or previous-single-property-change returns nil.

	* emacs-lisp/lisp-mnt.el (lm-verify): New arg NON-FSF-OK.
	Don't use interactive-p; instead, pass the proper args
	in (interactive...).  Clean up most of the trouble-report strings.

2001-12-10  Eli Zaretskii  <eliz@is.elta.co.il>

	* mail/smtpmail.el (smtpmail-send-queued-mail): Insert the
	enqueued messages literally.

2001-12-10  Noah Friedman  <friedman@splode.com>

	* battery.el (battery-insert-file-contents): Obsolete function
	removed.
	(battery-read-function): Obsolete function removed.
	(battery-linux-proc-apm): Use insert-file-contents.

2001-12-07  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-visit-buffer):
	Use `select-frame-set-input-focus'--needed when window manager
	uses "click to focus" policy.

2001-12-09  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* COPYING: Moved back.

2001-12-07  Eli Zaretskii  <eliz@is.elta.co.il>

	* term/internal.el (IT-character-translations): Add entries for
	more points.

	* international/characters.el: Resurrect the Hebrew category
	settings for all Hebrew characters removed by the last change.
	Add code for setting the Hebrew category of the Unicode Hebrew
	characters.  Set syntax entries for Hebrew punctuation characters.

	* international/ucs-tables.el (ucs-8859-8-alist): Add Hebrew
	points and directional formatting control characters.

2001-12-07  Dave Love  <fx@gnu.org>

	* language/lao-util.el: Add Unicode equivalents for rules.
	(lao-post-read-conversion): New function.

	* language/lao.el: Add Unicode equivalents.
	(lao): Add post-read conversion.

	* international/latin1-disp.el: Fix some 8-bit-graphic characters.
	Use iso2022 encoding.
	(latin1-char-displayable-p): Doc fix.
	(latin1-display-ucs-per-lynx): New option.
	(latin1-display-ucs-per-lynx): New command.
	(latin1-display-reset): Special-case arabic.
	(ucs-tables): Require.
	(latin1-display-sets, latin1-display-setup): Add arabic.
	(latin1-display) <variable>: Use function latin1-display.
	(latin1-display) <function>: Add mule-unicode stuff.
	(latin1-display-check-font): Don't lose if `info' is nil.

	* international/iso-transl.el: Insert Latin-1 characters, not
	unibyte codes.

	* language/european.el (diacritic-composition-pattern): New constant.
	(diacritic-compose-region, diacritic-compose-string)
	(diacritic-compose-buffer, diacritic-post-read-conversion)
	(diacritic-composition-function): New functions.

	* international/utf-8.el (ucs-mule-to-mule-unicode):
	New translation table.
	(ccl-encode-mule-utf-8): Use it.
	(utf-8-untranslated-to-ucs, utf-8-help-echo, utf-8-compose)
	(utf-8-post-read-conversion, utf-8-pre-write-conversion): New function.
	(utf-8-subst-table): New variable.
	(utf-8-compose-scripts): New option.
	(mule-utf-8): Update safe-charsets, pre-write and post-read conversion.

	* international/ucs-tables.el, international/utf-8-subst.el:
	New files.

	* international/characters.el: Don't set word syntax (the default)
	explicitly.  Add a diacritic category.  Add info for Unicode
	equivalents of characters in various Mule charsets and for extra
	Unicode characters.  Don't define specific categories for
	Indian/Devanagari, since they aren't used.

2001-12-06  Richard M. Stallman  <rms@gnu.org>

	* textmodes/fill.el (set-justification): Rename arg VALUE to STYLE.
	(set-justification-left, set-justification-right): Doc fix.

	* progmodes/f90.el (f90-break-line): Use (newline 1) to insert newline.
	(bug-f90-mode): Variable deleted.

2001-12-06  Stefan Monnier  <monnier@cs.yale.edu>

	* indent.el (indent-line-function): Default is indent-relative again.

2001-12-07  Miles Bader  <miles@gnu.org>

	* progmodes/compile.el (compilation-error-regexp-alist):
	Added regexps for RXP.

2001-12-05  Eli Zaretskii  <eliz@is.elta.co.il>

	* progmodes/cwarn.el (cwarn-font-lock-match-assignment-in-expression):
	Add shift-assignment operators to those highlighted, and highlight
	the whole operator rather than just the "=".

2001-12-04  Juanma Barranquero  <lektu@terra.es>

	* files.el (save-abbrevs, save-some-buffers): Don't ask the user
	before saving abbrevs if `save-abbrevs' has the value `silently'.

2001-12-04  Andreas Schwab  <schwab@suse.de>

	* xt-mouse.el (turn-off-xterm-mouse-tracking): Doc fix.

2001-12-04  Colin Walters  <walters@debian.org>

	* emacs-lisp/autoload.el (make-autoload): Also generate autoloads
	for `defmacro*' forms.

	* emacs-lisp/lisp-mode.el (toplevel): Define docstring offset for
	`defmacro*'.

2001-12-03  Stefan Monnier  <monnier@cs.yale.edu>

	* progmodes/antlr-mode.el (antlr-c-common-init): Undo last change.

2001-12-02  Richard M. Stallman  <rms@gnu.org>

	* files.el (insert-directory): If the df output does not look right,
	don't try to use it.  Other cleanups in overall code structure.

2001-12-02  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/outline.el (outline-mode-prefix-map):
	Add bindings for outline-promote and outline-demote.
	(outline-minor-mode-menu-bar-map): New var.
	(outline-minor-mode): Use it.
	(outline-heading-alist): New var (renamed from outline-level-heading).
	(outline-level): Use it.
	(outline-insert-heading, outline-promote, outline-demote):
	Update to use outline-heading-alist.

	* disp-table.el (standard-display-european):
	Simplify since the function is not interactive any more.
	Don't set the existing buffers to unibyte.

	* pcvs-util.el (cvs-file-to-string): Move condition-case outside.

	* pcvs.el (cvs-reread-cvsrc): Don't use cvs-file-to-string.

	* reveal.el (reveal-mode): Fix reveal-mode's lighter.

	* shell.el (shell): Use shell-file-name.
	Pop to buffer before calling comint to set COLUMNS properly.

	* emacs-lisp/cl.el (svref): New alias.

	* progmodes/antlr-mode.el (antlr-c-common-init):
	Don't inhibit adaptive-fill-mode any more.

	* progmodes/delphi.el (delphi-mode): Don't use make-local-hook.

	* progmodes/etags.el (tags-with-face): Use make-symbol.
	(tags-search, tags-query-replace): Use backquotes.

	* textmodes/picture.el (picture-mode-map): Don't use defconst
	for a variable.

2001-12-02  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* textmodes/reftex-index.el (reftex-index-mode):
	Remove make-local-hook.

	* textmodes/reftex-toc.el (reftex-toc-mode): Likewise.

2001-12-02  Kim F. Storm  <storm@cua.dk>

	* isearch.el (isearch-resume-enabled): New variable.
	(isearch-done): Use that variable.

2001-12-01  Richard M. Stallman  <rms@gnu.org>

	* wid-edit.el (widget-button-click): Don't move point permanently:
	Avoid mouse-set-point--instead select the window,
	then do save-excursion, then move point.
	Specify the buffer for get-char-property.
	Don't use `@' in interactive.

	* indent.el (indent-line-function):
	Default is indent-to-left-margin again.

	* replace.el (query-replace-read-args): Display message
	if FROM contains `\n' or `\t'.

2001-12-01  Stefan Monnier  <monnier@cs.yale.edu>

	* indent.el (tab-to-tab-stop): Use delete-horizontal-space.

	* bindings.el (minibuffer-local-map): Bind TAB to insert-tab.

	* emacs-lisp/regexp-opt.el (regexp-opt):
	Bind completion-regexp-list to nil.

	* progmodes/hideif.el (hif-nexttoken): Move to before first def.

2001-12-01  Eli Zaretskii  <eliz@is.elta.co.il>

	* progmodes/idlwave.el, progmodes/idlw-rinfo.el:
	* progmodes/idlw-shell.el, progmodes/idlw-toolbar.el:
	Update maintainer.

2001-11-30  Stefan Monnier  <monnier@cs.yale.edu>

	* mail/smtpmail.el: Use with-current-buffer.
	(message-make-date, message-make-message-id): Autoload when needed.
	(smtpmail-send-it): Use them to add `Date:' and `Message-Id:'
	headers when missing.

	* international/encoded-kb.el (encoded-kbd-mode):
	Use define-minor-mode.

	* enriched.el (enriched-mode): Use define-minor-mode.
	Use dolist and pop and push.

	* info.el (Info-find-node-2): Don't call info-insert-file-contents
	with the `visit' argument.
	(Info-extract-menu-node-name): Use `replace-regexps-in-string'.

	* progmodes/hideif.el (hide-ifdef-mode): Only modify
	`change-major-mode-hook' locally.  Reset invisibility spec.

	* man.el (Man-build-section-alist): Remove last Man-match-substring.

2001-11-30  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* textmodes/paragraphs.el (mark-paragraph): Clarify doc.
	Clarify error message.

2001-11-29  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* textmodes/paragraphs.el (mark-paragraph): Allow prefix arg.

2001-11-30  Andre Spiegel  <spiegel@gnu.org>

	* vc-cvs.el (vc-cvs-parse-status): Store file state in property,
	don't just return it.

2001-11-30  Eli Zaretskii  <eliz@is.elta.co.il>

	* menu-bar.el (menu-bar-read-lispref, menu-bar-read-lispintro)
	(menu-bar-read-emacs-man, search-emacs-glossary)
	(emacs-index-search, elisp-index-search): New functions.
	(apropso-documentation, apropos, apropos-value, apropos-variable)
	(apropos-commands): Modify menu item names and help text.
	(elisp-index-search, emacs-index-search, emacs-glossary):
	New menu items.
	(menu-bar-manuals-menu): Move the Ordering Manuals item to a
	submenu.
	(info-elisp, info-elintro): New menu items.
	(apropos): Modify the menu item name.

2001-11-30  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/lisp-mode.el (read-if): Add lisp-indent-function prop.

	* textmodes/outline.el (outline-promote, outline-demote): Typo.

	* man.el (man-follow-mouse): New function.
	(Man-mode-map): Bind mouse-2 to it.
	(Man-match-substring): Remove.  Replace with `match-string'.
	(man): Use the `default-value' argument to `read-string'.
	(Man-fontify-manpage): Add mouse-face to cross references.

	* emacs-lisp/cl-macs.el (shiftf): Fix more.  Simplify.

2001-11-29  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/crm.el (completing-read-multiple): Better preserve
	the value of require-match in minibuffer-completion-confirm.
	Use crm-local-completion-map.

	* emacs-lisp/cl-macs.el (shiftf): Fix the fast case so
	(let ((a 1) (b 2)) (shiftf a b (cons a b)) b) returns (1 . 2).
	(cl-make-type-test): Use char-valid-p for `character'.

	* info.el (Info-complete-next-re, Info-complete-cache): New vars.
	(Info-complete-menu-item): Rewrite.  Add the ability to search
	several sequential nodes.  Add a simple caching mechanism.
	(Info-goto-index): New function extracted from Info-index.
	(Info-index): Use it.  Add completion to the interactive spec.
	(Info-menu-update): Simplify call to `Info-complete-menu-item'.

2001-11-29  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* COPYING: Removed.

2001-11-29  Dave Love  <fx@gnu.org>

	* progmodes/fortran.el: Fontify rewind, backspace.  Doc fixes.
	(fortran-window-create, fortran-window-create-momentarily):
	Rewrite, moving error condition.
	(fortran-beginning-do, fortran-beginning-if): Fix regexps.
	(fortran-mode-syntax-table): Revert last change.

	* international/mule.el: Doc fixes.
	(map-charset-chars): New function.
	(register-char-codings): Use it to cope with generic chars in
	safe-chars.

2001-11-29  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* play/blackbox.el (blackbox-mode, blackbox): Doc fix.

	* play/cookie1.el (cookie, cookie-insert, shuffle-vector): Doc fixes.

	* play/studly.el (studlify-word, studlify-region)
	(studlify-buffer): Fix doc-string.
	(studlify-buffer): Add autoload cookie.

2001-11-28  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/outline.el (outline-up-heading): Add `invisible-ok' arg.
	(outline-up-heading-all): Remove.
	(hide-sublevels): Move to end-of-heading before calling flag-region.
	(outline-copy-overlay, outline-discard-overlays): Remove.
	(outline-flag-region): Use `remove-overlays'.
	Don't move to end-of-heading.
	(outline-next-visible-heading, outline-back-to-heading)
	(outline-on-heading-p): Use outline-invisible-p.
	(outline-font-lock-level): Use outline-up-heading's new arg.
	(outline-minor-mode): Simplify.
	(outline-map-tree, outline-reveal-toggle-invisible): New funs.
	(outline): Put a `reveal-toggle-invisible' property.
	(outline-level-heading): New var.
	(outline-insert-heading, outline-promote, outline-demote)
	(outline-toggle-children): New commands.

	* progmodes/hideif.el (hif-end-of-line): New function.
	(hide-ifdef-mode): Set line-move-ignore-invisible.
	(hide-ifdef-region-internal): New function.
	(hide-ifdef-region): Use it.
	(hif-defined): Return an integer.
	(hif-infix-to-prefix): Remove.
	(hif-tokenize): Parse from the buffer rather than from a string.
	Correctly tokenize integers.  Use forward-comment.
	(hif-expr): Use hif-or.
	(hif-term): Use hif-and.
	(hif-factor): Use hif-not.  Handle numbers properly.
	Don't require parenthesis around `defined's argument.
	(hif-and, hif-or, hif-not): New funs.
	(hif-canonicalize): Pass a region to hif-tokenize.  Use hif-not.
	(hif-hide-line): Don't hide the \n before the line.
	(hif-possibly-hide): Correctly handle numeric evaluation results.

	* progmodes/make-mode.el: Use line-(end|beginning)-position.
	(makefile-mode): Set indent-line-function.
	(makefile-browser-insert-continuation): Use with-current-buffer.
	(makefile-beginning-of-line-point, makefile-end-of-line-point): Remove.

2001-11-28  Karl Fogel  <kfogel@red-bean.com>

	* isearch.el (isearch-yank-internal): New helper function.
	(isearch-yank-char): New function.
	(isearch-yank-word, isearch-yank-line): Rewrite to use
	isearch-yank-internal.

2001-11-28  Eli Zaretskii  <eliz@is.elta.co.il>

	* mouse.el (mouse-set-font): Make it a no-op if multiple fonts
	aren't supported.  Print a message to that effect if invoked.

2001-11-27  Stephen Eglen  <stephen@gnu.org>

	* locate.el (locate): Put point at first matching file rather
	than top of buffer.

2001-11-27  Stefan Monnier  <monnier@cs.yale.edu>

	* reveal.el: New file.

	* progmodes/hideif.el: Misc cleanup.
	(hide-ifdef-mode-submap): Put the def in the defvar.
	Use substitute-key-definition.
	(hide-ifdef-mode): Use define-minor-mode.
	(hif-outline-flag-region): Remove.
	(hif-show-all): Define in terms of hif-show-ifdef-region.
	(hif-after-revert-function): Rename from hif-before-revert-function.
	(hide-ifdef-region, hif-show-ifdef-region): Use overlays.
	(hif-tokenize): Use with-syntax-table.
	(hif-make-range): Use `else' also for `else-p'.
	(hif-range-else-p): Remove.
	(hif-find-range): Simplify.
	(hif-hide-line): Don't bother preserving buffer-modified-p.
	(hide-ifdefs, show-ifdefs, hide-ifdef-block, show-ifdef-block):
	Don't use selective-display and inhibit-read-only.

	* subr.el (copy-overlay, remove-overlays): New funs.

	* emacs-lisp/regexp-opt.el (regexp-opt-depth): Fix off-by-two error.

2001-11-27  Sam Steingold  <sds@gnu.org>

	* ansi-color.el, bookmark.el, dired.el, emerge.el, fast-lock.el
	* lazy-lock.el, mouse-sel.el, mail/feedmail.el
	* emacs-lisp/advice.el, emacs-lisp/checkdoc.el, emacs-lisp/ewoc.el
	* obsolete/c-mode.el, obsolete/cplus-md.el
	* progmodes/dcl-mode.el, progmodes/idlw-shell.el, progmodes/idlwave.el
	* term/sun-mouse.el, textmodes/artist.el:
	Converted backquote to the new style.
	* mouse.el, reposition.el: Likewise (in comments).
	* expand.el: Likewise (in a string).

2001-11-27  Richard M. Stallman  <rms@gnu.org>

	* cus-edit.el (custom-load-symbol): Don't always load locate-library.

2001-11-26  Richard M. Stallman  <rms@gnu.org>

	* wid-edit.el (widget-toggle-value-create): On graphic terminal,
	if :on-glyph or :off-glyph is a list, eval it and store it back.
	(checkbox): Quote the values for :on-glyph and :off-glyph.

	* cus-start.el (recursive-load-depth-limit): Delete item.

2001-11-26  Stefan Monnier  <monnier@cs.yale.edu>

	* help-fns.el (describe-categories, help-describe-category-set): New.
	describe-categories moved here from src/category.c.

2001-11-26  Sam Steingold  <sds@gnu.org>

	* progmodes/cc-mode.el (c-submit-bug-report): Make sure that the
	arguments to `insert' are strings.

2001-11-26  Richard M. Stallman  <rms@gnu.org>

	* startup.el (command-line-1): Call kill-buffer only in non-fancy case.

2001-11-26  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/mule-diag.el: Require help-fns instead of
	help-funs.

	* help-fns.el: Renamed from help-funs.el.

	* startup.el (command-line-1): Don't try to call process-list if
	it is not fboundp.

2001-11-26  Sam Steingold  <sds@gnu.org>

	* frame.el (show-trailing-whitespace): Remove :set argument (the
	value was essentially identical to the defalt).

2001-11-26  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* hexl.el (hexl-mode, hexl-follow-ascii): Remove make-local-hook.

	* icomplete.el (icomplete-minibuffer-setup): Likewise.

	* hilit-chg.el (hilit-chg-set): Likewise.

	* speedbar.el (speedbar-mode): Likewise.

	* calendar/calendar.el (calendar-mode): Likewise.

	* play/yow.el (psychoanalyze-pinhead): Use insert instead of
	insert-string.

	* play/gamegrid.el (gamegrid-init-buffer): Likewise.

	* term/bg-mouse.el (bg-insert-moused-sexp): Likewise.

	* term/sun-mouse.el (sun-yank-selection): Likewise.

	* textmodes/bib-mode.el (return-key-bib): Likewise.

	* calendar/appt.el (appt-disp-window): Likewise.

	* calendar/diary-lib.el (list-diary-entries): Likewise.

	* array.el (array-reconfigure-rows): Likewise.

	* filecache.el (file-cache-minibuffer-complete): Likewise.

	* obsolete/cplus-md.el (fill-c++-comment): Likewise.

	* strokes.el (strokes-prompt-user-save-strokes): Likewise.

	* allout.el (outline-version, outline-open-topic)
	(outline-rebullet-heading, outline-insert-listified)
	(outline-latex-verbatim-quote-curr-line)
	(outline-latexify-one-item, outlineify-sticky): Likewise.

	* vc.el (vc-next-action-on-file): Likewise.
	(vc-dired-mode): Remove make-local-hook.

2001-11-26  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-find-version): New function.
	(vc-version-other-window): Redefined in terms of the above.

	* log-view.el (log-view-find-version): New function.
	(log-view-mode-map): Bind it to `f'.

2001-11-26  Gerd Moellmann  <gerd@gnu.org>

	* language/devan-util.el (dev-char-glyph): Escape `"' in
	string literals.
	(dev-glyph-glyph, dev-glyph-glyph-2)
	(devanagari-compose-syllable-region): Likewise.

2001-11-26  Richard M. Stallman  <rms@gnu.org>

	* window.el (save-selected-window): No error if saved window is dead.

	* help-funs.el (describe-syntax): Put (interactive) after doc string.

2001-11-26  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* international/quail.el (quail-help): Require help-mode in
	top-level instead.

	* iswitchb.el (iswitchb-exhibit): Use insert instead of
	insert-string.

	* icomplete.el (icomplete-exhibit): Likewise.

2001-11-25  Stefan Monnier  <monnier@cs.yale.edu>

	* diff-mode.el (diff-end-of-hunk): Watch out for ambiguities.
	(diff-hunk-kill): Simplify.
	(diff-post-command-hook): Only apply to a single hunk.
	(diff-hunk-text): Make `char-offset' non-optional.
	(diff-find-text): Return a cons cell.
	(diff-find-approx-text): New fun.
	(diff-find-source-location): Use it.
	(diff-apply-hunk, diff-test-hunk, diff-goto-source):
	Adapt to new retval of diff-find-text.

	* vc-cvs.el (vc-cvs-parse-entry): Rewrite, comparing the string-
	rather than integer- representation of dates.

	* textmodes/fill.el (fill-indent-according-to-mode): Default to nil.

	* emacs-lisp/syntax.el: Don't profile syntax-ppss any more.
	(syntax-after): New fun.

	* help-funs.el (describe-syntax): New fun.

	* font-lock.el (font-lock-cache-state, font-lock-cache-position)
	(font-lock-ppss-stats, font-lock-ppss): Remove.
	(font-lock-fontify-syntactically-region): Remove tuning code.
	(font-lock-compile-keywords): Fix off-by-one bug.
	(font-lock-set-defaults): Don't set removed vars.
	(c-keywords): Add `inline'.
	(c-type-names): Add `_Complex', `_Imaginary' and `_Bool'.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Set syntax-begin-function.
	(lisp-interaction-mode-abbrev-table): Defvar to its correct value.
	(lisp-interaction-mode): Don't set local-abbrev-table any more.
	(lisp-mode-auto-fill): Use syntax-ppss and obey
	comment-auto-fill-only-comments.
	(lisp-fill-paragraph): Use syntax-ppss.

2001-11-25  ShengHuo ZHU  <zsh@cs.rochester.edu>

	* mail/rmail.el (rmail-enable-mime-composing): New. A lightweight
	version of rmail-enable-mime.
	(rmail-forward): Use it.

2001-11-25  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-indent-function): Add doc string.

	* international/quail.el (quail-keyboard-layout-button):
	Define button type.
	(quail-keyboard-customize-button): Likewise.
	(quail-help): Use those button types.  Require `help-mode'.
	Avoid altering the argument `package'.

	* help-mode.el (help-function, help-variable, help-face)
	(help-coding-system, help-input-method, help-character-set):
	Define each button type with its own explicit define-button-type.

	* language/devan-util.el: Comment out parts of the file
	which apparently are garbled.

2001-11-25  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* mail/smtpmail.el (smtpmail-deduce-address-list): Don't use
	insert-string.

2001-11-25  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* play/snake.el (snake-mode): Remove make-local-hook.

	* play/tetris.el (tetris-mode): Likewise.

	* play/decipher.el (decipher-mode): Likewise.

	* tmm.el (tmm-add-prompt): Likewise.

2001-11-25  Sam Steingold  <sds@gnu.org>

	* menu-bar.el (menu-bar-apropos-menu): New variable.
	Moved all `apropos' bindings to this menu.
	(menu-bar-help-menu): Added `menu-bar-apropos-menu'.

2001-11-24  KAWABATA, Taichi <batta@beige.ocn.ne.jp>

	The following changes are for new indian languages support based
	on Unicode charset and CDAC fonts.

	* international/mule-conf.el: Change indian-1-column charset to
	indian-glyph charset.

	* international/characters.el: Adjusted for the change of
	indian-1-column -> indian-glyph.

	* international/fontset.el: Delete the setting for indian-1-column
	and add the setting for indian-glyph in the default fontset.

	* language/indian.el: Completely re-written.

	* language/devanagari.el: Completely re-written.

	* language/devan-util.el: Completely re-written.

	* language/ind-util.el: New file.

2001-11-24  Richard M. Stallman  <rms@gnu.org>

	* startup.el (command-line-1): Don't do startup screen
	if a subprocess is running.  Call the startup screen buffer
	"GNU Emacs".  Make a special mode-line-format for it.

	* net/browse-url.el (browse-url-galeon-new-window-is-tab): New var.
	(browse-url-galeon): Use that variable.

	* mail/supercite.el (sc-toggle-var): Don't use set-variable or
	eval-expression.  Eval and set the variable simply.

	* files.el (temporary-file-directory): Use defcustom.
	(small-temporary-file-directory): Likewise.
	(normal-backup-enable-predicate): Move down in file
	after definition of temporary-file-directory.

	* bindings.el (last-buffer, unbury-buffer): Doc fixes.

2001-11-24  Colin Walters  <walters@debian.org>

	* calc/calc-ext.el (calc-init-extensions): Update the rest of the
	autoload names to match files renamed on initial calc import.

	* calc/calc.el (Commentary): Cleanup, and add logistic curve
	fitting suggestion from Robert J. Chassell <bob@rattlesnake.com>.

2001-11-23  Colin Walters  <walters@debian.org>

	* Makefile.in (finder_setwins, setwins): Include Calc again.

	* calc/calc-rules.el: Add header comment.

2001-11-23  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (with-vc-properties): Don't bind `filename' locally.
	(with-vc-file, edit-vc-file): Use `make-symbol' for local bindings
	to avoid name clashes.  Fix `lisp-indent-function' property for
	both.

2001-11-23  Francesco Potorti`  <pot@gnu.org>

	* generic-x.el (mailrc-generic-mode): Highlight the `source' keyword.

2001-11-22  Colin Walters  <walters@debian.org>

	* calc/calc-misc.el (report-calc-bug):
	Use `reporter-prompt-for-summary-p'.

	* calc/INSTALL, calc/Makefile: Remove.

2001-11-22  Miles Bader  <miles@gnu.org>

	* emacs-lisp/re-builder.el (reb-match-0, reb-match-1)
	(reb-match-2, reb-match-3): Add dark-background variants.

2001-11-22  Colin Walters  <walters@debian.org>

	* calc/calc-misc.el (calc-info): Don't perform voodoo, just
	(info "Calc").
	(report-calc-bug): Use reporter.el.

	* mail/reporter.el (reporter-submit-bug-report): Doc fixes.

2001-11-21  Richard M. Stallman  <rms@gnu.org>

	* which-func.el (which-function): Call imenu--make-index-alist
	if necessary to get a list of functions.
	(which-function-imenu-failed): New variable.
	(which-func-update): Handle all visible windows.
	(which-func-update-1): New subroutine broken out of which-func-update.

	* files.el (temporary-file-directory, null-device)
	(small-temporary-file-directory): Definitions moved up.

	* progmodes/cperl-mode.el (cperl-problems, cperl-tips)
	(cperl-non-problems, cperl-praise): Doc fixes.

	* progmodes/sh-script.el (sh-mode): Don't use define-derived-mode.
	(sh-mode-syntax-table): Function restored.
	Variable set up for use by function sh-mode-syntax-table.
	(sh-set-shell): Set the syntax table.

	* play/gomoku.el (gomoku-mode): Don't use define-derived-mode.

	* progmodes/perl-mode.el (perl-mode): Don't use define-derived-mode.

	* international/encoded-kb.el: Don't alter minor-map-alist.

2001-11-20  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* files.el (auto-save-file-name-transforms): Put remote files in
	temporary-file-directory rather than /tmp.

2001-11-21  Colin Walters  <walters@debian.org>

	* calc/calc-macs.el (calc-slow-wrapper): Move (point) call outside
	of (function ...) wrapper.

2001-11-20  Stefan Monnier  <monnier@cs.yale.edu>

	* derived.el (define-derived-mode): Create the abbrev-table
	from inside the `defvar'.

	* jit-lock.el (jit-lock-defer-time): New var.
	(jit-lock-defer-timer, jit-lock-buffers): New vars.
	(jit-lock-mode): Initialize them.  Cancel the timers more carefully.
	(jit-lock-function): Defer fontification if requested.
	(jit-lock-stealth-chunk-start): Pay attention to the new non-nil value.
	(jit-lock-stealth-fontify): Check the new `jit-lock-defer-multiline'
	text property.
	(jit-lock-deferred-fontify): New fun.

2001-11-20  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-interaction-mode):
	Set local-abbrev-table to lisp-mode-abbrev-table.

	* emacs-lisp/re-builder.el (reb-mode):
	Don't use define-derived-mode.  Call kill-all-local-variables.

	* emacs-lisp/lisp-mode.el (lisp-mode, emacs-lisp-mode):
	Don't use define-derived-mode.

	* help-mode.el (help-mode): Undo 2001-10-07 change.

	* replace.el (occur-mode): Undo 2001-5-20 change.

2001-11-20  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el (w32-system-coding-system): Change to an alias for
	locale-coding-system.
	(set-w32-system-coding-system): Document the above change.
	Set locale-coding-system instead.

2001-11-20  Richard M. Stallman  <rms@gnu.org>

	* ruler-mode.el: Add pagination.
	(ruler-mode-toggle-show-tab-stops): No need to
	test `ruler-mode' variable.

2001-11-20  Eli Zaretskii  <eliz@is.elta.co.il>

	* play/landmark.el: Mark lm-mode as special.

	* play/gomoku.el: Mark gomoku-mode as special.

2001-11-20  Juanma Barranquero  <lektu@terra.es>

	* emacs-lisp/re-builder.el (reb-change-target-buffer): New function.
	(top-level): Bind it to C-c C-b.
	(re-builder): Don't re-enter RE Builder Mode.

	* bs.el (bs-delete): Signal an error if the buffer cannot be deleted.

2001-11-20  Stefan Monnier  <monnier@cs.yale.edu>

	* progmodes/cperl-mode.el (cperl-perldoc): Require man before binding
	`manual-program'.

	* emacs-lisp/lisp-mode.el (lisp-fill-paragraph): Don't move back
	to a line without a comment.

2001-11-20  Eli Zaretskii  <eliz@is.elta.co.il>

	* dired.el (dired-listing-switches): Mention in the doc string
	that some switches are not supported by ls-lisp.el

2001-11-19  Stefan Monnier  <monnier@cs.yale.edu>

	* imenu.el (imenu--split-menu): Use dolist and copy-sequence.
	(imenu--create-keymap-2): Remove.
	(imenu--create-keymap-1): Simplify, remove third argument.
	(imenu--generic-function): Use dolist.
	(imenu-find-default): New function.
	(imenu--completion-buffer): Use it.
	(imenu--mouse-menu): Use popup-menu.
	(imenu--menubar-select): Return t rather than calling imenu.

	* textmodes/fill.el (fill-delete-prefix, fill-delete-newlines):
	New functions, extracted from fill-region-as-paragraph.
	(fill-region-as-paragraph): Use them.
	Use an end marker instead of eob.
	Ignore whitespace-only fill-prefixes when indenting according to mode.
	Simplify the loop that searches for spaces backwards.

	* textmodes/picture.el (picture-vertical-step)
	(picture-horizontal-step): Don't use defconst for variables.

	* mail/mail-extr.el: Use backquote/dolist/mapc/when.  Docstring fixes.
	(mail-extract-address-components): Downcase domain names.
	(mail-extr-delete-char): Remove.  Use delete-char instead.

	* emulation/pc-select.el: Doc string fixes.
	(pc-selection-mode): Don't treat macos as a tty.

	* emacs-lisp/lisp.el (mark-sexp): Mark more if repeated.

	* progmodes/cc-engine.el (c-parse-state): Typo. From Martin Stjernholm.

	* mwheel.el (mouse-wheel-scroll-amount): Allow float values.
	(mouse-wheel-progessive-speed): New var.
	(mwheel-scroll): Use it and handle float values.

	* lazy-lock.el (lazy-lock-install-hooks): Remove make-local-hook.

	* iswitchb.el (iswitchb-mode): Use define-minor-mode.
	(iswitchb): Fix the case where the result was selected with the mouse.
	(iswitchb-completion-help): Use the normal *Completions* now that
	mouse selection works.
	(iswitchb-minibuffer-setup): Simplify.

	* newcomment.el (comment-column, comment-style, comment-multi-line)
	(comment-auto-fill-only-comments): Remove :group arg.
	(comment-padding): Add :type.
	(comment-indent-new-line): Ignore comment-auto-fill-only-comments
	if called interactively.

2001-11-19  Colin Walters  <walters@verbum.org>

	* calc/calc.el (toplevel): Add comment and version header.
	(calc-init-base): Bump version to 2.02f, update date.

2001-11-19  Richard M. Stallman  <rms@gnu.org>

	* net/browse-url.el: Support Mozilla and Galeon.
	By default, find the installed browser whichever it is.
	(browse-url-mozilla): New function.
	(browse-url-mozilla-sentinel): New function.
	(browse-url-galeon, browse-url-galeon-sentinel): New functions.
	(browse-url-default-browser): New function.
	(browse-url-process-environment): Use browse-url-browser-display.
	(browse-url-browser-display): Renamed from browse-url-netscape-display.
	(browse-url-mozilla-startup-arguments, browse-url-galeon-program)
	(browse-url-galeon-arguments, browse-url-galeon-startup-arguments)
	(browse-url-mozilla-program, browse-url-mozilla-arguments): New vars.
	(browse-url-browser-function): New default, new options.

2001-11-19  Sam Steingold  <sds@gnu.org>

	* bindings.el (last-buffer, unbury-buffer): New function.
	(mode-line-unbury-buffer): Use `unbury-buffer'.

2001-11-18  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-cannot-complete-hook): New variable to
	control behaviour when no further completion is possible.

2001-11-19  Colin Walters  <walters@verbum.org>

	* calc/calc-macs.el (calc-wrapper, calc-slow-wrapper)
	(math-showing-full-precision, math-with-extra-prec, math-working)
	(calc-with-default-simplification)
	(calc-with-trail-buffer): Use backtick.
	(Math-zerop, Math-integer-negp, Math-integer-posp, Math-negp)
	(Math-looks-negp, Math-posp, Math-integerp, Math-natnump)
	(Math-ratp, Math-realp, Math-anglep, Math-numberp, Math-scalarp)
	(Math-vectorp, Math-messy-integerp, Math-objectp, Math-objvecp)
	(Math-integer-neg, Math-equal, Math-lessp, Math-primp)
	(Math-num-integerp, Math-bignum-test, Math-equal-int)
	(Math-natnum-lessp, math-format-radix-digit): Change to `defsubst'.
	(calc-record-compilation-date-macro): Deleted.  Callers updated.
	(math-format-radix-digit): Move to calc-bin.el.

	* calc/calc.el (calc-record-compilation-date): Remove.
	(calc-bug-address): Update.
	(calc-settings-file): Use `user-init-file'.

	* calc/calc-mode.el (calc-settings-file-name, calc-save-modes):
	Handle null `calc-settings-file'.

	* calc/calc-frac.el (calc-over-notation): Use `completing-read'.
	* calc/calc-keypd.el (calc-keypad-mode): New.
	(calc-do-keypad): Use it.
	(calc-keypad-map): Move into `calc-keypad-mode'.

	* calc-math.el (calcFunc-sqrt, calcFunc-hypot): Add missing quote
	to defalias argument.

	* calc-misc.el (math-fixnump, math-fixnatnump, calcFunc-trunc)
	(calcFunc-floor): Ditto.

	* calc-units.el (calcFunc-usimplify): Ditto.

	* calc-aent.el, calc-ext.el, calc-incom.el, calc-misc.el
	* calc-sel.el, calc-vec.el, calc-alg.el, calc-fin.el
	* calc-keypd.el, calc-mode.el, calc-stat.el, calc-yank.el
	* calc-arith.el, calc-forms.el, calc-lang.el, calc-mtx.el
	* calc-store.el, calc.el, calc-bin.el, calc-frac.el, calc-macs.el
	* calc-poly.el, calc-stuff.el, calcalg2.el, calc-comb.el
	* calc-funcs.el, calc-maint.el, calc-prog.el, calc-trail.el
	* calcalg3.el, calc-cplx.el, calc-graph.el, calc-map.el
	* calc-rewr.el, calc-undo.el, calccomp.el, calc-embed.el
	* calc-help.el, calc-math.el, calc-rules.el, calc-units.el
	* calcsel2.el: Change all toplevel `setq' forms to `defvar' forms,
	and move them before their first use.  Use `when', `unless'.
	Remove trailing periods from error forms.  Add description and
	headers suggested by Emacs Lisp coding conventions.

2001-11-19  Stefan Monnier  <monnier@cs.yale.edu>

	* newcomment.el (comment-indent):
	Fix misindentation for comment-only lines.
	(comment-indent-new-line): Only obey comment-multi-line if the
	comment-ender is not the end-of-line.

2001-11-19  Richard M. Stallman  <rms@gnu.org>

	* net/net-utils.el (network-connection-service-abbrev-alist):
	New variable.

	* emacs-lisp/cl-indent.el (lisp-indent-defmethod):
	Advance to start of 3rd sexp by moving fwd and backing over it.
	At first three elements, act like defun.

	* delsel.el (delete-selection-pre-hook): Handle and resignal
	file-supersession errors to interact properly with userlock.el.

2001-11-18  Richard M. Stallman  <rms@gnu.org>

	* progmodes/fortran.el (fortran-mode-syntax-table):
	Specify punctuation syntax for backslash.

	* progmodes/sh-script.el (sh-must-be-shell-mode): Function deleted.
	All calls deleted.

	* international/mule-util.el (string-to-sequence): Make it obsolete.
	(string-to-list, string-to-vector): Implement them directly
	using append and vconcat, not with string-to-sequence.

	* startup.el (command-line): Set abbrevs-changed to nil after
	reading the init file and the abbrevs file.

	* isearch.el (isearch): Use magenta2 as bg for (background light)

2001-11-17  Richard M. Stallman  <rms@gnu.org>

	* menu-bar.el (menu-bar-update-buffers-1): Don't pad the buffer name.

	* simple.el (minibuffer-history-sexp-flag): Doc fix.

2001-11-17  Stefan Monnier  <monnier@cs.yale.edu>

	* font-lock.el (font-lock-compile-keywords): New arg `regexp'.
	If set and if applicable, add a regexp to highlight defun-like
	text inside comments and strings.
	(font-lock-fontify-keywords-region): Pass that new arg.
	(font-lock-set-defaults): Move the code to set `font-lock-keywords'
	to the end and pass that new arg.
	(c-font-lock-keywords-2): Fix regex for labels.
	(font-lock-match-c++-style-declaration-item-and-skip-to-next):
	Make it work when LIMIT is several lines further.
	(c-font-lock-keywords-3, c++-font-lock-keywords-3)
	(objc-font-lock-keywords-3, java-font-lock-keywords-3):
	Use backquote and make the regexes for `int a, b, c;' work on
	multiple lines.

	* emacs-lisp/re-builder.el (reb-mode): Use define-derived-mode.
	(font-lock-defaults-alist): Don't change it any more.
	(reb-subexp-mode-map): Cleanup.

	* custom.el (custom-current-group-alist): New var.
	(custom-declare-group): Set it.
	(custom-current-group): New fun.
	(custom-declare-variable, custom-handle-all-keywords):
	Use it as a default if no :group argument is specified.

	* international/mule-cmds.el (locale-name-match): Use \` and \(?:.
	(standard-keyboard-coding-systems): New var.
	(set-locale-environment): Use it to decide whether or not to call
	set-keyboard-coding-system.
	(locale-language-names): Use \"French\" for "fr".

2001-11-17  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/checkdoc.el (princ-list, checkdoc-read-event)
	(add-to-list): Delete compatibility code.
	(checkdoc-next-message-error): Doc fix.

2001-11-17  Stephen Eglen  <stephen@gnu.org>

	* locate.el (locate): Show default locate pattern within the
	prompt, but don't insert it into the minibuffer contents.
	Catch the case when pattern is the empty string.

2001-11-17  Eli Zaretskii  <eliz@is.elta.co.il>

	* language/european.el ("French"): New language environment.

2001-11-16  Richard M. Stallman  <rms@gnu.org>

	* calendar/todo-mode.el (todo-save): Fix previous change.

	* subr.el (functionp): Do use cdr-safe on object.

2001-11-16  Stefan Monnier  <monnier@cs.yale.edu>

	* bindings.el (mode-line-mode-name): Only put the help-echo property
	if the local-map property was put as well.
	(global-map): Bind switch-frame, delete-frame, iconify-frame
	and make-frame-visible events.

	* emacs-lisp/elp.el (elp-not-profilable): New var.
	(elp-not-profilable-p): New function.
	(elp-instrument-function): Use it.  Use backquotes and push.

	* emacs-lisp/bytecomp.el (byte-compile-call-tree, byte-code-vector)
	(byte-stack+-info, byte-compile-last-warned-form)
	(byte-compile-last-logged-file): Don't defconst a variable.
	(no-byte-compile): Declare.
	(byte-compile-file): Don't boundp-check no-byte-compile any more.
	(byte-compile-defvar): Leave defconst as is.

	* emacs-lisp/edebug.el (edebug-form-data, edebug-offsets)
	(edebug-offsets-stack, edebug-read-dotted-list, edebug-def-name)
	(edebug-current-offset, edebug-old-def-name, edebug-error-point)
	(edebug-best-error): Don't defconst a variable.
	(edebug-read-syntax-table): Use a char-table.
	(edebug-lemacs-specific): Remove.
	Toplevel: Eliminate check for Lucid Emacs.

	* pcvs-util.el (cvs-prefix-define): Don't defconst a variable.

	* rect.el (move-to-column-force): Mark obsolete.
	(operate-on-rectangle, delete-extract-rectangle-line)
	(insert-rectangle, delete-whitespace-rectangle-line)
	(open-rectangle-line, clear-rectangle-line): Use move-to-column.
	(string-rectangle-history): New var.
	(string-rectangle, string-insert-rectangle): Use it.
	(delete-rectangle-line): Fix pos/column mixup and simplify.

	* startup.el (normal-top-level-add-subdirs-to-load-path): Simplify.
	(normal-top-level, command-line, command-line-1): Simplify.

	* tar-mode.el (tar-mode): Use define-derived-mode.

	* view.el (view-mode-enable): Don't use make-local-hook.

	* emacs-lisp/eldoc.el (eldoc-mode): Use define-minor-mode.

2001-11-16  Richard M. Stallman  <rms@gnu.org>

	* mail/mail-extr.el (mail-extr-voodoo): Treat a number as a word
	if it doesn't make sense as anything else.
	Don't recognize a "telephone number" at the beginning of the name.
	(mail-extr-leading-garbage): Match non-word characters only.

2001-11-16  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* startup.el (command-line-processed): Doc fix.

	* apropos.el (apropos-next-label-button): Doc fix.

2001-11-16  Stefan Monnier  <monnier@cs.yale.edu>

	* comint.el (comint-mode): Simplify.
	(make-comint-in-buffer): Run `comint-mode' only if necessary.

	* subr.el (eval-after-load): Make it work with features as well.

	* log-view.el (log-view-mode): Don't mark the buffer unmodified.

	* international/mule-cmds.el (describe-input-method): Setup xref.
	(set-language-environment): Use functionp.
	(locale-language-names, locale-charset-language-names)
	(locale-preferred-coding-systems): Defconst and purecopy.

	* language/european.el (mac-roman): Add mime-charset property.

2001-11-15  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/cl.el (values, values-list, multiple-value-list)
	(multiple-value-apply, nth-value): Use defsubst rather than defalias
	to get better doc strings.

2001-11-15  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* derived.el: Fix autoload cookie.

2001-11-15  Richard M. Stallman  <rms@gnu.org>

	* jka-compr.el (jka-compr-partial-uncompress): Fix previous change.

2001-11-15  Stefan Monnier  <monnier@cs.yale.edu>

	* menu-bar.el (menu-bar-edit-menu) <copy>: Put an explicit key binding.

2001-11-15  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-undo): Display a message to explain
	that this does not undo file system changes.

2001-11-15  David Kastrup  <David.Kastrup@t-online.de>

	* mouse-drag.el (mouse-drag-throw): Push back non-drag events
	into `unread-command-events' instead of trying keymap
	lookups ourselves.  This makes mouse-clicks do the right
	thing even when keymaps of overlays are involved.
	(mouse-drag-drag): Likewise.

2001-11-15  Andreas Schwab  <schwab@suse.de>

	* progmodes/ada-mode.el (ada-add-extensions): Quote regexp special
	characters and append anchor to pattern added to auto-mode-alist.

2001-11-15  Stefan Monnier  <monnier@cs.yale.edu>

	* server.el (server-process-filter): Run pore/post-comment-hook
	before/after visiting the file.

	* info-look.el (makefile-mode): Add info for automake.
	(autoconf-mode): Fix the name of the index for automake.

	* international/latin-9.el: Give pilcrow punctuation syntax.

2001-11-15  Andre Spiegel  <spiegel@gnu.org>

	* vc.el: Documentation fixes.

2001-11-14  Stefan Monnier  <monnier@cs.yale.edu>

	* smerge-mode.el (smerge-match-conflict): Fix typo.
	(smerge-diff): Be careful to read match-data early enough.

2001-11-14  Colin Walters  <walters@verbum.org>

	* calc/calc-alg.el (calcFunc-esimplify, calcFunc-simplify)
	(calcFunc-subst): Use `defalias' instead of `fset' and
	`symbol-function'.

	* calc/calc-arith.el (calcFunc-abs, calcFunc-float)
	(calcFunc-ceil, calcFunc-round): Ditto.

	* calc/calc-bin.el (calcFunc-clip): Ditto.

	* calc/calc-ext.el (calcFunc-evalv): Ditto.

	* calc/calc-math.el (calcFunc-sqrt, calcFunc-hypot): Ditto.

	* calc/calc-misc.el (math-fixnump, math-fixnatnump)
	(calcFunc-trunc, calcFunc-floor, calc-report-bug): Ditto.

	* calc/calc-units.el (calcFunc-unsimplify): Ditto.

	* calc-aent.el, calc-ext.el, calc-incom.el, calc-misc.el
	* calc-sel.el, calc-vec.el, calc-alg.el, calc-fin.el
	* calc-keypd.el, calc-mode.el, calc-stat.el, calc-yank.el
	* calc-arith.el, calc-forms.el, calc-lang.el, calc-mtx.el
	* calc-store.el, calc.el, calc-bin.el, calc-frac.el, calc-macs.el
	* calc-poly.el, calc-stuff.el, calcalg2.el, calc-comb.el
	* calc-funcs.el, calc-maint.el, calc-prog.el, calc-trail.el
	* calcalg3.el, calc-cplx.el, calc-graph.el, calc-map.el
	* calc-rewr.el, calc-undo.el, calccomp.el, calc-embed.el
	* calc-help.el, calc-math.el, calc-rules.el, calc-units.el
	* calcsel2.el: Style cleanup; don't put closing parens on their
	own line, add "foo.el ends here" to each file, and update
	copyright date.

	* README: Update maintainer.

2001-11-13  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (recompile): Use compilation-arguments if
	set, so as to be able to M-x recompile the exact command which
	created a compilation-mode buffer.

	* progmodes/ada-mode.el (ada-fill-comment-prefix): Doc fix.

2001-11-13  Gerd Moellmann  <gerd@gnu.org>

	* mouse.el (mouse-drag-region): Don't run the up-event
	handler if window start changed due to the down-mouse event.

2001-11-13  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-show-mark): Either move point to the mark
	or use highlighting, never both.
	(mouse-buffer-menu): If WINDOW is a frame, select its selected window.

2001-11-13  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (top-level): Change maintainer to Simon
	Josefsson, cleanup the smtpmail.el header.

	* mail/smtpmail.el (top-level): Don't require cl or base64.
	(smtpmail-cred-server, smtpmail-cred-port, smtpmail-cred-key)
	(smtpmail-cred-user, smtpmail-cred-cert, smtpmail-cred-passwd):
	Defsubst instead of defmacro.
	(smtpmail-intersection): Return value in reverse order.
	(smtpmail-open-stream): Use stringp instead of string-to-list.
	(smtpmail-open-stream, smtpmail-try-auth-methods): New functions,
	separated from smtpmail-via-smtp.

	* mail/smtpmail.el (top-level): Autoload starttls, mail-utils and
	rfc2104.  Require base64 and cl.
	(smtpmail-smtp-service): Doc fix.  :type fix.
	(smtpmail-debug-info): Doc fix.
	(smtpmail-debug-verb, smtpmail-auth-credentials)
	(smtpmail-starttls-credentials, smtpmail-auth-supported):
	New variables.
	(smtpmail-deduce-address-list, smtpmail-send-it): Don't require
	mail-utils (it is autoloaded).
	(smtpmail-cred-server, smtpmail-cred-port, smtpmail-cred-key)
	(smtpmail-cred-user, smtpmail-cred-cert, smtpmail-cred-passwd)
	(smtpmail-find-credentials, smtpmail-intersection): New utility funs.
	(smtpmail-via-smtp): Support STARTTLS, if binary is installed.
	(smtpmail-via-smtp): Support AUTH.
	(smtpmail-via-smtp): Use `smtpmail-debug-verb' to control VERB.

2001-11-13  Richard M. Stallman  <rms@gnu.org>

	* ebuff-menu.el (electric-buffer-update-highlight): New function.
	(electric-buffer-overlay): New variable.
	(electric-buffer-menu-looper): Call electric-buffer-update-highlight.
	(electric-buffer-list): Likewise.

	* isearch.el (isearch-whitespace-chars): Doc fix.
	(isearch-mode): Handle negative search-slow-window-lines correctly.

2001-11-13  Stefan Monnier  <monnier@cs.yale.edu>

	* newcomment.el (comment-normalize-vars): Handle a nil comment-padding.

	* progmodes/ada-mode.el (ada-fill-comment-prefix): GNAT wants 2 spaces.
	From Emmanuel Briot <briot@act-europe.fr>.

2001-11-13  Colin Walters  <walters@debian.org>

	* calc/calc.el (calc-unread-command): Use `unread-command-events'.

	* calc/calc-mode.el (calc-settings-file-name): Don't hardcode
	"~/.emacs"; use `read-file-name'.

	* calc/calc-graph.el, calc/calc-embed.el, calc/calc-graph.el
	* calc/calc-misc.el, calc/calc-mode.el, calc/calc-prog.el
	* calc/calc-sel.el, calc/calc-store.el, calc/calc-yank.el
	* calc/calc.el: Use `frame-width' instead of `screen-width',
	`frame-height' instead of `screen-height', and,
	`executing-kbd-macro' instead of `executing-macro'.

	* calc/calc-embed.el (calc-do-embedded): Call `y-or-n-p' with
	correct number of arguments.

	* calc/calc-aent.el (calc-do-alg-entry):
	Use `blink-paren-function' instead of `blink-paren-hook'.

2001-11-12  Richard M. Stallman  <rms@gnu.org>

	* calendar/todo-mode.el (todo-save): Add save-excursion
	and save-restriction.

	* server.el (server-edit, server-done): Doc fix.

	* simple.el (clone-indirect-buffer): Error if major mode symbol
	has a no-clone-indirect property.
	(clone-buffer): Check for obvious errors before reading clone name.

	* info.el (Info-mode): Add a no-clone-indirect property.

2001-11-12  Sam Steingold  <sds@gnu.org>

	* vc.el (vc-print-log): Bind `inhibit-read-only' to t before and
	set-buffer-modified-p to nil after `vc-exec-after'.
	* log-view.el (log-view-mode-map): Bind "q", "z", "m" and "d".
	(log-view-mode): Make read-only.
	(log-view-current-file): Do final `expand-file-name' in the
	current `default-directory'.
	(log-view-current-tag): Take an optional `where' arg.
	(log-view-diff): New user command.

2001-11-12  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* progmodes/cpp.el (cpp-choose-face): Fix typo.

2001-11-12  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/cl-indent.el (toplevel): Indent properly
	`generic-flet', `generic-labels', `with-accessors',
	`with-condition-restarts'.

2001-11-12  Richard M. Stallman  <rms@gnu.org>

	* dired.el: Many trivial doc fixes.
	(dired-get-file-for-visit): New function.
	(dired-find-alternate-file, dired-mouse-find-file-other-window):
	(dired-view-file, dired-find-file-other-window, dired-display-file):
	(dired-find-file): Use dired-get-file-for-visit.

2001-11-12  Alex Schroeder  <kensanata@yahoo.com>

	* sql.el (sql-mode): Doc change.

	* sql.el (sql-mode-syntax-table): The backslash is no longer an
	escape character.

2001-11-12  Colin Walters  <walters@debian.org>

	* calc/calc-keypd.el (toplevel): Bind mouse buttons.
	(calc-do-keypad): Don't attempt to use nonexistent global
	mouse-map, use calc-keypad-map.
	(calc-keypad-x-left-click): Renamed to calc-keypad-left-click.
	(calc-keypad-left-click): Don't use mouse-map; update to new event
	interface.
	(calc-keypad-x-middle-click, calc-keypad-x-right-click): Ditto.
	(calc-keypad-press): Use `unread-command-events' instead of
	`unread-command-char'.

	* calc/calc-ext.el (calc-init-extensions): Update autoload names
	to match files renamed on initial calc import.

2001-11-12  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* textmodes/flyspell.el (flyspell-default-dictionary):
	Fix previous change.

2001-11-12  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-default-dictionary):
	Fix custom type.

2001-11-11  Richard M. Stallman  <rms@gnu.org>

	* calendar/solar.el (solar-sunrise-and-sunset):
	Exchange the two extreme values of day-length.

	* progmodes/sh-script.el (sh-must-be-shell-mode):
	Allow modes derived from sh-mode.

	* emacs-lisp/checkdoc.el (checkdoc-file-comments-engine):
	Turn off error in some re-search-forward calls.

	* replace.el (query-replace-skip-read-only): New variable.
	(perform-replace): If that variable is non-nil, ignore matches
	that have a read-only property.

	* derived.el (define-derived-mode): Doc fix.

	* server.el (server-buffer-done): Test of server-existing-buffer
	was backwards.
	(server-existing-buffer): Doc fix.

	* textmodes/flyspell.el (flyspell-default-dictionary):
	Allow nil as value, and make nil the default.

2001-11-11  Eli Zaretskii  <eliz@is.elta.co.il>

	* menu-bar.el (menu-bar-edit-menu): Don't use x-selection-exists-p if
	it is not fboundp.
	(clipboard-yank): Ditto.

2001-11-11  Colin Walters  <walters@verbum.org>

	The following changes are based on patches from
	Eli Zaretskii <eliz@is.elta.co.il>, Kai Gro,A_(Bjohann
	<Kai.Grossjohann@CS.Uni-Dortmund.DE>, and others.

	* calc/calc.el (toplevel): Require calc-macs.
	(calc-minibuffer-size): New.
	(calcDigit-nondigit): Use it instead of `buffer-size'.
	(calcDigit-backspace): Likewise.
	(calcDigit-nondigit): Use `minibuffer-contents' instead of
	`buffer-string'.
	(calc-minibuffer-contains): Use `minibuffer-prompt-end' instead of
	`point-min'.
	(calcDigit-key): Use `calc-minibuffer-contains' instead of a
	`save-excursion'.

	* calc/calc-macs.el (calc-record-compilation-date-macro): Return a
	simple `setq' form.

	* calc/calc-ext.el: (toplevel): Require calc.
	(calc-fancy-prefix-map): New.
	(calc-fancy-prefix): Use it.
	(calc-fancy-prefix-other-key): New.

	* calc/calc-aent.el (toplevel): Require calc-macs during compilation.
	(calc-do-quick-calc): Use `frame-width' instead of `screen-width'.
	(calcAlg-edit): Use `minibuffer-contents' instead of `buffer-string'.
	(calcAlg-enter): Likewise.
	(calcAlg-enter): Use `minibuffer-prompt-end' instead of `point-min'.

2001-11-10  Richard M. Stallman  <rms@gnu.org>

	* abbrev.el (read-abbrev-file): Don't set save-abbrevs.
	(quietly-read-abbrev-file): Doc fix.

	* startup.el (command-line): Read standard abbrev
	file (abbrev-file-name), if it exists.

	* files.el (save-abbrevs): Default value is t.

	* progmodes/compile.el (compile-goto-error): Fix previous change
	in the case where subsequent errors have not been parsed yet
	because they are in a different source file.

2001-11-10  Peter Kleiweg  <kleiweg@let.rug.nl>

	* progmodes/ps-mode.el (ps-mode-font-lock-keywords-1):
	Merge two regular expressions into one.
	(ps-mode): Make local bindings for `comment-start' and
	`comment-start-skip'.
	(ps-mode-looking-at-nested): Simplify an if-else construct;
	use `set-match-data' to set the result.

2001-11-10  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-correct-word/local-keymap):
	Function deleted.
	(flyspell-correct-word): Old definition deleted.
	(flyspell-correct-word/mouse-keymap): Renamed to flyspell-correct-word.
	All references renamed too.

2001-11-10  Gerd Moellmann  <gerd@gnu.org>

	* Makefile.in (finder_setwins, setwins): Exclude Calc.

2001-11-09  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (checklist): Removed `:menu-tag'.
	(radio-button-choice): Ditto.
	(editable-list): Ditto.

2001-11-09  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* play/gomoku.el: Move definitions of constants to the beginning
	of file, before their use.

2001-11-09  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el: Use the keymap property
	instead of local-map, and don't use a minor-mode map.
	(flyspell-mode-map): Variable deleted.
	Don't mess with minor-mode-map-alist.
	(calling add-minor-mode): Specify nil for keymap.
	And always use add-minor-mode, now that it exists.
	(flyspell-overlay-keymap-property-name): Set it to `keymap'.
	(flyspell-mode-on): Don't locally bind flyspell-mouse-map
	or flyspell-local-mouse-map.
	(make-flyspell-overlay): Use flyspell-mouse-map directly.
	(flyspell-mode): Doc fix.
	(flyspell-mode-on): Don't call make-local-hook.

2001-11-09  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/debug.el (debugger-make-xrefs):
	Add buttons to all symbols.

2001-11-09  Andre Spiegel  <spiegel@gnu.org>

	* vc.el: Add John David Smith to credits.

	Suggested by Kalle Olavi Niemitalo <kon@iki.fi>:

	* vc-hooks.el (vc-error-occured): Backquotified.
	(vc-file-prop-obarray): Use prime length for better efficiency.

	* vc.el (vc-clear-context): Fill obarray with 0, not nil.

2001-11-09  Eli Zaretskii  <eliz@is.elta.co.il>

	* info.el (Info-file-list-for-emacs): Add entries for Calc.

2001-11-09  Miles Bader  <miles@gnu.org>

	* subr.el (functionp): Don't consider macros as functions.

2001-11-08  Miles Bader  <miles@gnu.org>

	* subr.el (functionp): Make work correctly for macros and unbound
	symbols.

	* comint.el (comint-send-input): Fix description of
	`comint-process-echoes' in the doc-string.

2001-11-08  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/mule.el (make-translation-table): Doc fix.
	Suggested by Alex Schroeder <alex@gnu.org>.

2001-11-07  Richard M. Stallman  <rms@gnu.org>

	* info.el (Info-fontify-node): Highlight every third menu item.

2001-11-07  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-face-value-create): Don't ignore the
	`customized-face' attribute when finding the current face spec.

2001-11-07  Stefan Monnier  <monnier@cs.yale.edu>

	* subr.el (with-local-quit): New macro.
	(make-syntax-table): Always inherit.
	(functionp): Be more careful when `object' is a symbol.

	* dabbrev.el (dabbrev-completion): Use "*Completions*".

2001-11-07  Paul Eggert  <eggert@twinsun.com>

	* dired.el (dired-move-to-filename-regexp):
	Do not distinguish between ASCII letters and non-ASCII characters.
	Don't allow comma except in the form "month day, year".
	Don't allow space between month name and comma.
	Clean up the code that checks for trailing period, comma, and space.
	Remove now-obsolete comments, and add more commentary about
	Japanese dates.
	Always gobble up trailing spaces, instead of doing it only sometimes.

2001-11-07  Miles Bader  <miles@gnu.org>

	* paren.el (show-paren-match-face): Add dark-background variant.

2001-11-06  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/lisp-mode.el (lisp-imenu-generic-expression): Paren typo.
	(lisp-mode-variables): Don't set paragraph-{start,separate}.
	Don't disable adaptive-fill-mode.
	(lisp-fill-paragraph): Use tab-width rather than 8.
	Prevent filling the first line of docstrings.

2001-11-06  Richard M. Stallman  <rms@gnu.org>

	* play/gomoku.el (gomoku): Doc fix.

	* jka-compr.el (jka-compr-partial-uncompress):
	Support an alternative of not using dd.
	(jka-compr-dd-program): Use defcustom to define this.
	(jka-compr-load-suffixes): Use defcustom.
	(jka-compr-mode-alist-additions): Use defcustom.

2001-11-06  Stefan Monnier  <monnier@cs.yale.edu>

	* font-lock.el (font-lock-match-c-style-declaration-item-and-skip-to-next):
	Also work when LIMIT is further than the end of line.

2001-11-06  Eli Zaretskii  <eliz@is.elta.co.il>

	* international/quail.el (quail-update-leim-list-file): Print the
	offending file name if some of its quail-define-package forms is broken.

2001-11-05  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (eval-last-sexp-1): Return the value
	of the evaluated form.

2001-11-05  Paul Eggert  <eggert@twinsun.com>

	* ls-lisp.el (ls-lisp-time-to-seconds): New function.
	(ls-lisp-format-time): Emulate GNU fileutils 4.1.1 ls, whose time
	stamps always line up by default.  Also, it uses a slightly
	different window to determine whether files are "recent".

2001-11-05  Andrew Innes  <andrewi@gnu.org>

	* makefile.w32-in (bootstrap-clean-CMD, bootstrap-clean-SH):
	Don't attempt to remake autoloads before nuking .elc files.

2001-11-04  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (last-sexp-toggle-display): Cope if
	previous-single-property-change or next-single-char-property-change
	returns nil.

	* international/mule-cmds.el (set-locale-environment):
	Make it interactive; make arg optional.

	* international/mule-diag.el (help-funs): Require help-funs.

2001-11-04  Eli Zaretskii  <eliz@is.elta.co.il>

	* term/internal.el (term-setup-hook): Add IT-setup-unicode-display.

2001-11-04  Miles Bader  <miles@gnu.org>

	* startup.el (fancy-splash-head): Reapply Gerd's hack to make the
	shadow of the splash image grey on a dark background instead of black.

2001-11-03  Stefan Monnier  <monnier@cs.yale.edu>

	* term.el (all faces): Don't (copy-face 'default <foo>).

	* term/xterm.el (function-key-map):
	Add entry for `ESC [ 3 ~' -> <delete>
	Add entries `ESC O 5 [ABCD]' -> C-{up,down,right,left}.
	Use inheritance so that .emacs and terminfo take precedence.

2001-11-03  Eli Zaretskii  <eliz@is.elta.co.il>

	* tooltip.el (tooltip-delay): Decrease to 0.7.
	(tooltip-hide-delay): Enlarge to 10.

2001-11-03  Richard M. Stallman  <rms@gnu.org>

	* startup.el (fancy-splash-tail): Explain how to recover
	from a crash, if there was a crash.
	(command-line-1): Reorganize display of startup screen,
	to simplify the logic.  Use a temp buffer for it.

2001-11-03  Eli Zaretskii  <eliz@is.elta.co.il>

	* frame.el (set-background-color, set-foreground-color):
	Call face-set-after-frame-default, to propagate the new colors to
	the frame's parameters alist.

	* calendar/timeclock.el (timeclock-out): Signal an error if
	timeclock-last-event is nil.

2001-11-02  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (fill-context-prefix): Fix braino.

	* international/quail.el (quail-help):
	Use `help-buffer' and move `help-setup-xref' to beginning.

	* international/mule-cmds.el (describe-language-environment):
	Use `help-buffer' and move `help-setup-xref' to beginning.

	* international/mule-diag.el (list-character-sets)
	(sort-listed-character-sets, describe-character-set)
	(describe-coding-system, describe-fontset, list-fontsets):
	Use `help-buffer' and move `help-setup-xref' to beginning.
	(describe-char-after): Use `internal-describe-syntax-value'.

2001-11-02  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (popup-menu): If the user refuses to select
	from a menu, don't try to invoke the menu.

2001-11-02  Miles Bader  <miles@gnu.org>

	* help-mode.el (help-xref): New button type.
	(help-function, help-variable, help-face, help-coding-system)
	(help-input-method, help-character-set, help-type, help-symbol)
	(help-back, help-info, help-customize-variable, help-customize-face)
	(help-function-def, help-variable-def): Use it as a supertype.
	Remove `action' property.

	* international/mule-diag.el (describe-character-set)
	(describe-coding-system): Pass correct args to `help-xref-button'.
	(sort-listed-character-sets): New button type.
	(list-character-sets): Use it.
	(list-charset-chars): New button type.
	(list-character-sets-1): Use it.

2001-11-01  Stefan Monnier  <monnier@rum.cs.yale.edu>

	* indent.el (tab-always-indent, indent-for-tab-command):
	Remove redundant `never' setting.

	* fill.el (fill-region-as-paragraph): Don't forget to skip
	over current whitespace before looking for a preceding space.

2001-11-01  Richard M. Stallman  <rms@gnu.org>

	* files.el (file-newest-backup): Don't pass backup file name
	thru file-name-sans-versions, because it never has version numbers.

	* textmodes/sgml-mode.el (sgml-xml-guess): Fix regexp
	to avoid ambiguous nested loops.

	* files.el (find-file-noselect): Offer to change buffer-read-only
	only when the file's read-only status has changed from before
	as well as disagreeing with the buffer's current status.
	(buffer-file-read-only): New var, local in all buffers.

	* buff-menu.el (buffer-menu): Doc fix.
	(buffer-menu-other-window): Doc fix.
	(list-buffers, list-buffers-noselect): Doc fix.

2001-11-01  Gerd Moellmann  <gerd@gnu.org>

	* startup.el (command-line): If the terminal Emacs is running on
	has erase char set to ^H, use the Backspace key for deleting
	backward, and the Delete key for deleting forward.

2001-11-01  Miles Bader  <miles@gnu.org>

	* button.el (define-button-type): Make sure every user-defined
	button type has a supertype.

2001-10-31  Jason Rumney  <jasonr@gnu.org>

	* international/mule-cmds.el (locale-language-names): Add chs and
	cht as aliases for Chinese-GB and Chinese-BIG5.

2001-10-31  Richard M. Stallman  <rms@gnu.org>

	* bindings.el (mode-line-frame-identification): Add doc string.
	(mode-line-position, mode-line-modes): New variables.
	(mode-line-format): Use mode-line-position for the part
	that displays the position-in-buffer info.
	Use mode-line-modes for the part that displays major and minor modes.

2001-10-31  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/debug.el (debugger-make-xrefs): New function.
	(debugger-setup-buffer): Call it.
	(debugger-mode-map): Bind RET and mouse-2.

2001-10-31  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* startup.el: Document command line option --no-window-system
	instead of --no-windows.

2001-10-30  Stefan Monnier  <monnier@cs.yale.edu>

	* progmodes/autoconf.el (autoconf-mode): Fix comment-start-skip.

	* font-lock.el (java-font-lock-syntactic-face-function): New fun.
	(font-lock-defaults-alist): Use it.
	From David Ponce <david.ponce@wanadoo.fr>

	* progmodes/perl-mode.el (perl-indent-line): Use `eq' to compare
	output of `char-after'.

	* bindings.el (ctl-x-map): Add binding for C-x (, C-x ) and C-x e.

	* simple.el (reindent-then-newline-and-indent): Insert the newline
	before indenting the first line.
	(undo-get-state, undo-revert-to-state): New funs.
	(shell-command): Don't kill the buffer even if empty.
	(transpose-subr-start1, transpose-subr-start2, transpose-subr-end1)
	(transpose-subr-end2): Remove.
	(transpose-subr): Add `special' arg and simplify.
	(transpose-subr-1): Rewrite.
	(do-auto-fill): Use fill-indent-according-to-mode and fill-nobreak-p.
	(rfc822-goto-eoh): Simplify.

2001-10-30  Richard M. Stallman  <rms@gnu.org>

	* enriched.el (enriched-face-ans): Fix previous change.

2001-10-30  Gerd Moellmann  <gerd@gnu.org>

	* international/iso-acc.el (iso-accents-compose): Remove a
	superfluous setq.

2001-10-30  Eli Zaretskii  <eliz@is.elta.co.il>

	* buff-menu.el (list-buffers-noselect): If the buffer's name
	starts with a blank, but it visits a file, do show it (for files
	whose names start with a blank).

2001-10-30  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (sentence-end-double-space)
	(sentence-end-without-period): Move to paragraphs.el.
	(fill-indent-according-to-mode): Change default to t.
	(fill-context-prefix): Simplify control-flow and use a more
	sophisticated merge that unifies both previous checks.
	(fill-single-word-nobreak-p, fill-french-nobreak-p): New funs.
	(fill-nobreak-predicate): Make it into a defcustom'd hook.
	(fill-nobreak-p): New fun.
	(fill-region-as-paragraph): Use it.
	Handle `fill-indent-according-to-mode' slightly differently.
	(fill-individual-paragraphs-prefix): Simplify the control-flow.
	(fill-individual-paragraphs-citation): Fix.

	* textmodes/paragraphs.el (use-hard-newlines): Use define-minor-mode.
	(paragraph-start): Change default to the `text-mode' value.
	(sentence-end-double-space, sentence-end-without-period):
	Move from fill.el.
	(forward-paragraph): Use `parstart' and `parsep' for temp variables
	rather than rebinding `paragraph-start' and `paragraph-separate'.

	* indent.el (indent-line-function): Change default to indent-relative.
	(tab-always-indent): Add an `never' setting.
	(indent-according-to-mode): Handle `indent-relative' and
	`indent-relative-maybe' specially.
	(indent-for-tab-command): Rename `prefix-arg' to `arg'.
	Handle the `never' case for `tab-always-indent'.
	Don't call indent-according-to-mode for indent-relative' and
	`indent-relative-maybe'.
	(insert-tab): Rename `prefix-arg' to `arg'.
	(indent-region): Indent the first line as well.
	(indent-relative): Don't mark the buffer modified if the indentation
	is unchanged.

	* textmodes/text-mode.el (paragraph-indent-minor-mode):
	Don't set paragraph-separate.  Set paragraph-start more carefully.
	Set indent-line-function.
	(paragraph-indent-text-mode): Use it and define-derived-mode.
	(text-mode-map): Remove the \t binding.
	(text-mode): Simplify now that the default is more favorable.

2001-10-29  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/find-func.el (find-function-search-for-symbol):
	If the regexp doesn't match, use a looser one.
	(find-variable-noselect): Add `file' argument.

	* pcvs.el (cvs-mode-commit-hook): New hook.
	(cvs-mode-commit): Run it.

	* log-edit.el (log-edit): Run hook after `log-edit-files'.

	* emacs-lisp/edebug.el (delay-mode-hooks): Add edebug-spec.
	(edebug-instrument-function): Use `find-function-noselect'.

2001-10-29  Richard M. Stallman  <rms@gnu.org>

	* term.el (term-if-emacs19): Macro deleted.
	Callers changed to use progn instead.

	* frame.el (blink-cursor-mode): Doc fix.

	* files.el (find-backup-file-name): Use make-backup-file-name.

	* emacs-lisp/edebug.el (edebug-window-live-p): Always alias to
	window-live-p.
	(edebug-set-conditional-breakpoint): Unconditionally use
	the former Emacs >=19 definition.
	(edebug-mark): Define unconditionally.
	(edebug-eval-expression): Always call read-from-minibuffer
	and specify history list.
	(edebug-lemacs-specific): Override emacs-mark, edebug-window-live-p,
	edebug-set-conditional-breakpoint.
	(edebug-emacs-version-specific): Function deleted;
	do the job at top level.
	(edebug-emacs-19-specific): Function deleted, this is the default.

2001-10-29  Sam Steingold  <sds@gnu.org>

	* w32-fns.el (convert-standard-filename): Handle cygwin-specific
	"/cygdrive/LETTER/" pathnames.

2001-10-29  Eli Zaretskii  <eliz@is.elta.co.il>

	* faces.el (invert-face): Check for 'unspecified, not for nil,
	when testing whether face colors are not specified.
	From David.Kastrup@t-online.de (David Kastrup).
	(read-face-name): Doc fix.
	(make-face-bold, make-face-unbold, make-face-italic)
	(make-face-unitalic, make-face-bold-italic, invert-face):
	Remove trailing blank from the prompt passed to read-face-name.

2001-10-29  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/bytecomp.el (byte-recompile-directory):
	Report numbers of files skipped and failed too.
	(byte-compile-file): Return 'no-byte-compile for skipped files.

2001-10-29  Kai Gro,A_(Bjohann  <Kai.Grossjohann@CS.Uni-Dortmund.DE>

	* log-view.el (log-view-mode-map): Bind `M-n' and `M-p', not `M n'
	and `M p'.

2001-10-29  Gerd Moellmann  <gerd@gnu.org>

	* international/iso-acc.el (iso-accents-compose): Push SECOND-CHAR
	as is on unread-command-events instead of `(SECOND-CHAR)'.

2001-10-29  Andre Spiegel  <spiegel@gnu.org>

	* vc.el: Mention vc-*-switches in backend API documentation.
	(vc-annotate): Adapt doc string to recent change.

2001-10-29  Gerd Moellmann  <gerd@gnu.org>

	* enriched.el (enriched-face-ans): Handle face attributes
	of the form `(FACE1 FACE2 ...)'.

	* dired-x.el (dired-omit-startup): Show ``Omit'' only in Dired buffers.

2001-10-29  Alex Schroeder  <kensanata@yahoo.com>

	* progmodes/sql.el (sql-mysql): Doc change by RMS.

	* progmodes/sql.el (sql-db2): Doc change.
	(sql-help): Doc change by Christian Egli <christian.egli@stest.ch>.
	(sql-mysql): Doc change by Christian Egli <christian.egli@stest.ch>.

2001-10-29  Gerd Moellmann  <gerd@gnu.org>

	* env.el (substitute-env-vars): Don't quote argument to `rx';
	it's a macro.

2001-10-28  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-start.el (recursive-load-depth-limit): Added.

2001-10-28  Richard M. Stallman  <rms@gnu.org>

	* textmodes/ispell.el (version18p, version20p): Vars deleted.
	All uses removed--assume Emacs version is >= 20.

	* mail/supercite.el (sc-emacs-features): Test for "Emacs 19"
	by really checking that it is not version 18.

	* emacs-lisp/lisp-mode.el (eval-defun): Doc fix.

2001-10-28  Miles Bader  <miles@gnu.org>

	* faces.el (face-attribute): Add INHERIT argument, consider face
	inheritance if it's non-nil.
	(face-attribute-merged-with): New function.
	(face-attribute-specified-or): New macro.
	(face-foreground, face-background, face-stipple): Add INHERIT
	argument.  Use `face-attribute-specified-or'.

2001-10-28  Stefan Monnier  <monnier@cs.yale.edu>

	* font-lock.el: Require `syntax'.
	(font-lock-defaults-alist): Don't define keywords for lisp languages.
	Use `c-font-lock-syntactic-face-function' for c languages.
	(font-lock-mode): Don't unset vars when turning the mode off.
	(font-lock-default-fontify-buffer): Don't unset vars at the end.
	(font-lock-extra-managed-props): New var.
	(font-lock-default-unfontify-region): Use it.
	(font-lock-apply-syntactic-highlight): Flush the syntax cache.
	Don't eval the value when there's no match.
	(font-lock-ppss-stats): New var.
	(font-lock-ppss): New fun.
	(font-lock-fontify-syntactically-region): Use it and syntax.ppss.
	(font-lock-apply-highlight): Allow `highlight' to set several props.
	(font-lock-set-defaults): Use dolist.
	(font-lock-unset-defaults): Remove.
	(font-lock-match-c-style-declaration-item-and-skip-to-next):
	Try to recognize prototypes using `foo P_ ((args))'.
	({c,c++,java,objc}-font-lock-keywords-{1,2,3}): Don't setq a defconst.
	(c-font-lock-keywords-2): Fix last change to still use Anders' trick.
	(c-font-lock-syntactic-face-function): New function.
	(font-lock-match-c++-style-declaration-item-and-skip-to-next)
	(c++-keywords): Use a more sophisticated regexp to handle
	shallowly nested templates.

2001-10-27  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/sgml-mode.el (sgml-empty-tags): New var.
	(sgml-tag): Use it.  Cleanup with `cond'.
	(sgml-tags-invisible): Make sgml-tags-invisible buffer-local.
	Mark the overlays and only delete those that are marked.
	(sgml-skip-close-p): Remove.
	(sgml-value): Replace sgml-skip-close-p with its definition.
	(html-tag-alist): Use sgml-xml a bit more.
	(html-mode): Set sgml-empty-tags.

	* textmodes/texnfo-upd.el: Use `when', `dolist', `push', ...
	(texinfo-update-node, texinfo-sequential-node-update):
	Don't bind the obsolete `auto-fill-hook'.
	(texinfo-multi-file-included-list,texinfo-multi-file-master-menu-list):
	Use `set-buffer' rather than `switch-to-buffer'.
	(texinfo-multi-file-update): Use "Top" rather than `up-node-name'.
	Use `set-buffer' rather than `switch-to-buffer'.

	* mail/sendmail.el (mail-mode-syntax-table): Let it inherit from
	text-mode-syntax-table.
	(mail-mode): Use define-derived-mode.
	Fix ordering of alternatives in adaptive-fill-regexp.
	(mail-mode-map): Don't rely on keymap's internal representation.

2001-10-27  Sam Steingold  <sds@gnu.org>

	* textmodes/sgml-mode.el (sgml-xml): Renamed from `html-xhtml'.
	(sgml-xml-guess): Extracted from `html-mode' and generalized.
	(sgml-mode-common): Call it.
	(sgml-mode, html-mode): Set `mode-name' based on `sgml-xml'.
	(sgml-tag, sgml-skip-close-p, html-tag-alist, html-line)
	(html-horizontal-rule, html-image, html-ordered-list):
	(html-unordered-list, html-list-item, html-paragraph):
	(html-checkboxes, html-radio-buttons): Use `sgml-xml' instead of
	`html-xhtml'.

2001-10-26  Masayuki Ataka  <ataka@milk.freemail.ne.jp>

	* textmodes/texinfmt.el (texinfo-format-ifnotinfo): New function.
	(ifnothtml): New alias.

2001-10-27  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/text-mode.el (text-mode): Use define-derived-mode.
	(toggle-text-mode-auto-fill): Use derived-mode-p.

2001-10-27  Gerd Moellmann  <gerd.moellmann@t-online.de>

	* net/ange-ftp.el (ange-ftp-send-cmd): Call fix-name-func for
	`mdtm'.  From "Forrest Cahoon" <forrest.cahoon@merrillcorp.com>.

2001-10-26  Eli Zaretskii  <eliz@is.elta.co.il>

	* term/pc-win.el (x-frob-font-slant, x-frob-font-weight):
	Add make-obsolete cookies, to follow faces.el.

	These changes avoid warnings from the byte compiler in faces.el:

	* faces.el (internal-get-face): Use facep instead of the obsolete
	internal-find-face.
	(internal-frob-font-weight, internal-frob-font-slant):
	New defaliases for obsolete functions.
	(x-make-font-bold, x-make-font-demibold, x-make-font-unbold)
	(x-make-font-italic, x-make-font-oblique, x-make-font-unitalic)
	(x-make-font-bold-italic): Use internal-frob-font-weight and
	internal-frob-font-slant aliases instead of the obsolete
	x-frob-... functions.

2001-10-26  Sam Steingold  <sds@gnu.org>

	* textmodes/sgml-mode.el (html-mode): Set `html-xhtml' from the
	DOCTYPE; set `mode-name' based on it.
	(html-tag-alist): Use `html-xhtml' for "li", "dt" and "dd".
	(sgml-tag): Close empty tags in XHTML.

2001-10-26  Jason Rumney  <jasonr@gnu.org>

	* w32-fns.el: (w32-charset-info-alist): Use ANSI for iso10646-1
	when UNICODE is not defined.

2001-10-26  Sam Steingold  <sds@gnu.org>

	* font-lock.el (c-font-lock-keywords-2): Do not require labels to
	be alone on the line.

2001-10-26  Eli Zaretskii  <eliz@is.elta.co.il>

	* button.el (button): Special face definition for MS-DOS terminals.

2001-10-26  Sam Steingold  <sds@gnu.org>

	* progmodes/sh-script.el (sh-font-lock-syntactic-keywords):
	Protect the /= test by checking that the args are non-nil.
	(sh-font-lock-close-heredoc): Check eof for being non-nil.

2001-10-26  Tomas Abrahamsson  <tab@lysator.liu.se>

	* textmodes/artist.el (artist-version): 1.2.4.
	(artist-butlast-fn): New variable.
	(artist-butlast): New function.
	(artist-ellipse-mirror-quadrant): Use it.
	(artist-mouse-draw-poly): Use nil for `point-list'.
	(artist-mouse-draw-poly): Check for point-list being nil.

2001-10-26  Peter Kleiweg  <kleiweg@let.rug.nl>

	* progmodes/ps-mode.el (ps-mode-print-function): Remove quote for
	lambda expression.
	(ps-mode-menu-main): Submenu with options on/off was replaced with
	a toggle button.
	(ps-mode, ps-run-mode): Define with `define-derived-mode'
	(ps-mode): Autoload cookie added on same line as comment
	(ps-mode-tabkey, ps-mode-backward-delete-char):
	(ps-mode-r-balance): Replace `delete-horizontal-space' and
	`indent-to' with `indent-line-to'
	(ps-mode-print-buffer, ps-mode-print-region): Use `funcall'
	instead of `eval'.
	(ps-mode-print-region): Use `with-temp-buffer'.
	(ps-run-start): Use of `mapconcat'.  Use `apply' instead of `eval'.
	(numerous places): Add back-tick and tick around names in
	docstrings, fix punctuation in docstrings, remove trailing spaces.

2001-10-25  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/sgml-mode.el (sgml-font-lock-keywords-1): Ignore comments.
	(sgml-font-lock-keywords-2): Use `eval'.  Moved from sgml-mode-common.
	(sgml-font-lock-syntactic-keywords): New var.
	(sgml-mode-common): Drop the two args.
	Don't make buffer-local variables that aren't used.
	Don't set sgml-font-lock-keywords-2 now that it uses `eval instead.
	Don't set `before-string' props from sgml-display-text.
	(sgml-mode): Use define-derived-mode.
	(sgml-tags-invisible): Use sgml-display-text.
	(sgml-quote): New command.
	(html-tag-alist): Add args for `span'.
	(html-mode): Use define-derived-mode.
	Set sgml-display-text and sgml-tag-face-alist.

2001-10-25  Sam Steingold  <sds@gnu.org>

	* add-log.el (add-log-always-start-new-record): New user option.
	(add-change-log-entry): Use it.

2001-10-25  Richard M. Stallman  <rms@gnu.org>

	* progmodes/etags.el (tags-query-replace): Make tags-loop-scan
	bind case-fold-search if FROM is not all lower case.

2001-10-25  Gerd Moellmann  <gerd@gnu.org>

	* startup.el (normal-top-level): Check for frame-initial-frame
	only if it's really used.

	* mail/mh-utils.el (mh-recenter): Call recenter with arg `(4)'.

	* progmodes/compile.el (compilation-parse-errors-filename-function):
	New variable.
	(compilation-parse-errors): Use it.

2001-10-25  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/checkdoc.el (checkdoc-eval-defun): Call eval-defun
	interactively so that C-u M-C-x still does edebug.
	(checkdoc-sentencespace-region-engine): Don't force a double-space
	after `.' if it doesn't look like an end-of-sentence.
	(debug-ignored-errors): Add `disambiguate ...'.

2001-10-24  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/texinfo.el (texinfo-environments)
	(texinfo-environment-regexp): Hoist.
	(texinfo-font-lock-keywords): Use `italic' and `bold' faces.
	Only highlight the menu name in menu items.
	Setup `@foo ... @end foo' as text clones.
	(texinfo-clone-environment): New function.
	(texinfo-mode): Simplify auto-fill-inhibit-regexp.
	(texinfo-insert-block): Simplify.
	(texinfo-insert-quote): Insert a plain " if preceded by \ or if
	the command is repeated.
	(texinfo-last-unended-begin, texinfo-next-unmatched-end): New funs.
	(texinfo-insert-@end): Simplify.

	* textmodes/texnfo-upd.el (texinfo-section-types-regexp)
	(texinfo-section-level-regexp, texinfo-subsection-level-regexp)
	(texinfo-subsubsection-level-regexp)
	(texinfo-update-menu-same-level-regexps)
	(texinfo-update-menu-higher-regexps)
	(texinfo-update-menu-lower-regexps): Hoist to eliminate warnings.

	* derived.el (define-derived-mode): Use {delay,run}-mode-hooks.
	(derived-mode-p): Autoload.

	* subr.el (delay-mode-hooks, delayed-mode-hooks, run-mode-hooks):
	New vars and functions.
	(text-clone-maintain, text-clone-create): New functions.

2001-10-25  Miles Bader  <miles@gnu.org>

	* facemenu.el (facemenu-add-new-face): Fix variable names.

2001-10-24  Richard M. Stallman  <rms@gnu.org>

	* facemenu.el (facemenu-unlisted-faces): Improve doc strings
	of t and nil values.
	(facemenu-set-face): Handle START and END interactively.
	(facemenu-set-foreground): Don't use a face; specify color directly.
	(facemenu-set-background): Likewise.
	(facemenu-set-face-from-menu): Doc fix.
	(facemenu-active-faces): Use face-attribute-vector
	to handle bare attributes not in faces.
	(facemenu-get-face): Don't handle face names fg:... and bg:...
	specially.
	(facemenu-add-new-face): New argument MENU.
	New way to handle adding colors to the color menus.

	* env.el (substitute-env-vars): Quote the arg to rx.

2001-10-24  Sam Steingold  <sds@gnu.org>

	* mouse.el (mouse-buffer-menu-mode-groups): Added "Version
	Control" and "SGML" groups.

2001-10-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-beginning-of-member-init-list):
	Better handling of C++ template args to avoid confusion with `<'
	and `>' used as operators in member init expressions.

2001-10-24  Gerd Moellmann  <gerd@gnu.org>

	* replace.el (perform-replace): Move START and END parameters
	to the end of the argument list and make them optional.

	* progmodes/ebrowse.el, progmodes/etags.el: Adapt to change in
	perform-replace.

	* international/fontset.el (x-must-resolve-font-name): New function.
	(x-complement-fontset-spec): Use it.

2001-10-23  Stefan Monnier  <monnier@cs.yale.edu>

	* uniquify.el (uniquify-get-proposed-name): Fix (.. "usr" "/usr" 0).

	* progmodes/compile.el (compile-mouse-goto-error, compile-goto-error):
	Turn caadr into caar of cdr.

2001-10-23  Gerd Moellmann  <gerd@gnu.org>

	* info.el (Info-fontify-node): Bind down-mouse-{1,2} instead
	of mouse-{1,2} since dragging is on the down event.

	* play/doctor.el (make-doctor-variables): Remove a '($ please)'.

	* mail/mh-utils.el (mh-recenter): Call `recenter' with arg t
	if ARG is nil.

	* desktop.el (desktop-last-buffer): New variable.
	(desktop-create-buffer): Set it.
	(desktop-read): Bind it and switch to that buffer.

2001-10-22  Gerd Moellmann  <gerd@gnu.org>

	* progmodes/compile.el (compilation-set-window-height):
	Select old window only if it's still live.

2001-10-22  Pavel Jan,Am(Bk  <Pavel@Janik.cz>

	* help-mode.el (help-buffer): Remove debugging code.
	From Stefan Monnier <monnier@cs.yale.edu>.

2001-10-22  Eli Zaretskii  <eliz@is.elta.co.il>

	* files.el (file-name-sans-extension, file-name-extension):
	Don't count the leading dots in file names as signaling an extension.

2001-10-22  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-diff-switches): Doc rewritten.

2001-10-22  Eli Zaretskii  <eliz@is.elta.co.il>

	* tooltip.el (tooltip-set-param): Doc fix.

	* textmodes/sgml-mode.el (sgml-mode-map): Bind 8-bit codes above
	127 to sgml-maybe-name-self.
	(sgml-name-8bit-mode): Doc fix.
	(sgml-char-names-table): New variable.
	(sgml-name-char): Support non-ASCII and mule-unicode-*
	characters.  Doc fix.
	(sgml-maybe-name-self): Convert unibyte characters to multibyte.

	* tooltip.el (tooltip-x-offset, tooltip-y-offset): Mention in the
	doc string the effect of `left' and `top' parameters in
	tooltip-frame-parameters, the default values, and the units.
	(tooltip-frame-parameters): Mention `top' and `left' in the doc string.
	(tooltip-show): Mention in the doc string the `top' and `left'
	parameters in tooltip-frame-parameters, and x-max-tooltip-size.

2001-10-22  Andre Spiegel  <spiegel@gnu.org>

	Add autoscaling support for vc-annotate.
	From J.D. Smith <jdsmith@alum.mit.edu>.

	* vc.el (vc-annotate-display-default): Accept colormap scaling
	ratio (now deprecated).
	(vc-annotate-display-autoscale): Added.
	(vc-annotate-add-menu): New autoscaling menu options "Span to
	Oldest" and "Span Oldest->Newest".  Easymenu support added for
	toggle menus driven by customize variable `vc-annotate-display-mode'.
	(vc-annotate-display-select): Added.
	(vc-annotate): Changed temp-buffer-show-function to
	`vc-annotate-display-select'.
	(vc-annotate-display): Removed arguments BUFFER and BACKEND.
	Added argument OFFSET.  Instead of backend function, calls now
	generic `vc-annotate-difference'.
	(vc-annotate-difference): Added as generic function instead of
	backend-specific function.  No longer takes argument POINT, but
	instead accepts a time OFFSET.
	(vc-default-annotate-current-time): Added.

	* vc-cvs.el (vc-cvs-annotate-difference): Removed to generic
	version in vc.el, with
	(vc-cvs-annotate-current-time): Added, as override of default.
	(vc-cvs-annotate-time): Added.  Taken mostly from the (now removed)
	`vc-cvs-annotate-difference'.

2001-10-22  Gerd Moellmann  <gerd@gnu.org>

	* saveplace.el (save-place): Require `saveplace'.

	* progmodes/cwarn.el (cwarn-font-lock-feature-keywords-alist):
	Use `sexp' for :value-type instead of `face'.

2001-10-21  Eli Zaretskii  <eliz@is.elta.co.il>

	* mail/rmailsum.el (rmail-summary-font-lock-keywords): Fix the
	regexps due to 5-digit message IDs.

2001-10-21  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (redisplay-dont-pause): Don't set.

2001-10-21  Miles Bader  <miles@gnu.org>

	* help-funs.el (help-manyarg-func-alist): Variable removed.

2001-10-21  Miles Bader  <miles@gnu.org>

	* help-funs.el (help-manyarg-func-alist): Remove entries for
	`insert', `insert-and-inherit', `insert-before-markers',
	`insert-before-markers-and-inherit', `message', `message-box',
	`message-or-box', `propertize', `format', `encode-time', `append',
	`concat', `vconcat', `nconc', `widget-apply', `make-hash-table',
	`insert-string', `ml-if', `ml-provide-prefix-argument', and
	`ml-prefix-argument-loop'.

2001-10-21  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-diff-internal, vc-coding-system-for-diff)
	(vc-default-diff-tree): New functions.
	(vc-version-diff): Use them.  As a result, coding systems are now
	set up properly for all sorts of diffs, and tree diffs can now
	also be done locally.
	(vc-diff): With a prefix argument, don't require that it's called
	from a buffer under version control.
	(diff-switches): Remove duplicate definition.

	* vc-cvs.el (vc-cvs-diff-tree): New function.

2001-10-21  Miles Bader  <miles@gnu.org>

	* help-funs.el (help-manyarg-func-alist): Remove entries for
	`list', `vector', `make-byte-code', `call-process',
	`call-process-region', `string', `+', `-', `*', `/', `max', `min',
	`logand', `logior', and `logxor'.

	* wid-edit.el (checkbox): Swap bg/fg colors in image, and invert
	image bits to compensate.  Use `make-string' instead of
	`make-bool-vector' (XBM apparently wants byte-aligned rows).

2001-10-20  Kim F. Storm  <storm@cua.dk>

	* simple.el (kill-ring-save): Don't show extent of copied region
	if using transient-mark-mode and region is fully visible.

See ChangeLog.9 for earlier changes.

;; Local Variables:
;; coding: iso-2022-7bit
;; End:

    Copyright (C) 2001, 2002 Free Software Foundation, Inc.
  Copying and distribution of this file, with or without modification,
  are permitted provided the copyright notice and this notice are preserved.
