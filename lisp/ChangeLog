2004-09-03  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): Bind `buffer-read-only'
	locally around the call to `revert-buffer'.

2004-09-03  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-toggle-regexp): Set `isearch-success' and
	`isearch-adjusted' to `t'.
	(isearch-toggle-case-fold): Set `isearch-success' to `t'.
	(isearch-message-prefix): Add "pending" for isearch-adjusted.
	(isearch-other-meta-char): Restore isearch-point unconditionally.
	(isearch-query-replace): Add new arg `regexp-flag' and use it.
	Set point to start of match if region is not active in transient
	mark mode (to include the current match to region boundaries).
	Push the search string to `query-replace-from-history-variable'.
	Add prompt "Query replace regexp" for isearch-regexp.
	Add region beginning/end as last arguments of `perform-replace.'
	(isearch-query-replace-regexp): Replace code by the call to
	`isearch-query-replace' with arg `t'.

2004-09-03  Richard M. Stallman  <rms@gnu.org>

	* startup.el (normal-top-level): Undo previous TERM change.

2004-09-03  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-rect.el (cua--overlay-keymap): New keymap for
	highlight overlays; allow using RET when cursor is over a button.
	(cua--highlight-rectangle): Use it.
	(cua--rectangle-set-corners): Don't move backwards at eol.
	(cua--forward-line): Don't move into void after eob.

	* emulation/cua-rect.el (cua--rectangle-set-corners): Ensure that
	point is set (and displayed) inside rectangle.
	(cua--rectangle-operation): Fix for highlight of empty lines.
	(cua--highlight-rectangle): Fix highlight for tabs.
	Position cursor at left/right edge of rectangle using new `cursor'
	property on overlay strings.
	(cua--indent-rectangle): Don't tabify.
	(cua-rotate-rectangle): Ignore that point has moved.

2004-09-02  YAMAMOTO Mitsuharu  <mituharu@math.s.chiba-u.ac.jp>

	* term/mac-win.el: Add ASCII equivalents for some function keys.
	(mode-line-frame-identification): Sync with x-win.el.

2004-09-02  Juri Linkov  <juri@jurta.org>

	* progmodes/compile.el (compilation-buffer-name): Compare major
	mode with second element of compilation-arguments instead of third
	to reflect latest changes in compilation-arguments structure.
	(recompile): Use global variable `compilation-directory' to get
	recent compilation directory only when `recompile' is invoked NOT
	in the compilation buffer.  Otherwise, use `default-directory' of
	the compilation buffer.
	(compilation-error-properties): Allow to funcall col and end-col.
	(compilation-mode-font-lock-keywords): Check col and end-col by
	`integerp'.
	(compilation-goto-locus): If end-mk is non-nil in transient mark
	mode don't activate the mark (and don't display message in
	push-mark), but highlight overlay between mk and end-mk.

	* progmodes/grep.el (grep-highlight-matches): New defcustom.
	(grep-regexp-alist): Add rule to highlight grep matches.
	(grep-process-setup): Set env-vars GREP_OPTIONS and GREP_COLOR.

	* info.el (Info-fontify-node): Don't compute other-tag
	if Info-hide-note-references=hide.

	* help.el (function-called-at-point):
	* help-fns.el (variable-at-point):
	Try `find-tag-default' when other methods failed.

	* emacs-lisp/lisp.el (beginning-of-defun, end-of-defun):
	Do not push mark if inhibit-mark-movement is non-nil.

	* textmodes/ispell.el (ispell-html-skip-alists):
	Fix backslashes in docstring.

2004-09-01  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-wrap-function)
	(isearch-push-state-function): New defvars.
	(isearch-pop-fun-state): New defsubst.
	(isearch-top-state): Call function saved in `isearch-pop-fun-state'.
	(isearch-push-state): Set the result of calling
	`isearch-push-state-function' to the `isearch-pop-fun-state' field.
	(isearch-cancel): Call function saved in `isearch-pop-fun-state' to
	restore the mode-specific starting point of terminated search.
	(isearch-abort): Call `isearch-cancel' instead of its duplicated code.
	(isearch-repeat): Call `isearch-wrap-function' if defined.
	(isearch-message-prefix): Don't add prefix "over" to the message
	for wrapped search if `isearch-wrap-function' is defined.
	(isearch-search): Call function saved in `isearch-pop-fun-state' to
	restore the mode-specific starting point of failed search.

	* info.el (Info-search-whitespace-regexp): Fix backslashes.
	(Info-search): Add new optional arguments for the sake of isearch.
	Replace whitespace in Info-search-whitespace-regexp literally.
	Add backward search.  Don't call `Info-select-node' if regexp is
	found in the same Info node.  Don't add node to Info-history for
	wrapped isearch.
	(Info-search-backward, Info-isearch-search, Info-isearch-wrap)
	(Info-isearch-push-state, Info-isearch-pop-state): New funs.
	(Info-mode): Set local variables `isearch-search-fun-function',
	`isearch-wrap-function', `isearch-push-state-function',
	`search-whitespace-regexp'.

	* isearch.el: Remove ancient Change Log section.
	(isearch-string, isearch-message-string, isearch-point)
	(isearch-success, isearch-forward-flag, isearch-other-end)
	(isearch-word, isearch-invalid-regexp, isearch-wrapped)
	(isearch-barrier, isearch-within-brackets)
	(isearch-case-fold-search): Add suffix `-state' to state-related
	defsubsts to avoid name clashes with other function names.

	* simple.el (next-error): New defgroup and defface.
	(next-error-highlight, next-error-highlight-no-select):
	New defcustoms.
	(next-error-no-select): Let-bind next-error-highlight to the value
	of next-error-highlight-no-select before calling `next-error'.

	* progmodes/compile.el (compilation-goto-locus):
	Use `next-error' face instead of `region'.  Set 4-th argument of
	`move-overlay' to `current-buffer' to move overlay to different
	source buffers.  Use new variable `next-error-highlight'.

	* simple.el (next-error-find-buffer): Move the rule
	"if current buffer is a next-error capable buffer" after the
	rule "if next-error-last-buffer is set to a live buffer".
	Simplify to test all rules in one `or'.
	(next-error): Doc fix.
	(next-error, previous-error, first-error)
	(next-error-no-select, previous-error-no-select):
	Make arguments optional.

2004-08-31  Luc Teirlinck  <teirllm@auburn.edu>

	* macros.el (apply-macro-to-region-lines): Make it operate on all
	lines that begin in the region, rather than on all complete lines
	in the region.

2004-08-31  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-protocol-alist): Document update.
	(x-dnd-known-types): Defcustom it.
	(x-dnd-handle-motif): Print message-atom in error message.

2004-08-30  John Paul Wallington  <jpw@gnu.org>

	* textmodes/tex-mode.el (tex-validate-buffer): Use distinct
	strings rather than programatically constructing message.

2004-08-30  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (prin1-char): Don't turn S-a into A.
	Don't return a string that would read as the wrong character code.

2004-08-29  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua-auto-expand-rectangles): Remove
	automatic rectangle padding feature; replace by non-destructive
	virtual rectangle edges feature.
	(cua-virtual-rectangle-edges): New defcustom.
	(cua-auto-tabify-rectangles): New defcustom.
	(cua-paste): If paste into a marked rectangle, insert rectangle at
	current column, even if virtual; also paste exactly as many lines
	as has been marked (ignore additional lines or add empty lines),
	but paste whole source if only one line is marked.
	(cua--update-indications): No longer use overwrite-cursor to
	indicate rectangle padding

	* emulation/cua-rect.el (cua--rectangle-padding): Remove.
	(cua--rectangle-virtual-edges): New defun.
	(cua--rectangle-get-corners): Remove optional PAD arg.
	(cua--rectangle-set-corners): Never do padding.
	(cua--forward-line): Remove optional PAD arg.  Simplify.
	(cua-resize-rectangle-right, cua-resize-rectangle-left)
	(cua-resize-rectangle-down, cua-resize-rectangle-up):
	(cua-resize-rectangle-bot, cua-resize-rectangle-top)
	(cua-resize-rectangle-page-up, cua-resize-rectangle-page-down)
	(cua--rectangle-move): Never do padding.  Simplify.
	(cua--tabify-start): New defun.
	(cua--rectangle-operation): Add tabify arg.  All callers changed.
	(cua--pad-rectangle): Remove.
	(cua--delete-rectangle): Handle delete with virtual edges.
	(cua--extract-rectangle): Add spaces if rectangle has virtual edges.
	(cua--insert-rectangle): Handle insert at virtual column.
	Perform auto-tabify if necessary.
	(cua--activate-rectangle): Remove optional FORCE arg.
	Never do padding.  Simplify.
	(cua--highlight-rectangle): Enhance for virtual edges.
	(cua-toggle-rectangle-padding): Remove command.
	(cua-toggle-rectangle-virtual-edges): New command.
	(cua-sequence-rectangle): Add optional TABIFY arg.  Callers changed.
	(cua--rectangle-post-command): Don't force rectangle padding.
	(cua--init-rectangles): Bind M-p to cua-toggle-rectangle-virtual-edges.

2004-08-28  Luc Teirlinck  <teirllm@auburn.edu>

	* indent.el (edit-tab-stops-buffer): Doc fix.

2004-08-28  Richard M. Stallman  <rms@gnu.org>

	* progmodes/grep.el (grep-default-command): Use find-tag-default.
	(grep-tag-default): Function deleted.

	* subr.el (find-tag-default): Moved from etags.el.

	* progmodes/etags.el (find-tag-default): Moved to subr.el.

	* emacs-lisp/lisp-mode.el (prin1-char): Put `shift' modifier
	into the basic character if it has an uppercase form.

2004-08-27  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (utf-8-post-read-conversion): If the
	buffer is unibyte, temporarily make it multibyte.

2004-08-27  Masatake YAMATO  <jet@gyve.org>

	* calendar/time-date.el (time-to-seconds): Add autoload cookies.

2004-08-25  John Paul Wallington  <jpw@gnu.org>

	* textmodes/tex-mode.el (tex-validate-buffer): Distinguish between
	0, 1, and many mismatches in message.
	(tex-start-shell): Use `set-process-query-on-exit-flag'.

	* ielm.el (ielm-tab, ielm-complete-symbol): Doc fix.
	(inferior-emacs-lisp-mode): Use	`set-process-query-on-exit-flag'.

2004-08-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-svn.el (vc-svn-diff): Treat options from vc-svn-diff-switches and
	vc-diff-switches differently.

2004-08-22  Luc Teirlinck  <teirllm@auburn.edu>

	* speedbar.el (speedbar-file-regexp): Give it a phony defvar
	before and a real defvar after
	`speedbar-supported-extension-expressions'.  This is to silence
	the compiler without breaking bootstrapping.

2004-08-22  Richard M. Stallman  <rms@gnu.org>

	* textmodes/flyspell.el (flyspell-word):
	Use set-process-query-on-exit-flag.
	(flyspell-highlight-duplicate-region): Take POSS as arg.
	(flyspell-word): Pass POSS as arg.

	* progmodes/ada-xref.el: Many doc and style fixes.
	(ada-find-any-references): Use compilation-start.
	(ada-get-ali-file-name): Improve error msg.
	(ada-get-ada-file-name): Likewise.

	* net/ange-ftp.el (ange-ftp-gwp-start, ange-ftp-nslookup-host)
	(ange-ftp-start-process): Use set-process-query-on-exit-flag.

	* mail/mail-extr.el (mail-extr-all-top-level-domains):
	Add forward defvar.

	* whitespace.el (global-whitespace-mode): New alias
	for whitespace-global-mode.

	* speedbar.el (speedbar-file-regexp): Definition moved up.
	(speedbar-mode, speedbar-set-mode-line-format):
	Use with-no-warnings.
	(speedbar-emacs-popup-kludge): Delete Emacs 19 alternative.

	* simple.el (shell-command-on-region): New arg DISPLAY-ERROR-BUFFER
	controls whether to display the error buffer.

	* ps-mule.el: Delete compatibility code for old Emacses.
	(ps-mule-find-wrappoint): Don't use chars-in-region.

	* frame.el (display-mouse-p, display-selections-p):
	Use with-no-warnings.

	* font-lock.el (font-lock-set-defaults): Use with-no-warnings.

2004-08-22  David Kastrup  <dak@gnu.org>

	* textmodes/reftex-auc.el, progmodes/meta-mode.el: Update AUCTeX
	information.

	* speedbar.el, iswitchb.el, ido.el: Update AUCTeX information.

2004-08-22  Andreas Schwab  <schwab@suse.de>

	* cvs-status.el: Require pcvs during byte-compiling for defun-cvs-mode.

2004-08-22  Masatake YAMATO  <jet@gyve.org>

	* cvs-status.el (cvs-status-checkout): New function.
	(cvs-status-mode-map): Add a key definition for `cvs-status-checkout'.

2004-08-21  David Kastrup  <dak@gnu.org>

	* net/ange-ftp.el (ange-ftp-hash-entry-exists-p)
	(ange-ftp-file-entry-p, ange-ftp-file-symlink-p): Since the code
	has been converted to use hashtables, the relation `nil=none' is
	no longer valid, as `nil' is not a hashtable.  This patch tries to
	reduce the number of resulting errors.

2004-08-21  John Paul Wallington  <jpw@gnu.org>

	* subr.el (process-kill-without-query): Made obsolete in
	version	21.4, not 21.5.

	* log-edit.el (vc-comment-ring, vc-comment-ring-index)
	(vc-previous-comment, vc-next-comment)
	(vc-comment-search-reverse, vc-comment-search-forward)
	(vc-comment-to-change-log): Likewise.

	* international/latin1-disp.el (latin1-char-displayable-p): Likewise.

2004-08-21  Peter Seibel  <peter@javamonkey.com>  (tiny patch)

	* emacs-lisp/cl-indent.el (lisp-indent-defmethod):
	Correct indentation of DEFMETHODS with non-standard method
	combinations (e.g., PROGN, MIN, MAX).

2004-08-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* startup.el (normal-top-level-add-subdirs-to-load-path):
	Avoid unnecessarily checking system-type.
	(normal-top-level): Set TERM to "dumb".  Simplify.

	* avoid.el (mouse-avoidance-ignore-p): New fun.
	Also ignore switch-frame, select-window, double, and triple clicks.
	(mouse-avoidance-banish-hook, mouse-avoidance-exile-hook)
	(mouse-avoidance-fancy-hook): Use it.

2004-08-20  Zoran Milojevic  <zoran@sipquest.com>  (tiny change)

	* avoid.el (mouse-avoidance-nudge-mouse)
	(mouse-avoidance-banish-destination): Stay within the current window
	to avoid problems with mouse-autoselect-window.

2004-08-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-parse.el (cvs-parse-table, cvs-parse-commit): Try to adapt to
	the newer format of some messages in cvs-1.12.1.

2004-08-19  Masatake YAMATO  <jet@gyve.org>

	* emacs-lisp/elp.el (elp-results-symname-map): New keymap.
	(elp-results-jump-to-definition-by-mouse)
	(elp-results-jump-to-definition, elp-output-insert-symname): New funs.
	(elp-output-result): Use elp-output-insert-symname.

2004-08-18  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el: Register koi8-r in
	ctext-non-standard-encodings-alist.
	("Cyrillic-KOI8"): Add ctext-non-standard-encoding.

2004-08-17  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/copyright.el (copyright-update-year): Delete code
	that replaces 20xy with xy.

2004-08-17  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/re-builder.el (reb-mode-map): Define within defvar.
	(reb-force-update): Doc fix.

2004-08-16  Richard M. Stallman  <rms@gnu.org>

	* progmodes/which-func.el (which-func-update-1): Doc fix.

	* progmodes/sh-script.el (sh-set-shell): Use sh-mode-abbrev-table.
	(sh-mode-abbrev-table): New variable.

	* progmodes/compile.el (compilation-mode): Doc fix.

	* emacs-lisp/lisp-mode.el (eval-last-sexp):
	Don't cons a new symbol each time.
	(eval-last-sexp-fake-value): New variable.

	* emacs-lisp/copyright.el (copyright-years-regexp): New variable.
	(copyright-update-year): Detect continuation of list of years.

	* term.el (term-default-fg-color, term-default-bg-color)
	(ansi-term-color-vector): Use `unspecified', not nil, as default.

	* imenu.el: Several doc fixes: don't say variables are buffer-local.

2004-08-16  Davis Herring <herring@lanl.gov>

	* isearch.el (isearch-string, isearch-message-string, isearch-point)
	(isearch-success, isearch-forward-flag, isearch-other-end)
	(isearch-word, isearch-invalid-regexp, isearch-wrapped)
	(isearch-barrier, isearch-within-brackets)
	(isearch-case-fold-search): Fix broken `nth'-like calls to `aref'.

2004-08-16  Kenichi Handa  <handa@m17n.org>

	* ps-mule.el (ps-mule-font-info-database): Fix docstring.

2004-08-15  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): If utf8 was successful but
	ctext was not, use utf8 string.

2004-08-14  Davis Herring  <herring@lanl.gov>

	* isearch.el: Remove accidental changes of March 4.  Fix backing
	up when a regexp isearch is made more general.  Use symbolic
	accessor functions for isearch stack frames to make usage clearer.
	(search-whitespace-regexp): Made groups in documentation shy (as
	is the group in the default value).
	(isearch-fallback): New function, addresses problems with regexps
	liberalized by `\|', adds support for liberalization by `\}' (the
	general repetition construct), and incorporates behavior for
	`*'/`?'.
	(isearch-}-char): New command, calls `isearch-fallback' with
	arguments appropriate to a typed `}'.
	(isearch-*-char, isearch-|-char): Now just call `isearch-fallback'
	appropriately.
	(isearch-mode-map): Bind `}' to `isearch-}-char'.
	(isearch-string, isearch-message,string, isearch-point)
	(isearch-success, isearch-forward-flag, isearch-other-end)
	(isearch-word, isearch-invalid-regexp, isearch-wrapped)
	(isearch-barrier, isearch-within-brackets, isearch-case-fold-search):
	New inline functions to read fields of a stack frame.

2004-08-14  Kurt Hornik  <Kurt.Hornik@wu-wien.ac.at>  (tiny change)

	* battery.el (battery-linux-proc-acpi): Look into battery
	directories matching the literal string "CMB", too (required for
	Linux kernel version 2.6.7).

2004-08-14  John Paul Wallington  <jpw@gnu.org>

	* cus-start.el (read-file-name-completion-ignore-case): Add.
	(blink-cursor-alist): Change version to "21.4".

	* emacs-lisp/bytecomp.el (forward-word): Allow 0 args.

2004-08-11  Daniel Pfeiffer  <occitan@esperanto.org>

	* speedbar.el (speedbar-scan-subdirs): New option.
	(speedbar-file-lists): Don't ignore file-name case on Unix and use
	dolist.
	(speedbar-insert-files-at-point): Take an extra argument and use
	it to optionally find out if a subdir is empty.  Also unreadable
	files don't get expand buttons.
	(speedbar-directory): New image (unused pixmap already existed).
	(speedbar-expand-image-button-alist): Use it.

2004-08-11  Martin Stjernholm  <bug-cc-mode@gnu.org>

	CC Mode update to 5.30.9:

	* progmodes/cc-defs.el, progmodes/cc-vars.el (c-emacs-features):
	Move from cc-vars to cc-defs for dependency reasons.  Fix the
	POSIX char class test to check that it works in
	`skip-chars-(forward|backward)' too.

	* progmodes/cc-align.el (c-lineup-arglist): Fix bug when the
	first argument starts with a special brace list.

	* progmodes/cc-engine.el (c-forward-type): Fix promotion bug
	when `c-opt-type-concat-key' is used (i.e. in Pike).

	* progmodes/cc-engine.el (c-looking-at-special-brace-list):
	Fix bug when the inner char pair doesn't have paren syntax, i.e. "(<
	>)".

	* progmodes/cc-align.el (c-lineup-multi-inher): Made it syntactic
	whitespace safe.

	* progmodes/cc-engine.el (c-guess-basic-syntax): Fix anchor
	position for `arglist-intro', `arglist-cont-nonempty' and
	`arglist-close' when there are two arglist open parens on the same
	line and there's nothing in front of the first.

	* progmodes/cc-fonts.el (c-basic-matchers-before): Fix font
	locking of qualified names in Java, which previously could fontify
	common indexing expressions in many cases.  The standard Java
	naming conventions are used to tell them apart.

	* progmodes/cc-align.el (c-lineup-whitesmith-in-block):
	Fix inconsistency wrt opening parens on the first line inside a paren
	block.

	* progmodes/cc-defs.el (c-langs-are-parametric): Must be known at
	compile time for the sake of `c-major-mode-is'.

	(c-mode-is-new-awk-p): Made it a macro to delay expansion of
	`c-major-mode-is' in the event that this is used inside a
	`c-lang-defconst'.

	* progmodes/cc-defs.el (c-major-mode-is): Fix expansion inside
	`c-lang-defconst' so that it works better with fallback languages.

	* progmodes/cc-defs.el (c-add-language): Fix a typo that caused
	it to fail to record the base mode.

	* progmodes/cc-engine.el (c-syntactic-re-search-forward):
	Fix bug so that it doesn't go past the closing paren when PAREN-LEVEL
	is used.  Reordered the syntax checks to get more efficient
	skipping in some situations.

	* progmodes/cc-cmds.el (c-electric-brace): Don't trip up on a line
	continuation which might precede the newly inserted '{'.

	* progmodes/cc-engine.el (c-syntactic-re-search-forward):
	Fix cases where it could loop indefinitely.

	* progmodes/cc-fonts.el (c-font-lock-declarators): Handle array
	size specs correctly.  Only fontify identifiers in front of '('
	with as functions - don't accept any paren char.  Tightened up
	initializer skipping to stop before function and class blocks.

	* progmodes/cc-engine.el (c-beginning-of-decl-1): Fix bug where
	the point could be left directly after an open paren when finding
	the beginning of the first decl in the block.

	* progmodes/cc-engine.el (c-parse-state): Don't use the syntax
	table when filtering out legitimate open parens to be recorded.
	This could cause cache inconsistencies when e.g.
	`c++-template-syntax-table' was temporarily in use.

	* progmodes/cc-engine.el (c-on-identifier)
	(c-simple-skip-symbol-backward): Small fix for handling "-"
	correctly in `skip-chars-backward'.  Affected the operator lfun
	syntax in Pike.

	* progmodes/cc-engine.el (c-invalidate-sws-region-after):
	Fix bug that could cause an error from `after-change-functions' when
	the changed region is at bob.

2004-08-11  Alan Mackenzie  <bug-cc-mode@gnu.org>

	CC Mode update to 5.30.9:

	* progmodes/cc-cmds.el, progmodes/cc-vars.el: Amend doc(-strings)
	to say that <TAB> doesn't insert WS into a CPP line.
	(c-indent-command, c-tab-always-indent): Amend doc strings.

	* progmodes/cc-styles.el, progmodes/cc-engine.el: Add in two
	checks for user errors, thus eliminating cryptic and unhelpful
	Emacs error messages.  (1) Check the arg to `c-set-style' is a
	string.  (2) Check that settings to `c-offsets-alist' are not
	spuriously quoted.

	* progmodes/cc-cmds.el: (c-electric-brace): Don't delete a comment
	which precedes the newly inserted `{'.

2004-08-10  Michael Albinus  <michael.albinus@gmx.de>

	Sync with Tramp 2.0.44.

	* net/tramp.el (tramp-post-connection): Quote $1 and $2 of shell
	function "tramp_file_attributes".  Otherwise, file names
	containing spaces are misinterpreted.  Reported by Magnus Henoch
	<mange@freemail.hu>.
	(tramp-handle-file-truename): FILENAME must be expanded first.
	Otherwise, parameters like "/ssh:deego@gnufans.net:~" will return
	obscure results.  Reported by D. Goel <deego@gnufans.org>.
	(tramp-handle-verify-visited-file-modtime): If file does not
	exist, say it is not modified if and only if that agrees with the
	buffer's record.  Check whether a file is visiting the buffer, or
	the buffer has no recorded last modification time.  Return t in
	case the visiting file doesn't exist.  Suggested by Luc Teirlinck
	<teirllm@auburn.edu>.
	(tramp-handle-write-region): Pass modtime explicitely to
	`set-visited-file-modtime', because filename can be different
	from (buffer-file-name) if `file-precious-flag' is set.
	`set-visited-file-modtime' must be called always when `visit' is t
	or a string.  Suggested by Luc Teirlinck <teirllm@auburn.edu>.
	(tramp-handle-set-visited-file-modtime): If `time-list' is not
	nil, don't apply the whole body.  If the file doesn't exists, set
	modtime to '(-1 65535).  Suggested by Luc Teirlinck
	<teirllm@auburn.edu>.

2004-08-09  Luc Teirlinck  <teirllm@auburn.edu>

	* help.el (describe-bindings): Doc fix.

	* subr.el (kbd): Doc fix.

2004-08-08  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (define-ibuffer-column size): Use `string-to-number'
	instead of `string-to-int'.
	(define-ibuffer-column mode): Fix indentation.

2004-08-08  Lars Hansen  <larsh@math.ku.dk>

	* wid-edit.el (widget-sexp-validate): Allow whitespace after expression.

2004-08-08  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (global-unset-key, local-unset-key): Doc fixes.

	* novice.el (disabled-command-function): New variable renamed from
	`disabled-command-hook'.
	(disabled-command-hook): Keep the _variable_ as alias for
	`disabled-command-function' and make obsolete.
	(disabled-command-function): Function renamed from
	`disabled-command-hook'.  Adapt code to name change of the variable.

2004-08-07  Satyaki Das  <satyaki@theforce.stanford.edu>  (tiny change)

	* simple.el (completion-root-regexp): New defvar.
	(completion-setup-function): Use it instead of a literal string.

2004-08-07  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/re-builder.el (reb-re-syntax): Add `rx' syntax.
	(reb-lisp-mode): Require `rx' feature when `re-reb-syntax' is `rx'.
	(reb-lisp-syntax-p, reb-change-syntax): `rx' is a Lisp syntax.
	(reb-cook-regexp): Call `rx-to-string' when `re-reb-syntax' is `rx'.

2004-08-05  Katsumi Yamaoka  <yamaoka@jpl.org>  (tiny change)

	* mail/mail-extr.el (mail-extr-disable-voodoo): New variable.
	(mail-extr-voodoo): Check mail-extr-disable-voodoo.

2004-08-04  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el (encoded-kbd-setup-keymap):
	Fix previous change.

2004-08-03  Kenichi Handa  <handa@m17n.org>

	* international/encoded-kb.el: The following changes are to
	utilize key-translation-map instead of minor mode map.
	(encoded-kbd-iso2022-non-ascii-map): Delete it.
	(encoded-kbd-coding, encoded-kbd-handle-8bit): Delete them.
	(encoded-kbd-last-key): New function.
	(encoded-kbd-iso2022-single-shift): New function.
	(encoded-kbd-iso2022-designation)
	(encoded-kbd-self-insert-iso2022-7bit)
	(encoded-kbd-self-insert-iso2022-8bit)
	(encoded-kbd-self-insert-sjis, encoded-kbd-self-insert-big5)
	(encoded-kbd-self-insert-ccl): Make them suitable for bindings in
	key-translation-map.
	(encoded-kbd-setup-keymap): Setup key-translation-map.
	(saved-key-translation-map): New variable.
	(encoded-kbd-mode): Save/restore key-translation-map.  Adjusted
	for the change of encoded-kbd-setup-keymap.

2004-08-02  Kim F. Storm  <storm@cua.dk>

	* avoid.el (mouse-avoidance-point-position): Use window-inside-edges
	and call compute-motion with nil for topos and width to get proper
	usable width and height for both window and non-window systems.

	* windmove.el (windmove-coordinates-of-position): Let compute-motion
	calculate usable window width and height.

	* window.el (window-buffer-height): Call compute-motion with nil width.

2004-08-01  David Kastrup  <dak@gnu.org>

	* replace.el (query-replace-read-from):
	Use `query-replace-compile-replacement'.
	(query-replace-compile-replacement): New function.
	(query-replace-read-to): Use `query-replace-compile-replacement'
	for repeating the last command.

2004-08-01  John Paul Wallington  <jpw@gnu.org>

	* printing.el (toplevel, pr-ps-fast-fire, pr-ps-set-utility)
	(pr-ps-set-printer, pr-txt-set-printer, pr-eval-setting-alist)
	(pr-switches): Remove period from end of error messages.

	* help-mode.el (help-go-back): Likewise.

	* abbrev.el (only-global-abbrevs): Doc fix.
	(edit-abbrevs-map): Define within defvar.
	(quietly-read-abbrev-file): Doc fix.

2004-07-31  Luc Teirlinck  <teirllm@auburn.edu>

	* novice.el (enable-command, disable-command): Doc fixes.

	* subr.el (event-modifiers, event-basic-type): Doc fixes.

2004-07-30  Richard M. Stallman  <rms@gnu.org>

	* subr.el (with-local-quit): Doc fix.

2004-07-30  Luc Teirlinck  <teirllm@auburn.edu>

	* international/utf-8.el (utf-translate-cjk-mode): Doc fix.

2004-07-28  Luc Teirlinck  <teirllm@auburn.edu>

	* custom.el (defcustom): Doc fix.

2004-07-28  Masatake YAMATO  <jet@gyve.org>

	* progmodes/etags.el (etags-tags-apropos): Show building progress.

2004-07-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* imenu.el (imenu-prev-index-position-function)
	(imenu-extract-index-name-function, imenu-name-lookup-function)
	(imenu--index-alist): Docstring redundancy fix.

2004-07-25  Lars Hansen  <larsh@math.ku.dk>

	* wdired.el (wdired-finish-edit): Require dired-aux before locally
	binding dired-backup-overwrite.

2004-07-25  John Paul Wallington  <jpw@gnu.org>

	* subr.el (butlast, event-modifiers, event-basic-type): Doc fixes.

2004-07-24  Luc Teirlinck  <teirllm@auburn.edu>

	* term/tty-colors.el (tty-color-approximate): Doc fix.

	* select.el (x-get-selection, x-set-selection): Doc fixes.

	* frame.el (make-frame): Doc fix.

2004-07-24  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-mime-charset-pattern):
	Don't include semicolon in the charset value.

	* replace.el (occur-next-error): Call set-window-point.
	(occur-engine): Handle negative NLINES.

2004-07-23  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (modify-all-frames-parameters): Minor doc fix.
	(set-frame-configuration): Doc fix.

2004-07-23  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* simple.el (completion-setup-function): Compute the common parts
	and the first difference place correctly when
	partial-completion-mode is on.

2004-07-22  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Doc fix.
	(ps-print-version): New version 6.6.5.
	(ps-printing-region): Doc fix.
	(ps-generate-string-list): Comment fix.
	(ps-message-log-max): Code fix.

2004-07-22  Michael Piotrowski  <mxp@dynalabs.de>  (tiny change)

	* ps-print.el (ps-begin-file): Improve the DSC compliance of the
	generated PostScript.

2004-08-17  Reiner Steib  <Reiner.Steib@gmx.de>

	* net/tls.el (tls-process-connection-type): Fix docstring.  (Sync
	with Gnus v5_10 branch.)

2004-08-16  Reiner Steib  <Reiner.Steib@gmx.de>

	* calendar/time-date.el (time-to-number-of-days): New function.
	Imported from from Gnus.

2004-07-22  Kim F. Storm  <storm@cua.dk>

	* progmodes/make-mode.el: Fix comments.

2004-07-21  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.

2004-07-20  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (modify-all-frames-parameters): Minor doc fix.

2004-07-20  Richard M. Stallman  <rms@gnu.org>

	* textmodes/fill.el (fill-nobreak-p): If this break point is
	at the end of the line, don't consider the newline which follows
	as a reason to return t.

2004-07-19  John Paul Wallington  <jpw@gnu.org>

	* dired-aux.el (dired-file-set-difference): Don't use `caddr'.

2004-07-18  Luc Teirlinck  <teirllm@auburn.edu>

	* dired-aux.el (dired-do-kill-lines): Expand docstring.
	Delete irrelevant code.

2004-07-17  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* net/tramp.el (tramp-handle-verify-visited-file-modtime):
	New docstring.  From Luc Teirlinck.

2004-07-17  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el: Describe `Auto Revert Tail Mode' in `Commentary'
	section.
	(auto-revert-handler): Do not check `auto-revert-tail-mode' for
	non-file buffers.  We know it is nil.

2004-07-17  Kai Grossjohann  <kai.grossjohann@gmx.net>

	Sync with Tramp 2.0.43.

	* net/tramp.el (tramp-handle-verify-visited-file-modtime): Remove
	outdated comment.
	(tramp-locked, tramp-locker): New variables for implementing a
	global lock.
	(tramp-sh-file-name-handler): Use them to implement the global
	lock.

2004-07-13  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp.el (all): Code cleanup.  Change all `tramp-handle-xxx'
	calls to respective `xxx` calls.
	(tramp-process-alive-regexp): Precise doc string.
	(tramp-multi-action-process-alive): New defun.
	(tramp-multi-actions): Use it.
	(tramp-handle-find-backup-file-name): `copy-tree' is available
	since Emacs 21.4 only (XEmacs has it).  Implementation rewritten
	in order to avoid this function.
	(tramp-handle-write-region): Set current buffer.  If connection
	wasn't open, `file-modes' has changed it accidently.  Reported by
	David Kastrup <dak@gnu.org>.
	(tramp-enter-password, tramp-read-passwd): New arguments USER and
	HOST.
	(tramp-action-password, tramp-multi-action-password): Apply it.
	(tramp-open-connection-rsh): If a port is given, the Tramp buffer
	name must still contain the port number.  Otherwise, we have two
	Tramp buffers, with all the confusion.  Reported by Myron Selby
	<myron@xytech.com> and Rolf Dubitzky
	<Dubitzky@physi.uni-heidelberg.de>.

	* net/tramp-smb.el (tramp-smb-open-connection): Apply USER and
	HOST to `tramp-enter-passwd'.

	* net/tramp-vc.el (all): Code cleanup.  Change all
	`tramp-handle-xxx' calls to respective `xxx` calls.

2004-07-17  Jonathan Yavner  <jyavner@member.fsf.org>

	* emacs-lisp/testcover.el: New category "potentially-1valued" for
	functions that are not erroneous if either 1-valued or
	multi-valued.  Detect functions in this class.
	(testcover-1value-functions, testcover-compose-functions,
	testcover-progn-functions) Added some additional functions to lists.
	(testcover-mark): Bugfix when marking up the definition for an
	empty function.

2004-07-17  Richard M. Stallman  <rms@gnu.org>

	* replace.el (occur-read-primary-args): Pass default to read-from-minibuffer.

	* mail/footnote.el (footnote-section-tag): Use defcustom.

	* font-lock.el (font-lock-add-keywords, font-lock-remove-keywords):
	Compile font-lock-keywords, not KEYWORDS.
	(lisp-font-lock-keywords-2): Add multiple-value-prog1, go.
	Add warn, check-type.  Handle cerror like error.

2004-07-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/which-func.el (which-func-keymap): New var.
	(which-func-face): New face.
	(which-func-format): Use them.

2004-07-16  Stephan Stahl  <stahl@eos.franken.de>  (tiny change)

	* buff-menu.el (list-buffers-noselect): Append the buffer's
	process status to its mode name.

2004-07-16  Kim F. Storm  <storm@cua.dk>

	* simple.el (inhibit-mark-movement): New defvar.
	(beginning-of-buffer, end-of-buffer): Do not push mark if
	inhibit-mark-movement is non-nil or C-u prefix is given.

	* emulation/cua-base.el (cua--preserve-mark-commands): New defvar.
	Init to beginning-of-buffer and end-of-buffer.
	(cua--undo-push-mark): New defvar.
	(cua--pre-command-handler): Set inhibit-mark-movement if mark is
	already active and command is in cua--preserve-mark-commands.
	Also fix check for shift modifier on non-window systems.
	(cua--post-command-handler): Clear inhibit-mark-movement if set.

2004-07-14  Luc Teirlinck  <teirllm@auburn.edu>

	* calendar/cal-dst.el (calendar-time-from-absolute): Return a list
	of two integers, instead of a cons.

	* net/tramp.el (tramp-handle-verify-visited-file-modtime):
	`visited-file-modtime' now returns a list of two integers, instead
	of a cons.

	* dired.el (dired-directory-changed-p): Ditto.

	* progmodes/grep.el (grep): Doc fix.

2004-07-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* autorevert.el (auto-revert-tail-mode)
	(auto-revert-tail-mode-text, auto-revert-tail-pos): New vars.
	(auto-revert-mode): Turn off auto-revert-tail-mode, so we're not
	in both at the same time.
	(auto-revert-tail-mode): New command.
	(turn-on-auto-revert-tail-mode, auto-revert-tail-handler): New funs.
	(auto-revert-handler): Revert only either tail or whole file.

	* bindings.el (mode-line-mode-menu): Fix alphabetical ordering and
	add auto-revert-tail-mode.

2004-07-12  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  Change name of some funs.
	(pr-dosify-file-name): New fun.  Replace ps-dosify-path.
	(pr-unixify-file-name): New fun.  Replace ps-unixify-path.
	(pr-standard-file-name): New fun.  Replace pr-standard-path.
	(pr-call-process): Code fix.

2004-07-12  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (with-selected-window): Doc fix.

2004-07-11  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (get-buffer-window-list): Doc fix.

2004-07-10  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (switch-to-buffer-other-window): Doc fix.

	* window.el (save-selected-window, one-window-p)
	(split-window-keep-point, split-window-vertically)
	(split-window-horizontally): Doc fixes.

2004-07-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.  Now it uses call-process instead of
	shell-command for low command execution.
	(pr-version): New version number (6.8).
	(pr-shell-file-name): Option removed.
	(pr-shell-command): Fun removed.
	(pr-call-process): New fun.  Replace pr-shell-command.
	(pr-standard-path, pr-remove-nil-from-list): New funs.
	(zmacs-region-stays, current-mouse-event, current-menubar): New var.
	(pr-ps-file-preview, pr-ps-file-using-ghostscript, pr-ps-file-print)
	(pr-setup, pr-ps-set-printer, pr-txt-set-printer)
	(pr-ps-utility-process, pr-txt-print): Code fix.

2004-07-10  Stephan Stahl  <stahl@eos.franken.de>  (tiny change)

	* ediff-mult.el (ediff-meta-truncate-filenames): Change type to
	boolean.

2004-07-09  Lars Hansen  <larsh@math.ku.dk>

	* wid-edit.el (widget-field-buffer): Doc fix.

2004-07-09  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/re-builder.el (reb-update-overlays): Distinguish
	between one and several matches in message.

2004-07-09  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-set-region-1): If transient-mark-mode
	is `identity', change it to `only'.

	* simple.el (current-word): Doc fix.

2004-07-09  Mark A. Hershberger  <mah@everybody.org>

	* progmodes/cperl-mode.el (cperl-mode): Adapt defun-prompt-regexp
	so that it is more understanding of whitespace.

	* xml.el (xml-maybe-do-ns, xml-parse-tag): Produce elements in the
	form
	(("ns" . "element") (attr-list) children) instead of
	((:ns . "element") (attr-list) children) in order to reduce the
	number of symbols used.
	(xml-skip-dtd): Change to use xml-parse-dtd but set
	xml-validating-parsing to nil.
	(xml-parse-dtd): Parse entity deleclarations in DOCTYPEs.
	(xml-substitute-entity): Remove in favor of new entity substitution.
	(xml-substitute-special): Rewrite in to substitute complex
	entities from DOCTYPE declarations.
	(xml-parse-fragment): Parse fragments from entity deleclarations.
	(xml-parse-region, xml-parse-tag, xml-parse-attlist)
	(xml-parse-dtd, xml-substitute-special): Make validity checks
	conditioned on xml-validating-parser.  Add "Not Well Formed" to
	error messages about well-formedness.

2004-07-08  Steven Tamm  <steventamm@mac.com>

	* term/mac-win.el (mac-scroll-ignore-events, mac-scroll-down)
	(mac-scroll-down-line, mac-scroll-up, mac-scroll-up-line):
	Do not treat double clicks and triple clicks specially in the
	scroll bar (preventing strange repositioning problems)

2004-07-06  Stefan  <monnier@iro.umontreal.ca>

	* replace.el (query-replace-regexp-eval): Fix last change.

2004-07-05  Stefan  <monnier@iro.umontreal.ca>

	* replace.el (query-replace-descr): New fun.
	(query-replace-read-from, query-replace-read-args): Default to the
	previous from&to.
	(query-replace-read-to): Quote the `from' string when displaying it.
	(query-replace-regexp-eval): Immediately check read-only status.
	Use query-replace-read-from to get the \n checking.
	Quote the `from' string when displaying it.
	(map-query-replace-regexp, occur-read-primary-args):
	Quote the `from' string when displaying it.

	* isearch.el (isearch-query-replace): Pass the regexp-ness and
	delimited-ness of the search to query-replace.

	* replace.el (query-replace-read-from, query-replace-read-to):
	New funs extracted from query-replace-read-args.
	(query-replace-read-args): Use them.

	* replace.el (query-replace-interactive, query-replace-read-args):
	Remove the `initial' special value.
	(query-replace-regexp-eval, map-query-replace-regexp): Simplify.
	(occur-engine): Remove unused var `matchend'.

	* isearch.el (isearch-query-replace, isearch-query-replace-regexp):
	Use the search string without prompting.

2004-07-05  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (decode-coding-inserted-region):
	Set last-coding-system-used only when coding is nil.

2004-07-03  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/grep.el (grep-compute-defaults, grep-command)
	(grep-program, find-program, grep-find-use-xargs, grep-history)
	(grep-find-history, grep-tag-default, grep-find-command)
	(grep-regexp-alist, grep-process-setup, grep-compute-defaults):
	Add autoload cookies, for unbundled packages that load `compile'
	and expect all grep-related symbols to become defined.

2004-07-03  KOSEKI Yoshinori  <kose@meadowy.org>

	* iimage.el (turn-on-iimage-mode, iimage-mode): Add autoload cookies.
	(iimage-mode-image-search-path): New user option to search the
	image file.
	(iimage-locate-file): New funcion.  Emacs21.3 or earlier does not
	have locate-file.
	(iimage-mode-buffer): Use it.

2004-07-03  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-goto-breakpoint): String match more
	carefully.
	(gdb-delete-breakpoint, gdb-toggle-breakpoint): Handle gdbmi.

2004-07-03  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-read-args): Swallow space after 'foo,
	not after (quote foo).  Match space only immediately after symbol,
	not anywhere in the whole string.

2004-07-02  Richard M. Stallman  <rms@gnu.org>

	* replace.el (query-replace-read-args): Swallow space after
	symbols, not after closeparens.  But avoid error if string ends there.

	* progmodes/python.el (python-beginning-of-statement):
	Exit the loop if backward-up-list gets error.

	* textmodes/enriched.el (enriched-encode): Bind inhibit-read-only.

2004-07-02  Andre Spiegel  <spiegel@gnu.org>

	* vc-rcs.el (vc-rcs-checkout-model): Look at the version headers
	only if vc-consult-headers is non-nil.

2004-07-02  Juri Linkov  <juri@jurta.org>

	* pcvs.el (cvs-mode-diff-repository): New command.

	* pcvs-defs.el (cvs-mode-diff-map): Bind r to cvs-mode-diff-repository.

2004-07-01  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind C-M-w to isearch-del-char,
	C-M-y to isearch-yank-char.  Bind M-% to isearch-query-replace,
	C-M-% to isearch-query-replace-regexp.
	(minibuffer-local-isearch-map): Add arrow key bindings.
	Bind C-f to isearch-yank-char-in-minibuffer.
	(isearch-forward): Doc fix.
	(isearch-edit-string): Doc fix.
	(isearch-query-replace, isearch-query-replace-regexp): New funs.
	(isearch-del-char): Add optional arg.  Set isearch-yank-flag to t.
	(isearch-yank-char): Add optional arg.
	(isearch-yank-char-in-minibuffer): New fun.

	* replace.el (query-replace-interactive): Change type from boolean
	to choice.  Add value `initial'.
	(query-replace-read-args): Handle value `initial' of
	query-replace-interactive.

2004-06-29  Kim F. Storm  <storm@cua.dk>

	* progmodes/gdb-ui.el (breakpoint-enabled-bitmap-face)
	(breakpoint-disabled-bitmap-face): Add :group 'gud.

	* progmodes/ada-xref.el (ada-tight-gvd-integration):
	Add :group 'ada.

	* vc-arch.el (vc-arch-mode-line-rewrite): Add :group 'vc.

2004-06-29  Juri Linkov  <juri@jurta.org>

	* replace.el (query-replace-read-args): Swallow a space after
	everything except )]" which in most cases means after a symbol.

	* emacs-lisp/pp.el (pp-buffer): Add autoload.

2004-06-28  Richard M. Stallman  <rms@gnu.org>

	* font-lock.el (font-lock-fontify-syntactic-keywords-region):
	More changes to go with previous change in font-lock.el.

2004-06-26  David Kastrup  <dak@gnu.org>

	* replace.el (perform-replace): Highlight the match even in
	non-query mode if there is potential replace string editing.

2004-06-26  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* net/tramp.el (tramp-handle-file-remote-p): New implementation to
	agree with new return value of `file-remote-p'.
	This syncs with Tramp 2.0.42.

	* net/ange-ftp.el (ange-ftp-file-remote-p): New return value,
	according to new documentation of `file-remote-p'.

	* files.el (file-remote-p): Fix doc to say that return value is
	identification of remote system, if not nil.
	(file-relative-name): Use new return value of `file-remote-p'.

2004-06-26  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-toggle-breakpoint)
	(gdb-goto-breakpoint): Fix breakage.

2004-06-26  Eli Zaretskii  <eliz@gnu.org>

	* man.el (Man-getpage-in-background): Add windows-nt to the list
	of systems where shell-file-name should be used instead of
	literal "sh".

2004-06-25  Sam Steingold  <sds@gnu.org>

	* add-log.el (change-log-font-lock-keywords): Support Common Lisp
	function names `(setf symbol)'.

2004-06-24  Richard M. Stallman  <rms@gnu.org>

	* replace.el (query-replace-read-args): Swallow space after \,SYMBOL.

	* font-lock.el (font-lock-keywords): Change format of compiled values.
	Document it.
	(font-lock-add-keywords): If font-lock-keywords is compiled,
	extract the uncompiled version, modify, then recompile.
	(font-lock-remove-keywords): Likewise.
	(font-lock-fontify-keywords-region): Handle changed format.
	(font-lock-compile-keywords): Handle changed format.
	(font-lock-set-defaults): Compile the keywords explicitly here.

2004-06-24  David Kastrup  <dak@gnu.org>

	* replace.el (query-replace-read-args): Implement `\,' and `\#'
	replacements here.
	(query-replace-regexp): Doc string explaining this and the new
	`\?' replacement.  Remove `\,' and `\#' implementation here, as it
	is better placed in `query-replace-read-args'.
	(replace-regexp): Explain `\,', `\#' and `\?'.
	(replace-match-data): New function for thorough reuse/destruction
	of old match-data.
	(replace-match-maybe-edit): Function for implementing `\?' editing.
	(perform-replace): Fix maintaining of the match stack including
	already matched regions, implement `\?', fix various problems
	with regions while editing and other stuff.
	(replace-highlight): Simplify.

2004-06-24  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/grep.el (grep-error-screen-columns): New variable.
	(grep-regexp-alist): Give it the full functionality of gnu style
	compilation messages with line and column ranges.  Ask me for the
	perl script I'm working on, that uses these.

2004-06-23  Nick Roberts  <nickrob@gnu.org>

	* comint.el: (comint-insert-clicked-input, comint-copy-old-input):
	Remove.
	(comint-insert-input, comint-mouse-insert-input): New functions
	based on comint-insert-clicked-input for two bindings but just
	one functionality.

2004-06-23  Luc Teirlinck  <teirllm@auburn.edu>

	* net/goto-addr.el (goto-address-fontify): Fix help-echo text.

2004-06-23  Lars Hansen  <larsh@math.ku.dk>

	* files.el (write-contents-functions): Doc fix.

2004-06-21  Juanma Barranquero  <lektu@terra.es>

	* image.el (image-library-alist): Rewrite docstring in active voice.

2004-06-20  Richard M. Stallman  <rms@gnu.org>

	* mouse.el (mouse-set-region-1): Set transient-mark-mode to `only'.

	* isearch.el (isearch-repeat): Avoid testing old match data.
	(isearch-message): Display trailing space in special font
	when search is failing.
	(isearch-search-fun-function): Doc fix.

	* autorevert.el (global-auto-revert-non-file-buffers): Doc fix.

2004-06-19  Luc Teirlinck  <teirllm@auburn.edu>

	* frame.el (show-trailing-whitespace): Doc fix.

	* cus-edit.el (custom-variable-documentation): New function.
	(custom-variable): Use it.

2004-06-19  Nick Roberts  <nickrob@gnu.org>

	* man.el (Man-getpage-in-background): Revert previous change but
	make cygwin a special case.

2004-06-18  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (global-auto-revert-non-file-buffers):
	Update docstring.

2004-06-19  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-error-properties): Store one
	more than end-col, if present, so that transient-mark-mode will
	highlight last char too.
	* progmodes/grep.el (grep-regexp-alist): Match columns and column
	ranges, if present.

2004-06-18  Jason Rumney  <jasonr@gnu.org>

	* makefile.w32-in: Double percent signs in for loops.

2004-06-17  David Kastrup  <dak@gnu.org>

	* replace.el (query-replace-read-args): Only warn about use of \n
	and \t when we are doing a regexp replacement and the actual
	escaped character is n or t.
	(query-replace-regexp): Add \, and \# interpretation to
	interactive call and document it.
	(query-replace-regexp-eval, replace-match-string-symbols): Add \#
	as shortkey for replace-count.
	(replace-quote): New function for doubling backslashes.

2004-06-17  Juanma Barranquero  <lektu@terra.es>

	* files.el (parse-colon-path, cd): Mention in docstring that the
	path separator is colon in GNU-like systems.

	* newcomment.el (comment-region-internal): Fix docstring.

	* emacs-lisp/ewoc.el (ewoc-create, ewoc-map, ewoc-locate)
	(ewoc-invalidate, ewoc-collect): Doc fixes.
	(ewoc--create-node, ewoc--delete-node-internal):
	Fix typos in docstring.

2004-06-15  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (buffer-stale-function): Add hyperlink to emacs-xtra
	manual to docstring.

2004-06-15  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-time-stamp-iso8601): Comment doc string of defalias.

2004-06-15  Luc Teirlinck  <teirllm@auburn.edu>

	* dired-aux.el (dired-do-redisplay, dired-maybe-insert-subdir):
	Add hyperlink to emacs-xtra manual to docstring.

	* autorevert.el (global-auto-revert-non-file-buffers):
	Add hyperlink to emacs-xtra manual to docstring, as well as an
	info-link.

2004-06-14  Juanma Barranquero  <lektu@terra.es>

	* image.el (image-library-alist): New variable to map image types
	to external libraries.  Initialized to nil, unless system-specific
	configs change it.
	(image-type-available-p): Determine whether an image type is
	available by calling `init-image-library'.

	* term/w32-win.el (image-library-alist): Initialize to a known set
	of probable library names.

2004-06-14  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el (windows-1256, cp1125): Fix tables
	for several characters.

	* international/utf-8.el (ccl-encode-mule-utf-8): Fix previous change.

2004-06-13  Richard M. Stallman  <rms@gnu.org>

	* textmodes/paragraphs.el (sentence-end): Add 0x5397d as close brace.

	* emulation/pc-select.el: Doc fixes: say "PC Selection mode",
	not "`pc-selection-mode'".

	* emacs-lisp/bytecomp.el: Put `...' around symbols in warning messages.

	* simple.el (previous-matching-history-element): Specify a default.

	* hexl.el (hexl-mode): Catch errors in hexl-goto-address.

	* cus-face.el (custom-declare-face): Simplify code.

	* abbrev.el (abbrev-mode, edit-abbrevs-map): Doc fixes.

2004-06-13  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (before-save-hook): Add `time-stamp' to the options.

	* time-stamp.el (time-stamp): Recommend adding it to
	`before-save-hook', rather than `write-file-functions'.
	Make a similar change in `Commentary' section.

2004-06-13  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* diff-mode.el (diff-current-defun): If at start of hunk, use
	position of first change.

2004-06-13  Lars Hansen  <larsh@math.ku.dk>

	* dired-x.el (dired-mark-omitted): Bind to "*O".

2004-06-12  Karl Fogel  <kfogel@red-bean.com>

	* bookmark.el (bookmark-bmenu-relocate): New function, as
	suggested by David J. Biesack <David.Biesack@sas.com>.
	(bookmark-bmenu-mode-map): Bind `bookmark-bmenu-relocate' to "R".
	(bookmark-bmenu-mode): Describe binding in doc string.
	(bookmark-set-filename): Save the bookmark list if it's time.

2004-06-13  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (ccl-decode-mule-utf-8): Fix previous change.
	(ccl-untranslated-to-ucs): Fix typo.

2004-06-12  Karl Chen  <quarl@hkn.eecs.berkeley.edu>  (tiny change)

	* progmodes/python.el (python-open-block-statement-p):
	Fix indentation after a block opening that contains a comment.

2004-06-12  J,Ai(Br,At(Bme Marant  <jerome@marant.org>  (tiny change)

	* bindings.el (completion-ignored-extensions): Add file extensions
	of Python byte-compiled files.

2004-06-12  Juri Linkov  <juri@jurta.org>

	* info.el (Info-goto-node): Add autoload.
	(Info-toc): Add substring-no-properties on Info file name.
	(Info-mode, info, Info-toc, Info-mode-menu): Doc fix.
	(Info-mode-map): Bind L to Info-history, T to Info-toc.

2004-06-12  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment):
	Load subst tables if necessary.

	* international/mule.el (decode-char): Load subst tables if necessary.
	(encode-char): Likewise.

	* international/utf-16.el (utf-16-decode-ucs): Handle a surrogate
	pair correctly.  Call ccl-mule-utf-untrans for untranslable chars.
	(utf-16le-decode-loop): Set r5 to -1 before loop.
	(utf-16be-decode-loop): Likewise.
	(ccl-decode-mule-utf-16le): Add EOF processing block.
	(ccl-decode-mule-utf-16be): Likewise.
	(ccl-decode-mule-utf-16le-with-signature): Likewise.
	(ccl-decode-mule-utf-16be-with-signature): Likewise.
	(ccl-decode-mule-utf-16): Likewise.  Set r5 to -1 initially.
	(ccl-mule-utf-16-encode-untrans): New CCL.
	(utf-16-decode-to-ucs): Handle pre-read character.
	(utf-16le-encode-loop): Handle surrogate pair.
	(utf-16be-encode-loop): Likewise.
	(ccl-encode-mule-utf-16le-with-signature): Adjust for the change
	of utf-16le-encode-loop.
	(ccl-encode-mule-utf-16be-with-signature): Adjust for the change
	of utf-16be-encode-loop.
	(mule-utf-16-post-read-conversion):
	Call utf-8-post-read-conversion at first.
	(mule-utf-16[{le|be}], mule-utf-16{le|be}-with-signature):
	Include CJK charsets in safe-charsets if utf-translate-cjk-mode is on.
	Add post-read-conversion and pre-write-conversion.

	* international/utf-8.el (utf-translate-cjk-charsets): New variable.
	(utf-translate-cjk-unicode-range): New variable.
	(utf-translate-cjk-load-tables): New function.
	(utf-lookup-subst-table-for-decode): New function.
	(utf-lookup-subst-table-for-encode): New function.
	(utf-translate-cjk-mode): Init-value changed to t.  Don't load
	tables here.  Update safe-charsets of utf-* coding systems.
	(ccl-mule-utf-untrans): New CCL.
	(ccl-decode-mule-utf-8): Call ccl-mule-utf-untrans.  Use `repeat'
	at end of each branch.
	(ccl-mule-utf-8-encode-untrans): New CCL.
	(ccl-encode-mule-utf-8): Call ccl-mule-utf-8-encode-untrans.
	(ccl-untranslated-to-ucs): Handle 2-byte encoding.  Set r1 to the
	length of encoding.  Don't return r0.
	(utf-8-compose): New arg hash-table.  Handle 2-byte encoding.
	(utf-8-post-read-conversion): Narrow to region properly.
	If utf-translate-cjk-mode is on, load tables if necessary.
	Call utf-8-compose with hash-table arg if necessary.
	Call XXX-compose-region instead of XXX-post-read-convesion.
	(utf-8-pre-write-conversion): New function.
	(mule-utf-8): Include CJK charsets in safe-charsets if
	utf-translate-cjk-mode is on.  Add pre-write-conversion.

	* international/characters.el: Temporarily set
	utf-translate-cjk-mode to nil.

	* language/devan-util.el (devanagari-compose-region):
	Add autoload cookie.

	* international/ccl.el (ccl-dump-call): Fix printing the
	subroutine name.

2004-06-11  Luc Teirlinck  <teirllm@auburn.edu>

	* dired.el (dired-revert): If buffer is marked unmodified before
	reverting, keep it marked unmodified.
	Adapt to new conventions for commenting out code.
	(dired-make-relative): Adapt to new conventions for commenting out code.

2004-06-10  Miles Bader  <miles@gnu.ai.mit.edu>

	* eshell/esh-module.el (eshell-load-defgroups):
	Bind `vc-handled-backends' to nil when opening files.

2004-06-11  Juanma Barranquero  <lektu@terra.es>

	* files.el (parse-colon-path, cd): Doc fixes (refer to
	`path-separator', not colon).

2004-06-10  Juanma Barranquero  <lektu@terra.es>

	* newcomment.el (comment-search-forward)
	(comment-search-backward): Fix typos in docstring.
	(comment-region): Doc fix.

2004-06-10  Luc Teirlinck  <teirllm@auburn.edu>

	* dired.el (dired-insert-old-subdirs): Adapt to fact that the R
	switch is no longer stored in `dired-switches-alist'.

	* dired-aux.el (dired-insert-subdir): Do not store R switch in
	`dired-switches-alist'.

2004-06-10  Kim F. Storm  <storm@cua.dk>

	* pcvs.el (cvs-mode-diff-yesterday): New command.

	* pcvs-defs.el (cvs-mode-diff-map): Bind y to cvs-mode-diff-yesterday.

2004-06-10  Juri Linkov  <juri@jurta.org>

	* emacs-lisp/edebug.el (edebug-eval-defun):
	* emacs-lisp/lisp-mode.el (eval-defun-1): Add `defface'.
	Fix docstring.

	* simple.el (eval-expression-print-format): Don't print additional
	information on the first call to `eval-print-last-sexp'.
	(next-error-find-buffer): Fix punctuation.
	(killing) <defgroup>: Fix punctuation.
	(yank-excluded-properties): Change group from editing to killing.

	* replace.el (perform-replace): Use `limit' to terminate the
	while-loop explicitly.

2004-06-09  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/tool-bar.el (tool-bar-add-item, tool-bar-local-item):
	Use lc-*.xpm as prefix instead of *-locol.xpm.

	* toolbar/lc-copy.xpm, toolbar/lc-cut.xpm
	* toolbar/lc-help.xpm, toolbar/lc-home.xpm
	* toolbar/lc-index.xpm, toolbar/lc-jump_to.xpm
	* toolbar/lc-left_arrow.xpm, toolbar/lc-new.xpm
	* toolbar/lc-open.xpm, toolbar/lc-paste.xpm
	* toolbar/lc-preferences.xpm, toolbar/lc-print.xpm
	* toolbar/lc-right_arrow.xpm, toolbar/lc-save.xpm
	* toolbar/lc-saveas.xpm, toolbar/lc-search.xpm
	* toolbar/lc-spell.xpm, toolbar/lc-undo.xpm
	* toolbar/lc-up_arrow.xpm:
	Renamed from *-locol.xpm.

2004-06-09  Rajesh Vaidheeswarran  <rv@gnu.org>

	* ffap.el (ffap-string-at-point-mode-alist): Fix the url mode to
	include forms like &<str>; as valid url patterns.

2004-06-08  Luc Teirlinck  <teirllm@auburn.edu>

	* dired.el (dired-diff, dired-backup-diff)
	(dired-clean-directory, dired-do-chmod, dired-do-chgrp)
	(dired-do-chown, dired-do-touch, dired-do-print)
	(dired-do-shell-command, dired-do-kill-lines, dired-do-compress)
	(dired-do-byte-compile, dired-do-load, dired-do-redisplay)
	(dired-create-directory, dired-do-copy, dired-do-symlink)
	(dired-do-hardlink, dired-do-rename, dired-do-rename-regexp)
	(dired-do-copy-regexp, dired-do-hardlink-regexp)
	(dired-do-symlink-regexp, dired-upcase, dired-downcase)
	(dired-maybe-insert-subdir, dired-next-subdir)
	(dired-prev-subdir, dired-goto-subdir, dired-mark-subdir-files)
	(dired-kill-subdir, dired-tree-up, dired-tree-down)
	(dired-hide-subdir, dired-hide-all, dired-show-file-type)
	(dired-run-shell-command, dired-query): Remove redundant,
	or incorrect, autoloads.

	* dired-aux.el (dired-kill-tree): Do not kill DIRNAME, even if it
	does not end in a slash.  Add optional argument KILL-ROOT.
	Update docstring.
	(dired-do-touch, dired-clean-directory, dired-run-shell-command)
	(dired-query): Add autoloads.

2004-06-08  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-set-window-height):
	Rearrange the save-* functions because a buffer can have several current
	point in different windows.
	(compilation-error-regexp-alist-alist): Recognize {standard input}
	GNU messages (for gcc --pipe) and more kinds of Oracle messages.

2004-06-08  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/copy-locol.xpm, toolbar/cut-locol.xpm
	* toolbar/help-locol.xpm, toolbar/home-locol.xpm
	* toolbar/index-locol.xpm, toolbar/jump_to-locol.xpm
	* toolbar/left_arrow-locol.xpm, toolbar/new-locol.xpm
	* toolbar/open-locol.xpm, toolbar/paste-locol.xpm
	* toolbar/preferences-locol.xpm, toolbar/print-locol.xpm
	* toolbar/right_arrow-locol.xpm, toolbar/save-locol.xpm
	* toolbar/saveas-locol.xpm, toolbar/search-locol.xpm
	* toolbar/spell-locol.xpm, toolbar/undo-locol.xpm
	* toolbar/up_arrow-locol.xpm:
	New versions of icons that uses fewer colors.

	* toolbar/tool-bar.el (tool-bar-local-item)
	(tool-bar-local-item-from-menu): Try to use icons with fewer colors
	if display-color-cells is 256 or less.

2004-06-08  Kim F. Storm  <storm@cua.dk>

	* wid-edit.el (widget-specify-button): Use hand pointer rather
	than mouse-face as visible mouse-over effect.

2004-06-07  Karl Fogel  <kfogel@red-bean.com>

	* saveplace.el (save-place-alist-to-file): Bind `print-length'
	and `print-level' to nil when writing out `save-place-alist'.
	Thanks to Kai Grossjohann <kai@emptydomain.de> for enlightenment.

2004-06-07  Juanma Barranquero  <lektu@terra.es>

	* completion.el (completion-kill-region): Doc fix.

	* format.el (format-insert-annotations)
	(format-annotate-location): Doc fixes.
	(format-subtract-regions): Make arguments match their use in docstring.

	* simple.el (kill-region): Doc fix.

	* subr.el (insert-buffer-substring-no-properties)
	(insert-buffer-substring-as-yank): Doc fixes.

2004-06-07  Luc Teirlinck  <teirllm@auburn.edu>

	* dired-aux.el (dired-do-redisplay, dired-maybe-insert-subdir):
	Update docstring.
	(dired-reset-subdir-switches): New function.

	* dired.el (dired-undo): Call `dired-build-subdir-alist'.
	Limit scope of `buffer-read-only' binding.

2004-06-06  Emilio C. Lopes  <eclig@gmx.net>

	* eshell/esh-cmd.el (eshell/which): Respect commands quoted with
	eshell-explicit-command-char.

2004-06-06  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-argument-name): Inherit from italic face only
	if the frame supports it.

2004-06-06  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/alias.pbm, toolbar/close.pbm, toolbar/copy.pbm
	* toolbar/cut.pbm, toolbar/help.pbm, toolbar/home.pbm
	* toolbar/index.pbm, toolbar/jump_to.pbm, toolbar/left_arrow.pbm
	* toolbar/new.pbm, toolbar/open.pbm, toolbar/paste.pbm
	* toolbar/preferences.pbm, toolbar/print.pbm, toolbar/right_arrow.pbm
	* toolbar/save.pbm, toolbar/saveas.pbm, toolbar/search.pbm
	* toolbar/spell.pbm, toolbar/undo.pbm, toolbar/up_arrow.pbm:
	New conversions from xpm files.

	* toolbar/README: New file.

2004-06-06  Richard M. Stallman  <rms@gnu.org>

	* isearch.el (isearch-mode-map): Undo previous change.

2004-06-05  Juri Linkov  <juri@jurta.org>

	* bindings.el (debug-ignored-errors): Add regexps for history
	related messages.  Remove $ from "No further undo information".
	Move Ediff's messages to ediff.el.

	* ediff.el: Move Ediff's debug-ignored-errors from bindings.el.

	* cus-edit.el (custom-display): Add `min-colors'.

	* custom.el (defface): Add `supports' to docstring.

	* help-fns.el (help-argument-name): Add :group 'help.

2004-06-05  Luc Teirlinck  <teirllm@auburn.edu>

	* find-dired.el (find-ls-subdir-switches): New user option.
	(find-dired): No longer call `abbreviate-file-name' on DIR.
	Set `dired-subdir-switches' buffer-locally.

	* locate.el: Merge the two `Commentary' sections.
	(locate-ls-subdir-switches): New user option.
	(locate): Update for other changes.
	(locate-mode-map): Restore Dired binding for mouse-2.
	Bind `locate-mouse-view-file' to M-mouse-2.
	Bind `l' to `locate-do-redisplay'.
	(locate-main-listing-line-p, locate-do-redisplay): New functions.
	(locate-mouse-view-file, locate-tags, locate-find-directory):
	Print message if used outside main listing.
	(locate-mode): Update docstring.  Make `*Locate*' buffer read-only.
	Various changes to support inserted subdirectories.
	(locate-insert-header): Change header of *Locate* buffer.

	* dired-aux.el (dired-do-redisplay, dired-maybe-insert-subdir):
	Change interactive default switches.
	(dired-rename-subdir-2): Update `dired-switches-alist'.
	(dired-insert-subdir, dired-kill-subdir):
	Handle `dired-switches-alist'.  Do not mark buffer modified.
	(dired-insert-subdir-validate): Handle `dired-subdir-switches'.
	(dired-insert-subdir-doinsert): Omit messages.
	Handle `dired-subdir-switches'.
	(dired-hide-subdir, dired-hide-all): Do not mark buffer modified.

	* dired.el (dired-subdir-switches, dired-switches-alist): New vars.
	(dired-insert-old-subdirs): Do not repeatedly delete and reinsert
	subdirs if -R switch is used for a subdir.
	(dired-mode): Set `dired-switches-alist'.
	(dired-build-subdir-alist): Only print number of directories in
	echo area when invoked interactively.

2004-06-05  Lars Hansen  <larsh@math.ku.dk>

	* dired-x.el (dired-omit-mode): Rename from
	dired-omit-files-p.  Use define-minor-mode to define it.
	(dired-omit-files-p): Add as alias for dired-omit-mode.
	(dired-omit-toggle): Delete.  Replaced by dired-omit-mode and
	dired-mark-omitted.
	(dired-mark-omitted): Add.  Bind to M-O.

2004-06-05  Kenichi Handa  <handa@m17n.org>

	* ps-print.el: Fix typos (kein'ichi -> ken'ichi)

2004-06-05  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-argument-name): Reintroduce face.
	(help-default-arg-highlight): Use it, now that
	`face-differs-from-default-p' can be trusted.

2004-06-05  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* textmodes/table.el: Sentence commands added to Point Motion
	group; kill and backward-kill commands added to Extraction group.

2004-06-04  Mario Lang  <mlang@delysid.org>

	* battery.el (battery-linux-proc-acpi): `mA' was hardcored, but some
	systems appear to use mW, make the code handle this.  Fix a
	division-by-zero bug while at it, and handle kernels with
	a slightly different layout in /proc/acpi.

2004-06-04  Karl Fogel  <kfogel@red-bean.com>

	* vc-svn.el (vc-svn-checkin): Use 'nconc' instead of 'list*',
	because the latter is a CL-ism.  This fixes the bug reported by
	Shawn Boyette <mdxi@collapsar.net> in
	http://lists.gnu.org/archive/html/emacs-devel/2004-05/msg00442.html.

2004-06-04  Miles Bader  <miles@gnu.org>

	* faces.el (display-supports-face-attributes-p): Function moved to
	C code.  Previously only the tty-related portion of this function
	was done in C; however the previous attempt to do a halfway-proper
	job for non-tty displays in lisp didn't work properly because of
	funny conditions during Emacs startup.
	(face-differs-from-default-p): Simplify, now that
	display-supports-face-attributes-p works properly on all display
	types.  Remove :stipple from comparison; it doesn't really work
	in emacs anyway.

2004-06-04  Miles Bader  <miles@gnu.org>

	* faces.el (face-differs-from-default-p): Use a different
	implementation, so we can really check whether FACE displays
	differently or not.

2004-06-04  Miles Bader  <miles@gnu.org>

	* faces.el (display-supports-face-attributes-p): Implement a
	`different from default' check for non-tty displays.

2004-06-03  David Kastrup  <dak@gnu.org>

	* woman.el (woman-mapcan): More concise code.
	(woman-topic-all-completions, woman-topic-all-completions-1)
	(woman-topic-all-completions-merge): Replace by a simpler and
	much faster implementation based on O(n log n) sort/merge instead
	of the old O(n^2) behavior.

2004-06-03  Miles Bader  <miles@gnu.org>

	* subr.el (read-number): Use canonical format for default in prompt.

	* minibuf-eldef.el (minibuffer-default-in-prompt-regexps):
	Add regexp for " [...]" style defaults.

2004-06-02  Romain Francoise  <romain@orebokech.com>

	* ibuf-ext.el (ibuffer-jump-to-buffer): Add support for filter
	groups: if the user asks for a hidden buffer, open the
	corresponding filter group to expose it.

	* ibuffer.el (ibuffer-mode-map): Add key binding `M-g' to
	`ibuffer-jump-to-buffer'.
	(ibuffer-jump-offer-only-visible-buffers): New user option.

2004-06-02  Juanma Barranquero  <lektu@terra.es>

	* faces.el (frame-update-faces): Add empty docstring so the one
	for `ignore' doesn't show through.

	* subr.el (process-kill-without-query): Remove spurious "\n" on
	obsolescence string.
	(focus-frame, unfocus-frame): Add obsolescence declaration and
	empty docstring.

	* international/mule.el (register-char-codings): Make alias for
	`ignore'.  Move docstring to obsolescence info and remove redundancy.

2004-06-02  Kim F. Storm  <storm@cua.dk>

	* frame.el (blink-cursor-start): Turn cursor off initially so blink
	starts after blink-cursor-delay rather than 2*blink-cursor-delay.

2004-06-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* comint.el (comint-replace-by-expanded-history-before-point):
	Obey `start' as the docstring says.
	(comint-send-input, comint-snapshot-last-prompt, comint-output-filter)
	(comint-update-fence): Prevent font-lock from running unnecessarily.
	(comint-dynamic-list-completions): Use with-current-buffer.

2004-06-01  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-format-entry): Fix regexps.
	(bibtex-parse-strings): Bugfix, use assoc instead of assoc-string.
	(bibtex-entry-update): Handle alternatives and optional fields.
	(bibtex-parse-entry): Bugfix, handle empty key.

2004-05-31  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-state): Don't assume the file exists.

2004-05-31  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-save): Don't save minor modes without a
	known mode initialization function.

2004-05-30  Luc Teirlinck  <teirllm@auburn.edu>

	* replace.el (query-replace-interactive): Convert defvar -> defcustom.

	* autorevert.el: Update `Commentary' section.

2004-05-30  Juanma Barranquero  <lektu@terra.es>

	* dos-fns.el (convert-standard-filename):
	* files.el (convert-standard-filename):
	* w32-fns.el (convert-standard-filename):
	Rework docstring (wording by Eli Zaretskii and Kai Grossjohann).

2004-05-30  Kai Grossjohann  <kai.grossjohann@gmx.net>

	Sync with Tramp.

	* net/tramp.el (tramp-let-maybe): Reverse args of `get'.
	(tramp-let-maybe): Move to an earlier spot in the file.
	Patch by Andreas Schwab.

2004-05-30  Andreas Schwab  <schwab@suse.de>

	* dired.el (dired-get-filename): Don't use dired-re-dot.

2004-05-30  Richard M. Stallman  <rms@gnu.org>

	* files.el (find-file): Doc fix.

	* font-lock.el (lisp-font-lock-keywords-2): Add multiple-value-bind.

2004-05-30  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-current-frame, gud-watch)
	(gdb-locals-mode, gdb-frame-handler): Display current frame in the
	modeline of the locals buffer.
	(gdb-goto-breakpoint): Handle gdbmi.
	(gdb-get-frame-number): Change for gdbmi.

2004-05-30  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-remote-p): Apply file name handler for operation
	`file-remote-p'.  It isn' a property any longer.
	(file-relative-name): `fh' and `fd' get the required value via
	`find-file-name-handler' already.

	* ange-ftp.el (ange-ftp-file-remote-p): New defun.
	(top): Remove setting of `file-remote-p' property for
	`ange-ftp-hook-function'.  Add `ange-ftp' property to `file-remote-p'.

2004-05-29  Michael Albinus  <michael.albinus@gmx.de>

	Version 2.0.41 of Tramp released.

	* tramp.el (tramp-wait-for-regexp, tramp-wait-for-output):
	Throw away if process has died.
	Reported by Luc Teirlinck <teirllm@dms.auburn.edu>.
	(tramp-out-of-band-prompt-regexp): Rename to
	`tramp-process-alive-regexp', because its usage is widen.
	(tramp-actions-copy-out-of-band): Apply it.
	(tramp-actions-before-shell, tramp-multi-actions):
	Add `tramp-action-process-alive' action.
	(tramp-action-process-alive): New defun.
	(tramp-file-name-handler-alist, tramp-file-name-for-operation):
	Add entry for `file-remote-p'.
	(tramp-handle-file-remote-p): New defun.
	(top): Remove setting of `file-remote-p'.  Don't set
	`inhibit-file-name-handlers' and `inhibit-file-name-operation'.

	* tramp-smb.el (tramp-smb-file-name-handler-alist): Add entry for
	`file-remote-p'.

	* tramp-uu.el (tramp-uuencode-region): Padding characters aren't
	counted for (last) line.  [They should or they shouldn't?  --Stef]
	Reported by Aaron Ucko <ucko@ncbi.nlm.nih.gov>.

2004-05-29  Kai Grossjohann  <kai.grossjohann@gmx.net>

	* tramp.el (tramp-initial-commands): Add "unset HISTFILE"; this is
	not really necessary but seems to keep the shell history smaller
	in some cases.  It is no substitute for setting HISTFILE and
	HISTSIZE from tramp-open-connection-setup-interactive-shell,
	though.  Suggested by Luc Teirlinck.
	(tramp-open-connection-setup-interactive-shell): Export variables
	HISTFILE and HISTSIZE, do not just set them.  From Luc Teirlinck.
	(tramp-set-process-query-on-exit-flag): New compat function.
	(tramp-open-connection-multi, tramp-open-connection-su)
	(tramp-open-connection-rsh, tramp-open-connection-telnet)
	(tramp-do-copy-or-rename-file-out-of-band): Use it.
	(tramp-let-maybe): New macro, let-binds a variable only if it
	isn't obsolete.
	(tramp-check-ls-commands, tramp-handle-expand-file-name)
	(tramp-handle-file-truename): Use it.
	(tramp-completion-file-name-regexp-unified): Avoid matching
	filenames starting with "/:" -- those are reserved for
	file-name-non-special.

	* tramp-smb.el (tramp-smb-open-connection):
	Use tramp-set-process-query-on-exit-flag compat function.

2004-05-29  Richard M. Stallman  <rms@gnu.org>

	* net/browse-url.el (browse-url-interactive-arg): Doc fix.

	* emacs-lisp/lisp-mode.el (prin1-char): Catch errors from `string'.
	(eval-last-sexp-print-value): Print char equivalent regardless
	of standard-output value.

	* thumbs.el (thumbs-subst-char-in-string): Delete.
	(thumbs-thumbname): Use subst-char-in-string.
	(thumbs-resize-image): Use condition-case, not ignore-errors.
	(thumbs-kill-buffer): Likewise.

	* thumbs.el: Don't include cl.  Don't bother with old Emacs versions.
	(thumbs-mode): Make buffer read-only.
	(thumbs-make-thumb): Unconditionally accept an existing file.
	(thumbs-insert-thumb): Add thumb-image-file property to the image.
	(thumbs-do-thumbs-insertion): Be smarter about where to put newlines.
	(thumbs-show-thumbs-list): Error if images not supported.
	(thumbs-save-current-image): Improve prompt string.
	(thumbs-mode-map): Define u, R, x.
	(thumbs-unmark): New command.
	(thumbs-emboss-image): Minor cleanup.
	(thumbs-forward-char, thumbs-backward-char): Skip chars with no image.
	(thumbs-rename-images): New command.
	(thumbs-show-image-num): Rewrite.  Don't rename the buffer.

	* thumbs.el (thumbs-current-image): New function.
	(thumbs-file-list, thumbs-file-alist): New functions.
	(thumbs-find-image): Delete arg L.
	Don't set up thumbs-fileL as buffer-local global var.
	(thumbs-find-image-at-point): Use thumbs-current-image.
	(thumbs-set-image-at-point-to-root-window): Likewise.
	(thumbs-delete-images): Use thumbs-current-image, thumbs-file-alist.
	Record and warn about errors.  Update thumbs-markedL for deletions.
	(thumbs-next-image, thumbs-previous-image): Use thumbs-file-alist.
	(thumbs-redraw-buffer): Use thumbs-file-list.
	(thumbs-mark): Use thumbs-current-image.
	(thumbs-show-name): Use thumbs-current-image.

	* imenu.el (imenu--menubar-select): Set imenu-menubar-modified-tick
	and imenu--last-menubar-index-alist.

	* subr.el (with-selected-window): Undo previous change.

2004-05-29  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (thumbs-show-name): Do nothing if no image at point.
	(thumbs-mouse-find-image): New command.
	(thumbs-mode-map): Bind it to mouse-2.
	(thumbs-mode): Make mode-class special.
	(thumbs-view-image-mode): Likewise.

2004-05-29  Pavel Kobiakov  <pk_at_work@yahoo.com>

	* flymake.el: New file.

2004-05-28  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (find-file-noselect-1): Do not bind
	`inhibit-read-only' to t during execution of
	`find-file-not-found-functions'.

2004-05-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-mcvs.el (vc-mcvs-print-log, vc-mcvs-diff):
	* vc-arch.el (vc-arch-diff): Add optional `buffer' arg.

2004-05-28  Juri Linkov  <juri@jurta.org>

	* simple.el (eval-expression-print-format): New fun.

	* simple.el (eval-expression):
	* emacs-lisp/lisp-mode.el (eval-last-sexp-print-value):
	* emacs-lisp/edebug.el (edebug-compute-previous-result)
	(edebug-eval-expression): Print additionally the value returned by
	`eval-expression-print-format'.

	* emacs-lisp/lisp.el (insert-pair-alist): New var.
	(insert-pair): Make arguments optional.  Find character pair
	from `insert-pair-alist' according to the last input event.
	(insert-parentheses): Make arguments optional.
	(raise-sexp, delete-pair): New funs.

	* emacs-lisp/lisp-mode.el (indent-pp-sexp): New fun.
	(emacs-lisp-mode-map, lisp-interaction-mode-map):
	Bind C-M-q to `indent-pp-sexp'.

	* emacs-lisp/pp.el (pp-buffer): New fun created from the code in
	`pp-to-string' modified to be able to format text with newlines.
	(pp-to-string): Move the buffer-formatting part of the code to
	`pp-buffer'.  Call `pp-buffer'.

	* info.el (Info-desktop-buffer-misc-data): Don't save information
	about virtual files.
	(Info-restore-desktop-buffer): Restore Info buffers in prepared
	buffers with names obtained from the desktop file instead of the
	default *info* buffer.

2004-05-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (with-selected-window): Only save/restore the selected window.

	* progmodes/compile.el (compilation-error-regexp-alist):
	Use expand-file-name and data-directory.

	* progmodes/grep.el (grep-tree): Rework previous fix.

	* mouse.el (mouse-set-region-1): Use temporary transient-mark-mode
	after the user marked text with the mouse.

	* startup.el (command-line): Keep the first regexp of
	auto-save-file-name-transforms intact.

2004-05-28  Juanma Barranquero  <lektu@terra.es>

	* cus-edit.el (customize-face, customize-face-other-window)
	(custom-face-edit-delete): Make arguments match their use in
	docstring.
	(custom-unloaded-symbol-p, custom-unloaded-widget-p): Fix typo in
	docstring.

	* cvs-status.el (cvs-tree-merge, cvs-tags->tree): Use `butlast',
	not `cvs-butlast'.

	* pcvs-util.el (cvs-butlast, cvs-nbutlast): Remove (`butlast' and
	`nbutlast' are in subr.el).

	* w32-fns.el (w32-using-nt, w32-shell-dos-semantics)
	(set-w32-system-coding-system): Doc fixes.

	* textmodes/artist.el (artist-last, artist-remove-nulls): Simplify.
	(artist-draw-ellipse-general, artist-draw-ellipse-with-0-height):
	Make arguments match their use in docstring.
	(artist-draw-region-trim-line-endings)
	(artist-mouse-choose-operation): Fix typo in docstring.
	(artist-key-set-point-common): Doc fix.

2004-05-28  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-open-stream):
	Bind starttls-extra-arguments too, if starttls.el uses GNUTLS.

2004-05-26  Simon Josefsson  <jas@extundo.com>

	* starttls.el: Merge with my GNUTLS based starttls.el.
	(starttls-gnutls-program, starttls-use-gnutls)
	(starttls-extra-arguments, starttls-process-connection-type)
	(starttls-connect, starttls-failure, starttls-success): New variables.
	(starttls-program, starttls-extra-args): Doc fix.
	(starttls-negotiate-gnutls, starttls-open-stream-gnutls): New funs.
	(starttls-negotiate, starttls-open-stream): Check `starttls-use-gnutls'
	and pass on to corresponding *-gnutls function if it is set.

2004-05-27  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): Disable auto-reverting of
	remote files.

2004-05-27  Michael Albinus  <michael.albinus@gmx.de>

	* files.el (file-name-non-special): There are more operations
	which need handling: `find-backup-file-name',
	`insert-file-contents', `verify-visited-file-modtime',
	`write-region'.  Rename t value of method to `add'.  Add new
	methods `quote' and `unquote-then-quote' to file-arg-indices.

2004-05-25  Juri Linkov  <juri@jurta.org>

	* info.el (Info-toc): Call Info-mode on intermediate buffer.
	(Info-index-nodes): Enclose code in condition-case to catch errors.
	(Info-index-node): Don't search all index nodes if request is only
	for the current node and file is not in the cache of index nodes.
	(Info-mode-map): Bind Info-copy-current-node-name to `w'
	for consistency with dired-copy-filename-as-kill.
	Bind `S' to Info-search-case-sensitively.
	(Info-copy-current-node-name): New arg.  With zero prefix arg put
	the name inside a function call to `info'.  Display copied text in
	the echo area.

2004-05-25  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/lisp-mode.el (lisp-find-tag-default): New function:
	strip the package prefix from the symbol name, if any.
	Make it the `find-tag-default-function' for `lisp-mode'.

2004-05-25  John Paul Wallington  <jpw@gnu.org>

	* gs.el (gs-load-image): Use `set-process-query-on-exit-flag'
	instead of obsolete `process-kill-without-query'.

	* textmodes/texinfmt.el (texinfo-indexvar-alist):
	Declare as variable, not constant.

2004-05-25  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (find-file-noselect-1): Fix bug introduced by
	Revision 1.694.  As a side effect, `inhibit-read-only'
	is again, by default, t during execution of
	`find-file-not-found-functions'.
	(insert-directory): Check that lines were really inserted by
	the --dired switch, before erasing them.

2004-05-24  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-breakpoints-mode, gdb-frames-mode)
	(gdb-locals-mode): Check gud-minor-mode in gud-comint-buffer.
	(gdb-var-update, gdb-var-update-handler, gdb-var-delete)
	(gdb-edit-value, gdb-speedbar-expand-node): Handle new value for
	gud-minor-mode (gdbmi).

2004-05-24  Yoichi NAKAYAMA  <yoichi@geiin.org>  (tiny change)

	* net/browse-url.el (browse-url-interactive-arg): Enable user to
	explicitly select the text to be taken as URL.

2004-05-23  Juri Linkov  <juri@jurta.org>

	* info.el (Info-index-nodes): New var and fun.
	(Info-goto-index, Info-index, info-apropos)
	(Info-find-emacs-command-nodes): Rewrite to use Info-index-nodes.
	(Info-index): Fix docstring.  Store and restore Info-history-list.
	(Info-complete-nodes): New var.
	(Info-complete-menu-item): Use it.
	(Info-index-node): New fun.
	(Info-final-node, Info-forward-node, Info-backward-node)
	(Info-build-toc, Info-try-follow-nearest-node, Info-fontify-node):
	Use Info-index-node.
	(Info-extract-menu-item, Info-extract-menu-counting): Set second
	arg of `Info-extract-menu-node-name' to non-nil for index nodes.
	(Info-find-node-2): If a node with period in its name not found,
	try to find a node without the name part after period.
	(Info-select-node): Call Info-fontify-node only if
	Info-fontify-maximum-menu-size is not nil.
	(info-apropos): Set Info-fontify-maximum-menu-size to nil.
	(Info-find-emacs-command-nodes, Info-goto-emacs-command-node):
	Preserve Info-history-list.
	(Info-toc): Set Info-current-file.
	(Info-build-toc): Move point to the beginning of the buffer.
	Add main-file variable.
	(Info-dir-remove-duplicates, Info-history, Info-toc, info-apropos):
	Use backslashed representation of the control character ^_.

	* textmodes/texinfmt.el (texinfo-print-index): Print index line
	numbers in the new Texinfo 4.7 format.

	* add-log.el (change-log-font-lock-keywords): Remove `:' from
	regexps for function and variable names.

	* descr-text.el (describe-property-list): Add [show] button for
	`syntax-table' property with action to pp to a separate buffer.
	(describe-char): Replace search-forward by re-search-forward with
	whitespace regexp after "character:" to not fail in too narrow windows.

	* simple.el (next-error-find-buffer): Add a rule to return
	next-error capable buffer if one window on the selected frame
	displays such buffer.

2004-05-23  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-server-prefix): New variable.
	(gud-watch, gdb-send-item, gdb-breakpoints-mode, gdb-frames-mode)
	(gdb-locals-mode, gdb-send-item, gdb-toggle-breakpoint)
	(gdb-delete-breakpoint, gdb-frames-select, gdb-threads-buffer)
	(gdb-registers-buffer, gdb-reset, gdb-assembler-buffer):
	Handle new value for gud-minor-mode (gdbmi).
	(gdb-buffer-type, gdb-input-queue, gdb-prompting)
	(gdb-output-sink, gdb-current-item, gdb-pending-triggers):
	Change from local to global gdb variable set.
	(gdb-ann3): Initialise above gdb variable set.
	(gdb-var-update, gdb-var-update-handler, gdb-enqueue-input)
	(gdb-dequeue-input, gdb-source, gdb-pre-prompt, gdb-prompt)
	(gdb-subprompt, gdb-starting, gdb-stopping, gdb-frame-begin)
	(gdb-stopped, gdb-post-prompt, gdb-concat-output)
	(def-gdb-auto-update-trigger, def-gdb-auto-update-handler)
	(gdb-info-locals-handler, gdb-invalidate-assembler)
	(gdb-get-current-frame, gdb-frame-handler): Handle gdb variable
	set as global variables.
	(gdb-get-create-buffer): Don't make gud-comint buffer-local.
	Handle gdbmi.
	(gdb-info-breakpoints-custom): Fix regexp.
	(def-gdb-var): Delete.

	* progmodes/gud.el (gud-menu-map, gud-speedbar-menu-items)
	(gud-speedbar-buttons, gud-sentinel, gud-display-line)
	(gud-basic-call): Handle new value for gud-minor-mode (gdbmi) for
	a new mode.  The file (gdb-mi.el) for this mode will be included
	with the GDB distribution (6.2 onwards) and will use GDB/MI as its
	primary interface.

2004-05-23  Jesper Harder  <harder@ifa.au.dk>

	* progmodes/grep.el (grep-tree): Ensure that DIR argument is
	interpreted as a directory.

2004-05-22  Richard M. Stallman  <rms@gnu.org>

	* textmodes/paragraphs.el (sentence-end): Match unicode curly quotes
	as a close quote.

	* textmodes/bibtex.el: Use assoc-string, not assoc-ignore-case.

	* progmodes/idlw-shell.el (idlwave-shell-get-object-class):
	Use assoc-string, not assoc-ignore-case.

	* progmodes/ada-mode.el: Use assoc-string, not assoc-ignore-case.

	* emacs-lisp/lisp.el (mark-defun, narrow-to-defun):
	If moving back then fwd gets a defun that ends before point,
	try again moving fwd then back.

	* files.el (file-name-non-special): Allow t in file-arg-indices
	to mean requote the return value.  Use `identity' as an element
	rather than as the whole value.

	* gs.el (gs-options): Add -dSAFER.  Mark it risky.

2004-05-22  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-add-fundoc-usage): Use %S only for output of
	`help-make-usage'.
	(help-highlight-arguments): Skip function name before searching
	for arguments.

2004-05-21  Juanma Barranquero  <lektu@terra.es>

	* allout.el (allout-chart-subtree, allout-rebullet-topic-grunt):
	Don't mention in the docstring these arguments meant for
	internal (recursive) use only.
	(allout-char-spec): Comment out (it's not implemented).
	(allout-old-expose-topic, allout-exposure): Fix docstring and add
	obsolescence declaration.
	(allout-flatten-exposed-to-buffer)
	(allout-indented-exposed-to-buffer): Fix typos in docstring.
	(my-mark-marker): Doc fix.
	(produce-allout-mode-map, allout-sibling-index)
	(allout-isearch-expose, allout-distinctive-bullet)
	(allout-open-topic, allout-reindent-body)
	(allout-rebullet-heading, allout-process-exposed)
	(allout-insert-listified, allout-latex-verb-quote)
	(allout-insert-latex-header, allout-insert-latex-trailer):
	Make arguments match their use in docstring.
	(allout-primary-bullet, allout-old-style-prefixes)
	(allout-inhibit-protection, allout-init, allout-mode)
	(allout-before-change-protect, allout-flag-region):
	Use "Emacs" instead of "emacs" in docstrings.

2004-05-21  Masayuki Ataka  <ataka@milk.freemail.ne.jp>  (tiny change)

	* international/characters.el: Modify syntax of more characters.

2004-05-21  Masatake YAMATO  <jet@gyve.org>

	* progmodes/etags.el (tags-apropos, list-tags): Require apropos.
	(etags-tags-completion-table): Show parsing progress.

2004-05-20  Luc Teirlinck  <teirllm@auburn.edu>

	* locate.el (locate-prompt-for-command): Shorten first line of
	docstring.
	(locate-mode): Expand docstring and include keymap summary.

	* files.el (find-file-noselect-1): Limit the scope of the
	`inhibit-read-only' binding.  Make sure that `inhibit-read-only'
	is, by default, nil during the execution of
	`find-file-not-found-functions' and `find-file-hook'.

2004-05-20  Michael Mauger  <mmaug@yahoo.com>

	* facemenu.el (facemenu-color-name-equal): New function.
	(list-colors-display): Use it to compare colors instead of
	facemenu-color-equal.

2004-05-20  Dan Nicolaescu  <dann@ics.uci.edu>

	* compare-w.el (compare-windows-face): Use min-colors instead of
	checking for tty or pc types.

2004-05-19  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (do-auto-fill): Remove unused vars `bol' and `opoint'.
	(completion-setup-function): Use with-current-buffer.
	Properly save excursion.  Simplify.
	Don't assume there is necessarily a `mouse-face' property somewhere.

	* progmodes/gud.el (gud-reset): Use unless & with-current-buffer.

	* progmodes/gdb-ui.el (gdb-reset): Use unless.  Fix regexp.

	* emacs-lisp/bytecomp.el (byte-compile-log): Use backquotes.
	(byte-compile-log-1): Don't call (byte-goto-log-buffer).
	Use with-current-buffer.
	(byte-goto-log-buffer): Delete.
	(byte-compile-log-file): Call compilation-forget-errors.

2004-05-19  Takaaki Ota  <Takaaki.Ota@am.sony.com>  (tiny change)

	* net/ldap.el (ldap-search-internal): Avoid mixing standard error
	output messages into the search result.

2004-05-19  Masatake YAMATO  <jet@gyve.org>

	* wid-edit.el (widget-radio-button-notify): Revert my last
	change.  Reported by Katsumi Yamaoka <yamaoka@jpl.org>.

2004-05-19  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Fix syntax (open/close) of CJK chars.

2004-05-18  Karl Chen  <quarl@hkn.eecs.berkeley.edu>  (tiny change)

	* help-mode.el (help-go-back): Don't depend on position of back button.

2004-05-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* files.el (auto-save-file-name-transforms): Make sure ange-ftp temp
	files files don't contain an accidental additional /.

	* textmodes/tex-mode.el (tex-compilation-parse-errors): Save excursion
	in source buffer.

2004-05-18  Masatake YAMATO  <jet@gyve.org>

	* wid-edit.el (widget-radio-button-notify): Don't pass `widget'
	to widget-apply.  :action method assumes 2 arguments, not 3.

2004-05-17  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/f90.el (f90-end-block-re, f90-start-block-re):
	New constants.
	(hs-special-modes-alist): Add an f90-mode entry.

2004-05-17  Sam Steingold  <sds@gnu.org>

	* emacs-lisp/cl-indent.el (common-lisp-indent-function-1):
	Indent "without-" forms just like "with-" and "do-".  Use regexp-opt.

2004-05-16  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/timer.el (timer-event-handler): Fix last change.

2004-05-15  John Wiegley  <johnw@newartisans.com>

	* eshell/esh-io.el (eshell-get-target): Whitespace changes.
	(eshell-output-object-to-target): Improve output speed 20% by not
	calling `eshell-stringify' if something is already known to be a string.

2004-05-15  Alex Ott  <ott@jet.msk.su>

	* textmodes/ispell.el (ispell-local-dictionary-alist):
	Add windows-1251 to the choice of coding systems.
	(ispell-dictionary-alist-6): Add support for "russianw.aff",
	encoded in cp1251.

2004-05-15  Dan Nicolaescu  <dann@ics.uci.edu>

	* progmodes/compile.el (compilation-warning-face)
	(compilation-info-face): Use min-colors.

2004-05-15  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/close.pbm, toolbar/close.xpm, toolbar/copy.pbm
	* toolbar/copy.xpm, toolbar/cut.pbm, toolbar/cut.xpm
	* toolbar/help.pbm, toolbar/help.xpm, toolbar/home.pbm
	* toolbar/home.xpm, toolbar/index.pbm, toolbar/index.xpm
	* toolbar/jump_to.pbm, toolbar/jump_to.xpm, toolbar/left_arrow.pbm
	* toolbar/left_arrow.xpm, toolbar/new.pbm, toolbar/new.xpm
	* toolbar/open.pbm, toolbar/open.xpm, toolbar/paste.pbm
	* toolbar/paste.xpm, toolbar/preferences.pbm, toolbar/preferences.xpm
	* toolbar/print.pbm, toolbar/print.xpm, toolbar/right_arrow.pbm
	* toolbar/right_arrow.xpm, toolbar/save.pbm, toolbar/save.xpm
	* toolbar/saveas.pbm, toolbar/saveas.xpm, toolbar/search.pbm
	* toolbar/search.xpm, toolbar/spell.pbm, toolbar/spell.xpm
	* toolbar/undo.pbm, toolbar/undo.xpm, toolbar/up_arrow.pbm
	* toolbar/up_arrow.xpm: New icons from GTK+ version 2.

2004-05-15  Kim F. Storm  <storm@cua.dk>

	* emacs-lisp/timer.el (timer-activate): Add optional arg triggered-p.
	Use it to set triggered-p element of timer.
	(timer-event-handler): Set triggered-p element non-nil while running
	the timer function.

2004-05-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* descr-text.el (describe-char-unicode-data)
	(describe-char-unicodedata-file): Re-enable the unicode code now that
	the licensing issues have been cleared in the unicode-4 license.
	(describe-text-properties-1): Remove unused `overlay' var.
	(describe-char): Remove unused var `buffer'.

2004-05-14  David Ponce  <david@dponce.com>

	* tree-widget.el: New file.

2004-05-13  Marcelo Toledo  <marcelo@marcelotoledo.org>

	* language/european.el ("Brazilian Portuguese"): Add support for
	Brazilian Portuguese.

2004-05-13  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-use-virtual-buffers): Only turn on
	`recentf-mode' if this variable has been customized to t.

	* eshell/esh-test.el (eshell-test): Call the function
	`emacs-version' rather than trying to build a custom version string.

2004-05-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* net/telnet.el (telnet-mode): Use define-derived-mode.
	Don't modify the global value of comint-prompt-regexp.

2004-05-13  John Paul Wallington  <jpw@gnu.org>

	* version.el (emacs-version): Check for `gtk' feature before
	`x-toolkit' feature.

2004-05-13  Juanma Barranquero  <lektu@terra.es>

	* files.el (file-truename): Don't mention COUNTER and PREV-DIRS
	arguments in the docstring, they're used only in recursive calls.

	* help-fns.el (help-arg-highlighting-function)
	(help-argument-name): Delete.
	(help-default-arg-highlight): New function.
	(help-do-arg-highlighting): Use it.

2004-05-13  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-disp-window):
	Use `calendar-set-mode-line' for a centered mode-line.

2004-05-13  Takaaki Ota  <Takaaki.Ota@am.sony.com>  (tiny change)

	* calendar/appt.el (appt-disp-window): Do not split window
	excessively when `split-height-threshold' is low.

2004-05-12  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gud.el (gud-mode): Add gud-kill-buffer-hook to
	kill-buffer-hook here and make it local.
	(gud-kill-buffer-hook): Use kill-process for a sure kill.

2004-05-12  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-set-window-height):
	Use save-excursion to protect against misplaced marker.

2004-05-12  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* custom.el (defface): Document that type can have value gtk.

	* faces.el (face-spec-set-match-display): Handle type gtk in display.

2004-05-12  Kenichi Handa  <handa@m17n.org>

	* descr-text.el: Require quail at comile time.
	(describe-char): If an input method is on and it supports the
	character, show how to input it.

	* international/quail.el (quail-install-decode-map): Accept a
	char-table whose subtype is `quail-decode-map'.
	(quail-store-decode-map-key, quail-gen-decode-map1)
	(quail-gen-decode-map, quail-find-key1, quail-find-key)
	(quail-show-key): New functions.

2004-05-12  Juanma Barranquero  <lektu@terra.es>

	* generic.el (define-generic-mode): Remove redundant arglist info.

	* help-fns.el (help-split-fundoc, help-add-fundoc-usage):
	Make arguments match their use in docstring.
	(help-arg-highlighting-function): New variable.
	(help-argument-name): Mention it in the docstring.
	(help-do-arg-highlight): Use it.  Expand regexp to accept also
	ARG-xxx and xxx-ARG references.

2004-05-11  Yoichi NAKAYAMA  <yoichi@geiin.org>  (tiny change)

	* mail/rfc2368.el (rfc2368-parse-mailto-url): Make the results of
	parsing "mailto:addr1%2C%20addr2", "mailto:?to=addr1%2C%20addr2",
	and "mailto:addr1?to=addr2" equal.

2004-05-11  Alexander Pohoyda  <alexander.pohoyda@gmx.net>  (tiny change)

	* man.el (Man-getpage-in-background): Use shell-file-name
	and shell-command-switch variables instead of hard-coded values.

2004-05-11  Eli Zaretskii  <eliz@gnu.org>

	* iimage.el: New file.

2004-05-11  Juanma Barranquero  <lektu@terra.es>

	* custom.el (custom-initialize-default, defcustom):
	Fix typo in docstring.

	* files.el (set-visited-file-name, file-expand-wildcards):
	Fix docstring.

2004-05-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/lisp-mode.el (prin1-char): Use eventp.

	* subr.el (eventp): Be more discriminating with integers.

2004-05-10  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compile): Add universal prefix arg.
	(compilation-error-regexp-alist-alist): Add edg patterns.

2004-05-10  Sam Steingold  <sds@gnu.org>

	* textmodes/ispell.el (ispell-message):
	Use `message-cite-prefix-regexp' instead of `message-yank-prefix'.

2004-05-10  Dave Love  <fx@gnu.org>

	* progmodes/python.el (help-buffer): Autoload when compiling.
	(python-after-info-look): Don't assume Info-goto-node returns non-nil.
	(run-python): Prepend to any existing PYTHONPATH.

2004-05-10  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-annotation-rules): Add nquery annotation
	for pending breakpoints.

2004-05-10  Richard M. Stallman  <rms@gnu.org>

	* mail/unrmail.el (unrmail): Mostly rewritten.  Parses the file
	directly without calling any functions in Rmail.
	(unrmail-unprune): Function deleted.

2004-05-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (inferior-python-mode-map): Remove erroneous
	C-c C-z binding.

2004-05-10  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Fix previous change.  Don't make
	a unibyte character to multibyte in the *Help* buffer.

2004-05-10  Miles Bader  <miles@gnu.org>

	* lisp/progmodes/gud.el (gud-common-init): Only consider an existing
	buffer an error if the debugger process is actually running.

2004-05-10  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-argument-name): Default to italic.
	(help-highlight-arguments): Return always (usage . doc), even when
	usage is nil.

	* ibuf-macs.el (define-ibuffer-column, define-ibuffer-sorter)
	(define-ibuffer-filter): Add usage info.
	(define-ibuffer-op): Add usage info (but CL-style defaults for
	keyword args are not shown).

	* subr.el (remove-overlays, read-passwd): Fix docstring.
	(start-process-shell-command): Fix docstring.  Put usage info in a
	format usable by `describe-function'.
	(open-network-stream, open-network-stream-nowait)
	(open-network-stream-server): Fix docstring.

2004-05-09  Jason Rumney  <jasonr@gnu.org>

	* international/code-pages (cp932, cp936, cp949, c950): Remove.
	Only define cp125* if windows-125* is already defined.

	* language/korean.el (cp949): Add alias.

	* language/chinese.el (cp936, cp950): Add aliases.

	* language/japanese.el (cp932): Add alias.

	* term/w32-win.el: Require code-pages.

	* international/mule-cmds.el (set-locale-environment):
	On MS-Windows use ansi code-page for default coding-systems.
	Set up paper sizes for Windows 3 letter languages.

	* international/code-pages.el (cp932, cp936, cp949, cp950):
	Add aliases.  Also add cp125* if not already defined.

2004-05-09  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-highlight-arguments): Don't try to highlight
	missing or autoloaded arglists.  Accept structured arguments, like
	the first ones of `do' and `flet'.

	* pcvs.el (cvs-mode-run, cvs-is-within-p): Fix typo in docstring.
	(cvs-get-marked): Remove redundant arglist info.

	* net/quickurl.el (quickurl, quickurl-browse-url, quickurl-read):
	Don't use CL-style default args.

2004-05-08  Andreas Schwab  <schwab@suse.de>

	* emacs-lisp/checkdoc.el (checkdoc-minor-mode): Doc fix.

	* international/subst-ksc.el: Fix references to utf-translate-cjk
	into utf-translate-cjk-mode.
	* international/subst-big5.el: Likewise.
	* international/subst-gb2312.el: Likewise.
	* international/subst-jis.el: Likewise.
	* international/utf-16.el: Likewise.
	* international/utf-8.el: Likewise.

2004-05-08  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-use-virtual-buffers): Add support for
	"virtual buffers" (off by default), which makes it possible to
	switch to the "virtual" buffers of recently visited files.  When a
	buffer name search fails, and this option is on, iswitchb will
	look at the list of recently visited files, and permit matching
	against those names.  When the user hits RET on a match, it will
	revisit that file.
	(iswitchb-read-buffer): Add two optional arguments, which makes
	isearchb.el possible.
	(iswitchb-completions, iswitchb-set-matches, iswitchb-prev-match)
	(iswitchb-next-match): Add support for virtual buffers.

	* isearchb.el: This module extends iswitchb to provide "as you
	type" buffer selection.

	* textmodes/flyspell.el (flyspell-highlight-incorrect-region):
	Ignore the read-only property when flyspell highlighting is on.
	Not ignoring it leads to a series of confusing errors.
	(flyspell-highlight-duplicate-region): Ignore read-only, as above,
	but also make sure to call flyspell-incorrect-hook.
	(flyspell-maybe-correct-transposition): Perform transposition test
	by bit twiddling a string, rather than using a temp buffer.
	(flyspell-maybe-correct-doubling): Use a string rather than a temp
	buffer.  This is also the original version of the code, which
	could not be checked in before due to a previous lack of
	assignment papers.  This version has seen heavy usage on my system
	for several years now.

	* calendar/cal-bahai.el: New file, which adds support for the
	Baha'i calendar to Emacs.  This calendar is based on a solar year
	of 19 months of 19 days, with 4 intercalary days.  Each year
	begins on March 21, with the calendar starting in 1844.

	* calendar/cal-menu.el, calendar/calendar.el,
	calendar/diary-lib.el, calendar/holidays.el: Added support for
	using cal-bahai.el.

	* eshell/em-glob.el (eshell-glob-initialize): Move initialization
	of `eshell-glob-chars-regexp' into `eshell-glob-regexp', so that
	function can be used outside of eshell buffers.
	(eshell-glob-regexp): Initialize `eshell-glob-chars-regexp' here.

2004-05-08  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-do-arg-highlight): Temporarily set ?\- to be a
	word constituent so FOO-ARG is not recognized as an arg.
	(help-highlight-arguments): Don't skip lists in mandatory arguments.

	* simple.el (next-error): Fix typo in docstring.
	(open-line): Make argument names match their use in docstring.
	(split-line): Fix docstring.

	* emacs-lisp/cl-macs.el (do, do*): Put usage info in a format
	usable by `describe-function'.
	(gensym, gentemp, typep, ignore-errors): Make argument names match
	their use in docstring.

	* progmodes/python.el (python-describe-symbol): Pass INTERACTIVE-P
	argument to `help-setup-xref'.

2004-05-07  Kai Grossjohann  <kai@emptydomain.de>

	Version 2.0.40 of Tramp released.

	* net/tramp.el (tramp-completion-mode, tramp-md5-function):
	Use symbol-function to invoke functions only known on some Emacs
	flavors.  This avoids byte-compiler warnings.  Reported by Kevin
	Scaldeferri <kevin@scaldeferri.com>.
	(tramp-do-copy-or-rename-file-via-buffer): Rename from
	tramp-do-copy-or-rename-via-buffer (without `file'), to make it
	consistent with the other tramp-do-* functions.
	(tramp-do-copy-or-rename-file): Calls adjusted.
	(tramp-process-initial-commands): Avoid liveness check on shell --
	we know that it must be alive since we're opening a connection at
	this moment.
	(tramp-last-cmd): New internal variable.
	(tramp-process-echoes): New tunable.
	(tramp-send-command): Set tramp-last-cmd.
	(tramp-wait-for-output): Delete echo, if applicable.
	(tramp-read-passwd): Construct the key for the password cache in a
	way that works for multi methods, too.
	(tramp-bug): Add backup-directory-alist and
	bkup-backup-directory-info to bug reports, with Tramp counterparts.

2004-05-07  Michael Albinus  <michael.albinus@gmx.de>

	* net/tramp*.el: Suppress byte-compiler warnings where possible.

	* net/tramp.el (tramp-out-of-band-prompt-regexp)
	(tramp-actions-copy-out-of-band): New defcustoms.
	(tramp-do-copy-or-rename-file-out-of-band): Asynchronous process
	used instead of a synchronous one.  Allows password entering.
	(tramp-action-out-of-band): New defun.
	(tramp-open-connection-rsh, tramp-method-out-of-band-p):
	Remove restriction with password from doc string.
	(tramp-bug): Add variables `tramp-terminal-prompt-regexp',
	`tramp-out-of-band-prompt-regexp',
	`tramp-actions-copy-out-of-band', `password-cache' and
	`password-cache-expiry'.
	(toplevel): Remove todo item wrt ssh-agent.  Obsolete due to
	password caching.
	(tramp-touch): FILE can be a local file, too.
	(TODO): Remove items done.
	(tramp-handle-insert-directory): Properly quote file name also if
	not full-directory-p.  Handle wildcard case.  Reported by Andreas
	Schwab <schwab@suse.de>.
	(tramp-do-copy-or-rename-file-via-buffer): Set permissions of the
	new file.
	(tramp-handle-file-local-copy, tramp-handle-write-region):
	The permissions of the temporary file are set if filename exists.
	Reported by Ted Stern <stern@cray.com>.
	(tramp-backup-directory-alist)
	(tramp-bkup-backup-directory-info): New defcustoms.
	(tramp-file-name-handler-alist): Add entry for `find-backup-file-name'.
	(tramp-handle-find-backup-file-name): New function.
	Implements Tramp's find-backup-file-name.

	* net/tramp-smb.el (tramp-smb-file-name-handler-alist): Add entry
	for `find-backup-file-name'.

	* net/tramp-vc.el (tramp-vc-workfile-unchanged-p): Correct typo
	("file" -> "filename").  Reported by Kim F. Storm <storm@cua.dk>.

2004-05-07  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-mode-handlers): Fix docstring.

2004-05-07  Juanma Barranquero  <lektu@terra.es>

	* subr.el (lambda): Add arglist description to docstring.
	(declare): Fix typo in docstring.
	(open-network-stream): Fix docstring.
	(process-kill-without-query): Fix docstring and add obsolescence info.
	(last, butlast, nbutlast): Make arguments match their use in docstring.
	(insert-buffer-substring-no-properties): Likewise.
	(insert-buffer-substring-as-yank): Likewise.
	(split-string): Fix docstring.

	* emacs-lisp/byte-run.el (make-obsolete, make-obsolete-variable):
	Make argument names match their use in docstring.

	* emacs-lisp/re-builder.el (reb-auto-update): Fix typo in docstring.

2004-05-06  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el: Improve/extend documentation strings.
	Fit first sentence on one line for apropos-command.

2004-05-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	Changes largely merged in from Dave Love's code.
	* progmodes/python.el: Doc fixes.
	(python-mode-map): Add python-complete-symbol.
	(python-comment-line-p, python-beginning-of-string): Use syntax-ppss.
	(python-comment-indent, python-complete-symbol)
	(python-symbol-completions, python-partial-symbol)
	(python-try-complete): New.
	(python-indent-line): Remove optional arg.  Use python-block-end-p.
	(python-check): Bind compilation-error-regexp-alist.
	(inferior-python-mode): Use rx.  Move keybindings to top level.
	Set comint-input-filter.
	(python-preoutput-filter): Use rx.
	(python-input-filter): Re-introduce.
	(python-proc): Start new process if necessary.
	Check python-buffer non-nil.
	(view-return-to-alist): Defvar.
	(python-send-receive): New.
	(python-eldoc-function): Use it.
	(python-mode-running): Don't defvar.
	(python-mode): Set comment-indent-function.
	Maybe update hippie-expand-try-functions-list.
	(python-indentation-levels): Initialize differently.
	(python-block-end-p): New.
	(python-indent-line): Use it.
	(python-compilation-regexp-alist): Augment.
	(run-python): Import `emacs' module to Python rather than loading
	code directly.  Set python-buffer differently.
	(python-send-region): Use emacs.eexecfile.  Fix orig-start calculation.
	Use python-proc.
	(python-send-command): Go to end of comint buffer.
	(python-load-file): Use python-proc, emacs.eimport.
	(python-describe-symbol): Simplify interactive form.
	Use emacs.help.  Do use temp-buffer-show-hook.
	Call print-help-return-message.
	(hippie-exp): Require when compiling.
	(python-preoutput-continuation): Use rx.

	* diff-mode.el (diff-make-unified): Fix regexp.

2004-05-06  Romain Francoise  <romain@orebokech.com>  (tiny change)

	* ibuffer.el (ibuffer-redisplay-engine): Do not remove folded
	filter groups from the buffer when rebuilding the Ibuffer buffer
	and `ibuffer-show-empty-filter-groups' is nil.

2004-05-06  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el (ps-print-quote): Call ps-value-string.
	(ps-setup): Call ps-comment-string.
	(ps-value-string, ps-comment-string): New funs.

2004-05-06  Juanma Barranquero  <lektu@terra.es>

	* ehelp.el (electric-help-command-loop): Check whether the last
	character is visible, not (point-max).

	* help-fns.el (help-argument-name): Default to bold; don't inherit
	from font-lock-variable-name-face.
	(help-do-arg-highlight): Grok also ARGth occurrences in the docstring.

2004-05-05  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Copy the character with text
	properties and overlays into the first line, and call
	describe-text-properties on it.

2004-05-05  Stephen Eglen  <stephen@anc.ed.ac.uk>

	* iswitchb.el (iswitchb-global-map): Fix typo.
	Remove unwanted ###autoloads from source file.

2004-05-05  Lars Hansen  <larsh@math.ku.dk>

	* wdired.el (wdired-change-to-wdired-mode): Quote wdired-mode-hook
	in run-hooks.  Use substitute-command-keys in message.
	(wdired-abort-changes): Add message.

2004-05-03  Michael Mauger  <mmaug@yahoo.com>

	* emacs/lisp/progmodes/sql.el (sql-xemacs-p, sql-emacs19-p)
	(sql-emacs20-p): Remove.
	(sql-mode-syntax-table): Use shared GNU EMacs/XEmacs syntax.
	(sql-builtin-face, sql-doc-face): Remove.
	(sql-mode-ansi-font-lock-keywords)
	(sql-mode-oracle-font-lock-keywords)
	(sql-mode-postgres-font-lock-keywords)
	(sql-mode-linter-font-lock-keywords)
	(sql-mode-ms-font-lock-keywords)
	(sql-mode-mysql-font-lock-keywords): Use standard fonts.
	(sql-product-font-lock): Fix font-lock reset when font rules change.
	(sql-highlight-product): Remove incorrect font-lock reset logic.

2004-05-04  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (ses-set-parameter): Fix typo.

2004-05-04  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-read-internal): Fix call to read-file-name for edit.
	Must expand directory for completion to work; and don't mess with
	process-environment.
	(ido-read-file-name): If command has ido property, don't use ido
	if value is ignore, or read as directory if value is dir.
	Set ido ignore property for dired-do-rename command.

2004-05-04  Juanma Barranquero  <lektu@terra.es>

	* ehelp.el (electric-help-command-loop, electric-help-undefined)
	(electric-help-help): Check against unmapped commands.

	* help-fns.el (help-argument-name): New face, inheriting from
	font-lock-variable-name-face, to highlight function arguments in
	`describe-function' and `describe-key'.
	(help-do-arg-highlight): Auxiliary function to highlight a given
	list of arguments in a string.
	(help-highlight-arguments): Highlight the function arguments and
	all uses of them in the docstring.
	(describe-function-1): Use it.  Do docstring output via `insert',
	not 'princ', so text attributes are preserved.

	* winner.el (winner-mode-map): Move `winner-undo' and
	`winner-redo' to C-c <left> and C-c <right>, respectively (the
	previous bindings conflict with `prev-buffer', `next-buffer').

2004-05-03  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-progress-message): Fix docstring.
	(bibtex-entry-update): New command bound to C-c C-u.
	(bibtex-text-in-string): Fix regexp.
	(bibtex-assoc-of-regexp): Remove.
	(bibtex-progress-message): Fix docstring.
	(bibtex-inside-field): Use if.
	(bibtex-assoc-regexp): New function.
	(bibtex-format-entry): Make code more robust so that it formats
	also old entries.
	(bibtex-autokey-demangle-title): Merge with obsolete function
	bibtex-assoc-of-regexp.
	(bibtex-field-list): New function.
	(bibtex-entry): Use bibtex-field-list.
	(bibtex-parse-entry): Fix docstring.
	(bibtex-print-help-message): Use bibtex-field-list.
	(bibtex-make-field): Use bibtex-field-list.
	(bibtex-entry-index): Bugfix.  Return crossref key if required.
	(bibtex-lessp): Fix docstring.

2004-05-03  Luc Teirlinck  <teirllm@auburn.edu>

	* select.el (xselect-convert-to-string): Move comment to intended line.

2004-05-03  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* toolbar/tool-bar.el (tool-bar-setup): Use lookup-key for
	cut/copy/paste in case menu-bar-enable-clipboard is in effect.

2004-05-03  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* term/x-win.el (x-clipboard-yank): Don't exit on error from
	x-get-selection.

2004-05-03  Jason Rumney  <jasonr@gnu.org>

	* makefile.nt: Remove.

2004-05-03  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--update-indications): Fix last change.
	(cua-mode): Deactivate mark when cua-mode is enabled.

2004-05-02  Luc Teirlinck  <teirllm@auburn.edu>

	* select.el (xselect-convert-to-string): Bind `inhibit-read-only' to t.

2004-05-03  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gud-watch, gdb-display-buffer)
	(gdb-display-source-buffer, gdb-put-breakpoint-icon)
	(gdb-remove-breakpoint-icons, gdb-assembler-custom): Look for
	window over visible frames.
	(gdb-goto-breakpoint): Make buffer display file at breakpoint.

2004-05-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-gcpro): New var.
	(compilation-fake-loc): Use it.
	(compilation-forget-errors): Reset it.

2004-05-02  Dan Nicolaescu  <dann@ics.uci.edu>

	* diff-mode.el (diff-header-face, diff-file-header-face):
	Use min-colors.

2004-05-02  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-sort-buffer): Remove error message.
	(bibtex-clean-entry): Disentangle code.
	(bibtex-realign): New function.
	(bibtex-reformat): Use mapcar and bibtex-realign.  Do not use
	bibtex-beginning-of-first-entry and bibtex-skip-to-valid-entry.
	Remove undocumented optional arg called-by-convert-alien.
	(bibtex-convert-alien): Use bibtex-realign.  Use bibtex-reformat
	for sorting instead of bibtex-sort-buffer.

2004-05-02  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/compile.el (compilation-start): In the
	no-async-subprocesses branch, call sit-for to give redisplay a
	chance to show the updated process status in the mode line, and
	fontify the buffer explicitly after the process exits.

2004-05-01  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-compilation-line-number): Remove.
	(python-compilation-regexp-alist): Don't use it any more.
	(python-orig-start, python-input-filter): Remove.
	(inferior-python-mode): Don't set up comint-input-filter-functions.
	(python-send-region): Use compilation-fake-loc.

	* progmodes/compile.el (compilation-messages-start): New var.
	(compilation-mode): Don't setup next-error-function here.
	(compilation-setup): Set it up here instead (for minor modes as well).
	Make compilation-messages-start buffer local.
	(compilation-next-error-function): Use it.
	(compilation-forget-errors): Set compilation-messages-start.

2004-05-01  Luc Teirlinck  <teirllm@auburn.edu>

	* ielm.el (ielm-prompt-read-only): Update docstring.

	* comint.el (comint-prompt-read-only): Update docstring.
	(comint-update-fence, comint-kill-whole-line)
	(comint-kill-region): New functions.

	* simple.el (kill-whole-line): Use "p" instead of "P" in
	interactive form.

2004-05-01  Juanma Barranquero  <lektu@terra.es>

	* help-fns.el (help-add-fundoc-usage): Use %S instead of %s to
	format arglist so default values in CL-style argument lists are
	correctly shown.

2004-05-01  Jason Rumney  <jasonr@gnu.org>

	* term/w32-win.el (w32-drag-n-drop): Use x-dnd.el functions.

2004-05-01  Kenichi Handa  <handa@m17n.org>

	* international/titdic-cnv.el (miscdic-convert): Don't generate a
	quail file if it is up to date.

2004-04-30  Juri Linkov  <juri@jurta.org>

	* cus-edit.el (custom-mode-map):
	Add key binding `C-x C-s' to `Custom-save'.

	* outline.el (outline-blank-line): New var.
	(outline-next-preface, outline-show-heading)
	(outline-end-of-subtree): Use it.

	* dired-aux.el (dired-touch-initial): New fun.
	(dired-do-chxxx): Call it for op-symbol `touch'.
	(dired-diff): Use `dired-dwim-target-directory'
	if current dired buffer has no buffer mark.

	* bindings.el (propertized-buffer-identification):
	Replace `(:weight bold)' by `Buffer-menu-buffer-face'.
	Add C-M-arrow keys for consistency.

	* files.el (confirm-kill-emacs):
	Change group from top-level `emacs' to `convenience'.

	* emacs-lisp/lisp.el (beginning-of-defun, end-of-defun):
	Push mark on the first call of successive command calls.
	(insert-pair): New fun created from `insert-parentheses' with
	`open' and `close' arguments added.  Enclose active regions
	in paired characters.  Compare adjacent characters syntax with
	inserted characters syntax before inserting a space.
	(insert-parentheses): Call `insert-pair' with ?\( ?\).

	* delsel.el: Don't put `delete-selection' property
	on `insert-parentheses' symbol to take advantage of
	region handling in `insert-pair' function.
	Suggested by Stephan Stahl <stahl@eos.franken.de>.

2004-04-30  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el: Add support for changing cursor types;
	based on patch from Michael Mauger.
	(cua-normal-cursor-color, cua-read-only-cursor-color)
	(cua-overwrite-cursor-color, cua-global-mark-cursor-color):
	Customization cursor type and/or cursor color.
	(cua--update-indications): Handle cursor type changes.
	(cua-mode): Update cursor indications if enabled.

	* menu-bar.el (menu-bar-options-menu): Change menu text for CUA.

	* mouse.el (mouse-drag-copy-region): New defcustom.
	(mouse-set-region, mouse-drag-region-1): Use it.

	* simple.el (kill-ring-save): If region face background color is
	unspecified (if no highlighting), show extent of fully visible
	region even if transient-mark-mode is enabled.

	* emulation/cua-base.el (cua--standard-movement-commands):
	Add cua-scroll-up and cua-scroll-down.
	(cua-scroll-up, cua-scroll-down): New commands.
	(cua--init-keymaps): Remap scroll-up and scroll-down.

	* emulation/cua-rect.el (cua--convert-rectangle-as):
	New defmacro.
	(cua-upcase-rectangle, cua-downcase-rectangle): Use it.
	(cua-upcase-initials-rectangle, cua-capitalize-rectangle):
	New commands (suggested by Jordan Breeding).

2004-04-30  Juanma Barranquero  <lektu@terra.es>

	* smerge-mode.el (smerge-diff-switches): Fix typo in docstring.

2004-04-30  Mario Lang  <mlang@delysid.org>

	* diff.el (diff-switches): Fix typo in docstring.

2004-04-30  Alex Schroeder  <alex@gnu.org>

	* xml.el (xml-debug-print-internal): Don't add newline and
	indentation to text nodes and write empty elements as empty tags
	instead of opening and closing tags.
	(xml-debug-print): Take optional indent-string argument.
	(xml-print): Alias for xml-debug-print.

2004-04-30  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-fill): Use local var `bol' rather
	than duplicate call to `line-beginning-position'.

	* progmodes/f90.el (f90-get-present-comment-type):
	Return whitespace, as well as comment chars, for consistent filling
	of comment blocks.  Use `match-string-no-properties'.
	(f90-break-line): Trim trailing whitespace when filling comments.

2004-04-30  Dave Love  <fx@gnu.org>

	* calendar/diary-lib.el (diary-outlook-formats): New variable.
	(diary-from-outlook-internal, diary-from-outlook)
	(diary-from-outlook-gnus, diary-from-outlook-rmail):
	New functions to import diary entries from Outlook-format
	appointments in mail messages.

2004-04-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (python-send-command): New fun.
	(python-send-region, python-load-file): Use it.

	* progmodes/compile.el (compilation-last-buffer): Add var alias.

	* help-fns.el (help-C-file-name): Use new subr-name.
	Prepend `src/' to the file name.
	(help-C-source-directory, help-subr-name, help-find-C-source): Remove.
	(describe-function-1, describe-variable): Only find a C source file
	name if DOC is already loaded.

	* help-mode.el (help-function-def, help-variable-def):
	Use the new find-function-search-for-symbol functionality.
	Allow FILE to be `C-source'.

	* emacs-lisp/find-func.el (find-function-C-source-directory): New var.
	(find-function-C-source): New fun.
	(find-function-search-for-symbol): Use it.

2004-03-29  Michael Mauger  <mmaug@yahoo.com>

	* progmodes/sql.el (sql-product-alist): Rename variable
	`sql-product-support'.  Add Postgres login parameters.
	(sql-set-product, sql-product-feature): Update with renamed variable.
	(sql-connect-postgres): Add username prompt.
	(sql-imenu-generic-expression, sql-mode-font-lock-object-name):
	Make patterns less product specific.
	(sql-xemacs-p, sql-emacs19-p): Add flags for Emacs variants.
	(sql-mode-abbrev-table): Modify initialization.
	(sql-builtin-face): Add variable.
	(sql-keywords-re): Add macro.
	(sql-mode-ansi-font-lock-keywords): Update for ANSI-92.
	(sql-mode-oracle-font-lock-keywords): Update for Oracle 9i.
	(sql-mode-postgres-font-lock-keywords): Update for Postgres 7.3.
	(sql-mode-mysql-font-lock-keywords): Update for MySql 4.0.
	(sql-mode-linter-font-lock-keywords)
	(sql-mode-ms-font-lock-keywords): Use `sql-keywords-re' macro.
	(sql-mode-sybase-font-lock-keywords)
	(sql-mode-informix-font-lock-keywords)
	(sql-mode-interbase-font-lock-keywords)
	(sql-mode-ingres-font-lock-keywords)
	(sql-mode-solid-font-lock-keywords)
	(sql-mode-sqlite-font-lock-keywords)
	(sql-mode-db2-font-lock-keywords): Default to nil.
	(sql-product-font-lock): Always highlight ANSI keywords.
	(sql-add-product-keywords): Made similar to `font-lock-add-keywords'.
	(sql-send-string): Add function.

2004-04-29  Dave Love  <fx@gnu.org>

	* progmodes/cfengine.el (cfengine-beginning-of-defun)
	(cfengine-end-of-defun): Ensure progress through buffer.

	* info-look.el (cfengine-mode): Accept a terminal ().

2004-04-29  Juri Linkov  <juri@jurta.org>

	* isearch.el (isearch-mode-map): Bind \C-w to isearch-yank-word
	instead of isearch-yank-word-or-char.  Add new key bindings for
	isearch-yank-char to \C-f, and isearch-del-char to \C-b.
	(isearch-del-char): New fun.
	(isearch-forward, isearch-edit-string): Update docstring.
	(isearch-yank-char): Doc fix.
	(isearch-other-meta-char): Restore point after scrolling.

	* progmodes/compile.el (compilation-context-lines): Add nil option
	to disable compilation output window scrolling.
	(compilation-set-window): Use it.

	* outline.el (outline-next-preface, outline-show-heading):
	Don't leave unhidden blank line before heading.
	(outline-end-of-subtree): Include last newline into subtree.
	(hide-entry): Leave point at beginning of heading instead of end.
	(outline-up-heading): Push mark for the first call of successive
	command calls.

2004-04-28  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-prompt-read-only): New variable.
	(comint-output-filter): Implement it.

	* ielm.el (ielm-prompt-read-only, ielm-prompt): Update docstring.
	(ielm-prompt-internal): New variable.
	(ielm-font-lock-keywords): Remove irrelevant ielm-prompt keyword.
	(ielm-send-input): Delete unused variable `buf'.
	(ielm-eval-input): Use `ielm-prompt-internal'.
	(inferior-emacs-lisp-mode): Use new variables
	`comint-prompt-read-only' and `ielm-prompt-internal'.
	Get rid of obsolete variable `directory-sep-char'.
	(ielm): Use `zerop'.

2004-04-29  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (toplevel): Require cl at compile time.
	Remove conditional definitions of `ignore-errors' and `caddar'
	because they occur at run time.

2004-04-28  Nick Roberts  <nickrob@gnu.org>

	* progmodes/gdb-ui.el (gdb-frame-breakpoints-buffer)
	(gdb-frame-assembler-buffer, gdb-frame-threads-buffer)
	(gdb-frame-registers-buffer, gdb-frame-locals-buffer)
	(gdb-frame-gdb-buffer, gdb-frame-stack-buffer): Use selected-window.

	* progmodes/gud.el (gud-common-init): Throw an error if program is
	already running under gdb.

2004-04-28  John Paul Wallington  <jpw@gnu.org>

	* thumbs.el (thumbs-delete-images): Fix formatting of prompt.
	(thumbs-show-image-num): Move assignment of
	`thumbs-current-image-filename' within scope of `i'.
	(thumbs-emboss-image): Don't use `evenp'.

2004-04-28  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compilation-context-lines): Default now 0.

2004-04-28  Juanma Barranquero  <lektu@terra.es>

	Use `time-less-p' from calendar/time-date.el instead of defining
	custom versions of it.

	* pcomplete.el (pcomplete-time-less-p): Remove.

	* thumbs.el (time-less-p): Remove.

	* calendar/timeclock.el (timeclock-time-less-p): Remove.
	(timeclock-generate-report): Use `time-less-p'.

	* emacs-lisp/autoload.el (autoload-before-p): Remove.
	(update-file-autoloads, update-directory-autoloads): Use `time-less-p'.

2004-04-28  Masatake YAMATO  <jet@gyve.org>

	* subr.el (remove-overlays): Make arguments optional.

	* wid-edit.el (widget-specify-button): Put evaporate to the
	overlay for sample.
	(widget-specify-sample): Put evaporate to the overlay for sample.
	(widget-specify-doc): Put evaporate to the overlay for documentation.

2004-04-27  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Make it an index node.  Align node names
	like makeinfo.

2004-04-27  Eli Zaretskii  <eliz@gnu.org>

	* net/browse-url.el (browse-url-netscape-sentinel)
	(browse-url-mozilla-sentinel, browse-url-galeon-sentinel)
	(browse-url-epiphany-sentinel, browse-url-mosaic):
	Use browse-url-*-program instead of a literal program name.

2004-04-27  Kevin Ryde  <user42@zip.com.au>

	* eshell/em-alias.el:
	* eshell/em-dirs.el:
	* eshell/em-hist.el:
	* eshell/em-unix.el: Add "(require 'eshell)", to get necessary
	features when M-x customize-group loads modules before the main
	eshell.el.

2004-04-27  Matthew Mundell  <matt@mundell.ukfsn.org>

	* subr.el (momentary-string-display): Support EXIT-CHAR that is
	either a character representation of an event or an event
	description list.

	* type-break.el: Capitalise Emacs and Lisp.
	(type-break-good-break-interval, type-break-demo-boring-stats)
	(type-break-terse-messages, type-break-file-name): New defcustoms.
	(type-break-post-command-hook)
	(type-break-warning-countdown-string): Quote variable names in doc.
	(type-break-interval-start, type-break-auto-save-file-name): New vars.
	(type-break-mode): Document type-break-good-break-interval and the
	"session" file.  Schedule break according to the session file.
	Kill session file buffer on exit.  Organise for save-some-buffers
	to always save the session file.
	(type-break-mode-line-message-mode, type-break-query-mode):
	Uppercase arguments.
	(type-break-file-time, type-break-file-keystroke-count, timep)
	(type-break-choose-file, type-break-get-previous-time)
	(type-break-get-previous-count): New defuns.
	(type-break): Avoid break querying after a completed break in the
	case where the query was initiated during user invocation of the
	break.  Optional terse messages.
	Use type-break-good-break-interval if type-break-good-rest-interval is
	nil.  File the break time.
	(type-break-schedule): New optional args for overriding the use of
	the current time.
	(type-break-cancel-time-warning-schedule): Avoid leftover warnings
	after a break.
	(type-break-check): File the keystroke count.
	(type-break-do-query): Prevent a second query when the break is
	interrupted.  Optional terse message.
	(type-break-keystroke-reset): Record the start of a typing interval.
	(type-break-demo-boring): Optional terse messages.  Display word
	per minute and keystroke counts according to
	type-break-demo-boring-stats.

2004-04-27  Daniel M Coffman  <coffmand@us.ibm.com>  (tiny change)

	* arc-mode.el (archive-maybe-copy): If ARCHIVE includes leading
	directories, make sure they exist under archive-tmpdir.

2004-04-27  Juri Linkov  <juri@jurta.org>

	* help.el (view-emacs-news): With argument, display info for the
	selected version by finding it among different NEWS files, and
	narrowing the buffer to the selected version.

	* info.el: Add *info*<[0-9]+> to same-window-regexps instead of
	same-window-buffer-names.
	(info): New arg `buffer'.  Use it.  Doc fix.  Read file name for
	non-numeric prefix argument, append the number to the buffer name
	for numeric prefix argument.
	(info-other-window): Bind same-window-regexps to nil.
	(Info-reference-name): Rename to Info-point-loc.
	(Info-find-node-2): Call forward-line for numeric Info-point-loc,
	and Info-find-index-name for stringy Info-point-loc.
	(Info-extract-menu-node-name): New arg `index-node'.  Use regexp
	without middle `.', but with final `.' and optional line number
	for it.  Set Info-point-loc for index nodes.
	(Info-index): Remove middle `.' from index entry regexp.
	Modify line number regexp.
	(Info-index-next): Decrement line number.
	(info-apropos): Remove middle `.' from index entry regexp.
	Add optional line number regexp at the end.  Add matched value
	for line number to the result list and insert it to the buffer.
	Replace match-string by match-string-no-properties.
	Reorder result list.
	(Info-fontify-node): Hide index line numbers.
	(Info-goto-node): Replace "\\s *\\'" by "\\s +\\'" to not trim
	empty matches.
	(Info-follow-reference): Use `str' instead of
	Info-following-node-name-re.
	(Info-toc): Use full file names.  Set Info-current-node to "Top".
	(Info-fontify-node): Compare file names without directory name.
	(Info-try-follow-nearest-node): Don't set Info-reference-name.
	Set second arg of Info-extract-menu-node-name for index nodes.
	(info-xref-visited): Use magenta3 instead of magenta4.
	(Info-mode): Add info-apropos to docstring.

	* log-view.el (log-view-diff): Replace interactive code "r"
	by a list to allow to call it even if region is not active.

	* paren.el (show-paren-highlight-openparen): New var.
	(show-paren-function): Turn on openparen highlighting when
	matching forward if show-paren-highlight-openparen is non-nil.

	* simple.el (kill-ring-save): Use blink-matching-delay instead of
	the constant value 1.
	(completions-common-part): Expand docstring.

	* textmodes/picture.el (picture-mode-map): Add arrow keys.

2004-04-27  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-sliced-image): Use line-height instead of
	line-spacing property on newline.

2004-04-26  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-misc-data-function): Rename to
	desktop-save-buffer and change docstring.
	(desktop-buffer-modes-to-save): Delete.
	(desktop-save-buffer-p): Use desktop-save-buffer instead of
	desktop-buffer-modes-to-save.
	(desktop-save): Rename desktop-buffer-misc-data-function to
	desktop-save-buffer and allow non-function value.
	(desktop-missing-file-warning): Correct docstring.

	* dired.el (dired-mode): Rename desktop-buffer-misc-data-function
	to desktop-save-buffer.

	* info.el (Info-mode): Rename desktop-buffer-misc-data-function	to
	desktop-save-buffer.

	* mail/rmail.el (rmail-variables): Bind desktop-save-buffer to t.

	* mh-e/mh-e.el (mh-folder-mode): Bind desktop-save-buffer to t.

2004-04-26  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/gud.el (gud-pdb-command-name): Change default to "pydb".

2004-04-25  Luc Teirlinck  <teirllm@auburn.edu>

	* ielm.el (ielm-prompt-read-only, ielm-prompt): Expand docstring.
	(ielm): Only go to the end of the buffer when starting a new process.

2004-04-25  Juanma Barranquero  <lektu@terra.es>

	* ielm.el (inferior-emacs-lisp-mode): Display working buffer on the
	mode line.  Bind `inhibit-read-only' to t before modifying
	properties of text in the buffer.
	(ielm): Force point to the end of buffer, even when running ielm
	from inside itself.

2004-04-25  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Reset Info-complete-cache.

2004-04-25  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-error-regexp-alist-alist):
	Also recognize severe Irix et al. messages.
	(compilation-normalize-filename, compile-abbreviate-directory):
	Delete functions.
	(compilation-get-file-structure): New function inherits
	functionality of the two preceding ones.
	(compilation-internal-error-properties, compilation-fake-loc):
	Use it so that different paths to the same file share the same
	markers.  Also optimize finding adjacent marker slightly.

2004-04-25  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-sliced-image): Add line-spacing t property
	to newlines separating image lines.

2004-04-24  Luc Teirlinck  <teirllm@auburn.edu>

	* comint.el (comint-delete-output): Bind inhibit-read-only to t.

	* ielm.el (ielm-prompt-read-only): New user option.
	(ielm-prompt): Expand docstring to describe new behavior.
	(inferior-emacs-lisp-mode): Implement ielm-prompt-read-only and
	mention it in the docstring.

2004-04-24  Andreas Schwab  <schwab@suse.de>

	* progmodes/sh-script.el (sh-leading-keywords) <sh>: Add "!".

	* diff.el (diff): Set default-directory in diff buffer.

2004-04-24  Eli Zaretskii  <eliz@gnu.org>

	* mail/sendmail.el (mail-bury): Don't delete the frame where the
	mail was being composed if the terminal cannot display more than
	one frame; instead, switch to previous frame.

	* mail/rmail.el (rmail-mail-new-frame): Doc fix.
	(rmail-start-mail): Support rmail-mail-new-frame even on
	terminals that can display only one frame at a time.

2004-04-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/checkdoc.el (checkdoc-output-error-regex-alist): New var.
	(checkdoc-output-font-lock-keywords): Remove error regexp.
	(checkdoc-output-mode-map): Remove.
	(checkdoc-output-mode): Derive from compilation-mode.
	(checkdoc-find-error-mouse, checkdoc-find-error): Remove.

	* dired.el (dired-mode-map): Add a menu entry for wdired.

	* emacs-lisp/rx.el (rx-syntax): Move sregex style syntax to code.
	(rx-bracket, rx-check-any, rx-any): Clean up name space.

	* wdired.el: (wdired-mode-map): Move init into declaration.
	Fix `return' binding.
	(wdired-change-to-wdired-mode, wdired-change-to-dired-mode):
	Use force-mode-line-update.
	(wdired-get-filename): Use `unless'.
	(wdired-preprocess-files): Don't assume names have no \n and use / for
	dir separator.
	(wdired-normalize-filename): Use replace-regexp-in-string.
	(wdired-load-hooks): Remove.
	(wdired-mode-hooks): Rename to wdired-mode-hook.

	* info-look.el: Add support for cfengine-mode.
	(info-lookup-setup-mode): Use dolist.

2004-04-23  Juan Le,As(Bn Lahoz Garc,Am(Ba  <juan-leon.lahoz@tecsidel.es>

	* wdired.el: New file.

2004-04-23  Juanma Barranquero  <lektu@terra.es>

	* ielm.el (inferior-emacs-lisp-mode): Fix docstring.

	* pcomplete.el (pcomplete-opt, pcomplete-actual-arg)
	(pcomplete-match-string, pcomplete-comint-setup, pcomplete-here)
	(pcomplete--help, pcomplete--here): Doc fixes.

2004-04-23  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-default-workfile-unchanged-p): Fix code that
	handles wrong-number-of-arguments in backend call.

	* vc.el (vc-print-log): Likewise.

2004-04-20  Dave Love  <fx@gnu.org>

	* emacs-lisp/rx.el: Doc fixes.
	(rx-constituents): Add/extend many forms.
	(rx-check): Check form is a list.
	(bracket): Defvar.
	(rx-check-any, rx-any, rx-check-not): Modify.
	(rx-not): Simplify.
	(rx-trans-forms, rx-=, rx->=, rx-**, rx-not-char, rx-not-syntax): New.
	(rx-kleene): Use rx-trans-forms.
	(rx-quote-for-set): Delete.
	(rx): Allow multiple args.

2004-04-23  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (char-displayable-p): Simplify by
	using internal-char-font.

2004-04-23  Juanma Barranquero  <lektu@terra.es>

	* makefile.w32-in: Add "-*- makefile -*-" mode tag.

2004-04-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-next-error): New fun.
	(diff-mode): Use it.

	* simple.el (next-error): Change arg name.
	Add support for the documented C-u C-x ` usage.

	* frame.el (special-display-popup-frame, next-multiframe-window)
	(previous-multiframe-window): Only consider frames on same display.

2004-04-22  Lars Hansen  <larsh@math.ku.dk>

	* info.el (Info-restore-desktop-buffer): Delete with-no-warnings.
	* mh-e/mh-e.el (mh-restore-desktop-buffer): Delete with-no-warnings.

2004-04-22  Kim F. Storm  <storm@cua.dk>

	* net/telnet.el (telnet): Add optional port arg.

2004-04-21  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Minor sanity check on the `hyperlink' slot.

	* Makefile.in (recompile): Compile new files.

	* emacs-lisp/bytecomp.el (batch-byte-recompile-directory):
	Add byte-recompile-directory's optional `arg'.

	* cvs-status.el (cvs-tree-use-charset): New var.
	(cvs-tree-char-space, cvs-tree-char-hbar, cvs-tree-char-vbar)
	(cvs-tree-char-branch, cvs-tree-char-eob, cvs-tree-char-bob)
	(cvs-status-cvstrees): Use it.

	* emacs-lisp/checkdoc.el (checkdoc-output-mode):
	Make it a normal major mode.
	(checkdoc-buffer-label): Make sure the file name is meaningful.
	(checkdoc-output-to-error-buffer): Remove.
	(checkdoc-error, checkdoc-start-section): Rewrite.

	* info.el (info-node, info-menu-5, info-xref, info-header-node)
	(Info-title-1-face, Info-title-2-face, Info-title-3-face)
	(Info-title-4-face): Use new syntax.
	(info-xref-visited): Inherit from info-xref.

	* progmodes/python.el (python-maybe-jython): Don't assume point-min==1.

2004-04-21  Teodor Zlatanov  <tzz@lifelogs.com>

	* simple.el (next-error-last-buffer, next-error-function):
	New variables for the next-error framework.
	(next-error-buffer-p): New function.
	(next-error-find-buffer): Generalize compilation-find-buffer.
	(next-error, previous-error, first-error, next-error-no-select)
	(previous-error-no-select): Move from compile.el.

	* replace.el (occur-next-error, occur-1): Hook into the next-error
	framework.

	* progmodes/compile.el (compilation-start):
	Set next-error-last-buffer so next-error knows where to jump.
	(compilation-setup): Set the buffer-local variable
	next-error-function to 'compilation-next-error-function.
	(compilation-buffer-p, compilation-buffer-internal-p): Use an
	alternate way to find if a buffer is a compilation buffer, for
	next-error convenience.
	(next-error-no-select, previous-error-no-select, next-error)
	(previous-error, first-error): Move to simple.el.
	(compilation-find-buffer): Move to next-error-find-buffer in simple.el.
	(compilation-last-buffer): Remove.
	(compilation-start, compilation-next-error, compilation-setup)
	(compilation-next-error-function, compilation-find-buffer):
	Remove compilation-last-buffer use.

2004-04-21  Juanma Barranquero  <lektu@terra.es>

	* font-lock.el (font-lock-preprocessor-face): Remove spurious quote.
	(font-lock-warning-face): Fix spacing.

	* makefile.w32-in (WINS): Add url/ directory.

2004-04-21  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-mode-handlers): New variable.
	Alist of major mode specific functions to restore a desktop buffer.
	(desktop-buffer-handlers): Make variable obsolete.
	(desktop-create-buffer): Use desktop-buffer-mode-handlers.
	Catch errors signaled in handlers.  Update buffer count.
	Evaluate desktop-buffer-point.
	(desktop-buffer-dired): Rename to dired-restore-desktop-buffer and
	move to dired.el.
	(desktop-buffer-info): Rename to Info-restore-desktop-buffer and
	move to info.el.
	(desktop-buffer-rmail): Rename to rmail-restore-desktop-buffer and
	move to mail/rmail.el.
	(desktop-buffer-mh): Rename to mh-restore-desktop-buffer and move
	to mh-e/mh-e.el.
	(desktop-buffer-file): Rename to desktop-restore-file-buffer.
	On fail, print message (to message buffer) even if
	desktop-missing-file-warning is nil.
	(desktop-buffer-misc-data-function): New buffer local variable.
	Function returning major mode specific data.
	(desktop-buffer-misc-functions): Make variable obsolete.
	(desktop-save): Use desktop-buffer-misc-data-function.
	(desktop-buffer-dired-misc-data): Rename to
	dired-desktop-buffer-misc-data and move to dired.el.
	(desktop-buffer-info-misc-data): Rename to
	Info-desktop-buffer-misc-data and move to info.el.
	(desktop-read): Add message about number of buffers restored/failed.

	* dired.el (dired-restore-desktop-buffer) Move from desktop.el.
	Add parameters.  Pause to display error only when
	desktop-missing-file-warning is non-nil.
	(dired-desktop-buffer-misc-data): Move from desktop.el.  Add parameter.
	(dired-mode): Bind desktop-buffer-misc-data-function.

	* info.el (Info-restore-desktop-buffer): Move from desktop.el.
	Add Parameters.
	(Info-desktop-buffer-misc-data): Move from desktop.el.  Add parameter.
	(Info-mode): Bind desktop-buffer-misc-data-function.

	* mail/rmail.el (rmail-restore-desktop-buffer): Move from desktop.el.
	Add Parameters.

	* mh-e/mh-e.el (mh-restore-desktop-buffer): Move from desktop.el.
	Add Parameters.

2003-04-21  Paul Pogonyshev  <pogonyshev@gmx.net>

	* dabbrev.el (dabbrev--substitute-expansion): Don't lose
	the case of letters in case-insensitive expansions when the
	abbrev is preceded by characters with letter syntax.

2004-04-21  Richard M. Stallman  <rms@gnu.org>

	* progmodes/cperl-mode.el (cperl-putback-char):
	Delete Emacs 18 definition.

	* international/mule.el (ctext-post-read-conversion):
	Use assoc-string, not assoc-ignore-case.

	* international/mule-cmds.el: Use assoc-string, not assoc-ignore-case.

	* emacs-lisp/easymenu.el (easy-menu-add):
	Do call x-popup-menu, but only if it's defined.

	* emacs-lisp/disass.el (disassemble): Handle lambda-exp as arg.

	* emacs-lisp/bytecomp.el (byte-compile-no-warnings):
	Handle multiple args: compile like progn.

	* emacs-lisp/byte-run.el (with-no-warnings): Simplify:
	take all args as &rest arg.

	* autoinsert.el (auto-insert-alist): Insert the user's name in
	copyright notice, rather than Free Software Foundation.

2004-04-21  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Make it work on *Help* buffer.

2004-04-21  Kim F. Storm  <storm@cua.dk>

	* image.el (insert-image): Add optional SLICE arg.
	(insert-sliced-image): New defun.

2004-04-20  Lawrence Mitchell  <wence@gmx.li>  (tiny change)

	* subr.el (read-number): Check whether `default' is nil.

2004-04-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-error-properties):
	Split into two.
	(compilation-internal-error-properties): New one.
	(compilation-compat-error-properties): Use it.  Fix the non-marker case.

2004-04-20  Richard M. Stallman  <rms@gnu.org>

	* window.el (split-window-save-restore-data):
	Don't update the data if OLD-INFO is nil.

	* view.el (view-return-to-alist): Mark it permanent local.

	* subr.el (event-modifiers): Fix the criterion for ASCII control chars.

	* recentf.el (recentf-save-list): Catch and warn about errors.

	* menu-bar.el (menu-bar-update-buffers): Call copy-sequence
	so "Buffers" won't be pure.

	* help-mode.el (help-mode-finish): Set help-return-alist first
	thing, setting only the entry for the selected window.

	* help-fns.el (describe-function-1): If many non-control non-meta
	keys run the command, don't list all of them.

2004-04-20  Juanma Barranquero  <lektu@terra.es>

	* vc-svn.el (vc-svn-print-log, vc-svn-diff): Add optional BUFFER
	arg.  Copied from Andre Spiegel's patch of 2004-03-21.

	* calendar/time-date.el (time-to-day-in-year): Fix docstring.

2004-04-20  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-lookup-key): New optional arg
	NOT-RESET-INDICES.
	(quail-get-translations): Call quail-lookup-key with
	NOT-RESET-INDICES t.
	(quail-completion): Likewise.
	(quail-lookup-map-and-concat): Likewise.

2004-04-20  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-update-translation): Don't insert
	such an unsupported multibyte char in a unibyte buffer.

2004-04-20  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-frame-parameters): New constant.
	(gdb-frame-breakpoints-buffer, gdb-frame-stack-buffer)
	(gdb-frame-threads-buffer, gdb-frame-registers-buffer)
	(gdb-frame-locals-buffer, gdb-frame-gdb-buffer)
	(gdb-frame-assembler-buffer): Improve behaviour with
	multiple frames.
	(gdb-display-buffer): Extend search to all visible frames.

2004-04-19  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Don't remove ^M
	characters left after base64 decoding.
	(rmail-decode-region): Use -dos variety of `coding', to remove any
	^M characters left after qp or base64 decoding.

2004-04-19  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-open-local-file, x-dnd-open-file): Improve error
	messages.

2004-04-19  Stephen Eglen  <stephen@gnu.org>

	* add-log.el (add-change-log-entry): Update doc string to mention
	add-log-full-name and add-log-mailing-address.

2004-04-18  Juri Linkov  <juri@jurta.org>

	* info.el (Info-find-file, Info-find-node-2): Add history and toc.
	(Info-find-node-2): Simplify error message.
	(Info-insert-dir): Use Info-following-node-name.
	(Info-goto-node): Remove *info-history* and *info-toc*.
	(Info-history): Create a node of the virtual history file.
	(Info-toc): Create a node of the virtual toc file.
	(Info-insert-toc): New arg `curr-file' for reference file names.
	(info-apropos): Remove redundant var binding for temp-file.
	(Info-index, Info-index-next, Info-mode): Doc fix.
	(Info-goto-emacs-command-node): Don't jump to *info* from
	non-*info* Info buffers.
	(Info-fontify-node): Don't show the file name of external
	references if `Info-hide-note-references' is `hide'.  Don't hide
	newlines at the end of paragraphs.

	* international/mule-diag.el (list-input-methods):
	Fix args to help-xref-button.

	* help-fns.el (help-with-tutorial): Call `hack-local-variables'
	to put into effect local variables from TUTORIAL files.

	* textmodes/paragraphs.el (sentence-end) <function>: New fun
	with default value taken from the variable `sentence-end'.
	(sentence-end) <defcustom>: Set default to nil.  Doc fix.
	Add nil const to :type.
	(sentence-end-without-period, sentence-end-double-space)
	(sentence-end-without-space): Doc fix.

	* textmodes/paragraphs.el (forward-sentence):
	* textmodes/fill.el (canonically-space-region, fill-nobreak-p)
	(fill-delete-newlines):
	* progmodes/cc-cmds.el (c-beginning-of-statement):
	Use function `sentence-end' instead of variable `sentence-end'.

2004-04-18  Andreas Schwab  <schwab@suse.de>

	* progmodes/compile.el (compilation-start): Set window start to
	point-min if compilation-scroll-output is nil.

2004-04-18  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-completions): Remove dependency on cl.

2004-04-18  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-goto-info): Require 'info.
	(gdb-info-breakpoints-custom): Revert previous change.
	(gdb-view-assembler): Update assembler if necessary.
	(gdb-frame-handler): Parse correctly for gdb-current-frame.
	(gdb-display-source-buffer): Update properly when both source and
	assembler are visible.

2004-04-17  John Wiegley  <johnw@newartisans.com>

	* iswitchb.el (iswitchb-max-to-show): Add a new config variable
	which limits the number of names shown in the minibuffer.  Off by
	default.
	(iswitchb-completions): Use `iswitchb-max-to-show'.  This speeds
	up iswitchb for users with a multitude of open buffers by showing
	only the first and last N/2 buffers in the completion list (which
	is enough to aid C-s/C-r, and to know that more characters are
	needed to refine the completion list).

2004-04-17  Richard M. Stallman  <rms@gnu.org>

	* files.el (locate-file-completion): Handle nil in path-and-suffixes.
	(file-truename): Expand all ~ constructs directly.
	(insert-directory): Delete any error msg output by the
	`insert-directory-program'.

	* allout.el (allout-mode-exposure-menu, allout-mode-editing-menu):
	(allout-mode-navigation-menu, allout-mode-misc-menu): New defvars.
	(allout-prior-bindings, allout-added-bindings): Defvars deleted.
	(allout-init): Use find-file-hook, not find-file-hooks.
	(allout-mode): Eliminate Emacs 18 support.
	Use write-contents-functions, not local-write-file-hooks.

2004-04-17  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-error-properties): Fix for
	adding messages when there are already markers for their file.
	(compilation-fake-loc): New function.

2004-04-16  Dave Love  <fx@gnu.org>

	* progmodes/python.el (python-compilation-line-number): Fix braindamage.
	(python-load-file): Fix python-orig-start setting.

	* progmodes/compile.el: Doc fixes.
	(compilation-error-regexp-alist-alist)
	(compilation-mode-font-lock-keywords): Allow non-ASCII where possible.
	(compilation-assq): Wrap in eval-when-compile.
	(compilation-mode-font-lock-keywords): Don't use list*.
	(compilation-start): Avoid warning.
	(compilation-compat-error-properties)
	(compilation-directory-properties): Add keymap property.
	(compilation-parsing-end): Make it a marker for better compatibility.

	* progmodes/python.el (python-after-info-look): Use with-no-warnings.

2004-04-16  Mark A. Hershberger  <mah@everybody.org>

	* xml.el: Doc fixes.
	(xml-get-children): Only looks at sub-tags and ignore strings.

	* xml.el (xml-parse-tag): Avoid overwriting node-name.

2004-04-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-end-of-hunk): Be more careful with unified hunks.

2004-04-16  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-default-workfile-unchanged-p): Quote signal.

	* vc.el (vc-print-log): Likewise.

2004-04-16  Masatake YAMATO  <jet@gyve.org>

	* simple.el (completion-setup-function): Set an initial value
	to `element-common-end' before entering loop.  Set a value
	to `element-common-end' at the end of loop.
	The bug is reported by Juri Linkov <juri@jurta.org> in emacs-devel list.
	(completions-common-part): Rename from completion-de-emphasis.
	(completions-first-difference): Rename from completion-emphasis.
	Suggested by RMS.

2004-04-16  Juanma Barranquero  <lektu@terra.es>

	* bookmark.el (bookmark-send-edited-annotation): Fix docstring.
	(bookmark-edit-annotation-mode): Add mode name.

2004-04-15  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-match-conflict): Try to do something sensible
	for nested conflict markers.
	(smerge-find-conflict): Better handle errors in smerge-match-conflict.

2004-04-15  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-goto-info): New function.

	* progmodes/gud.el (gud-menu-map, gud-tool-bar-map): Add help button.

2004-04-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/bytecomp.el (batch-byte-compile-file):
	Give a backtrace if requested.

	* progmodes/ada-mode.el (ada-create-menu): Remove redundant call.

	* progmodes/python.el (python-mouse-2-command, python-RET-command):
	Remove unused functions.
	(python-orig-start-line, python-orig-file): Remove.
	(python-orig-start): New var.
	(python-input-filter, python-compilation-line-number)
	(python-send-region, python-load-file): Use it.

	* info.el (info): Always jump to *info*.

	* subr.el (posn-set-point): New function.

	* mouse.el (mouse-set-point): Use it.

	* progmodes/compile.el (compile-goto-error): Use it.
	(compilation-button-map): New keymap.
	(compilation-error-properties): Use it.
	(compilation-shell-minor-mode-map): Don't bind mouse-2.

	* smerge-mode.el (smerge-popup-context-menu): Use it.

	* emacs-lisp/checkdoc.el (checkdoc-output-mode-map)
	(checkdoc-find-error-mouse, checkdoc-find-error): Use it to merge the
	mouse and non-mouse case.

	* diff-mode.el (diff-goto-source): Make it work for mouse bindings.
	(diff-mouse-goto-source): Make it an alias of diff-goto-source.

	* pcvs.el (cvs-mode-toggle-mark): Rename from cvs-mouse-toggle-mark.
	Make it work for non-mouse events.

	* pcvs-info.el (cvs-status-map): Update binding name.

2004-04-14  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-maybe-do-ns): New function to handle namespace
	parsing of both attribute and element names.
	(xml-ns-parse-ns-attrs, xml-ns-expand-el, xml-ns-expand-attr)
	(xml-intern-attrlist): Remove in favor of xml-maybe-do-ns.
	(xml-parse-tag): Update assumed namespaces.  Clean up namespace parsing.
	(xml-parse-attlist): Make it do its own namespace parsing.

2004-04-14  Dave Love  <fx@gnu.org>

	* progmodes/python.el (run-python): Fix use of \n.
	(python-load-file): Remove `try' from Python fragment.
	(python-describe-symbol): Fix message.

	* comint.el: Doc fixes.
	(comint-last-input-start, comint-last-input-end)
	(comint-last-output-start): Give them values.
	(comint-arguments): Avoid warning.
	(comint-skip-prompt): Use line-end-position.
	(comint-backward-matching-input): Rename arg to agree with doc.
	(comint-extract-string): Use syntax-ppss.
	(comint-dynamic-simple-complete): Delete useless list construction.
	(comint-redirect-subvert-readonly): New.
	(comint-redirect-preoutput-filter): Use it.

	* emacs-lisp/lisp.el (beginning-of-defun-raw, end-of-defun):
	Correctly handle negative arguments when calling hook functions.

2004-04-14  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Don't clobber Info-history-list.

2004-04-14  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-setup):
	Localize overlay-arrow-position.
	(compilation-sentinel): Restructure code equivalently.
	(compilation-next-error): Find message on same line after point if
	not found before point.
	(compile-mouse-goto-error): Restore function so that compilation
	buffer need not be current and use compile-goto-error.
	(compile-goto-error): Restore function.
	(next-error): Set overlay-arrow-position.
	(compilation-forget-errors): Don't localize already local
	compilation-locs and remove FIXME about refontifying.

2004-04-14  Kim F. Storm  <storm@cua.dk>

	* startup.el (emacs-quick-startup): New defvar (set by -Q).
	(command-line): New option -Q.  Like -q --no-site-file, but
	in addition it also disables menu-bar, tool-bar, scroll-bars,
	tool-tips, and the blinking cursor.
	(command-line-1): Skip startup screen if -Q.
	(fancy-splash-head): Use ":align-to center" prop to center splash image.

	* emulation/cua-base.el (cua-read-only-cursor-color)
	(cua-overwrite-cursor-color, cua-global-mark-cursor-color): Doc fix.

2004-04-13  Dave Love  <fx@gnu.org>

	* progmodes/python.el: Doc fixes.  Changes for compiler warnings.
	(syntax): Don't require.
	(python) <defgroup>: Add :version.
	(python-quote-syntax): Re-written.
	(inferior-python-mode): Move stuff here from run-python and add
	some more.
	(python-preoutput-continuation, python-preoutput-result)
	(python-dotty-syntax-table): New.
	(python-describe-symbol): Use them.
	(run-python): Move stuff to inferior-python-mode.  Modify code
	loaded into Python.
	(python-send-region): Use python-proc, python-send-string.
	(python-send-string): Send newlines too.  Callers changed.
	(python-load-file): Re-written.
	(python-eldoc-function): New.
	(info-look): Don't require.
	(python-after-info-look): New.  A modified version of former
	top-level code for use with eval-after-load.
	(python-maybe-jython, python-guess-indent): Use widened buffer.
	(python-fill-paragraph): Re-written.
	(python-mode): Fix outline-regexp.  Set outline-heading-end-regexp,
	eldoc-print-current-symbol-info-function.  Add to eldoc-mode-hook.

2004-04-13  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/python.el (run-python): Use compilation-shell-minor-mode.
	Set compilation-error-regexp-alist earlier.

	* progmodes/compile.el (compilation-minor-mode-map)
	(compilation-shell-minor-mode-map, compile-mouse-goto-error)
	(compile-goto-error): Re-merge the mouse and non-mouse commands.

2004-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compile-goto-error): Select the buffer/window
	corresponding to the event.

2004-04-12  Joe Buehler  <jbuehler@hekiman.com>

	* loadup.el: Add cygwin to system-type list, for unexec() support.

2004-04-12  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (ibuffer-delete-window-on-quit): Remove.
	(ibuffer-restore-window-config-on-quit): New variable to replace
	`ibuffer-delete-window-on-quit'.  Update all references.
	(ibuffer-prev-window-config): New variable.
	(ibuffer-quit): Restore previous window configuration instead of
	deleting window.
	(ibuffer): Save window configuration before showing Ibuffer buffer.

	* help.el (describe-mode): Doc fix.

2004-04-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-mode-font-lock-keywords): Fix test
	not to treat nil as a function.

	* vc-arch.el (vc-arch-root): Be a bit more careful.
	(vc-arch-register): Save the buffer if we modified it.
	(vc-arch-delete-rej-if-obsolete): Save excursion.
	(vc-arch-find-file-hook): Use the simpler after-save-hook.
	(vc-arch-responsible-p, vc-arch-init-version): New functions.

	* net/ldap.el (ldap-search): Use list*.

2004-04-12  Juri Linkov  <juri@jurta.org>

	* info.el (Info-follow-reference): Allow multiline reference name.

2004-04-11  Dave Love  <fx@gnu.org>

	* emacs-lisp/bytecomp.el (byte-compile-cond): Fix last change.

	* progmodes/python.el: New file.

2004-04-11  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-arg-list): Function removed.
	(vc-default-workfile-unchanged-p): Use condition-case to check for
	backward compatibility.

	* vc.el (vc-print-log): Use condition-case to check for backward
	compatibility.

2004-04-11  Juri Linkov  <juri@jurta.org>

	* dired.el (dired-faces): New defgroup.
	(dired-header, dired-mark, dired-marked, dired-flagged)
	(dired-warning, dired-directory, dired-symlink, dired-ignored):
	New faces.
	(dired-header-face, dired-mark-face, dired-marked-face)
	(dired-flagged-face, dired-warning-face, dired-directory-face)
	(dired-symlink-face, dired-ignored-face): New face variables.
	(dired-font-lock-keywords): Use them instead of font-lock faces.
	Split the rule for dired marks into 3 separate rules: for marks,
	marked file names and flagged file names.

	* help-mode.el (help-make-xrefs): Add a final newline to the
	*Help* buffer.

2004-04-11  John Paul Wallington  <jpw@gnu.org>

	* replace.el (occur-engine): Distinguish between one and several
	matches in the matches per buffer heading.

2004-04-11  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-confirm-unique-completion): New defcustom.
	(ido-complete): Use it.
	(ido-write-file): Set it to t unconditionally.

2004-04-10  Miles Bader  <miles@gnu.org>

	RCS keyword removal (only non-comment changes are enumerated here):

	* emacs-lisp/bytecomp.el (byte-compile-version): Variable removed.
	(byte-compile-insert-header): Don't use `byte-compile-version'.
	* forms.el (forms-version): Variable removed.
	(forms-mode): Don't use `forms-version'.
	* recentf.el (recentf-version): Variable removed.
	* progmodes/delphi.el (delphi-version): Variable removed.
	* progmodes/ada-mode.el (ada-mode): RCS keyword removed from docstring.

2004-04-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/easymenu.el (easy-menu-add): Make it work in non-X Emacs.

2004-04-09  Jesper Harder  <harder@ifa.au.dk>

	* info.el (info-apropos): Improve menu item regexp.

2004-04-09  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el: Add comment, based on report by
	kdc@rcn.com (Kevin D. Clark).

2004-04-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el (compilation-mode-font-lock-keywords):
	Redo one more thing that I didn't notice Daniel had undone.

2004-04-08  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-source-window): Remove variable.
	(gdb-goto-breakpoint, gdb-display-buffer)
	(gdb-display-source-buffer, gdb-view-source-function)
	(gdb-view-assembler, gdb-setup-windows, gdb-restore-windows)
	(gdb-source-info, gdb-frame-handler): Don't specify a window
	for display.
	(gdb-info-breakpoints-custom): Remove superfluous update of
	assembler buffer.
	(gdb-many-windows): Make settable outside gdb.

2004-04-08  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (diary-mode, fancy-diary-display-mode):
	Derive from fundamental-mode rather than text-mode.

2004-04-08  Juri Linkov  <juri@jurta.org>

	* info.el (Info-history): Doc fix.
	(Info-history-list): New var.
	(info-xref): Change magenta4 to blue, remove bold for dark and
	light backgrounds, change bold to underline for non-color classes.
	(info-xref-visited): New face.
	(Info-fontify-visited-nodes): New custom.
	(Info-hide-note-references): Add new value `hide'.  Doc fix.
	(Info-reference-name): New var.
	(Info-selection-hook): New custom.
	(Info-edit-mode-hook): New var.
	(Info-find-file): New fun.
	(Info-find-node): Move part of code to Info-find-file.
	(Info-find-node-2): Add anchors to Info-history-list.  Move point
	to the place with the reference name if name is defined.
	(Info-select-node): Add current node to Info-history-list.
	(Info-goto-node): Switch to *info* from *info-history* *info-toc*.
	(Info-search-whitespace-regexp): New custom.
	(Info-search-case-fold): New var.
	(Info-search): Add "case-sensitively" to the prompt.
	Use Info-search-whitespace-regexp.  Set Info-search-case-fold.
	(Info-search-case-sensitively, Info-search-next): New fun.
	(Info-up): Move point to the menu item of the current node.
	(Info-history): New fun.  Add *info-history* to
	same-window-buffer-names.
	(Info-toc): New fun.  Add *info-toc* to same-window-buffer-names.
	(Info-insert-toc): New fun.
	(Info-build-toc): New fun.
	(Info-follow-reference): Add new arg `fork'.  Doc fix.
	Replace [ \n\t]* by [ \n\t]+ in the *Note regexp.  For references
	with the same name prefer the reference closest to point.
	(Info-next-reference): Replace * by + in the *Note regexp.
	Add regexp for http:// and ftp://.  Skip the *Note prefix.
	(Info-prev-reference): Replace * by + in the *Note regexp.
	Add regexp for http:// and ftp://.  Skip the *Note prefix.
	(Info-follow-nearest-node): Add new arg `fork'.
	(Info-try-follow-nearest-node): Add new arg `fork'.
	Call browse-url for http:// and ftp:// references.
	Set Info-reference-name for index entries.
	(Info-mode-menu): Add menu items for Info-search-case-sensitively,
	Info-search-next, Info-history, Info-toc, clone-buffer.
	(Info-menu-update): Replace * by + in the *Note regexp.
	(Info-mode): Add documentation for Info-history, Info-toc,
	Info-search-case-sensitively, Info-search-next, clone-buffer.
	(Info-fontify-menu-headers): Remove fun.  Move code to
	Info-fontify-node.
	(Info-fontify-node): Add docstring.  Add local vars
	fontify-visited-p and not-fontified-p.  If not-fontified-p is t
	then fontify header line, titles, menu headers, http and ftp
	references, refill paragraphs.  If not-fontified-p is t or
	fontify-visited-p is t then fontify cross references, menu items.
	Fontify menu headers.  Fontify http and ftp references.
	Change regexp for cross references to require whitespace after *Note,
	add matching groups for file and node names.  Remove hack for quote.
	Use display property for Info-hide-note-references=t.  Use fifth
	or fourth match for help-echo.  Display visited nodes in a
	different face.  Unhide file names of external references.
	Unhide newlines.  Display visited menu items in a different face.

2004-04-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/compile.el: Require CL.
	(compilation-mode-font-lock-keywords): Re-install the "line as
	function" patch.

	* help-fns.el (help-C-source-directory): New var.
	(help-subr-name, help-C-file-name, help-find-C-source): New funs.
	(describe-function-1, describe-variable): Use them.

	* help-mode.el (help-function-def, help-variable-def): Handle hyperrefs
	to C source files specially.

2004-04-07  Jan Nieuwenhuizen  <janneke@gnu.org>

	* info.el (Info-hide-cookies-node): New function.
	(Info-select-node): Use it.
	(Info-display-images-node): Remove message with image file name.

2004-04-07  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compilation-warning-face)
	(compilation-info-face, compilation-skip-threshold)
	(compilation-skip-visited, compilation-context-lines):
	Declare :version when added to Emacs.
	(compilation-error-regexp-alist-alist): Extend caml and irix.
	(compilation-setup): Fix if font-locked w/o font-lock-defaults.
	(compilation-mode-font-lock-keywords): Temporarily undo line as
	function patch, which wasn't ready.

2004-04-07  Kenichi Handa  <handa@m17n.org>

	* international/latin1-disp.el (latin1-display-setup): Check each
	character is displayable or not instead of calling
	latin1-display-check-font.

2004-04-06  Kenichi Handa  <handa@m17n.org>

	* language/ethio-util.el (ethio-sera-being-called-by-w3):
	New variable.
	(ethio-sera-to-fidel-ethio): Check ethio-sera-being-called-by-w3
	instead of sera-being-called-by-w3.
	(ethio-fidel-to-sera-buffer): Likewise.
	(ethio-find-file): Bind ethio-sera-being-called-by-w3 to t
	instead of sera-being-called-by-w3.
	(ethio-write-file): Likewise.

2004-04-05  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Doc fix.

2004-04-05  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-use-inferior-io-buffer): New option.
	(gdb-ann3, gdb-send, gdb-starting, gdb-stopping)
	(gdb-setup-windows): Only use separate IO buffer if required.

2004-04-06  Kim F. Storm  <storm@cua.dk>

	* term.el (term-is-xemacs): Remove.
	(term-if-xemacs, term-ifnot-xemacs): Test (featurep 'xemacs).
	(term-window-width): New function.
	(term-mode, term-check-size): Use it.
	(term-mode): Disable overflow-newline-into-fringe in term buffer.

2004-04-05  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-add-parent-links): Change unbound variable
	`symbol' to `name'.

2004-04-05  Jesper Harder  <harder@ifa.au.dk>
	* info.el (info-apropos): New function.
	(Info-mode-menu): Add it.
	(Info-find-node, Info-find-node-2): Grok apropos virtual file.

	* help-mode.el (help-make-xrefs): Recognize aliased variable with
	inherited docstring.

	* play/gamegrid.el (gamegrid-add-score-insecure): Use sort-fields.

2004-04-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (fill-comment-paragraph): Obey indent-tabs-mode.

	* progmodes/compile.el (font-lock): Don't require any more.
	(compilation-error-properties, compilation-start, compilation-sentinel)
	(compilation-filter, next-error): Use with-current-buffer.
	(compilation-skip-to-next-location, compilation-skip-threshold)
	(compilation-skip-visited): Move to silence the byte-compiler.
	(compilation-setup): Simplify.
	(compilation-next-error): Use line-(beginning|end)-position.
	Make sure `pt' is non-nil before using compilation-loop.
	(compile-goto-error): Add optional event arg.  Use it.
	(compile-mouse-goto-error): Make it an alias of compile-goto-error.
	(compilation-minor-mode-map, compilation-shell-minor-mode-map):
	Update the binding for mouse-2.
	(first-error): Set compilation-current-error to nil rather than bob.
	(compilation-parsing-end, compilation-parse-errors-function)
	(compilation-error-list, compilation-old-error-list):
	"New" compatibility variables.
	(compile-buffer-substring, compilation-compat-error-properties)
	(compilation-compat-parse-errors, compilation-forget-errors):
	New compatibility functions.
	(compilation-mode-font-lock-keywords): Use them.

2004-04-04  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): If point (or a window
	point) is at the end of the buffer, keep it there after
	reverting.  This allows to tail a file.
	Mention this in the `Commentary'.

	* format.el (format-write-file): Add optional argument CONFIRM
	and make it behave like the analogous argument to `write-file'.

2004-04-04  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el: Doc fix.
	(ebnf-version): New version number (4.2).
	(ebnf-syntax): Customization and docstring fix.
	(ebnf-eliminate-empty-rules, ebnf-optimize, ebnf-otz-initialize):
	Put autoloaded funs before first use.
	(ebnf-style-database): Add dtd entry.
	(ebnf-syntax-alist): Add dtd initialization.
	(ebnf-token-sequence): New fun.
	(ebnf-comment-table): Add new comment action character.
	(ebnf-dtd-parser, ebnf-dtd-initialize): Autoload funs from ebnf-dtd.

	* progmodes/ebnf-dtd.el: New file, implement a parser for DTD (Data
	Type Definition for XML).

	* progmodes/ebnf-abn.el (ebnf-abn-concatenation):
	* progmodes/ebnf-bnf.el (ebnf-sequence):
	* progmodes/ebnf-ebx.el (ebnf-ebx-concatenation):
	* progmodes/ebnf-iso.el (ebnf-iso-single-definition):
	* progmodes/ebnf-yac.el (ebnf-yac-sequence):
	Code simplification: call ebnf-token-sequence.

2004-04-04  Eli Zaretskii  <eliz@gnu.org>

	* calendar/timeclock.el (timeclock-relative)
	(timeclock-get-project-function, timeclock-get-workday-function)
	(timeclock-query-out, timeclock-when-to-leave)
	(timeclock-when-to-leave-string, timeclock-log-data)
	(timeclock-generate-report, timeclock-in): Doc fixes.

2004-04-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* url/: New dir.  Import the URL package from its repository.

2004-04-03  Andreas Schwab  <schwab@suse.de>

	* diff-mode.el (diff-mode): Fix missing quote.

2004-04-03  Juri Linkov  <juri@jurta.org>

	* descr-text.el (describe-property-list): Add `font-lock-face'.

	* dired.el (dired-font-lock-keywords): Fix permission regexps.

2004-04-02  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-handle-moz-url, x-dnd-insert-utf16-text):
	Use utf-16le on little endian machines and utf-16be otherwise.

2004-04-02  David Kastrup  <dak@gnu.org>

	* net/browse-url.el (browse-url-generic): Use call-process
	instead of start-process to allow browsers that fork and detach.

2004-04-01  Daniel Pfeiffer  <occitan@esperanto.org>

	* compile.el (compilation-current-error): New var.
	(compilation-setup, compile-mouse-goto-error)
	(compile-goto-error, next-error): Use it.
	(compilation-skip-to-next-location): Default to t, which gives
	contiguous skipping like old compile (where this was redundant).
	(compilation-next-error): Prevent previous-* commands from moving
	back to message at or just before point.

2004-04-01  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-view-source-function, gdb-view-assembler)
	(gdb-source-info): Don't display source at startup, if required.
	(gdb-show-main): New option.
	(gdba): Update documentation.
	(gdb-source): Cover case of auto-display output.

2004-03-31  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el: Delete obsolete autoload's and defvar's.
	(auto-revert-check-vc-info): New user option.
	(auto-revert-vc-cvs-file-version, auto-revert-vc-buffer-p)
	(auto-revert-handler-vc): Delete.
	(auto-revert-handler): Treat return value `fast' of
	buffer-stale-function specially.  Check `auto-revert-check-vc-info'.

	* buff-menu.el (Buffer-menu-mode): Make the buffer-stale-function
	return `fast'.

	* files.el (buffer-stale-function): Doc change.

2004-03-31  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: New tip on Tips section.
	(pr-version): New version number (6.7.4).
	(pr-shell-file-name): Initialization fix.

2004-03-31  Juri Linkov  <juri@jurta.org>

	* dired.el: Add autoload for `dired-do-touch'.
	(dired-touch-program): New var.
	(dired-mode-map): Bind `dired-do-touch' to T and add menu-item.
	(dired-no-confirm): Add `touch' to docstring.

	* dired-aux.el (dired-do-touch): New fun.
	(dired-do-chxxx): Add argument -t for touch operation.

	* dired-x.el (dired-mark-sexp): Replace hard-coded month names by
	`dired-move-to-filename-regexp'.

2004-03-31  H,Ae(Bkan Granath  <hakan.granath@kau.se>  (tiny change)

	* dired.el (dired-move-to-filename-regexp): Add `.' to HH:MM.

2004-03-30  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el (ebnf-eps-finish-and-write): Write a buffer if
	and only if the buffer was modified.

2004-03-30  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Delete pairs for U+2308..U+230B.

2004-03-29  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-gdb-marker-filter): Include "\n" in regexp
	to detect the beginning of a level 2 or 3 annotation.

2004-03-29  Kenichi Handa  <handa@m17n.org>

	* international/ucs-tables.el (ucs-insert): Fix the error message.

2004-03-29  Kenichi Handa  <handa@m17n.org>

	* international/mule-util.el (char-displayable-p): Fix generation
	of XLFD file name.

	* Makefile.in (setwins, setwins_almost): Change directory to $wd
	before finding directories by `find'.

2004-03-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (interactive-form): Delete.  Now implemented in C.

	* pcvs.el (cvs-parse-process): Workaround for Darwin.

	* vc.el (vc-version-diff, vc-default-diff-tree): Change `rel' -> `rev'.
	(vc-diff-label): New fun.
	(vc-diff-internal): Use it.

	* progmodes/gdb-ui.el (gdb-post-prompt): Fix test.

2004-03-28  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el (ebnf-abn-parser): Handle initial comments.

	* progmodes/ebnf-ebx.el: New file, implement a parser for EBNF used to
	specify XML (EBNFX).

	* progmodes/ebnf2ps.el: Doc fix.
	(ebnf-version): New version number (4.1).
	(ebnf-syntax): Adjust customization.
	(ebnf-style-database): Add ebnfx entry.
	(ebnf-syntax-alist): Add ebnfx initialization.
	(ebnf-ebx-parser, ebnf-ebx-initialize): Autoload funs from ebnf-ebx.

	* printing.el: Doc fix.
	(pr-version): New version number (6.7.3).
	(pr-menu-position): Adjust X and Y positions when mouse-pixel-position
	returns nil for mouse position.  Reported by Drew Adams
	<drew.adams@oracle.com>.
	(pr-update-menus): Modify interactive declaration.  Reported by Drew
	Adams <drew.adams@oracle.com>.

2004-03-28  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gdb-ui.el (gdb-ann3, gdb-send-item)
	(gud-gdba-marker-filter): Log the process input and output, if
	required.  From Stefan Monnier.
	(gdb-debug-log, gdb-enable-debug-log): New variables.
	(gdb-post-prompt): Don't do gdb-var-update on Mac OS X.

2004-03-28  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-file-not-found-hook): Fix typo.
	From lorentey@elte.hu (L$,1 q(Brentey K,Aa(Broly).

2004-03-27  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-handler): Handle auto-revert-mode.
	Call vc-find-file-hook here instead of in auto-revert-buffers.
	(auto-revert-buffers): Delete call to vc-find-file-hook.
	(auto-revert-verbose, global-auto-revert-non-file-buffers)
	(global-auto-revert-mode, auto-revert-set-timer)
	(auto-revert-handler, auto-revert-buffers): Doc fixes.

2004-03-27  Francis J. Wright  <F.J.Wright@qmul.ac.uk>

	* woman.el (woman-change-fonts): Rename local variable
	woman-font-alist to font-alist to avoid a compiler warning.

2004-03-27  Dave Love  <fx@gnu.org>

	* emacs-lisp/rx.el (rx): Doc fix.
	Fix copyright years.

	* strokes.el (strokes-global-set-stroke-string): New function.
	(strokes-list-strokes): Cope with strings, not just commands.
	Set foreground colour of image.
	(strokes-global-set-stroke): Doc fix.

2004-03-26  Luc Teirlinck  <teirllm@auburn.edu>

	* buff-menu.el (Buffer-menu-revert-function): Make it suitable for
	Auto Revert mode.
	(Buffer-menu-files-only): New variable.
	(Buffer-menu-toggle-files-only): New function.
	(Buffer-menu-mode-map): Bind it to `T'.
	(Buffer-menu-mode): Mention `T' in docstring.
	Set buffer-stale-function.
	(list-buffers-noselect): Mark buffer non-modified and set
	Buffer-menu-files-only.

	* dired.el (buffer-stale-function): Remove no longer needed defvar.

	* autorevert.el (auto-revert-handler): Print revert message
	before, rather than after, reverting.
	(buffer-stale-function): Move to files.el.

	* files.el (buffer-stale-function): Move here from autorevert.el.

2004-03-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc.el (vc-maybe-resolve-conflicts): Don't prompt the user.

	* calc/calc.el (calc-mode-map): Use mapc.

	* apropos.el (apropos-mode): Don't autoload.
	(apropos-symbols-internal): New fun.  Extracted from `apropos'.
	(apropos): Use it.
	(apropos-print): Add optional `text' argument.
	(apropos-describe-plist): Use help-buffer and hexlp-setup-xref.
	Don't assume point-min == 1.

	* bs.el (bs-buffer-list): Use buffer-local-value.
	(bs--set-toggle-to-show): Use with-current-buffer.

	* buff-menu.el (Buffer-menu-sort, Buffer-menu-make-sort-button):
	New funs.
	(list-buffers-noselect): Use them.  Adjust :align-to to new style.

	* cvs-status.el (cvs-tree-use-jisx0208): Use char-displayable-p.

	* dabbrev.el (dabbrev-expand): Fix regexp construction.
	(dabbrev--find-expansion): Use pop.
	(dabbrev--search): Use match-string-no-properties.

	* dired.el (dired-mode): Use run-mode-hooks.
	(dired-move-to-end-of-filename): Use match-string.

	* ediff-init.el (ediff-hide-face): Check that facemenu-unlisted-faces
	is bound before using it.
	(ediff-verbose-p): Make it into a var since it's not constant.

	* electric.el (Electric-pop-up-window): Avoid popping up a new frame.

	* faces.el (read-face-font): Don't cons up unnecessarily.
	(header-line, tool-bar): Share common parts.

	* files.el (file-relative-name): Use compare-strings.

	* finder.el (finder-mode): Follow coding convention.

	* subr.el (read-number): New function.

	* ses.el (ses-read-number): Move to subr.el.
	(ses-set-header-row): Use read-number.

2004-03-26  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-arg-list): New function, which handles both
	compiled and uncompiled code.
	(vc-default-workfile-unchanged-p): Use it.

	* vc.el (vc-print-log): Undo prev change, use new function
	vc-arg-list from vc-hooks.el.

2004-03-26  Masatake YAMATO  <jet@gyve.org>

	* simple.el (completion-setup-function): Emphasize the
	first uncommon characters in the completions; and de-emphasize
	the common prefix substrings.
	(completion-emphasis): New face.
	(completion-de-emphasis): New face.

2004-03-25  Juanma Barranquero  <lektu@terra.es>

	* progmodes/cperl-mode.el (cperl-indent-alist, cperl-where-am-i):
	Comment out (it's unused and unfinished code).

2004-03-25  Sam Steingold  <sds@gnu.org>

	* vc.el (vc-print-log): Fix a bug in the last patch:
	backend-function may be a byte-compiled object, not a lambda.

2004-03-25  Juri Linkov  <juri@jurta.org>

	* descr-text.el (describe-property-list): Add a button
	for `face' property that calls `describe-face'.
	Suggested by luis fernandes <elf@ee.ryerson.ca>

	* international/mule.el (keyboard-coding-system):
	* kmacro.el (kmacro-call-macro): Fix docstring.

	* dired.el: Fix comments.

	* textmodes/fill.el (fill): Fix Info link.

	* font-lock.el (fast-lock, lazy-lock):
	* jit-lock.el (jit-lock): Remove links to removed Support Modes
	Info node.

	* eshell/eshell.el (eshell): Fix broken info-link.

	* eshell/em-alias.el (eshell-alias, eshell-bad-command-tolerance):
	* eshell/em-banner.el (eshell-banner):
	* eshell/em-smart.el (eshell-smart):
	* eshell/esh-cmd.el (eshell-cmd):
	Comment out broken info-links to incomplete Info manual.

	* info-xref.el: Fix commentary.

2004-03-25  Kevin Ryde  <user42@zip.com.au>

	* info-xref.el (info-xref-check-buffer): Report empty filename parts.
	Remove spurious node duplicate suppression, doesn't work, not wanted.
	(info-xref-output): Take format style args, add "sit-for 0" to let
	user see the results as they progress.
	(info-xref-check-all-custom): New function.

2004-03-25  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el: Moved to progmodes.

2004-03-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-font-lock-keywords): Disable yank-handler.

2004-03-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-check): Remove superfluous progn.
	When finished with diary buffer: if it was not being displayed
	before, kill it; otherwise restore its original state.
	Suggested by Matthew Mundell <matt@mundell.ukfsn.org>.

	* calendar/calendar.el (calendar-set-mode-line): Use total
	available mode-line width, rather than frame-width.

	* calendar/diary-lib.el (fancy-diary-display): Set mode-line
	after mode change so effect not lost.

2004-03-23  Dave Love  <fx@gnu.org>

	* dired.el (dired) <defgroup>: Add link to manual.
	(dired-font-lock-keywords): Add highlighting on unusual permissions.
	(dired-revert): Use dolist.
	(dired-mode-map): Add U binding.
	(dired-mode): Add font-lock-beginning-of-syntax-function.
	(dired-garbage-files-regexp): Make it a defcustom.

2004-03-23  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-diff): Handle the special case where `newvers'
	is equivalent to nil.
	(vc-arch-diff3-rej-p): Be a bit more flexible in what we accept.
	(vc-arch-mode-line-string): Accept `added' state.
	(vc-arch-state): Use inode-sigs if available.
	(vc-arch-add-tagline): Rename from vc-arch-add-tag.
	Copy&delete existing id file if any.  Fallback if uuidgen is absent.
	(vc-arch-tagline-re): New var.
	(vc-arch-file-source-p, vc-arch-file-id, vc-arch-tagging-method):
	New functions.
	(vc-arch-find-file-not-found-hook, vc-arch-register): New backend ops.
	(vc-arch-registered): Try our best guess using vc-arch-file-source-p.

	* vc-hooks.el (vc-default-find-file-not-found-hook): New fun.
	(vc-file-not-found-hook): Use it.

	* diff-mode.el (diff-default-read-only): Change default.
	(diff-mode-hook): Make it a defcustom.  Add some options.
	(diff-mode-map): Bind diff-refine-hook.
	(diff-yank-handler): New var.
	(diff-yank-function): New fun.
	(diff-font-lock-keywords): Use them.
	(diff-end-of-file): Handle case where file-header looks like diff text.
	(diff-hunk-kill): Adjust to "new" hunk-next behavior.
	(diff-file-kill): Delete a subsequent empty line, if applicable.
	(diff-hunk-file-names): New fun, extracted from diff-tell-file-name.
	(diff-find-file-name): Use it.
	(diff-tell-file-name): New command.
	(diff-mode): Be careful with view-mode.
	(diff-delete-if-empty, diff-delete-empty-files, diff-make-unified):
	New functions, for use in diff-mode-hook.
	(diff-find-source-location): Catch "regex too large" errors.
	(diff-apply-hunk, diff-test-hunk): Go to old or new file.
	(diff-refine-hunk): New command.

	* smerge-mode.el (smerge-mode-menu): Fix activate pred for resolve.
	(smerge-context-menu-map): Remove unused var.
	(smerge-keep-all): Preserve markers.
	(smerge-keep-n): New fun.
	(smerge-keep-base, smerge-keep-other, smerge-keep-mine)
	(smerge-keep-current, smerge-ediff): Use it.
	(smerge-kill-current): Use it.  Make it work on some 3-part conflicts.
	(smerge-popup-context-menu): Also use context-menu on 3-part conflicts.
	(smerge-resolve): Resolve trivial 3-part conflicts.

2004-03-23  Juri Linkov  <juri@jurta.org>

	* man.el (Man-width): New var.
	(Man-getpage-in-background): Use it.
	(Man-support-local-filenames): New var and fun.
	(Man-build-man-command): Don't add a second %s.
	(Man-fontify-manpage): Clean up message.
	(Man-mode): Set outline-regexp, outline-level,
	imenu-generic-expression.

	* woman.el (woman-fill-frame): Doc fix.
	(woman-decode-region): Use window-width instead of frame-width.

	* abbrevlist.el (list-one-abbrev-table):
	* descr-text.el (describe-char):
	* international/mule-diag.el (describe-current-coding-system):
	* international/quail.el (quail-insert-decode-map):
	Use window-width instead of frame-width.

	* jka-compr.el (jka-compr-compression-info-list): Add tbz and dz.
	(jka-compr-mode-alist-additions): Add tbz.
	(jka-compr-write-region, jka-compr-insert-file-contents):
	Add message for undefined compress-program.
	(jka-compr-write-region): Remove redundant var bindings.

	* dired-x.el (dired-guess-shell-alist-default): Add choices for
	extracting files into subdirectory.  Add tbz and dz.  Fix regexps.
	Add extensions .[0-9] for man and nroff, and .pod for perldoc.
	(dired-man): Use dired-guess-shell-command.
	(dired-guess-shell-case-fold-search): Change defvar to defcustom.
	Change default nil to t.

	* dired-aux.el (dired-compress-file-suffixes): Add dz and tbz.
	(dired-compare-directories): Add default value for empty input.

	* help-at-pt.el: Move suggestions for key bindings to Commentary.

	* time.el (display-time-string-forms): Fix help-echo date format.

2004-03-22  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (global-auto-revert-non-file-buffers): Expand docstring.
	(buffer-stale-function): New variable.
	(auto-revert-list-diff, auto-revert-dired-file-list)
	(auto-revert-dired-changed-p, auto-revert-buffer-p): Delete.
	(auto-revert-handler): Take over some functionality of deleted
	functions.
	(auto-revert-buffers): Delete call to auto-revert-buffer-p.

	* dired.el (dired-directory-changed-p): New fun, extracted from
	dired-internal-noselect.
	(dired-buffer-stale-p): New fun.
	(dired-internal-noselect): Use dired-directory-changed-p.
	Eliminate revert messages.
	(dired-mode): Set buffer-stale-function to dired-buffer-stale-p.

2004-03-23  Kenichi Handa  <handa@m17n.org>

	* international/characters.el: Setup syntaxes for more parentheses
	Unicode characters.

	* international/mule-cmds.el (select-safe-coding-system):
	Merge coding-system and auto-cs before comparing them.

2004-03-22  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/pp.el (pp-eval-expression): Simplify.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Don't set
	normal-auto-fill-function and comment-indent-function.
	The default values now work just as well.
	Don't set font-lock-beginning-of-syntax-function since we already set
	syntax-begin-function.
	(lisp-outline-level): Put ;;;###autoload at same level as (.
	(prin1-char): Quote special chars.

	* emacs-lisp/lisp-mnt.el (lm-keywords-finder-p): Use defvar rather
	than with-no-warnings.

	* emacs-lisp/edebug.el (edebug-display): Bring up a debug trace
	if the source location can't be found.
	(edebug-compute-previous-result): Use prin1-char.

	* emacs-lisp/checkdoc.el (checkdoc-error): Don't assume point-min == 1.
	(debug-ignored-errors): Add an entry.

	* emacs-lisp/bytecomp.el (byte-recompile-directory): Ignore hidden dir.
	(byte-compile-file): Output warning when deleting a file.

	* emacs-lisp/byte-run.el (defsubst): Add edebug spec and use backquote.
	(dont-compile, eval-when-compile, eval-and-compile): Add edebug spec.

	* emacs-lisp/byte-opt.el (byte-compile-log-lap)
	(byte-compile-inline-expand): Use backquote.
	(byte-optimize-pure-func): Rename from byte-optimize-concat.
	(symbol-name, regexp-opt, regexp-quote): Mark as pure.

	* emacs-lisp/backquote.el (backquote-list*-macro): Use nreverse.

	* emacs-lisp/advice.el (ad-subr-arglist): Simplify.

2004-03-22  Juri Linkov  <juri@jurta.org>

	* finder.el (finder-known-keywords): Fix data, tex, unix.

	* play/landmark.el: Fix keywords.

	* language/ethio-util.el (ethio-find-file): Doc fix.

	* emacs-lisp/warnings.el: Doc fix.

	* textmodes/ispell.el (ispell-help): Doc fix.

2004-03-21  Luc Teirlinck  <teirllm@auburn.edu>

	* format.el (format-insert-file): Always return a list of two
	elements, like insert-file-contents does.

2004-03-21  Andre Spiegel  <spiegel@gnu.org>

	* vc.el: Add new optional BUFFER argument to vc-BACKEND-print-log
	and vc-BACKEND-diff.
	(vc-print-log): If the print-log implementation supports it, use
	the new BUFFER argument to direct output to *vc-change-log*, not *vc*.
	(vc-version-diff, vc-diff-internal): Doc fixes.

	* vc-hooks.el (vc-default-workfile-unchanged-p): If the
	implementation supports it, let diff output go to *vc*,
	not *vc-diff*, since this is an internal call.

	* vc-cvs.el (vc-cvs-print-log, vc-cvs-diff): Add optional BUFFER arg.

	* vc-rcs.el (vc-rcs-print-log, vc-rcs-diff): Likewise.

	* vc-sccs.el (vc-sccs-print-log, vc-sccs-diff): Likewise.

2004-03-21  Dave Love  <fx@gnu.org>

	* progmodes/cfengine.el (cfengine-mode):
	Set parse-sexp-ignore-comments.

	* emacs-lisp/rx.el (rx): Work at compile time, not run time.

2004-03-21  Juanma Barranquero  <lektu@terra.es>

	* allout.el (allout-mode): Fix docstring.

2004-03-20  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (insert-directory): Fix bug if SWITCHES is a list.

	* autorevert.el (auto-revert-interval): Make new value take
	effect immediately when set through Custom.
	(auto-revert-set-timer): Add interactive declaration.

2004-03-19  David Ponce  <david@dponce.com>

	* ruler-mode.el (ruler-mode-header-line-format-old):
	Don't `make-variable-buffer-local'.
	(ruler-mode-ruler-function): Default to `ruler-mode-ruler'.
	(ruler-mode-header-line-format): Simply funcall the above.
	(ruler-mode): Use `make-local-variable' and `kill-local-variable'
	to save/restore a previous header line format.
	(ruler-mode-space): Don't depend on a numeric WIDTH value.
	(ruler-mode-ruler): Use symbolic display elements for scrollbar,
	fringes and margins width.
	(ruler-mode-ruler-function): Default to ruler-mode-ruler.

2004-03-18  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-edit.el (log-edit-font-lock-keywords): Typo.

	* textmodes/tex-mode.el (tex-shell): Set error parsing function here.
	(tex-send-tex-command): Rather than here.
	(tex-compilation-parse-errors): Simplify.

	* info.el (Info-default-dirs): Don't ignore last part of I-d-d-l.

	* time.el (display-time-string-forms): Add help-echo with date on time.

	* composite.el (compose-region): Use restore-buffer-modified-p.

	* disp-table.el (standard-display-8bit): Simplify.

	* server.el (server-process-filter): Delete temp frame.

	* add-log.el (add-change-log-entry): Simplify.

2004-03-19  Kim F. Storm  <storm@cua.dk>

	* hexl.el (hexl-mode-ruler): Adapt to new :align-to semantics.
	(hexl-follow-line): Don't require 'fringe.

	* progmodes/compile.el (compilation-start): Always set
	compilation-last-buffer and return it.

2004-03-17  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (clone-buffer): Doc fix.

2004-03-18  Juanma Barranquero  <lektu@terra.es>

	* emacs-lisp/byte-run.el (make-obsolete-variable): Fix docstring.

2004-03-17  Stefan Monnier  <monnier@iro.umontreal.ca>

	* log-edit.el (log-edit-font-lock-keywords): New var.
	(log-edit-mode): Use it.

2004-03-17  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-var-list-children-handler): Handle C++ classes
	properly for watching in speedbar.

2004-03-17  Masatake YAMATO  <jet@gyve.org>

	* smerge-mode.el (smerge-popup-context-menu):
	Put `unwind-protect' around `overlay-put' and `popup-menu'.

2004-03-16  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-arch.el (vc-arch-workfile-unchanged-p): Define to avoid dup-diff.
	(vc-arch-workfile-version, vc-arch-mode-line-rewrite):
	Take sealed revisions into account.
	(vc-arch-checkin): Extract a summary line from the message.

2004-03-16  Masatake YAMATO  <jet@gyve.org>

	* register.el (register): Provide `register' feature.

2004-03-15  Masatake YAMATO  <jet@gyve.org>

	Added context menu support in smerge mode.
	Most of the part is written by Stefan Monnier.

	* smerge-mode.el (smerge-context-menu-map, smerge-context-menu):
	New keymap and menu.
	(smerge-text-properties): New function.
	(smerge-remove-props): New function.
	(smerge-popup-context-menu): New function.
	(smerge-resolve): Call `smerge-remove-props'.
	(smerge-keep-base, smerge-keep-other, smerge-keep-mine): Ditto.
	(smerge-keep-current): Ditto.
	(smerge-kill-current): New function.
	(smerge-match-conflict): Put text properties.
	Detect the file as `same-diff conflict' if the filename is "ANCESTOR".

2004-03-15  David Ponce  <david@dponce.com>

	* ruler-mode.el: (ruler-mode-left-fringe-cols)
	(ruler-mode-right-fringe-cols, ruler-mode-left-scroll-bar-cols)
	(ruler-mode-right-scroll-bar-cols): Remove.
	(ruler-mode-window-col, ruler-mode-mouse-set-left-margin)
	(ruler-mode-mouse-set-right-margin, ruler-mode-ruler):
	Use fringe-columns and scroll-bar-columns.

2004-03-15  Masatake YAMATO  <jet@gyve.org>

	* hl-line.el (hl-line-range-function): New variable.
	(hl-line-move): New function.
	(global-hl-line-highlight): Use `hl-line-move'.
	(hl-line-highlight): Ditto.

	* scroll-bar.el (scroll-bar-columns):
	* fringe.el (fringe-columns): New function derived from ruler-mode.el.

	* ruler-mode.el (top-level): Require scroll-bar and fringe.
	(ruler-mode-left-fringe-cols)
	(ruler-mode-right-fringe-cols): Use `fringe-columns'.
	(ruler-mode-right-scroll-bar-cols)
	(ruler-mode-left-scroll-bar-cols): Use `scroll-bar-columns'.
	(ruler-mode-ruler-function): New variable.
	(ruler-mode-header-line-format): Call `ruler-mode-ruler-function'
	if the value for `ruler-mode-ruler-function'is given.

	* hexl.el (hexl-mode-hook): Make the hook customizable.
	(hexl-address-area, hexl-ascii-area): New customize variables.
	(hexlify-buffer): Put font-lock-faces on the address area and
	the ascii area.
	(hexl-activate-ruler): New function.
	(hexl-follow-line): New function.
	(hexl-highlight-line-range): New function.
	(hexl-mode-ruler): New function.

2004-03-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-hooks.el (vc-handled-backends): Add Arch.  Move MCVS down.
	(vc-default-find-file-hook): New fun.
	(vc-find-file-hook): Call new find-file-hook operation.

	* vc-arch.el: New file.

2004-03-12  Jesper Harder  <harder@ifa.au.dk>

	* info-look.el (info-lookup): Reuse an existing Info window.

2004-03-12  Francis J. Wright  <F.J.Wright@qmul.ac.uk>

	* woman.el (woman-preserve-ascii): Default value changed to t and
	doc string revised.

2004-03-12  Richard M. Stallman  <rms@gnu.org>

	* pcvs.el (cvs-mode-add-change-log-entry-other-window):
	Fix minor bug.

	* replace.el (occur-engine): Change message for count of matches.

	* emacs-lisp/bytecomp.el (byte-compile-get-constant):
	For strings, do compare text properties.

2004-03-11  Daniel Pfeiffer  <occitan@esperanto.org>

	* progmodes/compile.el (compile-auto-highlight)
	(compilation-error-list, compilation-old-error-list)
	(compilation-parse-errors-function, compilation-parsing-end)
	(compilation-error-message, compilation-directory-stack)
	(compilation-enter-directory-regexp-alist)
	(compilation-leave-directory-regexp-alist)
	(compilation-file-regexp-alist, compilation-nomessage-regexp-alist)
	(compilation-current-file, compilation-regexps): Remove vars.

	(compile-error-at-point, compilation-error-filedata)
	(compilation-error-filedata-file-name, compile-reinitialize-errors)
	(compilation-next-error-locus, compilation-forget-errors)
	(count-regexp-groupings, compilation-parse-errors)
	(compile-collect-regexps, compile-buffer-substring): Remove funs.

	(compile-internal): Make obsolete.

	(compilation-first-column, compilation-error)
	(compilation-directory-matcher, compilation-page-delimiter)
	(compilation-mode-font-lock-keywords, compilation-debug)
	(compilation-error-face, compilation-warning-face)
	(compilation-info-face, compilation-line-face)
	(compilation-column-face, compilation-enter-directory-face)
	(compilation-leave-directory-face, compilation-skip-threshold)
	(compilation-skip-visited, compilation-context-lines): New vars.

	(compilation-warning-face, compilation-info-face)
	(compilation-message-face): New faces.

	(compilation-error-regexp-alist-alist): New constant.

	(compilation-face, compilation-directory-properties)
	(compilation-assq, compilation-error-properties, compilation-start)
	(define-compilation-mode, compilation-loop)
	(compilation-set-window): New functions.

	(compile): Additional argument for interactive compiles like TeX.

	* progmodes/grep.el (kill-grep): Move here from compile.el
	(grep-error, grep-hit-face, grep-error-face)
	(grep-mode-font-lock-keywords): New variables.
	(grep-regexp-alist): Simplify regexp and add `binary' case.
	(grep-mode): New mode.
	(grep-process-setup): Simplify.

2004-03-11  Jason Rumney  <jasonr@gnu.org>

	* net/ldap.el (ldap-search-internal): Handle file URLs with drive
	letters on DOS/Windows.

2004-03-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-name): New var.
	(server-socket-dir): New var to replace server-socket-name.
	(server-start): Use them.

2004-03-11  Simon Josefsson  <jas@extundo.com>

	* mail/smtpmail.el (smtpmail-read-response): Abort if process has
	died to avoid infloop.  Reported by Jonathan Glauner
	<jglauner@sbum.org>.

2004-03-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* smerge-mode.el (smerge-check-cache, smerge-check): New var and fun.
	(smerge-mode-menu): Use it to deactivate menu entries.
	(smerge-keep-current): New fun.
	(smerge-keep-current): Use it.

2004-03-10  John Paul Wallington  <jpw@gnu.org>

	* foldout.el (foldout-fold-list, foldout-modeline-string):
	Declare them as variables, not constants.

2004-03-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Modification to print *Messages* buffer.
	(ps-print-version): New version 6.6.4.
	(ps-message-log-max): New fun.
	(ps-spool-without-faces, ps-spool-with-faces)
	(ps-count-lines-preprint): Code fix.

	* printing.el: New tips in Tips section.

2004-03-09  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* delim-col.el: Doc fix.

	* printing.el: Doc fix.  New doc section (Tips).

2004-03-09  Stefan Monnier  <monnier@iro.umontreal.ca>

	* type-break.el (type-break-emacs-variant): Remove.
	(type-break-run-at-time, type-break-cancel-function-timers):
	Use fboundp rather than version name and number.

2004-03-09  Masatake YAMATO  <jet@gyve.org>

	* hexl.el (hexl-mode): Use `make-local-variable' instead of
	`make-variable-buffer-local'.

2004-03-08  Michael Albinus  <Michael.Albinus@alcatel.de>

	* find-dired.el (find-dired): Call `shell-command' instead of
	`start-process-shell-command'.  By this, Tramp takes over
	handling of remote directories.

2004-03-07  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-use-global-state): New var.
	(comment-search-forward): Use it.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables): Set it.

	* cus-edit.el (fill) <defgroup>: Move to fill.el.

	* textmodes/fill.el (fill) <defgroup>: Move from cus-edit.el.
	(enable-kinsoku): Make it a defcustom.
	(fill-comment-paragraph): Don't rely on fill-prefix to bound the
	paragraph to same-comment-start-marker.

2004-03-07  Dave Love  <fx@gnu.org>

	* net/browse-url.el (rfc2368-parse-mailto-url): Autoload.
	(browse-url-mail): Use it.

	* mail/rfc2368.el (rfc2368-unhexify-char): Delete.
	(rfc2368-unhexify-string): Use replace-regexp-in-string.

2004-03-07  Francis J. Wright  <F.J.Wright@qmul.ac.uk>

	* woman.el (woman-man.conf-path): Doc fix.
	(woman-parse-man.conf): Also parse OPTIONAL_MANPATH.

2004-03-07  Eli Zaretskii  <eliz@gnu.org>

	* sort.el (sort-columns): Remove ms-dos from the list of systems
	where the external `sort' command is not used.

2004-03-07  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (gdb-overlay-arrow-position): Add defvar.
	(gdb-reset): Reset gdb-overlay-arrow-position marker and remove it
	from overlay-arrow-variable-list.
	(gdb-assembler-mode): Use add-to-list for gdb-overlay-arrow-position.

2004-03-06  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-assembler-mode, gdb-assembler-custom): Set up
	overlay arrow string properly for the assembler buffer.

2004-03-05  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mail/sendmail.el (mail-mode): Fix last change.

2004-03-05  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-assembler-mode): Create a second overlay arrow
	for the assembler buffer.
	(gdb-assembler-custom): Position the overlay arrow.
	(gdb-put-arrow, gdb-remove-arrow): Delete functions.

2004-03-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/sh-script.el (sh-font-lock-paren): Add @ in case patterns.

	* pcvs-info.el (cvs-fileinfo->backup-file): Use a more constraining
	regexp to distinguish .#ChangeLog.9.1.400 and .#ChangeLog.1.400.

	* mail/sendmail.el (mail-mode): Set comment-start-skip.

	* newcomment.el (uncomment-region): Allow non-terminated comment.
	(comment-normalize-vars): Check the user-specified comstart marker.

2004-03-04  Jesper Harder  <harder@ifa.au.dk>

	* sort.el (sort-columns): Don't use external 'sort' on ms-windows.
	Otherwise, do use it if the region only contains font-lock text
	properties.

2004-03-04  Masatake YAMATO  <jet@gyve.org>

	* hexl.el (hexl-mode): Set `hexl-print-current-point-info'
	as the callback function for eldoc.
	(hexl-print-current-point-info): New function.
	(hexl-current-address): Print the address in both decimal
	and hexadecimal format.

2004-03-04  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Specify t for UNIBYTE when calling mail-unquote-printable-region.

	* mail/mail-utils.el (mail-unquote-printable-region):
	New arg UNIBYTE.

	* startup.el (command-switch-alist): Doc fix.

	* simple.el (undo): Temporarily set this-command to `undo-start',
	then set it to `undo' once undo-start returns without error.

	* simple.el (minibuffer-history-sexp-flag): Doc fix.

	* simple.el (kill-line): Don't disregard trailing whitespace
	in eol condition, if show-trailing-whitespace is set.

	* mouse-sel.el (mouse-sel-has-been-enabled): New var.
	(mouse-sel-mode): When enabling, set mouse-sel-has-been-enabled.
	When disabling, restore old values only if mouse-sel-has-been-enabled.

	* isearch.el (isearch-*-char): New arg WANT-BACKSLASH.
	(isearch-{-char): New function.
	(isearch-mode-map): Bind { to isearch-{-char.

	* font-lock.el (lisp-font-lock-keywords-2):
	Turn off the CL with-... and do-... general patterns.
	Instead, recognize several specific with... and do... constructs.

	* files.el (switch-to-buffer-other-window):
	Bind same-window-buffer-names and same-window-regexps to nil.
	(switch-to-buffer-other-frame): Likewise.

2004-03-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (fill-comment-paragraph): Be more careful when
	recognizing leading comment on code line.

2004-03-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* Makefile.in (setwins, setwins_almost): Skip .arch-ids and other
	hidden files/directories.

2004-03-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/fill.el (fill-paragraph): Don't check comment-start-skip,
	only comment-start (in case the mode hasn't set it).

	* Makefile.in (AUTOGENEL): New var.
	(bootstrap-prepare): Rename from bootstrap-clean.
	Don't remove elc files.
	(maintainer-clean): New target.

	* xml.el (xml-get-attribute-or-nil): Simplify.

2004-03-02  Juri Linkov  <juri@jurta.org>

	* net/browse-url.el (browse-url-netscape, browse-url-mozilla)
	(browse-url-galeon, browse-url-epiphany): Encode dollar signs in
	URL to prevent their substitution with the environment variable
	values by browsers.

2004-03-03  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Doc fix.
	(ps-print-version): New version number (6.6.3).
	(ps-right-header, ps-right-footer, ps-left-header, ps-left-footer):
	Docstring fix.
	(ps-kill-emacs-check): Check if ps-print temporary buffer is killed
	before printing.
	(ps-time-stamp-yyyy-mm-dd): New fun.
	(ps-time-stamp-iso8601): Alias for ps-time-stamp-yyyy-mm-dd.

2004-03-02  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (gdb-mouse-toggle-breakpoint): Remove debug message.

2004-03-01  Juanma Barranquero  <lektu@terra.es>

	* allout.el (allout-rebullet-heading): Fix typo in docstring.

	* desktop.el (desktop-file-version)
	(desktop-after-read-hook): Fix typos.
	(desktop-clear-preserve-buffers): Remove redundant info in
	docstring already shown by the obsolescence message.
	(desktop-truncate, desktop-internal-v2s)
	(desktop-value-to-string): Change argument name to match docstring.

	* emulation/tpu-edt.el (tpu-set-mark): Fix typo in docstring.

	* eshell/em-smart.el (eshell-smart-maybe-jump-to-end): Fix typo in
	docstring.

2004-02-29  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* printing.el: Replace "As Is..." in PostScript file print/preview by
	"No Preprocessing...".  Suggested by Colin Marquardt
	<_marquardt_@zmd.de>.
	(pr-insert-section-4): Adjust buffer interface.

2004-02-29  Kai Grossjohann  <kai.grossjohann@gmx.net>

	Version 2.0.39 of Tramp released.

	* net/tramp.el (tramp-handle-file-local-copy)
	(tramp-handle-write-region, tramp-open-connection-rsh):
	Variable name typo.  Small change.  From Patrick Tullmann
	<tullmann@flux.utah.edu>.
	(tramp-process-connection-type): New variable.
	(tramp-maybe-open-connection): Use it.
	(tramp-do-copy-or-rename-via-buffer): Handle KEEP-DATE arg if possible.
	(tramp-touch): Set last-modified time of a remote file.
	(tramp-handle-write-region): Say which function is used when encoding.

2004-02-29  Michael Albinus  <Michael.Albinus@alcatel.de>

	* net/tramp-smb.el (tramp-smb-handle-file-writable-p): Handle the
	case of non-existing filename, too.  Reported by Christoph Bauer
	<c_bauer@informatik.uni-kl.de>.
	(tramp-smb-get-file-entries): The directory in question should
	have permissions "drwxrwxrwx".  Just virtual, because we don't
	know the real permissions.  Don't we know?
	(tramp-smb-prompt): Add virtual prompt from listing shares, too.
	(tramp-smb-errors): Add "NT_STATUS_ACCOUNT_LOCKED_OUT".
	(tramp-smb-wait-for-output): Optimize algorithm getting pending
	output.  If it was received chunkwise, there have been problems.
	Remove the "prompt not found" error message; it is obvious.
	Simplify algorithm.
	(tramp-smb-process-running): Remove.  Since we acknowledge the
	virtual prompt for shares, there's no need for distinction of
	reading shares (process ends afterwards) and interactive mode of
	smblient.
	(tramp-smb-open-connection): Setting process sentinel removed.
	(tramp-smb-errors): Add "NT_STATUS_WRONG_PASSWORD" and
	"NT_STATUS_NETWORK_ACCESS_DENIED".
	(tramp-smb-maybe-open-connection): Set `process-connection-type'
	to 'pty.  Suggested by Piet van Oostrum <piet@cs.uu.nl>.
	(top-level): Setting default value in `tramp-default-method-alist'
	corrected.  Order of USER and HOST have been wrong.
	Nobody complained for months ...
	(tramp-smb-maybe-open-connection): Use `tramp-process-connection-type'.
	(tramp-smb-open-connection): Clear password cache if login has failed.

	* net/tramp.el (tramp-completion-mode) Don't check for 'xemacs' but
	`tramp-unified-filenames'.
	(tramp-completion-mode): Make test for XEmacs explicitely.
	`event-to-character' can exists in Emacs packages too.
	Reported by Matt Swift <swift@alum.mit.edu>.
	(tramp-buffer-name): Buffer name must contain the user if exists.
	Reported by Adrian Phillips <a.phillips@met.no>.
	(tramp-do-copy-or-rename-file): Handle out-of-band methods.
	Call `tramp-do-copy-or-rename-file-out-of-band' this case.
	(tramp-do-copy-or-rename-file-out-of-band): Rename from
	`tramp-do-copy-or-rename-file-one-local', because it handles also
	the case both files use the same out-of-band method.
	Implementation added.
	(tramp-handle-file-local-copy, tramp-handle-write-region):
	Out-of-band handling removed.  `copy-file' called instead, which
	calls `tramp-do-copy-or-rename-file-out-of-band'.
	(tramp-action-password): Check for out-of-band method removed.
	This function is used for 'login-program.
	(tramp-post-connection): Use `tramp-method-out-of-band-p' when
	appropriate.
	(tramp-completion-function-alist-ssh): Add `tramp-parse-shostkeys'
	and `tramp-parse-sknownhosts'.
	(tramp-completion-function-alist): It's a defvar now, because we
	want to apply the optimized `tramp-set-completion-function'
	instead of a static list.
	(tramp-set-completion-function): Implementation tuned.
	Avoid double entries, and entries where the function or the
	file/directory doesn't exist.
	(tramp-parse-shostkeys, tramp-parse-sknownhosts): New functions
	for SSH2.
	(tramp-file-name-handler-alist): Add `dired-compress-file' entry.
	(tramp-handle-dired-compress-file): New function.
	(tramp-async-proc): New variable.
	(tramp-handle-shell-command): Adding asynchronous processes.
	They are far from being perfect, but it works at least for
	`find-grep-dired' and `find-name-dired' in Emacs 21.4.
	(top-level): Require password.el if visible.  Should be mandatory
	once No Gnus has found its way into (X)Emacs.
	(tramp-read-passwd): Invoke `password-read' if available,
	`read-passwd' otherwise.  `ange-ftp-read-passwd' isn't used as
	fallback any longer.
	(tramp-clear-passwd): New function.
	(tramp-process-actions, tramp-process-multi-actions):
	Clear password cache if login has failed.

	* net/tramp-ftp.el (Commentary): Remove pointer to EFS.  It has
	its own module.
	(tramp-ftp-file-name-handler): Unset `ange-ftp-ftp-name-arg' and
	`ange-ftp-ftp-name-res'.  There could be incorrect values from
	previous calls in case the "ftp" method is used in the Tramp file
	name.  Reported by Katsumi Yamaoka <yamaoka@jpl.org>.

2004-02-28  Richard M. Stallman  <rms@gnu.org>

	* term.el (term-mouse-paste): Call mouse-set-point.

	* thumbs.el: New file.

2004-02-28  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el: Doc fix.

	* progmodes/ebnf-bnf.el: Doc fix.
	(ebnf-repeat): Code fix.

	* progmodes/ebnf2ps.el: Doc fix.
	(ebnf-syntax-directory, ebnf-syntax-file): New funs.

2004-02-28  Juri Linkov  <juri@jurta.org>

	* ffap.el (dired-at-point): Additional writability test for
	relative directory names.
	(dired-at-point-prompter): Treat directories as a directory, get
	the directory component from files.
	(ffap-string-at-point): Return string from region if region is active.
	(ffap-file-at-point): Remove redundant code.

2004-02-28  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (breakpoint-enabled-icon, breakpoint-disabled-icon):
	Initialize margin area images to nil.
	(breakpoint-bitmap): New defvar for breakpoint fringe bitmaps.
	(breakpoint-enabled-bitmap-face)
	(breakpoint-disabled-bitmap-face): New faces for bpt in fringe.
	(gdb-info-breakpoints-custom): Use gdb-remove-breakpoint-icons.
	(gdb-info-breakpoints-custom): Use gdb-put-breakpoint-icon.
	(gdb-mouse-toggle-breakpoint): Handle bpt in fringe.
	(gdb-reset): Use gdb-remove-breakpoint-icons.
	(gdb-put-string): Add dprop arg to specify alternative display
	property (for setting fringe bitmap).
	(gdb-remove-strings): Doc fix.
	(gdb-put-breakpoint-icon): New defun which displays a breakpoint
	icon in fringe (if available), or else as icon or text in display
	margin.  Creates necessary icons in breakpoint-bitmap,
	breakpoint-enabled-icon, and/or breakpoint-disabled-icon.
	Also make left window margin if required.
	(gdb-remove-breakpoint-icons): New defun to remove breakpoint
	icons inserted by gdb-put-breakpoint-icon.  Remove left margin if
	no longer needed.
	(gdb-assembler-custom): Use gdb-remove-breakpoint-icons and
	gdb-put-breakpoint-icon.
	(gdb-assembler-mode): Don't set left-margin-width here.

2004-02-27  Kevin Ryde  <user42@zip.com.au>

	* info-look.el: In scheme-mode symbol regexp, disallow backquote and
	comma, so that it DTRT in macros.

2004-02-27  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* progmodes/sh-script.el (sh-shell-arg)
	(sh-require-final-newline, sh-assignment-regexp, sh-builtins)
	(sh-leading-keywords, sh-other-keywords): Fix custom type.

2004-02-27  Dan Nicolaescu  <dann@ics.uci.edu>

	* faces.el (face-spec-set-match-display): Add a new attribute,
	`min-colors'.
	(region, highlight, secondary-selection): Use `min-colors'.

	* custom.el (defface): Add documentation for `min-colors'.

	* font-lock.el (font-lock-comment-face, font-lock-string-face)
	(font-lock-keyword-face, font-lock-function-name-face)
	(font-lock-variable-name-face, font-lock-constant-face):
	Use `min-colors'.

	* isearch.el (isearch, isearch-lazy-highlight-face): Use `min-colors'.

2004-02-25  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el: Doc fix.  For compatibility with Emacs 20,
	define assq-delete-all if it's not defined.
	(ebnf-generate-region): Code fix.

	* printing.el: Doc fix.
	(pr-version): New version number (6.7.2).
	(pr-command): Return empty string if command is an empty string.

2004-02-24  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-abn.el: New file, implements an ABNF parser.

	* progmodes/ebnf2ps.el: Doc fix.  Accept ABNF (Augmented BNF).  New
	arrow shapes: semi-up-hollow, semi-up-full, semi-down-hollow and
	semi-down-full.  Fix a bug on productions like test = {"test"}* | (
	"tt" ["test"] ).  Reported by Markus Dreyer
	<mdreyer@ix.urz.uni-heidelberg.de>.
	(ebnf-version): New version number (4.0).
	(ebnf-print-directory, ebnf-print-file, ebnf-spool-directory)
	(ebnf-spool-file, ebnf-eps-directory, ebnf-eps-file)
	(ebnf-delete-style): New commands.
	(ebnf-directory, ebnf-file): New funs.
	(ebnf-special-show-delimiter, ebnf-file-suffix-regexp)
	(ebnf-production-name-p, ebnf-stop-on-error): New options.
	(ebnf-syntax-alist): New var.
	(ebnf-element-width): New fun replacing ebnf-list-width.
	(ebnf-arrow-shape, ebnf-syntax): Custom fix.
	(ebnf-style-custom-list, ebnf-style-database, ebnf-arrow-shape-alist)
	(ebnf-prologue): Adjust vars.
	(ebnf-setup, ebnf-insert-style, ebnf-merge-style, ebnf-apply-style)
	(ebnf-reset-style, ebnf-push-style, ebnf-pop-style)
	(ebnf-check-style-values, ebnf-generate-production)
	(ebnf-generate-region, ebnf-production-dimension, ebnf-justify-list)
	(ebnf-make-terminal1, ebnf-make-or-more1, ebnf-make-repeat)
	(ebnf-token-repeat): Code fix.

	* progmodes/ebnf-yac.el: Doc fix.  Handle Bison pragmas %nonassoc,
	%right, %left and %prec.  Suggested by Matthew K. Junker
	<junker@alum.mit.edu>.
	(ebnf-yac-definitions, ebnf-yac-lex): Code fix.

	* progmodes/ebnf-iso.el: Doc fix.
	(ebnf-iso-token-table, ebnf-iso-non-terminal-chars): Adjust vars.
	(ebnf-iso-lex): Code fix.

	* progmodes/ebnf-bnf.el: Doc fix.
	(ebnf-bnf-lex): Code fix.

	* progmodes/ebnf-otz.el: Doc fix.

2004-02-23  Luc Teirlinck  <teirllm@auburn.edu>

	* abbrev.el (write-abbrev-file): Make argument optional.  Doc fix.
	(abbrev-prefix-mark): Doc fix.

2004-02-23  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gud-watch): Load tooltip, if necessary.
	(gdb-var-create-handler): Force speedbar-update-flag to be non-nil.
	(gdb-var-delete): Make interactive (really).
	(gdb-edit-value): Make non-interactive.

	* progmodes/gud.el (gud-speedbar-menu-items):
	Add gdb-var-delete and, indirectly, gdb-edit-value.
	(gud-install-speedbar-variables): Bind gdb-var-delete to "D".
	(gud-speedbar-buttons): Remove gdb-var-delete from tag-line.
	(gud-gdb-marker-filter): Add comment for annotations.

2004-02-23  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (generate-calendar)
	(calendar-read-date): Prevent display of BC calendars once more -
	reverts 2003-10-01 change.
	(generate-calendar-month): Doc fix.

2004-02-03  Matthew Mundell  <matt@mundell.ukfsn.org>  (tiny change)

	* calendar/diary-lib.el (fancy-diary-display): Don't rely on
	return value of increment-calendar-month.

2004-02-21  Stephen Compall  <s11@member.fsf.org>

	* saveplace.el (save-place-forget-unreadable-files)
	(save-place-save-skipped, save-place-skip-check-regexp): New vars.
	(save-place-forget-unreadable-files): New function.
	(save-place-alist-to-file): Use it to filter out files that are
	no longer readable.

	* textmodes/texinfo.el (texinfo-insert-@item): Look for the
	current Texinfo environment, using the same method as in
	`texinfo-insert-@end', and insert a space rather than a newline if
	point in a @table environment.

2004-02-21  Juri Linkov  <juri@jurta.org>

	* ffap.el (ffap-file-at-point): Try parent directories.

2004-02-21  Klaus Zeitler  <kzeitler@lucent.com>

	* vcursor.el (vcursor-modifiers): New defcustom.
	(vcursor-cs-binding): Use vcursor-modifiers instead of a
	hard-coded list.

2004-02-21  Masatake YAMATO  <jet@gyve.org>

	* play/animate.el (animate-birthday-present): Accept names other
	than `Sarah', too.

2004-02-21  Juri Linkov  <juri@jurta.org>

	* startup.el: Remove table of command line arguments from the
	Commentary section.

2004-02-20  John Wiegley  <johnw@newartisans.com>

	* eshell/em-pred.el (eshell-modifier-alist): Change the "eval
	again" modifier from 'e' to 'E', since 'e' is also used by the
	"file extension" modifier.

2004-02-19  Luc Teirlinck  <teirllm@auburn.edu>

	* help-fns.el (describe-categories): Doc fix.

2003-02-19  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-util.el (ediff-compute-custom-diffs-maybe): Avoid creating
	temporary file for buffer already visiting one.  This change makes
	output likely to be directly usable by patch program.
	Suggested by Adrian Aichner  <adrian@xemacs.org>

2004-02-20  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-use-colon-colon-notation): Set default to nil for
	case of variables defined in compound statements.
	(gdb-setup-windows, gdb-source-info, gdb-source-info):
	Simplify constructions using switch-to-buffer.

2004-02-19  Simon Josefsson  <jas@extundo.com>

	* play/morse.el: Fix typo.
	(morse-code): Add @.

2004-02-19  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-display-format): Change default to
	'ignore, for backwards compatibility.
	(appt-display-message): If appt-display-format is 'ignore,
	respect old vars appt-msg-window and appt-visible.
	(appt-activate): Don't depend on return value of cancel-timer.

	* calendar/calendar.el (calendar-holidays): Doc fix.

	* calendar/cal-coptic.el (coptic-prompt-for-date):
	Use assoc-string instead of assoc-ignore-case.
	* calendar/cal-french.el (calendar-goto-french-date): Ditto.
	* calendar/cal-hebrew.el (calendar-goto-hebrew-date)
	(mark-hebrew-diary-entries, list-yahrzeit-dates): Ditto.
	* calendar/cal-islam.el (calendar-goto-islamic-date)
	(mark-islamic-diary-entries): Ditto.
	* calendar/cal-julian.el (calendar-goto-julian-date): Ditto.
	* calendar/cal-mayan.el (calendar-read-mayan-haab-date)
	(calendar-read-mayan-tzolkin-date): Ditto.
	* calendar/calendar.el (calendar-read-date): Ditto.
	* calendar/diary-lib.el (mark-diary-entries): Ditto.

2004-02-18  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* progmodes/executable.el (executable-command-find-posix-p):
	Fix choice of the directory.

2004-02-17  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (interprogram-cut-function)
	(interprogram-paste-function, kill-new, kill-append):
	Doc fixes.
	(kill-region): Make it return nil.  Doc fix.
	(yank-pop): Make its argument optional.
	(yank): Make ARG `-' equivalent to `-1'.

2004-02-17  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-get-new-mail): Don't reference
	rmail-use-spam-filter if rmail-spam-filter is not loaded.

2004-02-16  Luc Teirlinck  <teirllm@auburn.edu>

	* autorevert.el (auto-revert-buffer-p): Only revert dired buffers
	if one of global-auto-revert-non-file-buffers or autorevert-mode
	is non-nil.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* subr.el (delete-dups): A better implementation from Karl Heuer
	<kwzh@gnu.org>.

2004-02-16  Matt Hodges  <matt@stchem.bham.ac.uk>  (tiny change)

	* net/telnet.el (telnet-interrupt-subjob): Move doc string to the
	correct place.
	* progmodes/icon.el (icon-indent-command): Ditto.
	* textmodes/paragraphs.el (repunctuate-sentences): Ditto.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* progmodes/grep.el (grep-compute-defaults): Undo change from
	2004-01-29: don't use executable-command-find-posix-p.

2004-02-16  Richard Sharman  <rsharman@pobox.com>

	* hilit-chg.el: Use require instead of eval-and-compile.
	(highlight-compare-buffers): New function.

2004-02-16  John Basrai  <jbasrai@comcast.net>  (tiny change)

	* man.el (Man-fontify-manpage): Render section headings in
	`Man-overstrike-face' even when overstrike was not used by man
	formatter for section headings.

2004-02-16  Eli Tziperman  <eli@deas.harvard.edu>

	* rmail-spam-filter.el: (vm-use-spam-filter)
	(rsf-min-region-length-added-to-spam-list): New	variables.
	(rsf-bbdb-auto-delete-spam-bbdb-entries): Rename from
	rmail-bbdb-auto-delete-spam-entries.  Add cc: to recipients for
	spam testing.  Don't delete spam message if automatic deletion
	after output via variable rmail-delete-after-output is turned on.
	(rsf-bbdb-dont-create-entries-for-deleted-messages): Rename from
	rsf-bbdb-dont-create-entries-for-spam.
	(check-field): New function, extracted from code in
	rmail-spam-filter to ease addition of header fields like content-type.
	(message-content-type): New variable to check the content-type:
	field added, also in defcustom of rsf-definitions-alist.
	(rmail-spam-filter): Replace repeated test code for header fields
	by calls to check-field; change the call to
	rmail-output-to-rmail-file such that rmail-current-message stays
	the same to avoid wrong deletion of unseen flags.
	(rsf-add-contents-type): New function to convert old format
	of rmail-spam-definitions-alist into new one.
	Change prefixes of all variables and functions from
	rmail-spam-filter- or spam-filter- or rmail-spam- to rsf-.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* loadhist.el (unload-hook-features-list): New defvar.

2004-02-16  Dave Love  <fx@gnu.org>

	* loadhist.el (unload-feature): Doc fix.  Rename flist to
	unload-hook-features-list.

2004-02-16  Jay Belanger  <belanger@truman.edu>  (tiny change)

	* calc/calc-embed.el (calc-do-embedded-activate): Add autoload
	cookie.  Don't check if we are looking-at open-formula.

2004-02-16  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* subr.el (match-string-no-properties): Use substring-no-properties.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/rx.el (rx-check, rx-check-any, rx-check-not)
	(rx-repeat, rx-check-backref, rx-syntax, rx-to-string):
	Use lower-case "rx" in all error message.

2004-02-16  Dave Love  <fx@gnu.org>

	* emacs-lisp/rx.el (rx-or): Put group around result.
	(rx-constituents): Add backref.
	(rx-syntax): Add string-delimiter, comment-delimiter.
	(rx-categories): Add combining-diacritic.
	(rx-check-not, rx-greedy, rx): Doc fix.
	(rx-backref, rx-check-backref): New.

2004-02-16  Jesper Harder  <harder@ifa.au.dk>

	* newcomment.el (uncomment-region): Allow eob as comment end.

2004-02-16  Jari Aalto  <jari.aalto@poboxes.com>

	* filecache.el: All message and error commands now use prefix
	"Filecache:" to make it easy to read *Messages* buffer.

2004-02-16  Jari Aalto  <jari.aalto@poboxes.com>

	* autorevert.el: Add support to detect changed dired and VC buffers.
	(auto-revert-active-p, auto-revert-list-diff)
	(auto-revert-dired-file-list, auto-revert-dired-changed-p)
	(auto-revert-handler, auto-revert-active-p): New functions.
	(auto-revert-buffers): Move revert logic to `auto-revert-handler'
	and `auto-revert-active-p'.
	(eval-when-compile): Defvar dired-directory and vc-mode.
	(auto-revert-vc-cvs-file-version, auto-revert-vc-buffer-p)
	(auto-revert-handler-vc): New functions.

2004-02-16  Alfred M. Szmidt  <ams@kemisten.nu>  (tiny change)

	* progmodes/compile.el (compilation-directory): New defvar.
	(compile): Save current directory in compilation-directory.
	(recompile): Bind default-directory to compilation-directory if
	that is non-nil.

2004-02-16  Dave Love  <fx@gnu.org>

	* newcomment.el (comment-insert-comment-function)
	(comment-region-function, uncomment-region-function): New.
	(comment-indent): Use comment-insert-comment-function.
	(uncomment-region): Use uncomment-region-function.
	(comment-region): Use comment-region-function.

	* emacs-lisp/rx.el (rx-not): Bind case-fold-search to nil.

2004-02-16  Richard Stallman  <rms@gnu.org>

	* Makefile.in (TAGS, TAGS-LISP): Filter out of `els' only
	loaddefs* and ldefs-boot*.

2004-02-16  Eli Zaretskii  <eliz@gnu.org>

	* mail/mail-utils.el (rmail-dont-reply-to): Anchor user login name
	and email address at the beginning and end of the address.

	* mail/rmail.el (rmail-default-dont-reply-to-names): Make "info-"
	anchored at the beginning of the email address.

2004-02-16  TAKAI Kousuke  <tak@kmc.gr.jp>  (tiny change)

	* international/ccl.el (ccl-compile-write): Pass `left' to
	ccl-embed-code to generate correct code of write-expr-register.

2004-02-15  Dan Nicolaescu  <dann@ics.uci.edu>  (tiny change)

	* progmodes/grep.el (grep-compute-defaults): Fix typos.

2004-02-15  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el: Mention support for Motif in commentary.
	(x-dnd-handle-drag-n-drop-event): Ditto.

2004-02-14  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el: Use "ses--" prefixes for buffer-local variables.
	Use (point-min) instead of 1, even when we know the buffer
	is unnarrowed.
	(ses-build-load-map): Delete.  Distribute its content to defconst's for
	the three maps.
	(ses-menu, ses-header-line-menu): New menus.
	(ses-mode-map): Use them.
	(ses-read-number) New fun.  Duplicates code from interactive "N" spec.

2004-02-14  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* Makefile.in: Fix the CC Mode recompile kludge so it works
	when building in a different directory.

2004-02-13  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (kill-new): Put yank-handler property on the entire string.

2004-02-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff.el: Don't use compile any more, use diff-mode instead.
	(diff-regexp-alist, diff-old-file, diff-new-file)
	(diff-parse-differences, diff-process-setup): Remove.
	(diff-sentinel): New fun.
	(diff): Use it.  Run the process ourselves.
	Use diff-mode for the rest of the processing.

	* diff.el (diff): Simplify code handling `switch'.

2004-02-11  Stefan Monnier  <monnier@iro.umontreal.ca>

	* pcvs-defs.el (cvs-menu): Add `tag'.

2004-02-11  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (kill-append): Doc fix.

	* emacs-lisp/lisp-mode.el (lisp-mode-variables):
	Adapt outline-regexp to the new conventions for commenting out code.

2004-02-11  John Paul Wallington  <jpw@gnu.org>

	* mail/smtpmail.el (smtpmail-try-auth-methods): Fix typo.

2004-02-10  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff.el (diff-switches): New fun.
	(diff, diff-backup): Use it.
	(diff): Clean up the args construction.  Use backquote.
	Use listp instead of consp to avoid putting a nil arg.
	(diff): Add a revert-buffer function.

2004-02-10  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-types-alist): Add COMPOUND_TEXT,  FILE_NAME
	handled by x-dnd-handle-file-name.
	(x-dnd-known-types): Add COMPOUND_TEXT.
	(x-dnd-init-frame): Call x-dnd-init-motif-for-frame.
	(x-dnd-get-state-cons-for-frame): Must do copy-sequence on
	x-dnd-empty-state.
	(x-dnd-forget-drop): Ditto.
	(x-dnd-save-state): Add optional parameter extra-data (for Motif).
	(x-dnd-handle-one-url): Return private when inserting text.
	(x-dnd-insert-ctext): New function.
	(x-dnd-handle-file-name): New function for FILE_NAME.
	(x-dnd-handle-drag-n-drop-event): Add Motif, remove call to error.
	(x-dnd-init-motif-for-frame, x-dnd-get-motif-value)
	(x-dnd-motif-value-to-list, x-dnd-handle-motif): New functions.

2004-02-10  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-select-utf8-or-ctext): Use compare-strings
	instead of while loop.

2004-02-10  Miles Bader  <miles@gnu.org>

	* emacs-lisp/macroexp.el: New file, implements `macroexpand-all'.

2004-02-09  Kenichi Handa  <handa@m17n.org>

	* tar-mode.el (tar-extract): Fix for the case that a file doesn't
	have end-of-line.

2004-02-09  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* Makefile.in: Added extra dependencies in the recompile target
	needed to cope with the compile time macro expansions in CC Mode.

2004-02-09  Kim F. Storm  <storm@cua.dk>

	* fringe.el (no-fringe-bitmap, undef-fringe-bitmap)
	(left-truncation-fringe-bitmap, right-truncation-fringe-bitmap)
	(up-arrow-fringe-bitmap, down-arrow-fringe-bitmap)
	(continued-line-fringe-bitmap, continuation-line-fringe-bitmap)
	(overlay-arrow-fringe-bitmap, top-left-angle-fringe-bitmap)
	(top-right-angle-fringe-bitmap, bottom-left-angle-fringe-bitmap)
	(bottom-right-angle-fringe-bitmap, left-bracket-fringe-bitmap)
	(right-bracket-fringe-bitmap, filled-box-cursor-fringe-bitmap)
	(hollow-box-cursor-fringe-bitmap, hollow-square-fringe-bitmap)
	(bar-cursor-fringe-bitmap, hbar-cursor-fringe-bitmap)
	(empty-line-fringe-bitmap): Define standard fringe bitmaps id's.

2004-02-08  Stefan Monnier  <monnier@iro.umontreal.ca>

	* window.el (window-safely-shrinkable-p): Don't change the buffer-list.
	Don't allow shrink if there's a window on our right.

	* progmodes/prolog.el (prolog-program-name): Use gprolog if available.
	(prolog-mode-syntax-table, prolog-mode-abbrev-table, prolog-mode-map):
	Bring together declaration and initialization.
	(prolog-mode-variables): Don't set the syntax table.
	Don't set paragraph-start and comment-indent-function.
	Add /*..*/ to the comment regexps.
	(prolog-mode-commands): Remove.  Do it during init of prolog-mode-map.
	(prolog-mode-map): Don't bind TAB.
	(prolog-mode): Set the syntax table.
	(prolog-comment-indent): Remove.
	(inferior-prolog-mode-map): Initialize in the declaration.
	(inferior-prolog-mode-syntax-table)
	(inferior-prolog-mode-abbrev-table): New vars.
	(inferior-prolog-mode): Derive from comint-mode.
	(run-prolog): Avoid switch-to-buffer which can fail in dedicated and
	minibuffer windows.

	* progmodes/grep.el (grep-regexp-alist): Allow :, \t and (
	in file names, as long as it is unabmiguous.

2004-02-08  Andreas Schwab  <schwab@suse.de>

	* textmodes/reftex-toc.el
	(reftex-toc-load-all-files-for-promotion): Remove useless use of
	format.  Doc fix.

	* textmodes/refer.el (refer-find-entry-internal): Remove extra
	format string arguments.

	* tar-mode.el (tar-parse-octal-integer-safe): Add missing format
	string argument.

	* progmodes/xscheme.el (verify-xscheme-buffer): Fix format strings.

	* play/zone.el (zone-call): Fix format string.

	* net/webjump.el (webjump-builtin): Add missing format string argument.

	* midnight.el (midnight-delay-set): Remove extra format string argument.

	* mail/rmail.el (rmail-get-new-mail): Remove useless use of format.

	* hexl.el (hexl-insert-char): Add missing format string argument.

	* format.el (format-decode): Fix format string.

	* emulation/vi.el (vi-mode): Remove extra format string argument.
	(vi-repeat-last-search): Likewise.
	(vi-reverse-last-search): Likewise.
	(vi-goto-mark): Likewise.
	(vi-reverse-last-find-char): Likewise.
	(vi-repeat-last-find-char): Likewise.
	(vi-locate-def): Likewise.

	* emacs-lisp/lisp-mnt.el (lm-verify): Remove useless use of format.

	* ediff-util.el (ediff-toggle-read-only): Remove extra format
	string argument.
	(ediff-toggle-regexp-match): Likewise.

	* dired-aux.el (dired-do-query-replace-regexp): Add missing
	format string argument.

	* calc/calc-map.el (calc-get-operator): Remove extra format
	string argument.

	* calc/calc-forms.el (calc-convert-time-zones): Fix format string.

	* calc/calc-ext.el (calc-do-prefix-help): Remove extra format
	string argument.

	* eshell/esh-mode.el (eshell-send-invisible): Fix format string.

	* eshell/em-hist.el (eshell-hist-word-reference): Fix format string.

	* emulation/viper-ex.el (ex-mark): Remove extra format string argument.

	* emacs-lisp/cl-macs.el (defstruct): Remove extra format string arg.
	(cl-struct-setf-expander): Likewise.

	* vc.el (with-vc-file): Fix unsafe uses of error.
	(vc-cancel-version): Likewise.

2004-02-08  Jan Nieuwenhuizen  <jan.nieuwenhuizen@aspiratie.nl>  (tiny change)

	* progmodes/gud.el (gud-jdb-marker-filter): Add period as optional
	thousands separator; fixes <class>:<line-number> regexp for
	non-english locales.

2004-02-08  Andreas Schwab  <schwab@suse.de>

	* view.el (view-mode-enable): Revert previous change.

2004-02-07  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-number-at-pos): Rename from line-at-pos.
	Uses changed (what-line and vc-annotate-warp-version).

2004-02-06  Stefan Monnier  <monnier@iro.umontreal.ca>

	* diff-mode.el (diff-file-regexp-alist, diff-error-regexp-alist)
	(diff-mode): Remove aborted attempt at support for compile.el.
	(diff-mode, diff-minor-mode): Avoid obsolete write-contents-hooks.

2004-02-06  Andreas Schwab  <schwab@suse.de>

	* view.el (view-mode-enable): Add view-mode-map to
	minor-mode-overriding-map-alist.

2004-02-05  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el (x-dnd-get-local-file-name): Fix byte compiler warning

2004-02-04  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-fill-paragraph): Call fill-paragraph
	with point inside rather than after the paragraph.

2004-02-04  Sam Steingold  <sds@gnu.org>

	* mail/smtpmail.el (smtpmail-try-auth-methods):
	Do not try authentication when no mechanism is available.
	Pass port-name as defaultport to `netrc-machine'.

2004-02-04  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-minibuffer-setup-hook): Update doc string
	to show how minibuffer height can be constrained.

2004-02-04  John Paul Wallington  <jpw@gnu.org>

	* files.el (auto-mode-alist): Fix .scm, .stk, .ss, .sch entry.

2004-02-03  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* x-dnd.el: New file for drag and drop.

	* term/x-win.el: require x-dnd, set after-make-frame-functions
	to x-dnd-init-frame, let x-dnd-handle-drag-n-drop-event handle
	drag-n-drop event.

	* dired.el (dired-dnd-test-function, dired-dnd-popup-notice)
	(dired-dnd-do-ask-action, dired-dnd-handle-local-file)
	(dired-dnd-handle-file): New functions for drag and drop support.
	(dired-mode): Initialize drag and drop if x-dnd present.

2004-02-02  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/cperl-mode.el (cperl-mode-map, cperl-do-auto-fill)
	(cperl-menu): Use fill-paragraph, not cperl-fill-paragraph.
	(cperl-mode): Set fill-paragraph-function.
	(cperl-fill-paragraph): Make it non-interactive.

2004-02-02  Benjamin Rutt  <brutt@bloomington.in.us>

	* diff-mode.el (diff-mode-shared-map): Bind q to `quit-window'.

2004-02-02  David Kastrup  <dak@gnu.org>

	* replace.el (perform-replace): Allow 'literal argument in
	regexp-flag to indicate literal replacement.
	(query-replace-regexp-eval): Use it.

2004-02-01  Andreas Schwab  <schwab@suse.de>

	* progmodes/executable.el (executable-command-find-posix-p): Doc fix.

2004-02-01  Stephen Eglen  <stephen@gnu.org>

	* info-look.el: Add support for maxima-mode.  Update commentary
	because info-lookup-symbol is now bound to C-h S.

2004-01-31  Luc Teirlinck  <teirllm@auburn.edu>

	* simple.el (edit-and-eval-command): Bind print-level and
	minibuffer-history-sexp-flag around call to read-from-minibuffer.
	Correct initial position in command-history.

2004-01-30  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (read-directory-name): Adapt the docstring to recent
	change in Fread_file_name.

2004-01-30  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (ses-print-cell): If print format too wide for column
	width, truncate decimal places if that helps to avoid "#####" fill.
	* ses.el (ses-initial-column-width): Revert previous change.

2004-01-29  Stefan Monnier  <monnier@iro.umontreal.ca>

	* jit-lock.el (jit-lock-context-time, jit-lock-context-timer): New var.
	(with-buffer-unmodified, with-buffer-prepared-for-jit-lock):
	Add edebug info.
	(jit-lock-mode): Setup/cancel the new timer.
	(jit-lock-context-fontify): New fun.  Extracted from
	context fontification code of jit-lock-stealth-fontify.
	(jit-lock-stealth-fontify): Don't do context fontification any more.

	* jit-lock.el (jit-lock-stealth-fontify): Allow quit.
	(jit-lock-fontify-now): Handle the `quit' case.
	(jit-lock-contextually): Rename from jit-lock-defer-contextually.

2004-01-29  Jari Aalto  <jari.aalto@poboxes.com>

	* progmodes/executable.el (executable-command-find-posix-p):
	New.  Check if find handles arguments Posix-style.

	* progmodes/grep.el (grep-compute-defaults):
	Use executable-command-find-posix-p.
	(grep-find): Check `grep-find-command'.

	* filecache.el (file-cache-find-posix-p): Delete.
	(file-cache-add-directory-using-find):
	Use `executable-command-find-posix-p'.

2004-01-29  Dave Love  <fx@gnu.org>

	* emacs-lisp/lisp.el (beginning-of-defun-raw, end-of-defun):
	Iterate the hook function if arg is given.
	(mark-defun, narrow-to-defun): Change order of finding the limits.

	* emacs-lisp/bytecomp.el (byte-compile-compatibility): Doc fix.
	(byte-compile-format-warn): New.
	(byte-compile-callargs-warn): Use it.
	(Format, message, error): Add byte-compile-format-like property.
	(byte-compile-maybe-guarded): New.
	(byte-compile-if, byte-compile-cond): Use it.
	(byte-compile-lambda): Compile interactive forms,
	just to make warnings about them.

2004-01-29  Jonathan Yavner  <jyavner@member.fsf.org>

	* ses.el (ses-initial-column-width): Increase to 14, so it will
	work well with the default printer of "%.7g" for extreme values
	like "-1.234567e+07".

2004-01-29  Kenichi Handa  <handa@m17n.org>

	* term/x-win.el (x-selection-value): Optimize for ASCII only case.

2004-01-28  Peter 'Luna' Runestig  <peter@runestig.com>

	* dos-w32.el: Added support for the `default-printer-name' function.

2004-01-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* server.el (server-socket-name): Don't use the hostname in the
	socket name since /tmp is local to the host anyway.

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation): Use a more
	robust check of widening and fix var-naming.

2004-01-27  Eli Tziperman  <eli@deas.harvard.edu>

	* rmail-spam-filter.el: Change rmail-spam-filter- or spam-filter-
	or rmail-spam- to rsf- in all function and variable names.
	(rsf-min-region-to-spam-list): New variable.
	(rsf-bbdb-auto-delete-spam-entries): Rename from
	rmail-bbdb-auto-delete-spam-bbdb-entries.  The cc: field is
	scanned together with the recipients field for spam testing; Don't
	delete spam message if rmail-delete-after-output is non-nil;
	(rsf-check-field): New function, extracted from code in
	rmail-spam-filter to ease addition of header fields like
	content-type:;
	(message-content-type): New variable.  The content-type: field was
	added also in defcustom of rsf-definitions-alist;
	(rmail-spam-filter): Replace repeated test code for header fields
	by calls to check-field; change the call to
	rmail-output-to-rmail-file such that rmail-current-message stays
	the same to avoid wrong deletion of unseen flags.
	(rmail-use-spam-filter): Add autoload cookie.

2004-01-27  Jari Aalto  <jari.aalto@poboxes.com>

	* filecache.el (file-cache-find-posix-p): New function.  Detect Cygwin.
	(file-cache-add-directory-using-find): Add Cygwin support.
	(file-cache-find-command-posix-flag): New user variable.

	* filecache.el (file-cache-add-directory): Check for
	directories an remove them from dir-files.

2004-01-27  Richard M. Stallman  <rms@gnu.org>

	* man.el (Man-fontify-manpage): Clean up message.

2004-01-27  Kenichi Handa  <handa@m17n.org>

	* textmodes/paragraphs.el (sentence-end-without-space): New variable.
	(sentence-end): Define using sentence-end-without-space.

	* textmodes/fill.el (fill-delete-newlines): Don't add a space if
	a sentence ends with one of a character in sentence-end-without-space.

2004-01-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* font-lock.el (font-lock): Add jit-lock as explicit group member.
	(jit-lock): Group declaration moved to jit-lock.el.
	(toplevel): Don't explicitly require jit-lock, since it's autoloaded
	when necessary.

	* jit-lock.el (jit-lock): Move group declaration from font-lock.el.
	(jit-lock-context-unfontify-pos): Rename from
	jit-lock-first-unfontify-pos.
	(jit-lock-defer-buffers): Rename from jit-lock-buffers.

2004-01-25  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/fortran.el (fortran-break-before-delimiters): Doc fix.
	(fortran-break-delimiters-re, fortran-no-break-re): New consts.
	(fortran-fill): When filling a string, adjust re-search-backward
	argument for special case of string just on fill-column.
	When filling non-string, allow one extra char if
	fortran-break-before-delimiters is non-nil.
	Suggested by Michael Hagemann <michael.hagemann@unibas.ch>.
	Use fortran-break-delimiters-re and fortran-no-break-re to
	correctly handle cases such as "**".

	* progmodes/f90.el (f90-break-delimiters): Doc fix.
	(f90-no-break-re): Add some extra tokens.  Doc fix.

2004-01-24  Thien-Thi Nguyen  <ttn@gnu.org>

	* mail/rmail-spam-filter.el:
	Use two semicolons as Commentary line prefix.
	Add ";;; Code:" stylized comment.
	Delete end-of-line whitespace.
	Wrap (require 'cl) with `eval-when-compile'.

2004-01-23  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-annotate): Fix improper use of `make-local-variable'
	at the top level of vc.el.

2004-01-23  Andre Spiegel  <spiegel@gnu.org>

	* vc.el (vc-current-line): Function removed.  This is now done by
	the new function line-at-pos in simple.el.
	(vc-annotate-warp-version): Use line-at-pos instead of
	vc-current-line.

2004-01-22  Kim F. Storm  <storm@cua.dk>

	* simple.el (line-at-pos): New defun.
	(what-line): Use it.  Optimize by only counting lines in narrowed
	region once.

2004-01-22  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el (ccl-encode-windows-1251-font): Rearrange code
	point (register r1) only for charset mule-unicode-0100-24ff.

2004-01-21  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* mail/rmail.el (rmail-convert-to-babyl-format): Avoid deleting
	trailing white space and ensure a final newline.

	* mail/rmail-spam-filter.el (rmail-use-spam-filter):
	Add autoload cookie.

2004-01-21  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-annotate-mode): Inherit from fundamental-mode and
	activate view-mode explicitly.

2004-01-21  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* term/x-win.el: Call menu-bar-enable-clipboard and make Paste
	use clipboard first.

2004-01-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* vc-mcvs.el (vc-mcvs-mode-line-string): Remove.  Does not work.
	(vc-mcvs-workfile-version): Manually macro expand vc-mcvs-cvs.
	(vc-mcvs-cvs): Remove.
	(vc-mcvs-command): Remove use of assert.

	* outline.el (outline-insert-heading): Tighten up match.
	(outline-demote, outline-move-subtree-down): Don't assume anything
	about outline-regexp.

	* textmodes/texinfo.el (texinfo-mode): Remove ^ from outline-regexp.
	(texinfo-show-structure): Explicitly add ^, and simplify.

2004-01-20  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el (appt-check): Restore usage of
	appt-issue-message deleted in previous change.
	(top-level): Activate package when loaded (needed for backwards
	compatibility).

2004-01-20  Jesper Harder  <harder@ifa.au.dk>

	* mail/smtpmail.el (smtpmail-via-smtp): No need to add two bytes
	following previous change to smtpmail-send-data.

2004-01-20  Benjamin Rutt  <brutt@bloomington.in.us>

	* vc.el (vc-default-previous-version): Doc enhancement.
	(vc-default-next-version): New function.
	(vc-print-log): New arg FOCUS-REV.
	(vc-annotate-mode): Derive from view-mode.
	(vc-annotate): New args REVISION, DISPLAY-MODE.
	(vc-annotate-workfile-version, vc-annotate-extract-revision-at-line)
	(vc-annotate-revision-at-line, vc-annotate-revision-previous-to-line)
	(vc-annotate-show-log-revision-at-line, vc-annotate-warp-version)
	(vc-annotate-show-diff-revision-at-line, vc-current-line)
	(vc-annotate-prev-version, vc-annotate-next-version): New functions.

	* vc-cvs.el (vc-cvs-annotate-extract-revision-at-line): New function.

2004-01-19  Karl Berry  <karl@gnu.org>

	* textmodes/texinfo.el: Use "Texinfo" consistently, no "TeXinfo"
	or "TexInfo".

2004-01-19  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (delete-dups): New function.

2004-01-19  Karl Berry  <karl@gnu.org>

	* textmodes/texinfo.el (texinfo-mode): Define outline-regexp to start
	with ^, since that's what texinfo-show-structure
	documentation says (plus it works much better in texinfo.txi).

2004-01-18  Jesper Harder  <harder@ifa.au.dk>

	* mail/smtpmail.el (smtpmail-send-data): Don't append spurious newline.

2004-01-18   David Ponce  <david@dponce.com>  (tiny change)

	* progmodes/which-func.el (which-function-mode): Don't cancel
	which-func-update-timer if not set.

2004-01-17  Thien-Thi Nguyen  <ttn@gnu.org>

	* calendar/diary-lib.el (diary-entry-time): Fix typo/bug:
	Remove spurious left square bracket in XX:XXam regexp.

2004-01-16  Luc Teirlinck  <teirllm@auburn.edu>

	* progmodes/cc-defs.el: Do not require cl at run time.

2004-01-16  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/cl.el (cl-cannot-unload): New function.
	(cl-unload-hook): Defvar this to run cl-cannot-unload.

	* mail/rmail.el (rmail-get-new-mail): New local rsf-number-of-spam.
	Call rmail-spam-filter.  Delete and expunge spam.
	Print number of spam messages deleted.
	Save and restore the deletion status of old messages when reading
	new mail with spam filter, so that expunging spam does not expunge
	msgs deleted by the user.
	(rmail-only-expunge): Add an optional argument dont-show to
	prevent showing message after expunge.

2004-01-15  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/cl.el (declare): Add `fmakunbound' for `declare'.
	* subr.el (declare): New macro.

2004-01-15  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/scheme.el (scheme-font-lock-keywords-2): Add "force".

2004-01-14  Stefan Monnier  <monnier@iro.umontreal.ca>

	* mwheel.el (mouse-wheel-down-event, mouse-wheel-up-event):
	Test window-system rather than system-type (for X11/Mac).

2004-01-12  Luc Teirlinck  <teirllm@auburn.edu>

	* emacs-lisp/bytecomp.el (compile-defun): Doc fix.

2004-01-12  Richard M. Stallman  <rms@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Use mail-unquote-printable-region.
	(rmail-hex-string-to-integer, rmail-decode-quoted-printable):
	(rmail-hex-char-to-integer): Functions deleted.

	* mail/mail-utils.el (mail-unquote-printable-hexdigit): Upcase CHAR.
	(mail-unquote-printable-region): New arg NOERROR.
	For invalid encoding, either signal an error to just return nil.

2004-01-11  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/appt.el: Update copyright and commentary.
	(appt-issue-message): Make obsolete.
	(appt-visible, appt-msg-window): Make obsolete, in favour of
	appt-display-format.
	(appt-display-mode-line, appt-display-duration)
	(appt-display-diary, appt-time-msg-list, appt-mode-string)
	(appt-prev-comp-time, appt-display-count, appt-timer)
	(appt-convert-time): Doc change.
	(appt-disp-window-function, appt-delete-window-function):
	Use defcustom rather than defvar.
	(appt-display-format): New variable.
	(appt-display-message): New function with display code from appt-check.
	(appt-check): Add optional FORCE argument.  Doc change.
	Add appt-make-list to diary-hook if displaying diary.
	Remove checking of view-diary-entries-initially.
	Message display section removed to new function appt-display-message.
	(appt-display-window): Doc change.  Remove unused internal var
	this-buffer.  Do not beep, since appt-display-message does that.
	(appt-make-list): Doc change.  Use caar.
	(appt-sort-list): Simplify by using builtin sort function.
	(appt-update-list): New function for updating appts when diary is
	saved.
	(appt-activate): New autoloaded function to toggle package
	functionality.

	* calendar/cal-x.el: (calendar-one-frame-setup)
	(calendar-only-one-frame-setup, calendar-two-frame-setup): Doc change.

	* calendar/calendar.el: Update copyright.
	(view-diary-entries-initially, european-calendar-style): Doc change.
	(calendar-setup): Make defcustom rather than defvar.
	(mark-visible-calendar-date): Initialize temp-face and faceinfo
	in let binding so local to function.

	* calendar/diary-lib.el: Update copyright.
	(diary, diary-entry-time): Doc change.
	(list-diary-entries): Doc change.  Trivial logic change.
	(fancy-diary-display): Restore make-face command mistakenly
	deleted 2003-05-08.
	(show-all-diary-entries): Allow to pop-up frame if needed.

2004-01-09  John Paul Wallington  <jpw@gnu.org>

	* bindings.el (mode-line-change-eol): Add EVENT parameter.
	Temporarily select EVENT's window for changing eol type.

2004-01-09  Deepak Goel  <deego@gnufans.org>

	* calendar/diary-lib.el (diary-entry-time):
	Also accept time in the form XX[.XX][am/pm/AM/PM].
	(fancy-diary-font-lock-keywords): Likewise.
	(diary-font-lock-keywords): Likewise.
	* calendar/appt.el (appt-add): Likewise.
	(appt-make-list): Likewise.
	(appt-convert-time): Likewise.

2004-01-08  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-ann3): Revert previous change.
	(gdb-source-info): Allow for case of where compilation directory
	is not recorded.

2004-01-08  John Paul Wallington  <jpw@gnu.org>

	* emerge.el (emerge-restore-buffer-characteristics): Doc fix.

2004-01-07  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gdb-first-prompt): Rename from gdb-first-pre-prompt

	* gdb-ui.el (gdba): Avoid duplication, use gdb-ann3.
	(gdb-ann3): Use GDB command "set width 0" to prevent word wrapping
	problems.
	(gdb-prompt): Set (renamed) gdb-first-prompt to nil in gdb-ann3.

2004-01-07  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (write-file-functions, write-contents-functions):
	Clarify docstrings.

2004-01-07  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (set-auto-coding): Fix for the case that
	end-of-line is only CR.

2004-01-07  Kim F. Storm  <storm@cua.dk>

	* subr.el (event-start, event-end): Doc fix.
	(posn-string, posn-image): New defuns.
	(posn-object): Return either image or string object.
	(posn-object-x-y): Return 8th element of position.
	(posn-object-width-height): New defun.

2004-01-06  Andreas Schwab  <schwab@suse.de>

	* gdb-ui.el (gdb-frame-handler): Handle word wrapping anywhere in
	output.

2004-01-05  Karl Berry  <karl@gnu.org>

	* emacs-lisp/copyright.el (copyright-regexp): Might as well allow
	/ and *, too.

2003-12-31  Simon Josefsson  <jas@extundo.com>

	* files.el (before-save-hook): Add.
	(basic-save-buffer): Use before-save-hook.

	* emacs-lisp/copyright.el: Fix comment to recommend
	before-save-hook instead of write-file-functions.

2004-01-05  Richard M. Stallman  <rms@gnu.org>

	* finder.el (finder-commentary): Call delete-other-windows.

	* net/ange-ftp.el (ange-ftp-file-attributes):
	Pass 2 args to ange-ftp-real-file-attributes only if ID-FORMAT non-nil.

2004-01-04  Karl Berry  <karl@gnu.org>

	* emacs-lisp/copyright.el (copyright-regexp): Allow the common
	comment characters % and # in the copyright year notice,
	as well as ;.

2004-01-04  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (default): Define dummy :value-delete.
	Reported by Jesper Harder <harder@ifa.au.dk>.

2004-01-03  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compile-internal): Use point, not point-min,
	for set-window-point.

	* textmodes/tex-mode.el (latex-find-indent): Avoid error at end of buf.

	* emacs-lisp/lisp-mnt.el (lm-section-end): Require outline.

	* progmodes/grep.el (grep-mode-map):
	Don't remap next-line, previous-line.

2004-01-03  Eric M. Ludlam  <eric@siege-engine.com>

	* speedbar.el (speedbar-edit-line): Change regexp to position
	the cursor on the first character of this line's button.

2004-01-03  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (functionp): Doc fix.

2004-01-03  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* progmodes/idlwave.el (idlwave-make-tags):
	* textmodes/flyspell.el (flyspell-large-region):.
	* progmodes/make-mode.el (makefile-query-by-make-minus-q):
	* emulation/viper-util.el (viper-glob-unix-files):
	* emacs-lisp/shadow.el (shadow-same-file-or-nonexistent):
	* man.el (Man-init-defvars):
	* jka-compr.el (jka-compr-call-process):
	* files.el (get-free-disk-space,insert-directory):
	* ediff-ptch.el (ediff-test-patch-utility):
	* ediff-diff.el (ediff-test-utility):
	* dired-aux.el (dired-check-process):
	* mail/sendmail.el (sendmail-send-it): Don't use = or zerop to
	test the return value of call-process, because it can be a string.

2003-12-31  John Paul Wallington  <jpw@gnu.org>

	* bindings.el (completion-ignored-extensions): Add .pfsl.

2003-12-31  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-nonreadable-directory-p): New defun to check for
	nonreadable directory without activating tramp (to avoid problems
	with checking incomplete tramp paths).
	(ido-set-current-directory, ido-file-internal)
	(ido-file-name-all-completions1): Use it.

2003-12-30  Luc Teirlinck  <teirllm@auburn.edu>

	* help-mode.el (help-xref-info-regexp): Make hyperlinks to Info
	documentation if the anchor (or node) name is preceded by `info
	anchor' or `Info anchor' in addition to earlier `info node' and
	`Info node'.
	(help-make-xrefs): Adapt to new value of `help-xref-info-regexp'.

2003-12-30  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Fix off-by-one
	error in arguments to base64-decode-region.  Remove ^M characters
	after decoding base64.

2003-12-30  Simon Josefsson  <jas@extundo.com>

	* textmodes/texinfo.el: Change maintainer to FSF.  Suggested by
	karl@freefriends.org (Karl Berry), since the Texinfo Elisp files
	have only been distributed with Emacs for some years.
	(texinfo-mode-hook): Customize.

2003-12-30  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Make the code
	cleaner (suggested by Richard Stallman).

	* progmodes/gud.el (gud-tool-bar-map): Modify names of icon files
	for gud-next, gud-nexti, gud-step and gud-stepi to prevent
	file-name clashes on 8+3 DOS filesystems.

	* toolbar/gud-next.pbm, toolbar/gud-next.xpm
	* toolbar/gud-nexti.pbm, toolbar/gud-nexti.xpm
	* toolbar/gud-step.pbm, toolbar/gud-step.xpm
	* toolbar/gud-stepi.pbm, toolbar/gud-stepi.xpm: Renamed to
	gud-n.*, gud-ni.*, gud-s.*, and gud-si.*, respectively, to avoid
	file-name clashes on 8+3 filesystems.

	* emacs-lisp/tcover-unsafep.el, emacs-lisp/tcover-ses.el:
	Renamed from testcover-unsafep.el and testcover-ses.el to avoid
	file-name clashes on 8+3 DOS filesystems.

2003-12-29  Richard M. Stallman  <rms@gnu.org>

	* mail/mail-utils.el (mail-unquote-printable-hexdigit):
	Upcase the character.

	* textmodes/flyspell.el (mail-mode-flyspell-verify):
	Search for header separator alone on a line, literally,
	and search for it backward, not forward.
	(flyspell-abbrev-table): Always use global-abbrev-table
	if there is no local one.

	* progmodes/sh-script.el (sh-get-indent-info):
	Don't move point back if at bob.

	* progmodes/antlr-mode.el (save-buffer-state-x): Use with-no-warnings.

	* play/handwrite.el (handwrite): Make the handwrite credit message
	a comment rather than an output command.

	* obsolete/sc.el: Display message that this file is obsolete.

	* net/ange-ftp.el (ange-ftp-start-process): Copy the environment.

	* mail/rfc822.el (rfc822-address-start): Declare variable.
	Renamed from address-start.  All uses changed.

	* term.el (term-exec): Set up sentinel.
	(term-sentinel): New function.
	(term-handle-exit): New function.

	* subr.el (assoc-ignore-case, assoc-ignore-representation):
	Use assoc-string, and mark them obsolete.
	(delay-mode-hooks): Mark as permanent local.

	* simple.el (sendmail-user-agent-compose): Use assoc-string.

	* register.el (copy-rectangle-to-register): Doc fix.

	* info.el (Info-insert-dir): Use assoc-string.

	* info-look.el (info-lookup): Use assoc-string.

	* frame.el (pop-up-frame-function): Use quote, not `function'.
	(frame-notice-user-settings): Calculate ADJUSTED-TOP
	copying with lists as coordinate values.

	* font-lock.el (font-lock-after-change-function): Bind inhibit-quit.

	* find-dired.el (kill-find): New command.
	(find-dired): Make buffer read-only.
	Set up a keymap with C-c C-k running kill-find.
	(find-dired-filter, find-dired-sentinel): Bind inhibit-read-only.

	* files.el (backup-buffer-copy): If MODES is nil, don't set modes.

	* filecache.el (file-cache-ignore-case): New variable.
	(file-cache-assoc-function): Var deleted.  Use assoc-string instead.

	* comint.el (comint-arguments): Set COUNT after ARGS is complete.
	(comint-dynamic-complete-as-filename): Rename local vars.
	(comint-dynamic-list-filename-completions): Likewise.

	* comint.el (comint-dynamic-list-completions-config): New var.
	(comint-dynamic-list-completions): Handle both SPC and TAB right.

	* comint.el (comint-file-name-chars): Add [].
	(comint-word): Use skip-chars-backward, not search.

	* shell.el (shell-file-name-chars): Add [].

	* shell.el (shell-dynamic-complete-as-command): Rename local vars.

	* bookmark.el (bookmark-get-bookmark): Use assoc-string.

	* generic.el (define-generic-mode): Doc fix.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* files.el (kill-some-buffers): Doc fix.

2003-12-29  David Herring  <sdh6@ra.msstate.edu>  (tiny change)

	* comint.el (comint-watch-for-password-prompt): Pass `string' as
	arg to send-invisible
	(send-invisible): Doc fix.  The argument is now a prompt, not the
	string to send.
	(comint-read-noecho): Doc fix.

2003-12-29  Michael R. Wolf  <MichaelRWolf@att.net>  (tiny change)

	* net/ange-ftp.el (ange-ftp-name-format): Allow USER to contain
	"@", as required by some ISP hosting service.  Fix defcustom
	argument syntax errors that prevented use of customization.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* xml.el (xml-get-attribute-or-nil): Doc fix.

2003-12-29  Peter 'Luna' Runestig  <peter@runestig.com>

	* net/zone-mode.el (zone-mode): Use write-file-functions, not
	write-file-hooks.

2003-12-29  Eric Hanchrow  <offby1@blarg.net>  (tiny change)

	* autorevert.el (auto-revert-interval): Doc fix.

2003-12-29  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-get-attribute-or-nil): New function, like
	xml-get-attribute, but returns nil if the attribute was not found.
	(xml-get-attribute): Convert to defsubst, uses
	xml-get-attribute-or-nil.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* emacs-lisp/easymenu.el (easy-menu-define): Doc fix.

2003-12-29  Alex Schroeder  <alex@emacswiki.org>  (tiny change)

	* custom.el (custom-declare-theme): Use `value' when putting
	properties on `theme'.

2003-12-29  Takaaki Ota  <Takaaki.Ota@am.sony.com>

	* subr.el (insert-for-yank): Call insert-for-yank-1 repetitively
	for each yank-handler segment.
	(insert-for-yank-1): New function, with the body of the previous
	insert-for-yank.

	* textmodes/table.el (table-yank-handler): New defcustom.
	(table--put-cell-indicator-property): Put yank-handler property
	that indicates the yank handler for the table cell.

2003-12-29  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* generic-x.el (etc-modules-conf-generic-mode): A more complete
	set of keywords.

2003-12-29  Eli Zaretskii  <eliz@gnu.org>

	* international/mule-cmds.el (reset-language-environment)
	(set-language-environment): Don't invoke fontset-related functions
	if fontset-list is not fboundp.

2003-12-29  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (reset-language-environment):
	Call set-overriding-fontspec-internal with nil.
	(set-language-environment): Call set-overriding-fontspec-internal
	if the language environment specify `overriding-fontspec'.
	(language-info-alist): Doc added.

	* language/cyrillic.el (ccl-encode-koi8-font): Make it work for
	characters of mule-unicode-0100-24ff.
	(ccl-encode-windows-1251-font): New CCL program.
	("Bulgarian"): Specify overriding-fontspec.
	("Belarusian"): Likewise.

2003-12-28  Sam Steingold  <sds@gnu.org>

	* net/ange-ftp.el (ange-ftp-file-attributes): Add new optional
	parameter ID-FORMAT to conform with the 2003-11-30 patch.

2003-12-28  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-gdb-command-name): Set default to
	"gdb --annotate=3".
	(gud-gdb-marker-filter): Look out for annotations.
	(gdb-first-pre-prompt): New variable.
	Remove trailing white space.

	* gdb-ui.el (gdb-prompt): Change filter for level 3 annotations,
	if necessary.
	(gdb-ann3): New function.  Initialise M-x gdb as for M-x gdba if
	annotations are detected.
	(gud-gdba-marker-filter): Use global variable gud-marker-acc
	instead of a local one to allow transition from
	gud-gdb-marker-filter.
	Remove trailing white space.

2003-12-27  Kim F. Storm  <storm@cua.dk>

	* ido.el: Handle non-readable directories.
	(ido-decorations): Add 9th element for non-readable directory.
	(ido-directory-nonreadable): New dynamic var.
	(ido-set-current-directory): Set it.
	(ido-read-buffer, ido-file-internal):
	(ido-read-file-name, ido-read-directory-name): Let-bind it.
	(ido-file-name-all-completions1): Return empty list for
	non-readable directory.
	(ido-exhibit): Print [Not readable] if directory is not readable.
	(ido-expand-directory): New defun (based on tiny fix from Karl Chen).
	(ido-read-file-name, ido-file-internal, ido-read-directory-name):
	Use it.

2003-12-27  Lars Hansen  <larsh@math.ku.dk>

	* ls-lisp.el (ls-lisp-insert-directory): Add parameter 'string in
	calls to directory-files-and-attributes and file-attributes.
	(ls-lisp-format): Remove system dependent handling of user and
	group id's.

2003-12-25  Luc Teirlinck  <teirllm@auburn.edu>

	* ffap.el (ffap-read-file-or-url): Revert previous change.

2003-12-25  Robert J. Chassell  <bob@rattlesnake.com>

	* textmodes/texnfo-upd.el (texinfo-multi-file-update): Create a
	new list of included files called `files-with-node-lines', that
	only have node lines.  This way @include commands can include any
	file, such as version and update files without node lines, not
	just files that are chapters.

2003-12-25  Andreas Schwab  <schwab@suse.de>

	* jka-compr.el (jka-compr-insert-file-contents): Avoid error when
	file not found.

2003-12-08  Miles Bader  <miles@gnu.org>

	* dired.el (dired-between-files): Always use dired-move-to-filename,
	which is more robust in non-english locales.

2003-12-25  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* vc.el (vc-dired-purge): Avoid error from `kill-line'.

2003-12-24  Andreas Schwab  <schwab@suse.de>

	* shell.el (shell-file-name-quote-list): Add backslash.

	* comint.el (comint-quote-filename): Correctly handle backslash
	in comint-file-name-quote-list.

2003-12-24  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-default-coding-systems):
	Call ucs-set-table-for-input for all buffers that don't have local
	value of buffer-file-coding-system.

	* international/ucs-tables.el (ucs-set-table-for-input):
	If translation-table-for-encode is a symbol, get its
	translation-table property.

2003-12-23  Luc Teirlinck  <teirllm@auburn.edu>

	* ffap.el (ffap-read-file-or-url): Eliminate reliance of the call
	to `completing-read' on a recently fixed bug.

	* fringe.el (fringe-query-style): Suggest `?' in minibuffer prompt,
	instead of SPACE, to get the list of possible fringe modes.
	SPACE only works if both `partial-completion-mode' and
	`completion-auto-help' are nil.

	* complete.el (PC-is-complete-p): Delete.
	(PC-do-completion): Replace all calls to `PC-is-complete-p' with
	calls to `test-completion'.

2003-12-23  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-speedbar-buttons): Use speed-bar-edit-line
	to edit values when there are no children.

	* gdb-ui.el (gdba, gdb-assembler-mode): Call the mode "Machine" as
	a mode called "Assembler" already exists.
	(gdb-use-colon-colon-notation, gdb-show-changed-values): New options.
	(gud-watch): Use format option.  Remove font properties from string.
	(gdb-var-create-handler, gdb-var-list-children-handler):
	Don't bother about properties as there are none.
	(gdb-var-create-handler, gdb-var-list-children-handler)
	(gdb-var-update-handler): Call gdb-var-evaluate-expression-handler
	with two arguments.
	(gdb-var-evaluate-expression-handler, gdb-post-prompt):
	Let speedbar show value changes with a different font.
	(gdb-edit-value): New defun.
	(gdb-clear-partial-output, gdb-clear-inferior-io)
	(def-gdb-auto-update-handler): Use erase-buffer.
	(gdb-frame-handler): Display watch expressions in
	FUNCTION::VARIABLE format if required.

2003-12-23  John Paul Wallington  <jpw@gnu.org>

	* info.el (Info-unescape-quotes, Info-split-parameter-string)
	(Info-goto-emacs-command-node): Doc fixes.

2003-12-12  Jesper Harder  <harder@ifa.au.dk>

	* cus-edit.el (custom-add-parent-links): Define "many".

2003-12-08  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (widget-child-value-get, widget-child-value-inline)
	(widget-child-validate, widget-type-value-create)
	(widget-type-default-get, widget-type-match): New functions.
	(lazy): New widget.
	(menu-choice, checklist, radio-button-choice, editable-list)
	(group, documentation-string): Remove redundant (per 2003-10-25
	change) calls to `widget-children-value-delete'.
	(widget-choice-value-get, widget-choice-value-inline): Remove.
	(menu-choice): Update widget.

2003-12-03  Kenichi Handa  <handa@m17n.org>

	* language/cyrillic.el: Register "microsoft-cp1251" in
	ctext-non-standard-encodings-alist.
	("Bulgarian"): Add ctext-non-standard-encodings.
	("Belarusian"): Likewise.

	* international/mule-conf.el (compound-text-with-extensions):
	Change the type to 2 (iso-2022 base).

	* international/mule.el (ctext-non-standard-encodings-alist):
	Change the format.
	(ctext-non-standard-encodings): New variable.
	(ctext-post-read-conversion): Fully re-written.
	(ctext-non-standard-designations-alist): Delete it.
	(ctext-non-standard-encodings-table): New function.
	(ctext-pre-write-conversion): Fully re-written.

2003-11-30  Per Abrahamsen  <abraham@dina.kvl.dk>

	* cus-edit.el (custom-add-parent-links): Add documentation links
	for parent, if the item has none of its own.

2003-11-30  Richard M. Stallman  <rms@gnu.org>

	* dired-aux.el (dired-do-query-replace-regexp):
	Report files visited read-only.

2003-11-30  Juri Linkov  <juri@jurta.org>

	* dired-aux.el (dired-compare-directories): New command.
	(dired-file-set-difference, dired-files-attributes): New functions.

2003-11-30  Kai Grossjohann  <kai.grossjohann@gmx.net>
	Version 2.0.38 of Tramp released.

	* net/tramp.el (tramp-chunksize): Extend docstring.  Suggested by
	Charles Curley <charlescurley@charlescurley.com>.
	(tramp-multi-connection-function-alist): Add ssht entry which adds
	"-e none -t -t" to the list of ssh args.  Suggested by Adrian
	Aichner.
	(tramp-get-method-parameter): New function to retrieve a method
	parameter.  This allows for omission of method parameters.
	Callers adjusted.

2003-11-30  Michael Albinus  <Michael.Albinus@alcatel.de>

	* net/tramp.el: Add new optional parameter ID-FORMAT to
	`file-attributes'.  Calls of `file-attributes' won't use this
	parameter for backward compatibility reasons.
	(tramp-perl-file-attributes): Add a new parameter to Perl script
	in order to handle uid/gid as strings, if desired.
	(tramp-handle-file-truename, tramp-handle-file-symlink-p):
	Apply `file-attributes' instead of `tramp-handle-file-attributes' in
	order to make the function more general.
	(tramp-handle-file-attributes): Replace proprietary optional
	parameter NONNUMERIC by the recently (Emacs 21.4) introduced ID-FORMAT.
	(tramp-handle-file-attributes-with-perl): Handle parameter
	NONNUMERIC if set.  This wasn't done in the past.
	(tramp-post-connection): Apply second parameter "$2" if
	`tramp-remote-perl' is called.

	* net/tramp-smb.el (tramp-smb-handle-delete-file):
	Correct cut'n'waste error (`filename' instead of `directory').
	(tramp-smb-handle-directory-files-and-attributes)
	(tramp-smb-handle-file-attributes): Add recently (Emacs 21.4)
	introduced parameter ID-FORMAT.
	(tramp-smb-handle-make-directory-internal): Correct cut'n'waste
	error (`directory' instead of `ldir').

	* net/tramp-vc.el (tramp-handle-vc-user-login-name): Check if
	`file-attributes' has a second parameter.  If yes, apply it with
	value "'integer".  Otherwise, don't use that parameter (default is
	integer format).

2003-11-30  Luc Teirlinck  <teirllm@auburn.edu>

	* help.el (help-map): Bind `display-local-help' to `C-h .'.
	(help-for-help): Add `C-h .' to the listed Help options.
	Remove trailing whitespace.

	* help-at-pt.el: New file.

2003-11-30  Jonathan Yavner  <jyavner@member.fsf.org>

	* subr.el (noreturn, 1value): New macros for test coverage.
	See `testcover.el'.

	* emacs-lisp/edebug.el: Add def-edebug-spec for `noreturn' and `1value'.

	* emacs-lisp/testcover.el (testcover-reinstrument): Special case
	for macro `1value'.
	(testcover-1value): New function.  Checks that a 1value form
	actually returns only one value.  Requested by RMS.

2003-11-29  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gud-watch, gdb-var-create-handler)
	(gdb-var-list-children, gdb-var-list-children-handler)
	(gdb-var-update-handler, gdb-var-delete): Add server prefix to the
	gdb commands that use mi to keep them out of the command history.

2003-11-29  Jan Dj,Ad(Brv  <jan.h.d@swipnet.se>

	* cus-start.el (all): Add use-file-dialog.

2003-11-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (latex-mode): `tex-trailer' is not a regexp.

2003-11-27  Kim F. Storm  <storm@cua.dk>

	* subr.el (posn-object-x-y): New defun.

2003-11-26  Stefan Monnier  <monnier@iro.umontreal.ca>

	* progmodes/make-mode.el (makefile-font-lock-syntactic-keywords):
	Don't use `space' for \\\n.
	Be more selective as to which # are comment-starters.

2003-11-26  Luc Teirlinck  <teirllm@auburn.edu>

	* subr.el (number-sequence): Improve handling of floating point
	arguments (suggested by Kim Storm).  Allow negative arguments.

2003-11-26  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (standard-display-european-internal):
	Cancel the standard-display-table setting for ` and '.

2003-11-26  Kim F. Storm  <storm@cua.dk>

	* ido.el (ido-use-filename-at-point, ido-use-url-at-point):
	New defcustoms to add ffap-like functionality to ido.
	(ido-saved-vc-hb): Rename from ido-saved-vc-mt.  Uses changed.
	(ido-no-final-slash): New defun.
	(ido-make-prompt, ido-file-internal, ido-toggle-vc)
	(ido-read-file-name): ): Toggle VC checking via
	vc-handled-backends instead of vc-master-templates.
	(ido-file-internal): Handle ido-use-url-at-point and
	ido-use-filename-at-point via code borrowed from ffap-guesser.
	Handle new ido-exit code ffap.
	(ido-sort-list): Ignore final slash when sorting file names.

2003-11-25  Kim F. Storm  <storm@cua.dk>

	* emulation/cua-base.el (cua--standard-movement-commands):
	Add forward-sentence and backward-sentence.

2003-11-25  Stephen Eglen  <stephen@gnu.org>

	* iswitchb.el (iswitchb-read-buffer,iswitchb-exit-minibuffer):
	iswitchb-exit is set to 'usefirst when user selects buffer at head
	of list using RET.  (Selecting buffers at the head of the list was
	broken if the substring was also a complete buffername.)

2003-11-23  Kim F. Storm  <storm@cua.dk>

	* progmodes/compile.el (grep-command, grep-use-null-device)
	(grep-find-command, grep-tree-command, grep-tree-files-aliases)
	(grep-tree-ignore-case, grep-tree-ignore-CVS-directories)
	(grep-regexp-alist, grep-program, find-program)
	(grep-find-use-xargs, grep-history, grep-find-history)
	(grep-process-setup, grep-compute-defaults)
	(grep-default-command, grep, grep-tag-default, grep-find)
	(grep-expand-command-macros, grep-tree-last-regexp)
	(grep-tree-last-files, grep-tree): Move grep variables, functions
	and commands to new file grep.el.
	(compilation-mode-map): Remove grep commands from Compile sub-menu.
	(compilation-process-setup-function): Doc fix.
	(compilation-highlight-regexp, compilation-highlight-overlay): New
	defvars used for highlighting current compile error in source buffer.
	(compile-internal): New optional args HIGHLIGHT-REGEXP and
	LOCAL-MAP which overrides compilation-highlight-regexp and
	compilation-mode-map for this compilation.
	Delay calling compilation-set-window-height until after running
	compilation-process-setup-function so it can buffer-local override
	compilation-window-height.
	Check buffer-local value of compilation-scroll-output.
	(compilation-set-window-height): Use buffer-local value of
	compilation-window-height.
	(compilation-revert-buffer): Don't pass (undefined)
	preserve-modes arg to revert-buffer.
	(next-error-no-select, previous-error-no-select): New commands.
	(compilation-goto-locus): Temporarily highlight current match in
	source buffer using compilation-highlight-regexp.

	* progmodes/grep.el: New file with grep code from compile.el.
	(grep): New defcustom group.
	(grep-window-height): New defcustom, like compilation-window-height.
	(grep-auto-highlight): New defcustom, like compile-auto-highlight.
	(grep-scroll-output): New defcustom, like compilation-scroll-output.
	(grep-command, grep-use-null-device, grep-find-command)
	(grep-tree-files-aliases, grep-tree-ignore-case)
	(grep-tree-ignore-CVS-directories): Move to grep custom group.
	(grep-setup-hook): New hook variable.
	(grep-mode-map): New keymap for grep commands.  Add Grep menu.
	(grep-last-buffer): New defvar, override compilation-last-buffer.
	(grep): Add optional arg HIGHLIGHT-REGEXP.  Doc fix.
	Call compile-internal with args highlight-regexp and grep-mode-map.

2003-11-23  Kim F. Storm  <storm@cua.dk>

	* subr.el (event-start, event-end): Doc fix.
	(posn-window, posn-x-y, posn-timestamp): Simplify doc.
	(posn-area, posn-actual-col-row, posn-object): New defuns.
	(posn-col-row): Simplify doc.  Rewrite to use cond.
	(posn-point): Also return buffer position for events outside text
	area (that info is now present in the event position).

	* mouse.el: Bind mouse-1 on left-fringe and right-fringe to
	mouse-set-point so that hscroll still works now that clicks on
	fringes generate specific mouse events.
	(mouse-set-point): Note that it now works in fringes and margins
	too due to new semantics of posn-point in fringes and margins.

	* gdb-ui.el (gdb-mouse-toggle-breakpoint): New defun.
	(gdba): Bind it to [left-margin mouse-1] and [left-fringe mouse-1].

2003-11-20  Kim F. Storm  <storm@cua.dk>

	* gdb-ui.el (gud-gdba-command-name): Find gdb command via PATH.
	(breakpoint-xpm-data, breakpoint-enabled-pbm-data): Make smoother.
	(breakpoint-enabled-icon, breakpoint-disabled-icon): Set :ascent
	to 100 for icons to avoid increasing line height when shown.

2003-11-17  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* newcomment.el (comment-normalize-vars): Initialize properly if
	comment-start was nil.

2003-11-19  Andreas Schwab  <schwab@suse.de>

	* simple.el (set-variable): Fix indentation.

2003-11-17  Kenichi Handa  <handa@m17n.org>

	* international/latin1-disp.el (latin1-display-ucs-per-lynx):
	Fix docstring.

2003-11-17  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* international/latin1-disp.el (latin1-display): Fix docstring.

2003-11-16  John Wiegley  <johnw@newartisans.com>

	* eshell/em-ls.el (eshell-ls-file): There are times with
	size-width is nil and uncomputed (when directories are created in
	dired, for example); in this case, 4 is reasonable default value,
	although it may caused skewed new entries (which could be avoided
	by returning the original value of 8 in all cases, but 99% of the
	time this is a waste of whitespace).

2003-11-16  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* cc-engine.el (c-guess-continued-construct)
	(c-guess-basic-syntax): Check a little more carefully if it's a
	function declaration when an unknown construct followed by a block
	is found inside a statement context.  This avoids macros followed
	by blocks to be taken as function declarations.

	(c-guess-continued-construct): Change the analysis of a statement
	continuation with a brace open to `substatement-block', for
	consistency with recognized statements.

	(c-add-stmt-syntax): Don't continue to the surrounding sexp if the
	start is in a position so that `c-beginning-of-statement-1' jumped
	to the beginning of the same statement.

	* cc-fonts.el, cc-engine.el (c-forward-<>-arglist-recur):
	Don't accept binary operators in the arglist if we're in a function
	call context, i.e. if `c-restricted-<>-arglists' is set.  That avoids
	template recognition in cases like "if (a < b || c > d)".

	(c-restricted-<>-arglists): New more appropriate name for
	`c-disallow-comma-in-<>-arglists'.

	Accessing functions updated for the variable name change.

	* cc-engine.el (c-syntactic-re-search-forward): Fix bug where the
	match data could get clobbered if NOT-INSIDE-TOKEN is used.

	* cc-engine.el (c-beginning-of-statement-1): Don't allow parens in
	labels.

	(c-backward-to-decl-anchor): Use `c-beginning-of-statement-1'
	instead of duplicating parts of it.  This fixes bogus label
	recognition.

	* cc-align.el (c-gnu-impose-minimum): Revert to the old method
	of checking the context in which to apply the minimum indentation,
	so that it isn't enforced in e.g. namespace blocks.

	* cc-vars.el (c-inside-block-syms): New constant used by
	`c-gnu-impose-minimum'.  It's defined close to `c-offsets-alist'
	to somewhat reduce the risk of becoming stale.

	* cc-cmds.el, cc-engine.el (c-shift-line-indentation): Move from
	cc-cmds to cc-engine to allow use from cc-align.

	* cc-engine.el (c-beginning-of-inheritance-list): Cope with fully
	qualified identifiers containing "::".

	* cc-defs.el (c-make-keywords-re): Add kludge for bug in
	`regexp-opt' in Emacs 20 and XEmacs when strings contain newlines.

	* cc-vars.el (c-emacs-features): Use a space in front of the name
	of the temporary buffer.  That also avoids dumping problems in
	XEmacs due to undo info being left around after the buffer is killed.

	* cc-engine.el (c-in-knr-argdecl): Look closer at the function
	arglist to see if it's a K&R style declaration.

	(c-guess-basic-syntax): CASE 5B.2: Check with `c-in-knr-argdecl'
	before returning `knr-argdecl-intro'.

2003-11-16  John Wiegley  <johnw@newartisans.com>

	* eshell/em-ls.el (eshell-ls-file): Instead of making the size
	field in a long-listing always 8 characters, use `size-width',
	which has already been computed.

2003-11-15  Thien-Thi Nguyen  <ttn@gnu.org>

	* subr.el (minor-mode-list): Add `hs-minor-mode'.

2003-11-14  Thien-Thi Nguyen  <ttn@gnu.org>

	* diff-mode.el (diff-hunk-prev, diff-hunk-next):
	Support operation while narrowed, with `diff-restrict-view'.

2003-11-14  Thien-Thi Nguyen  <ttn@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	Take additional optional arg NARROWFUN.  For the generated functions:
	Add local var `was-narrowed-p'.  Also, if NARROWFUN is specified,
	include frags that arrange to check for and save narrowing state before
	the move and then conditionally call NARROWFUN after the move.

2003-11-14  John Wiegley  <johnw@newartisans.com>

	* eshell/esh-var.el (eshell-parse-variable-ref): Add a backslash
	that was optional, but obviously missing based on surrounding code.

	* eshell/esh-cmd.el (eshell-lisp-command): Do not late-convert
	string arguments to numbers unless the whole argument was seen as
	a number.

2003-11-14  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (ctext-non-standard-encodings-alist):
	Fix coding systems.

2003-11-10  Kenichi Handa  <handa@m17n.org>

	* language/kannada.el ("Kannada"): Add sample-text.

	* language/knd-util.el (kannada-compose-region)
	(kannada-compose-string, kannada-post-read-conversion):
	Add autoload cookie.

	* international/quail.el (quail-completion): Change the message
	"corresponding translations" to "corresponding characters".

2003-11-09  Markus Rost  <rost@mathematik.uni-bielefeld.de>

	* descr-text.el (describe-char): Fix typo.

2003-11-08  Kailash C. Chowksey  <klchxbec@m-net.arbornet.org>

	These changes are to support Kannada language/script.

	* Makefile.in (DONTCOMPILE): Add kannada.el.

	* makefile.w32-in (DONTCOMPILE): Add kannada.el.

	* loadup.el: Preload kannada.el.

	* language/ind-util.el (ucs-kannada-to-is13194-alist)
	(is13194-to-ucs-kannada-hashtbl, is13194-to-ucs-kannada-regexp):
	New variables.

	* language/kannada.el: New file.

	* language/knd-util.el: New file.

2003-11-07  Andreas Schwab  <schwab@suse.de>

	* progmodes/autoconf.el (autoconf-font-lock-keywords):
	Also highlight AH_*.

	* xml.el (xml-parse-dtd): Fix misplaced paren.

2003-11-07  Kenichi Handa  <handa@m17n.org>

	* language/european.el (windows-1252): Fix table (0x8F and 0x9E).

2003-11-05  Juri Linkov  <juri@jurta.org>

	* desktop.el (desktop-locals-to-save): Add buffer-file-coding-system.
	(desktop-buffer-file): Use saved buffer-file-coding-system
	for file reading.  Set auto-insert to nil to prevent automatic
	insertion into restored empty files.

2003-11-04  Luc Teirlinck  <teirllm@auburn.edu>

	* files.el (risky-local-variable-p): Make second argument optional.

2003-11-03  Stefan Monnier  <monnier@iro.umontreal.ca>

	* subr.el (add-hook): Fix last change.

2003-11-03  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	If base64-decode-region signals an error, catch it and silently
	ignore it.

2003-11-01  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-parse-region): Allow comments to appear after the
	topmost element has closed.
	(xml-ns-parse-ns-attrs, xml-ns-expand-el)
	(xml-ns-expand-attr): New functions to do namespace handling.
	(xml-intern-attrlist): Back-compatible handling of attribute names.
	(xml-parse-tag): Move namespace handling to separate functions.
	Now produces elements in the form ((:ns . "element") (attr-list)
	children) instead of ('ns:element (attr-list) children).
	(xml-parse-attlist): Fix attribute parsing.
	(xml-parse-dtd): Change parsing so that it produces strings
	instead of interned symbols.

2003-11-01  era@iki.fi  <era@iki.fi>  (tiny change)

	* dired.el (dired-ls-sorting-switches): Doc fix.

2003-11-01  Oliver Scholz  <epameinondas@gmx.de>

	* emacs-lisp/rx.el (rx-or): Fix the case of
	"(rx (and ?a (or ?b ?c) ?d))".

2003-11-01  Christoph Wedler  <wedler@users.sourceforge.net>  (tiny change)

	* textmodes/texinfmt.el (texinfo-pre-format-hook): New variable.
	(texinfo-format-region): Use it.
	(texinfo-format-buffer-1): Ditto.

2003-11-01  Alan Mackenzie  <acm@muc.de>

	Changes to allow scrolling whilst in isearch mode:
	* isearch.el (isearch-unread-key-sequence): New function,
	extracted from isearch-other-meta-char.
	(top level): (put 'foo 'isearch-scroll) on all Emacs's
	"scrollable" standard functions.
	(isearch-allow-scroll): New customizable variable.
	(isearch-string-out-of-window, isearch-back-into-window)
	(isearch-reread-key-sequence-naturally)
	(isearch-lookup-scroll-key): New functions.
	(isearch-other-meta-char): Doc string and functionality enhanced.
	Now accepts a prefix argument.
	(isearch-lazy-highlight-window-end): New variable.
	(isearch-lazy-highlight-new-loop): Pay attention to the window's
	end (thru isearch-lazy-highlight-window-end), not only its start.

	* simple.el (overriding-map-is-bound, saved-overriding-map): New vars.
	(ensure-overriding-map-is-bound, restore-overriding-map): New funs.
	(universal-argument, universal-argument-more, negative-argument)
	(digit-argument, universal-argument-other-key): Minor changes.

2003-11-01  Alexander Pohoyda  <alexander.pohoyda@gmx.net>  (tiny change)

	* mail/rmailsum.el (rmail-summary-goto-msg): Don't call itself
	recursively if the last message is deleted, thus avoiding an
	infinite loop.

2003-10-30  Stefan Monnier  <monnier@iro.umontreal.ca>

	* textmodes/tex-mode.el (tex-compile-commands): Add `yap' and `ps2pdf'.
	(tex-main-file): Don't add .tex if the extension is already present.
	(tex-uptodate-p): Don't recurse indefinitely with symlinks.

2003-10-29  Lute Kamstra  <lute@gnu.org>

	* progmodes/octave-inf.el (inferior-octave-prompt):
	Recognize version number in prompt.

2003-10-28  Dave Love  <fx@gnu.org>

	* international/characters.el: Fix some Unicode ranges.

2003-10-28  Kenichi Handa  <handa@m17n.org>

	* disp-table.el (standard-display-8bit)
	(standard-display-default, standard-display-ascii)
	(standard-display-g1, standard-display-graphic)
	(standard-display-underline): Assure that standard-display-table
	is a display table.

2003-10-27  Stefan Monnier  <monnier@iro.umontreal.ca>

	* simple.el (reindent-then-newline-and-indent): Delete space *after*
	reindenting the first line.

2003-10-25  Per Abrahamsen  <abraham@dina.kvl.dk>

	* wid-edit.el (widget-default-delete): Always delete child widgets.

2003-10-24  Stefan Monnier  <monnier@iro.umontreal.ca>

	* newcomment.el (comment-indent): Don't call indent-according-to-mode
	if the line has code.
	Don't try to line up with something that's too far left.

	* progmodes/octave-mod.el (octave-comment-start): Simplify.
	(octave-mode-syntax-table): Add % as a comment starter.
	(octave-point): Remove.
	(octave-in-comment-p, octave-in-string-p)
	(octave-not-in-string-or-comment-p, calculate-octave-indent)
	(octave-blink-matching-block-open, octave-auto-fill):
	Use line-(beginning|end)-position instead.

2003-10-23  Francesco Potort,Al(B  <pot@gnu.org>

	* emacs-lisp/authors.el (authors-aliases): Add correct realname
	for Francesco Potort,Al(B.

2003-10-23  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (locale-charset-to-coding-system):
	Don't rely on nil being a coding system.

	* mail/mail-extr.el (mail-extr-ignore-single-names): Add :version.
	(mail-extr-address-syntax-table): Remove non-ASCII unibyte chars.
	(mail-extr-voodoo): Use char classes in regexps (for non-ASCII).

2003-10-21  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-current-language): New variable.
	(gdb-update-flag): Remove variable.
	(gud-watch, gdb-frame-handler): Adapt for other languages (Fortran).
	(gdb-take-last-elt): Remove function.
	(gdb-dequeue-input): Avoid recursion by not using gdb-take-last-elt.
	(gdb-post-prompt): Check for variable object changes here.

	* progmodes/gud.el (gud-speedbar-buttons): Check for variable
	object changes in gdb-ui.el.

2003-10-21  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/edebug.el (edebug-display-freq-count): Doc fix.

	* ls-lisp.el (ls-lisp-insert-directory): Arg is now wildcard-regexp.
	Don't check for foo*/ wildcard form here.
	(insert-directory): Recognize foo*/ as a wildcard.
	Separate wildcard-regexp variable from the arg, wildcard.

	* subr.el (add-hook): Correctly detect when make-local-hook was used.
	(remove-hook): Correctly handle strange cases about local hooks.

2003-10-21  David Ponce  <david@dponce.com>

	* ruler-mode.el (ruler-mode-left-fringe-cols): Add new optional
	argument REAL, to return a real number instead of a rounded
	integer value.  Define as inline function.
	(ruler-mode-right-fringe-cols): Likewise.
	(ruler-mode-scroll-bar-cols): New function.
	(ruler-mode-left-scroll-bar-cols): Use it.  Define as macro.
	(ruler-mode-right-scroll-bar-cols): Likewise.
	(ruler-mode-space): New function.
	(ruler-mode-ruler): Use it.  Handle variations of fringe style,
	scroll bar mode and margins in a more robust way.

2003-10-21  Christoph Wedler  <Christoph.Wedler@sap.com>

	* progmodes/antlr-mode.el: Make major mode work with cc-mode-5.30+.
	(antlr-c-init-language-vars): New function.
	(antlr-mode): Use it with cc-mode before v5.29.
	(antlr-c-common-init): Don't set some local vars here.
	(antlr-mode): Set them here.
	(antlr-c-forward-sws): New function alias.
	(antlr-mode): Redefine with cc-mode before v5.30.
	(antlr-skip-sexps): Use it.
	(antlr-skip-exception-part): Ditto.
	(antlr-skip-file-prelude): Ditto.
	(antlr-outside-rule-p): Ditto.
	(antlr-end-of-body): Ditto.
	(antlr-option-kind): Ditto.
	(antlr-insert-option-area): Ditto.
	(antlr-file-dependencies): Ditto.

2003-10-21  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-move-outside-of-entry):
	Move backward only if point was not inside an entry.

2003-10-21  Richard M. Stallman  <rms@gnu.org>

	* progmodes/compile.el (compile-auto-highlight): Undo July 7 change.

2003-10-21  Juri Linkov  <juri@jurta.org>

	* compare-w.el: Automatically skip non-matching text to resync.
	(compare-windows-whitespace): Doc fix.
	(compare-windows-sync, compare-windows-sync-string-size)
	(compare-windows-recenter, compare-ignore-whitespace)
	(compare-windows-highlight, compare-windows-face): New variables.
	(compare-windows): Use compare-windows-sync.
	(compare-windows-highlight, compare-windows-dehighlight)
	(compare-windows-sync-regexp)
	(compare-windows-sync-default-function): New functions.

2003-10-21  Juri Linkov  <juri@jurta.org>

	* diff.el (diff-parse-differences): Don't visit the files now;
	instead, just record the error locus.

2003-10-21  Dave Love  <fx@gnu.org>

	* progmodes/cfengine.el: New file.

2003-10-20  Stefan Monnier  <monnier@iro.umontreal.ca>

	* complete.el (PC-do-completion): Do not forget to use `pred' as the
	default-directory when completing file names.

2003-10-20  Luc Teirlinck  <teirllm@auburn.edu>

	* help-mode.el (help-make-xrefs): Make sure that if a symbol is
	followed by the word `face', it gets treated as a face, even if
	it is also defined as a variable or a function.

2003-10-20  Dave Love  <fx@gnu.org>

	* emacs-lisp/easy-mmode.el (easy-mmode-define-navigation):
	Avoid incf in macro expansion.

2003-10-20  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/elint.el (elint-check-defcustom-form): Don't use
	`evenp'	so we don't implicitly require cl library at runtime.

2003-10-18  Luc Teirlinck  <teirllm@auburn.edu>

	* help-mode.el (help-xref-symbol-regexp): Treat newlines as whitespace.
	(help-make-xrefs): Only make cross-references for faces if
	preceded or followed by the word `face'.  Do not make a
	cross-reference for variables without variable documentation,
	unless preceded by the word `variable' or `option'.  Update doc
	string accordingly.

2003-10-18  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el: Rewrite one-armed `if'
	constructs using either `when' or `unless'.
	(hs-grok-mode-type): Elide superfluous `progn'; nfc.

2003-10-16  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (breakpoint-xpm-data, breakpoint-enabled-pbm-data)
	(breakpoint-disabled-pbm-data): Make breakpoint icons 10x10
	instead of 12x12.

2003-10-16  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format): Display a
	message while converting to Babyl.

2003-10-16  Vadim Nasardinov  <vadimn@redhat.com>  (tiny change)

	* allout.el (allout-mode): Doc fix.

2003-10-16  Lute Kamstra  <lute@gnu.org>

	* subr.el (force-mode-line-update): Fix docstring.

2003-10-14  Dave Love  <fx@gnu.org>

	* international/mule-cmds.el (find-multibyte-characters): Doc fix.
	(default-input-method): Add :link, improve :type.
	(locale-charset-language-names): Fix utf-8 pattern.
	(locale-charset-match-p, locale-charset-alist)
	(locale-charset-to-coding-system): New.
	(set-locale-environment): Deal with codeset part of locale specs.

2003-10-14  Lute Kamstra  <lute@gnu.org>

	* fringe.el (fringe-mode): Use active voice in docstring.
	(set-fringe-style): Ditto.

2003-10-13  Lute Kamstra  <lute@gnu.org>

	* fringe.el (fringe-mode): Fix docstring.
	(set-fringe-style): Ditto.

2003-10-12  Michael Kifer  <kifer@cs.stonybrook.edu>

	* ediff-mult.el (ediff-filegroup-action):
	Use ediff-default-filtering-regexp.

	* ediff-util.el (ediff-recenter): Don't call
	ediff-restore-highlighting twice.
	(ediff-select-difference): Set current difference.
	(ediff-unselect-and-select-difference): Add comment.

	* ediff.el (ediff-directories,ediff-directory-revisions)
	(ediff-directories3,ediff-merge-directories)
	(ediff-merge-directories-with-ancestor)
	(ediff-merge-directory-revisions)
	(ediff-merge-directory-revisions-with-ancestor):
	Use ediff-default-filtering-regexp.

2003-10-12  Andreas Schwab  <schwab@suse.de>

	* international/mule-cmds.el (locale-charset-language-names):
	Simplify regex by removing unused grouping.

2003-10-10  Dave Love  <fx@gnu.org>

	* bindings.el: Don't bind stop.

2003-10-08  Miles Bader  <miles@gnu.org>

	* gdb-ui.el (gdb-info-frames-custom): Use proper :inverse-video
	face instead of attempting to emulate it.

2003-10-07  Kenichi Handa  <handa@m17n.org>

	* international/mule-diag.el (list-coding-systems-1): List coding
	systems that are loaded automatically.

	* international/code-pages.el (iso-8859-11): Add autoload cookie.

	* international/mule.el (autoload-coding-system): New function.

2003-10-07  Andreas Schwab  <schwab@suse.de>

	* log-edit.el (log-edit-changelog-entries): Prefer local value of
	change-log-default-name in the buffer visiting the file.

2003-10-06  Dave Love  <fx@gnu.org>

	* files.el (find-file-hook): Customize.
	(auto-mode-alist): Add .stk, .ss, .sch, .orig.

	* bindings.el (completion-ignored-extensions): Remove .log.
	(global-map): Add again, open, stop keys.

2003-10-05  Richard M. Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-feature): Handle sh-modify like sh-append.
	(sh-for, sh-indexed-loop, sh-function, sh-while, sh-while-getopts):
	Use sh-modify directly.
	(sh-select): Use sh-append, not eval.

	* mail/emacsbug.el (report-emacs-bug): Fix previous change.

	* info.el (Info-following-node-name): New function.

	* loadhist.el (unload-feature-special-hooks):
	Rename from loadhist-hook-functions.
	(loadhist-hook-functions): Now an alias.

2003-10-04  Eli Zaretskii  <eliz@gnu.org>

	* ldefs-boot.el: Renamed from loaddefs-boot.el, to prevent
	file-name clashes on 8+3 filesystems.

	* Makefile.in (DONTCOMPILE, bootstrap-clean):
	Rename loaddefs-boot.el to ldefs-boot.el

	* makefile.w32-in (DONTCOMPILE, bootstrap-clean-CMD)
	(bootstrap-clean-SH): Rename loaddefs-boot.el to ldefs-boot.el

2003-10-03  Lute Kamstra  <lute@gnu.org>

	* info.el (Info-mode): Revert previous change.
	(Info-escape-percent): New function.
	(Info-fontify-node): Use it.

2003-10-02  Andreas Schwab  <schwab@suse.de>

	* loaddefs-boot.el: Regenerated.

2003-10-01  Rajesh Vaidheeswarran  <rv@gnu.org>

	* ffap.el: Remove defadvice related code from CVS since `complete'
	provides a `PC-completion-as-file-name-predicate' variable that
	ffap can override.

2003-10-02  Kenichi Handa  <handa@m17n.org>

	* international/utf-8.el (ccl-decode-mule-utf-8):
	Lookup utf-subst-table-for-decode even for U+E000..U+FFFF.

	* international/subst-jis.el: Include U+FF00..U+FFEF in decode table.
	* international/subst-big5.el: Likewise.
	* international/subst-gb2312.el: Likewise.
	* international/subst-ksc.el: Likewise.

2003-10-01  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (increment-calendar-month)
	(calendar-leap-year-p, calendar-absolute-from-gregorian)
	(generate-calendar, calendar-read-date, calendar-interval)
	(calendar-day-of-week): Handle years BC.
	(generate-calendar-month, calendar-gregorian-from-absolute): Doc fix.

2003-10-01  Dave Love  <fx@gnu.org>

	* language/cyrillic.el (cp1251): Alias for windows-1251.

	* vc-cvs.el (vc-cvs-parse-entry): Revert last change to allow
	bootstrap.

2003-10-01  Lute Kamstra  <lute@gnu.org>

	* files.el: Fix typo.
	* imenu.el (imenu--generic-function): Docstring fix.

2003-09-30  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-mode): Handle dired-directory as a list.

2003-09-30  Nick Roberts  <nick@nick.uklinux.net>

	* toolbar/gud-watch.xpm, toolbar/gud-watch.pbm: Add.

	* toolbar/gud-display.xpm, toolbar/gud-display.pbm: Remove.

	* progmodes/gud.el (gud-menu-map, gud-tool-bar-map):
	Replace gud-display with gud-watch.
	(gud-speedbar-buttons): Add stuff for watching expressions
	in the speedbar when using M-x gdba.  Use dolist on old part
	of this function.

	* gdb-ui.el (gdb-var-list, gdb-var-changed, gdb-update-flag)
	(gdb-update-flag): New variables.
	(gdb-var-update, gdb-var-update-handler,gdb-var-delete)
	(gdb-speedbar-expand-node, gdb-var-evaluate-expression-handler)
	(gud-watch, gdb-var-create-handler) : New functions.
	(gdb-var-list-children, gdb-var-list-children-handler)
	(gdb-var-create-regexp, gdb-var-update-regexp)
	(gdb-var-list-children-regexp): New constants.
	(gud-gdba-command-name): Don't specify -noasync so that GDB/MI works.
	(gdb-annotation-rules): Reduce annotation set (level 3).
	(gdb-pre-prompt, gdb-prompt): Call handler in gdb-prompt.
	(gdb-post-prompt): Don't update GDB buffers every time speedbar
	updates.
	(gdb-window-height, gdb-window-width, gdb-display-in-progress)
	(gdb-expression-buffer-name, gdb-display-number, gdb-point)
	(gdb-dive-display-number, gdb-nesting-level, gdb-expression)
	(gdb-annotation-arg, gdb-dive-map, gdb-values, gdb-array-start)
	(gdb-array-stop, gdb-array-slice-map, gdb-display-string)
	(gdb-array-size, gdb-display-mode-map, gdb-expressions-mode-map):
	(gdb-expressions-mode-menu, gdb-dive): Remove variables.
	(gud-display, gud-display1)
	(gdb-display-begin,gdb-display-number-end, gdb-delete-line)
	(gdb-display-end, gdb-display-go-back, gdb-array-section-end)
	(gdb-field-begin, gdb-field-end, gdb-elt,gdb-field-format-begin)
	(gdb-field-format-end, gdb-dive, gdb-dive-new-frame)
	(gdb-insert-field, gdb-array-format, gdb-mouse-array-slice)
	(gdb-array-slice, gdb-array-format1, gdb-info-display-custom)
	(gdb-delete-frames, gdb-display-mode, gdb-display-buffer-name)
	(gdb-display-display-buffer, gdb-toggle-display)
	(gdb-delete-display, gdb-expressions-popup-menu)
	(gdb-expressions-mode, gdb-array-visualise): Remove functions.
	(gdb-setup-windows, gdb-reset, gdb-source-info): Remove references
	to display buffer.

2003-09-30  Richard M. Stallman  <rms@gnu.org>

	* progmodes/ada-mode.el (ada-mode): Don't use advice.
	Instead, set which-func-functions.

	* progmodes/which-func.el (which-func-modes): Add ada-mode.
	(which-func-functions): New variable.
	(which-function): Use that.

	* info.el (Info-mode): Double each `%' in header line.

	* emacs-lisp/lisp-mnt.el (lm-with-file):
	When FILE is nil, run BODY in current buffer.

	* mail/emacsbug.el (report-emacs-bug): Mention major and minor modes.

	* help.el (describe-mode): Start with a brief list of minor modes.
	Find them thru minor-mode-list so as to find them all.
	Show them in alphabetical order.

	* mail/sendmail.el (mail-aliases): Doc fix.

	* progmodes/sh-script.el (sh-mode-syntax-table): Add defvar.

2003-09-30  Alexander Pohoyda  <alexander.pohoyda@gmx.net>  (tiny change)

	* mail/rmailsum.el (rmail-make-summary-line-1):
	Change comma after last label to a space.
	(rmail-summary-font-lock-keywords): Adapt to that change.

2003-09-30  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/scheme.el (scheme-mode-variables): When setting
	`font-lock-defaults', also specify that "#" should
	be interpreted with `word' syntax.
	(scheme-font-lock-keywords-2): Also interpret "#:foo" as keyword.

2003-09-30  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el: A lot of comments updated.
	(desktop-save-mode): Minor mode introduced.
	(desktop-enable, desktop-clear-preserve-buffers): Make vars obsolete.
	(desktop-load-default): Function made obsolete.
	(desktop-locals-to-save): Variable made customizable.
	(desktop-read): Optional parameter `dirname' added.
	(desktop-change-dir, desktop-revert): Parameter `dirname' in
	`desktop-read' used.
	(desktop-save-in-load-dir): Rename to `desktop-save-in-desktop-dir'.

2003-09-29  Rajesh Vaidheeswarran  <rv@gnu.org>

	* whitespace.el (whitespace-clean-msg): Add user customizable message
	for displaying ``clean'' output.
	(whitespace-buffer): Use `whitespace-clean-msg'.
	(whitespace-global-mode): Fix typo.

2003-09-29  Thien-Thi Nguyen  <ttn@gnu.org>

	* pcvs.el (cvs-mode-unmark-up): Move to goal column when done.

2003-09-29  Lute Kamstra  <lute@gnu.org>

	* bindings.el (mode-line-modes): Remove superfluous :propertize
	construct in initialization.
	(mode-line-position): Change cons cell into proper list in
	initialization.

2003-09-29  SAITO Takuya  <tabmore@rivo.mediatti.net>  (tiny change)

	* international/mule.el (decode-coding-inserted-region): Use car
	of the return value of find-operation-coding-system.

2003-09-29  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char): Fix previous change.

2003-09-28  Kenichi Handa  <handa@m17n.org>

	* descr-text.el (describe-char-display): New function.
	(describe-char): Pay attention to display table on describing how
	a character is displayed.

	* international/mule-cmds.el (encoded-string-description):
	Prepend "0x" to each encoded byte.

2003-09-28  Andreas Schwab  <schwab@suse.de>

	* find-file.el (ff-special-constructs): Add autoload cookie.

2003-09-28  Kevin Ryde  <user42@zip.com.au>

	* info.el (Info-find-index-name): Remove any "<n>" suffixes which
	makeinfo appends to duplicate index entries.

2003-09-28  Eli Zaretskii  <eliz@gnu.org>

	* dired-x.el (dired-clean-tex): Doc fix.

	* language/chinese.el ("Chinese-GB", "Chinese-BIG5"): Set up for
	using a Chinese tutorial.

2003-09-28  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* mail/smtpmail.el (smtpmail-via-smtp): Don't insert a space
	between "MAIL FROM:" and "RCPT TO:" and the following address.

2003-09-28  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* textmodes/text-mode.el (paragraph-indent-minor-mode): Doc fix.

2003-09-28  David Ponce  <david@dponce.com>

	* recentf.el (recentf-initialize-file-name-history): New defcustom.
	(recentf-load-list): When `recentf-initialize-file-name-history'
	is non-nil, initialize an empty `file-name-history' with the
	recent list.

2003-09-28  Evgeni Dobrev  <evgeni_dobrev@developer.bg>  (tiny change)

	* man.el (Man-default-man-entry): Remove the leading `*' from the
	word at point.

2003-09-26  Lute Kamstra  <lute@gnu.org>

	* bindings.el (mode-line-position): Mention size indication in
	docstring.

2003-09-26  Andre Spiegel  <spiegel@gnu.org>

	* calendar/parse-time.el (parse-time-string): Add autoload cookie.

	* vc-cvs.el (vc-cvs-parse-entry): Don't require parse-time,
	because it's autoloaded now.

2003-09-25  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* progmodes/sh-script.el (sh-builtins): Add bash `shopt' builtin.
	(sh-font-lock-keywords, sh-feature): Fix previous change of
	sh-feature to avoid infloop with sh-font-lock-keywords.

2003-09-25  Kim F. Storm  <storm@cua.dk>

	* frame.el (frame-current-scroll-bars): New defun.

	* window.el (window-current-scroll-bars): New defun.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-parse-state): Fix bug that could
	cause errors when the state cache contains info on parts that have
	been narrowed out.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-vars.el (c-comment-prefix-regexp): Document that
	`c-setup-paragraph-variables' has to be used when this variable is
	changed; it doesn't work to reinitialize the mode since that
	typically clobbers the variable.

	* progmodes/cc-styles.el (c-setup-paragraph-variables):
	Make it interactive.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-fonts.el (c-font-lock-declarations):
	Fix recognition of constructors and destructors for classes whose
	names are matched by `*-font-lock-extra-types'.

	* progmodes/cc-langs.el (c-type-list-kwds): If "operator" is
	followed by an identifier in C++ then it's a type.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-fonts.el (c-font-lock-invalid-string): Fix eob
	problem that primarily affected XEmacs.  Don't use faces to find
	unterminated strings since Emacs and XEmacs fontify strings
	differently - this function should now work better in XEmacs.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace): Fix a bug in the
	`expand-abbrev' workaround which caused braces to misbehave inside
	macros.

	* progmodes/cc-engine.el (c-forward-keyword-clause): Fix error
	handling.  This bug could cause interactive font locking to bail out.

2003-09-24  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-just-after-func-arglist-p):
	Handle paren-style types in Pike.  Also fixed some cases of
	insufficient handling of unbalanced parens.

2003-09-24  Rajesh Vaidheeswarran  <rv@gnu.org>

	* ffap.el (ffap-shell-prompt-regexp): Add regexp to identify
	common shell prompts that are not common filename or URL characters.
	(ffap-file-at-point): Use the new regexp to strip the prompts from
	the file names.  This is an issue mostly for user prompts that
	don't have a trailing space and find-file-at-point is invoked from
	within a shell inside Emacs.

2003-09-24  Andre Spiegel  <spiegel@gnu.org>

	* vc-cvs.el (vc-cvs-parse-entry): Restore the code to compare time
	stamps numerically, rather than textually.

2003-09-24  Kenichi Handa  <handa@m17n.org>

	* language/devan-util.el (devanagari-post-read-conversion):
	* language/mlm-util.el (malayalam-post-read-conversion):
	* language/tml-util.el (tamil-post-read-conversion):
	Add autoload cookie.

	* international/utf-8.el (utf-8-post-read-conversion):
	Call post-read-conversion functions for Devanagari, Malayalam,
	and Tamil.

2003-09-23  Dave Love  <fx@gnu.org>

	* Makefile.in (bootstrap-clean): Fix misplaced `!'.

2003-09-22  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (perldb): Add gud-until to list of commands.
	Update gud-remove.

2003-09-22  Richard M. Stallman  <rms@gnu.org>

	* progmodes/sh-script.el (sh-mode-default-syntax-table):
	Rename from sh-mode-syntax-table.  Call sh-mode-syntax-table directly.
	(sh-mode-syntax-table-input): New variable.
	(sh-require-final-newline): Don't use eval.
	(sh-builtins, sh-leading-keywords, sh-other-keywords)
	(sh-variables, sh-font-lock-keywords): Don't use eval.
	(sh-set-shell): When setting require-final-newline,
	treat value = `require-final-newline' as don't change it.
	Set sh-mode-syntax-table locally based on
	sh-mode-syntax-table-input and sh-mode-default-syntax-table.

	* progmodes/compile.el (compile-internal):
	Call compilation-set-window-height before setting window start.

2003-09-22  Greg Hill  <ghill@synergymicro.com>  (tiny change)

	* emacs-lisp/bytecomp.el (byte-compile-log-file):
	Clear out byte-compile-last-warned-form.

2003-09-22  Richard M. Stallman  <rms@gnu.org>

	* woman.el (woman-file-name, woman-follow-word):
	If current-word returns nil, use "".

	* simple.el (eval-expression): Bind standard-output in to-buffer case.

2003-09-22  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mnt.el (lm-with-file):
	Don't visit the file, just use insert-file-contents in temp buffer.

2003-09-22  Jari Aalto  <jari.aalto@poboxes.com>

	* emacs-lisp/lisp-mnt.el (lm-get-header-re):
	Add surrounding \\( and \\) around the header, as in
	for lm-history-header 'Change Log\\|History'.

2003-09-22  John Paul Wallington  <jpw@gnu.org>

	* progmodes/ld-script.el: Add Commentary section,
	minor cleanup of file header.
	(ld-script-font-lock-keywords): Doc fix.
	(toplevel): Provide `ld-script' feature.

2003-09-21  Kim F. Storm  <storm@cua.dk>

	* scroll-bar.el (set-scroll-bar-mode): Initialize to
	new built-in variable default-frame-scroll-bars.
	(scroll-bar-mode): Use default-frame-scroll-bars when enabling
	scroll-bar-mode; notably, use it instead of t when we toggle
	scroll-bars on.
	(toggle-scroll-bar): Use default-frame-scroll-bars.

2003-09-19  Masatake YAMATO  <jet@gyve.org>

	* pcvs.el (cvs-do-removal): Change the prompt depending on
	`filter' value.

2003-09-19  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* startup.el (command-line-1): Stop startup-echo-area-message
	being hidden by "Loading image..." message.
	(use-fancy-splash-screens-p, display-splash-screen):
	Move display-graphic-p test from latter to former.

	* progmodes/sh-script.el (sh-font-lock-keywords):
	Highlight escaped EOLs differently from other backslash constructs.

2003-09-19  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/edebug.el (edebug-var-status, edebug-restore-status):
	New functions.
	(edebug-enter, edebug-outside-excursion): Use them.

	* emacs-lisp/bytecomp.el (byte-compile-warning-prefix):
	Fix the condition for whether to print "In WHERE".

2003-09-19  Jari Aalto  <jari.aalto@poboxes.com>

	* finder.el (finder-mode-hook): New variable.
	(finder-mode): Run hook finder-mode-hook

2003-09-18  Masatake YAMATO  <jet@gyve.org>

	* progmodes/ebrowse.el: Fix broken magic autoload comments.

2003-09-17  Mario Lang  <mlang@delysid.org>

	* progmodes/gud.el (perldb): Change gud-print from just "%e" to
	"p %e" to actually print the value in the GUD buffer.

2003-09-16  Miles Bader  <miles@gnu.ai.mit.edu>

	From David Ponce <david.ponce@wanadoo.fr>:
	* makefile.w32-in (DONTCOMPILE): Add loaddefs-boot.el.
	(bootstrap-clean-CMD, bootstrap-clean-SH): Recreate loaddefs.el
	from loaddefs-boot.el if necessary.

2003-09-15  Zoltan Kemenczy  <kemenczy@rogers.com>

	* progmodes/gud.el (gud-find-class): Make jdb work again since
	cc-mode changed the syntactic information.

2003-09-15  David Ponce  <david@dponce.com>

	* recentf.el: (recentf-exclude): Accept predicates too.
	(recentf-file-readable-p): New function.
	(recentf-include-p): Handle predicates in recentf-exclude.
	(recentf-add-file): Doc fix.  Use recentf-file-readable-p.
	(recentf-cleanup): Likewise.
	(recentf-save-list): Use write-file to handle backup of
	recentf-save-file.

2003-09-15  Miles Bader  <miles@gnu.ai.mit.edu>

	* loaddefs-boot.el: Renamed from `loaddefs.el'
	* Makefile.in (DONTCOMPILE): Add loaddefs-boot.el.
	(bootstrap-clean): Recreate loaddefs.el from loaddefs-boot.el if
	necessary.

2003-09-13  Thien-Thi Nguyen  <ttn@gnu.org>

	* electric.el (Electric-pop-up-window): For the `one-window' case,
	no longer disconcertingly move point in the original buffer.

2003-09-12  Stefan Monnier  <monnier@iro.umontreal.ca>

	* emacs-lisp/tq.el (tq-create): Fix mixed up unquote style.

2003-09-12  Eric Hanchrow  <offby1@blarg.net>  (tiny change)

	* dired.el (dired-mode-map): Fix typo.

2003-09-11  Richard M. Stallman  <rms@gnu.org>

	* dired.el (dired-mode-map): Bind M-g to dired-goto-file.

2003-09-11  Paul Pogonyshev  <pogonyshev@gmx.net>  (tiny change)

	* window.el (kill-buffer-and-window): Remove `yes-or-no-p' so that
	the function is less noisy.  Now only `kill-buffer' can ask questions.

2003-09-10  Mario Lang  <mlang@delysid.org>

	* battery.el: Update Commentary and Copyright.
	(battery-linux-proc-acpi): Fix a bug in %b which made "!" never
	appear due to wrong ordering of the expressions in `or'.

2003-09-09  Lute Kamstra  <lute@gnu.org>

	* misc.el (upcase-char): Fix docstring.
	(zap-up-to-char): New command.

2003-09-08  David Ponce  <david@dponce.com>

	Ensure that recentf correctly updates the menu bar.
	* recentf.el (recentf-menu-path,recentf-menu-before): Doc fix.
	(recentf-menu-bar): New function.
	(recentf-clear-data): Use it
	(recentf-update-menu): Likewise.  Use easy-menu-add-item instead
	of easy-menu-change.

2003-09-08  Lute Kamstra  <lute@gnu.org>

	* simple.el (size-indication-mode): New.
	* bindings.el (mode-line-position): Add buffer size indicator.

2003-09-04  Mario Lang  <mlang@delysid.org>

	* battery.el (battery-linux-proc-acpi): New function.
	(battery-status-function): Modify default value calculation to also
	check for availability of ACPI.
	(battery-echo-area-format): Ditto.
	(battery-mode-line-format): Ditto.

2003-09-06  Dave Love  <fx@gnu.org>

	* ielm.el (ielm-mode-hook): Add :options.

	* emacs-lisp/eldoc.el (eldoc-print-current-symbol-info-function): New.
	(eldoc-print-current-symbol-info): Use it.

2003-09-04  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gud-display1): Use gud-call to prevent extra prompt
	being displayed in GUD buffer.
	(gdb-idle-input-queue): Remove var.  Use just one queue.
	(gdb-enqueue-idle-input,gdb-dequeue-idle-input):
	Remove functions.  Use just one queue.
	(gdb-prompt, gdb-subprompt, def-gdb-auto-update-trigger)
	(gdb-invalidate-assembler, gdb-get-current-frame):
	Modify functions.  Use just one queue.

2003-09-04  Dave Love  <fx@gnu.org>

	* cus-start.el: Add blink-cursor-alist.

	* ruler-mode.el (ruler-mode-fill-column-char)
	(ruler-mode-current-column-char): Use char-displayable-p,
	not window-system.

	* international/codepage.el ("mule-diag"): Add eval-after-load clause.

	* language/european.el (windows-1252): Move from code-pages.

	* language/cyrillic.el ("Windows-1251"): Delete.
	("Bulgarian", "Belarusian"): Remove `features'.
	(windows-1251): Move from code-pages.

	* international/mule-diag.el (non-iso-charset-alist):
	Remove `codepage' stuff.
	(print-designation, list-coding-systems-1): Output fixes.

	* international/code-pages.el (cp-make-translation-table)
	(cp-valid-codes): Made defsubsts.
	(cp-fix-safe-chars): Delete.
	(mule-diag): Don't require.
	(windows-1251, windows-1252): Remove to cyrillic.el/european.el.
	(top-level): Check for defined coding system when defining
	cp... aliases.  Change w32-add-charset-info test to avoid warning.
	(non-iso-charset-alist): Defvar when compiling.
	(cp-make-coding-system): Doc fix.

2003-09-02  Jason Rumney  <jasonr@gnu.org>

	* international/titdic-cnv.el (tsang-quick-converter): Fix broken
	line-ends from CVS before doing conversion.

2003-09-02  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/diary-lib.el (diary-header-line-flag)
	(diary-header-line-format): New variables.
	(list-diary-entries): Use them to set header line in simple diary.

	* progmodes/sh-script.el (sh-font-lock-keywords): Use something
	other than font-lock-string-face to highlight backslashes.

2003-09-01  Jason Rumney  <jasonr@gnu.org>

	* international/titdic-cnv.el (tit-read-key-value): Include \r in
	regexp.

2003-09-01  Dave Love  <fx@gnu.org>

	* mouse.el (mouse-popup-menubar, mouse-skip-word): Doc fix.

	* menu-bar.el (menu-bar-showhide-menu): Amend date and time label
	and :help; also line and column numbers labels.

	* international/mule-util.el (char-displayable-p): Move from
	latin1-disp, rename and autoload.

	* international/latin1-disp.el (latin1-char-displayable-p):
	Now obsolete alias.  Replace uses with char-displayable-p.
	(latin1-display-ucs-per-lynx): Fix last change.

	* international/mule-cmds.el (standard-display-european-internal):
	Don't use char code for Latin-1 NBSP.
	<XFree86 4>: Unfrob NBSP display table.  Set display table to use
	U+2018, U+2019 for `'.
	(select-safe-coding-system): Message fix.

2003-09-01  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset): For Thai
	font, specify "*" family.

2003-09-01  Kevin Rodgers  <ihs_4664@yahoo.com>  (tiny change)

	* progmodes/compile.el (previous-error): Accept a prefix
	argument, similarly to next-error.

2003-08-31  Masatake YAMATO  <jet@gyve.org>

	* pcvs.el (cvs-do-removal): Use = instead of eq to check
	the number of files.  Bind the number of files to a local
	variable.  Suggested by Kevin Rodgers <ihs_4664@yahoo.com>.

2003-08-30  Eli Zaretskii  <eliz@gnu.org>

	* vc-hooks.el (vc-make-version-backup): Fix the change made on
	2003-07-26: msdos-long-file-names is a function, not a variable.

2003-08-29  Richard M. Stallman  <rms@gnu.org>

	* mail/sendmail.el (sendmail-sync-aliases, mail-setup):
	Do nothing with mail-personal-alias-file if it is nil.

	* mail/mailabbrev.el (mail-abbrevs-sync-aliases):
	Do nothing if mail-personal-alias-file is nil.

	* term.el (term-exec-1): Bind coding-system-for-read.

	* dired.el (dired-mouse-find-file-other-window):
	Use dired-view-command-alist here, as in dired-view-file.
	(dired-view-command-alist): Use %s to substitute file name.
	Handle .ps_pages, .eps, .jpg, .gif, .png.

2003-08-29  Paul Pogonyshev  <pogonyshev@gmx.net>  (tiny change)

	* info.el (Info-mode-map): Bind S-tab and <backtab> to
	`Info-prev-reference', instead of M-tab.

2003-08-29  Martin Stjernholm  <mast@lysator.liu.se>

	* simple.el (blink-matching-open): Work correctly on chars that
	are designated as parens through the syntax-table text property.

2003-08-29  Thierry Emery  <thierry.emery@club-internet.fr>  (tiny change)

	* kinsoku.el (kinsoku-longer, kinsoku-shorter): Do not choose a
	line break position in the middle of a non-kinsoku (e.g. latin)
	word, making it skip until either a space or a character with
	category "|".
	(kinsoku-longer): Test for end of buffer.

2003-08-28  Eli Zaretskii  <eliz@gnu.org>

	* mail/rmail.el (rmail-convert-to-babyl-format):
	Detect quoted-printable- and base64-encoded messages and decode them
	automatically.  Set the message's encoding from the charset=
	header, if any.  Decode base64-encoded messages in Mail format as well.

2003-08-26  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* mail/smtpmail.el: Fix previous change.
	(smtpmail-send-queued-mail): Set smtpmail-mail-address before
	calling smtpmail-via-smtp.
	(smtpmail-via-smtp): Add fall-back values for envelope-from.

2003-08-26  John Paul Wallington  <jpw@gnu.org>

	* image.el (image-jpeg-p): Don't search beyond length of data.

2003-08-26  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-cmds.el (c-electric-brace): Work around for a
	misfeature in `expand-abbrev' which caused electric keywords like
	"else" to disappear if an open brace was typed directly afterwards.

2003-08-26  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-vars.el (c-extra-types-widget): The doc string is
	mandatory in `define-widget'.

	* progmodes/cc-align.el, progmodes/cc-langs.el (c-lineup-math):
	Don't align the operators "!=", "<=" and ">=" as assignment operators.

	(c-assignment-operators): New language constant that only contains
	the assignment operators.

	(c-assignment-op-regexp): New language var used by `c-lineup-math'.

2003-08-26  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-just-after-func-arglist-p):
	Safeguard against unbalanced sexps.

2003-08-26  Terje Rosten  <terjeros@phys.ntnu.no>

	* version.el (emacs-version): Check for gtk.  Include gtk version info.

2003-08-25  John Paul Wallington  <jpw@gnu.org>

	* man.el (Man-default-man-entry): Don't whizz past the section
	number before looking for it.

2003-08-24  Nick Roberts  <nick@nick.uklinux.net>

	* progmodes/gud.el (gud-display-line): Don't set window-point if
	source buffer is not visible.  (Only happens with M-x gdba.)

	* gdb-ui.el (gdba): Remove gdb-quit (previously removed) from
	documentation.
	(gdb-source, gdb-source-info): Update to assembler unnecessary
	as its done after each GDB command anyway.
	(gdb-pre-prompt): Use with-current-buffer.
	(gdb-insert-field): Add help-echo text.
	(gdb-invalidate-assembler): Re-display of assembler now done in
	gdb-info-breakpoints-custom.
	(gdb-info-breakpoints-custom): Force re-display of assembler to
	happen *after* update of breakpoints buffer.
	(gdb-display-source-buffer): Don't choke if gdb-source-window
	isn't visible.
	(gdb-put-string, gdb-put-arrow): Remove free variables.

2003-08-24  John Paul Wallington  <jpw@gnu.org>

	* ibuffer.el (ibuffer-formats): Make name and size columns wider.

	* man.el (Man-default-man-entry): Strip text properties when
	snarfing parts of entry because `format' preserves properties.

2003-08-24  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* files.el (file-newest-backup): Use `expand-file-name'.

	* calendar/diary-lib.el (simple-diary-display, make-diary-entry):
	Allow the diary to pop up a new frame, if needed.

	* mail/sendmail.el (mail-specify-envelope-from): Doc change.
	* mail/smtpmail.el (smtpmail-mail-address): Doc change.
	(smtpmail-send-it): Make treatment of envelope-from consistent with
	sendmail.el.

	* progmodes/sh-script.el (sh-builtins): Add some bash builtins.
	(sh-leading-keywords): Add the bash `time' reserved word.
	(sh-variables): Add some bash variables.
	(sh-add-completer): Fix nil branch of case statement.

2003-08-24  Masatake YAMATO  <jet@gyve.org>

	* progmodes/ld-script.el: New file.

2003-08-23  Markus Rost  <rost@math.ohio-state.edu>

	* vc-hooks.el (vc-ignore-vc-files, vc-master-templates): Doc fix.

2003-08-23  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-ignore-vc-files, vc-master-templates):
	Better explain obsolescence, and what to use instead.

2003-08-23  Masatake YAMATO  <jet@gyve.org>

	* pcvs.el (cvs-do-removal): Show the deleted file name
	on the prompt.

2003-08-20  Dave Love  <fx@gnu.org>

	* international/mule.el (make-coding-system)
	(set-buffer-file-coding-system): Doc fix.

	* emacs-lisp/lisp-mode.el (common-lisp-mode): New.

	* emacs-lisp/lisp.el (beginning-of-defun-function): Doc fix.

	* international/utf-8.el (ucs-unicode-to-mule-cjk): Use smaller :size.

	* international/utf-16.el: Add mime-text-unsuitable coding system
	properties.

	* international/latin1-disp.el (latin1-display): Add ?$,1s"(B.

	* cus-edit.el: Add some :links.
	(bib): Remove.

	* textmodes/bib-mode.el (bib): Add :group external.

2003-08-18  Luc Teirlinck  <teirllm@mail.auburn.edu>

	* wid-edit.el (widget-echo-help): Make it handle expressions that
	evaluate to strings.

2003-08-18  Michael Mauger  <mmaug@yahoo.com>

	Version 1.8.0 of sql-mode.  (Patch submitted 2003-06-21)

	Simplify selection of SQL products to define highlighting and
	interactive mode.  Includes detailed instructions on adding
	support for new products.

	* progmodes/sql.el (sql-product): New variable.  Identifies SQL
	product for use in highlighting and interactive mode.
	(sql-interactive-product): New variable.  SQL product for
	sql-interactive-mode.
	(sql-product-support): New variable.  Specifies product-specific
	parameters to drive highlighting and interactive mode.
	(sql-imenu-generic-expression): Add more object types.
	(sql-sqlite-options): Correct comment.
	(sql-ms-program): Use "osql" rather than "isql".
	(sql-prompt-regexp, sql-prompt-length): Update comment.
	(sql-mode-menu): Add "Start SQLi session" entry.
	Replace Highlighting submenu with Product menu.  Fix Send Region entry.
	(sql-mode-abbrev-table): Add abbreviations.  Support of
	SYSTEM-FLAG on define-abbrev.  Support was removed with last
	check-in; it now handles older Emacsen without the SYSTEM-FLAG.
	(sql-mode-font-lock-object-name): Add font-lock pattern for object
	names.
	(sql-mode-ansi-font-lock-keywords): Set as default value.
	(sql-mode-oracle-font-lock-keywords): Set as default value.
	Support Oracle 9i keywords.
	(sql-mode-postgres-font-lock-keywords): Set as default value.
	(sql-mode-linter-font-lock-keywords): Set as default value.
	(sql-mode-ms-font-lock-keywords): New variable.  Support Microsoft
	SQLServer 2000.
	(sql-mode-sybase-font-lock-keywords)
	(sql-mode-interbase-font-lock-keywords)
	(sql-mode-sqlite-font-lock-keywords)
	(sql-mode-strong-font-lock-keywords)
	(sql-mode-mysql-font-lock-keywords)
	(sql-mode-db2-font-lock-keywords): New variables.  Default to ANSI
	keywords.
	(sql-mode-font-lock-defaults): Update comment.
	(sql-product-feature): New function.  Returns feature associated
	with a product from `sql-product-support' alist.
	(sql-product-font-lock): New function.  Set font-lock support
	based on `sql-product'.
	(sql-add-product-keywords): New function.  Add font-lock rules to
	product-specific keyword variables.
	(sql-set-product): New function.  Set `sql-product' and apply
	appropriate font-lock highlighting.
	(sql-highlight-product): New function.  Set font-lock support
	based on a product.  Also set mode name to include product name.
	(sql-highlight-ansi-keywords, sql-highlight-oracle-keywords)
	(sql-highlight-postgres-keywords, sql-highlight-linter-keywords):
	Use `sql-set-product'.
	(sql-highlight-ms-keywords)
	(sql-highlight-sybase-keywords)
	(sql-highlight-interbase-keywords)
	(sql-highlight-strong-keywords)
	(sql-highlight-mysql-keywords)
	(sql-highlight-sqlite-keywords)
	(sql-highlight-db2-keywords): New functions.  Use `sql-set-product'.
	(sql-get-login): Prompt in the same order as the tokens.
	(sql-mode): Uses `sql-product-highlight' and `sql-product-font-lock'.
	(sql-product-interactive): New function.  Common portions of
	product-specific interactive mode wrappers.
	(sql-interactive-mode): Rewritten to use product features.
	(sql-oracle, sql-sybase, sql-informix, sql-sqlite, sql-mysql)
	(sql-solid, sql-ingres, sql-ms, sql-postgres, sql-interbase)
	(sql-db2, sql-linter): Use `sql-product-interactive'.
	(sql-connect-oracle, sql-connect-sybase, sql-connect-informix)
	(sql-connect-sqlite, sql-connect-mysql, sql-connect-solid)
	(sql-connect-ingres, sql-connect-postgres)
	(sql-connect-interbase, sql-connect-db2, sql-connect-linter):
	New functions.  Format command line parameters and invoke comint on
	the appropriate interpreter.  Code was in the corresponding
	`sql-xyz' function before.
	(sql-connect-ms): New function.  Support -E argument to use
	operating system credentials for authentication.

2003-08-18  Kenichi Handa  <handa@m17n.org>

	* international/mule.el (encode-char): Fix for the ASCII case.

2003-08-15  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset): Change "*" to
	nil in the specifications of font family.

2003-08-18  Kim F. Storm  <storm@cua.dk>

	* kmacro.el (kmacro-keymap): Group related bindings in
	initialization for clarity.  Bind C-s to start macro.
	Remove C-r binding.
	(kmacro-initial-counter-value): New defvar to hold initial counter
	value in case we set the value before defining a macro.
	(kmacro-insert-counter): Clear kmacro-initial-counter-value..
	(kmacro-set-counter): Set kmacro-initial-counter-value if we are
	not defining or executing macro.  Doc fix.
	(kmacro-add-counter): Clear kmacro-initial-counter-value.
	(kmacro-view-last-item, kmacro-view-item-no): New defvars used to
	temporarily view older elements on the macro ring without cycling
	the ring.
	(kmacro-display): Doc fix.
	(kmacro-exec-ring-item): New helper function.
	(kmacro-call-ring-2nd): Use it.
	(kmacro-call-ring-2nd-repeat): Doc fix.
	(kmacro-start-macro): Use (and clear) kmacro-initial-counter-value.
	(kmacro-end-or-call-macro): Execute last viewed macro (using
	kmacro-exec-ring-item) from ring if this follows
	kmacro-view-macro.  This allows us to find a macro on the ring
	with C-x C-k C-v C-v ... and execute it (with C-k) without cycling
	the ring to bring it to the head of the ring.
	(kmacro-bind-to-key): Doc fix (describe reserved bindings).
	Allow binding to reserved keys without specifying C-x C-k prefix.
	Ask for confirmation if entered key sequence is already bound to
	a non-macro command.
	(kmacro-view-macro): Repeating command will show older elements
	on the macro ring; C-k will execute the last viewed macro.
	(kmacro-view-macro-repeat): Doc fix.  Change its kmacro-repeat
	property from 'ring to 'head.

2003-08-17  Alan Shutko  <ats@acm.org>

	* calendar/calendar.el (calendar-make-alist): Correct off-by-one
	keeping December out of the alist.

2003-08-17  Edward M. Reingold  <reingold@emr.cs.iit.edu>

	* calendar/cal-move.el (calendar-goto-day-of-year): New function.
	* calendar/calendar.el (calendar-mode-map): Bind it to key.
	* calendar/cal-menu.el (calendar-mode-map): Add it to menu.
	(calendar-flatten): New function.
	(calendar-mouse-view-other-diary-entries)
	(calendar-mouse-view-diary-entries): Rewritten to put any holidays
	in the menu title and to show multi-line diary entries correctly
	in the menu.

2003-08-17  Luc Teirlinck  <teirllm@mail.auburn.edu>

	* info.el (Info-scroll-prefer-subnodes): Add :version keyword to
	defcustom, because the default was recently changed.

2003-08-16  Richard M. Stallman  <rms@gnu.org>

	* net/ange-ftp.el (ange-ftp-error): Add save-excursion.

	* emacs-lisp/lisp-mode.el (eval-last-sexp-print-value):
	New subroutine, broken out of eval-last-sexp-1.
	(eval-last-sexp-1): Use eval-last-sexp-print-value.

	* custom.el (custom-load-symbol): Load cus-load and cus-start first.

	* dabbrev.el (dabbrev--safe-replace-match): Use with-no-warnings.

	* simple.el (eval-expression): Use eval-last-sexp-print-value.

2003-08-14  Jari Aalto  <jari.aalto@poboxes.com>

	* progmodes/compile.el (compilation-error-regexp-alist):
	Add Java ANt error detection as described in document
	http://ant.apache.org/faq.html

2003-08-12  Juri Linkov  <juri@jurta.org>  (tiny change)

	* simple.el (backward-word, forward-to-indentation)
	(backward-to-indentation): Argument changed to optional.
	(next-line, previous-line): Use `or' instead of `unless'.

2003-08-12  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf-iso.el (ebnf-no-meta-identifier): Becomes a var
	instead of a constant.

2003-08-12  Markus Rost  <rost@math.ohio-state.edu>

	* shell.el (shell): With prefix-arg, suggest a new buffer name.

2003-08-12  Andre Spiegel  <spiegel@gnu.org>

	* vc-sccs.el (vc-sccs-state-heuristic): Fix parentheses.
	(vc-sccs-workfile-version): Search the entire delta table, rather
	than just the first entry, because that might be a deleted version.

2003-08-11  Karl Fogel  <kfogel@red-bean.com>

	* menu-bar.el (menu-bar-options-menu): Supply a body for the
	[save-place] binding in the Options menu.  Have it require
	'saveplace' and then toggle the variable manually, to avoid an an
	unbound variable error.  Thanks to <Sebastien.Kirche@sage.com>
	for the bug report.

2003-08-11  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-insert-field, gdb-array-format1)
	(gdb-info-breakpoints-custom, gdb-info-frames-custom)
	(gdb-info-threads-custom): Add help-echo text.
	(gdb-display-back): Don't use purecopy.
	(gdb-info-breakpoints-custom, gdb-reset)
	(gdb-assembler-custom): Use display-images-p to test if breakpoint
	icons can be displayed.

2003-08-11  Markus Rost  <rost@math.ohio-state.edu>

	* textmodes/reftex-vars.el (reftex-auto-recenter-toc): Fix typo.

2003-08-11  Stefan Monnier  <monnier@cs.yale.edu>

	* bookmark.el (bookmark-completing-read):
	Return a string, instead of a list of one string.
	Use a popup menu if activated from the mouse.
	(bookmark-edit-annotation): Remove unused vars.
	(bookmark-jump, bookmark-relocate, bookmark-insert-location)
	(bookmark-rename, bookmark-insert, bookmark-delete): Adjust calls
	to bookmark-completing-read.
	(bookmark-bmenu-show-filenames, bookmark-bmenu-hide-filenames)
	(bookmark-bmenu-mark, bookmark-bmenu-select, bookmark-bmenu-unmark)
	(bookmark-bmenu-delete, bookmark-bmenu-list): Use inhibit-read-only
	and erase-buffer.
	(bookmark-menu-delete, bookmark-menu-rename, bookmark-menu-locate)
	(bookmark-menu-jump, bookmark-menu-insert)
	(bookmark-popup-menu-and-apply-function)
	(bookmark-menu-popup-paned-bookmark-menu): Remove.
	(bookmark-menu-build-paned-menu): Remove by folding it into
	bookmark-menu-popup-paned-menu.
	(menu-bar-bookmark-map): Move the define-key statements here.
	Use the "non-menu" commands since they now pop up a menu if needed.
	(bookmark-exit-hook-internal): Simplify.

2003-08-11  Carsten Dominik  <dominik@sand.science.uva.nl>

	* reftex-toc.el (reftex-toc-rename-label): New function.
	(reftex-toc-check-docstruct): New function.

	* reftex.el (reftex-region-active-p): New function.

	* reftex-parse.el (reftex-locate-bibliography-files): Improved the
	regexp to find the \bibliography macro.

	* reftex-vars.el (reftex-section-levels): Removed subsubparagraph,
	which does not exist in LaTeX.
	(reftex-cite-format-builtin): Added amsrefs support.
	(reftex-toc-confirm-promotion): New option

	* reftex-toc.el
	(reftex-toc): Use `reftex-toc-split-windows-fraction'.
	(reftex-toc-demote, reftex-toc-promote)
	(reftex-toc-do-promote, reftex-toc-promote-prepare)
	(reftex-toc-promote-action, reftex-toc-extract-section-number)
	(reftex-toc-newhead-from-alist)
	(reftex-toc-load-all-files-for-promotion): New functions.
	(reftex-toc-help): Added description of new keys.
	(reftex-toc-split-windows-fraction): New option.
	(reftex-recenter-toc-when-idle): Search *toc* window on all
	visible frames.
	(reftex-toc): Additional parameter REUSE
	(reftex-toc-recenter): Remember current frame.  Call `reftex-toc'
	with REUSE argument.
	(reftex-recenter-toc-when-idle): Reset `current-prefix-arg' for
	the call of `reftex-toc'.
	(reftex-make-separate-toc-frame): New function .
	(reftex-toc-recenter): When called with triple prefix arg, call
	`reftex-make-separate-toc-frame' first.
	(reftex-toc-toggle-dedicated-frame): New command.
	(reftex-toc-quit): Adapted to delete frame when called in
	dedicated frame.

	* reftex-index.el (reftex-index-phrase-match-is-indexed): Check
	all enclosing macros.


2003-08-08  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el (ebnf-total, ebnf-nprod): Move defvar before
	first use.

2003-08-07  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* progmodes/ebnf2ps.el (ebnf-begin-job): Code fix.

2003-08-06  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (list-diary-entries-hook)
	(diary-display-hook, nongregorian-diary-listing-hook)
	(mark-diary-entries-hook, nongregorian-diary-marking-hook):
	Add some customize options for these hooks.
	(calendar-abbrev-construct): Don't try to take a substring longer
	than the original string.

2003-08-05  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/testcover.el (noreturn): Report error if does return.
	(testcover-reinstrument-clauses): Doc fix.

	* emacs-lisp/warnings.el: Doc fixes, args renamed.
	(warning-type-format): Rename from warning-group-format.

	* emacs-lisp/bytecomp.el (byte-compile-not-obsolete-var): New var.
	(byte-compile-variable-ref): Handle byte-compile-not-obsolete-var.
	(byte-compile-defvar): Bind byte-compile-not-obsolete-var
	to prevent warnings about defvar for an obsolete variable.

	* emacs-lisp/bytecomp.el (byte-compile-log-warning):
	warning-group-format renamed to warning-type-format.

	* subr.el (read-passwd): Use clear-string instead of fillarray.

	* edmacro.el (edmacro-format-keys): Use edmacro-sanitize-for-string.
	Use vconcat instead of concat.
	(edmacro-sanitize-for-string): New function.

2003-08-05  Dave Love  <fx@gnu.org>

	* cus-start.el: Add open-paren-in-column-0-is-defun-start,
	line-number-display-limit-width.

	* textmodes/tex-mode.el (tex-dvi-view-command): Fix quoted quotes.

2003-08-05  Kenichi Handa  <handa@m17n.org>

	* international/code-pages.el: Don't require mule-diag.

	* international/mule-diag.el (non-iso-charset-alist):
	Add autoload cookie.

	* language/devan-util.el (dev-glyph-order): Add an entry for the
	glyph code #xC4.

2003-08-03  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/calendar.el (diary-file, diary-file-name-prefix)
	(european-calendar-style, diary-date-forms)
	(calendar-day-name-array, calendar-month-name-array): Doc change.
	(generate-calendar-month): Adapt for new behaviour of
	`calendar-day-name' function.
	(calendar-abbrev-length, calendar-day-abbrev-array)
	(calendar-month-abbrev-array): New variables.
	(calendar-abbrev-construct): New function.
	(calendar-day-name, calendar-month-name): Use new abbrev arrays,
	rather than fixing abbrevs at some width.  Calling syntax change.
	(calendar-make-alist): Use abbrev arrays.  Calling syntax change.
	(calendar-date-string): Adapt for new behaviours of
	`calendar-day-name' and `calendar-month-name' functions.

	* calendar/diary-lib.el (list-diary-entries): Adapt for new
	behaviour of `calendar-day-name' and `calendar-month-name' functions.
	(diary-name-pattern): Use abbrev arrays, rather than fixing
	abbrevs at three chars.  Calling syntax change.
	(mark-diary-entries): Adapt for new behaviours of
	`diary-name-pattern' and `calendar-make-alist' functions.
	(fancy-diary-font-lock-keywords): Adapt for new behaviour of
	`diary-name-pattern' function.
	(font-lock-diary-date-forms): Use abbrev arrays, rather than
	fixing abbrevs at three chars.  Calling syntax change.
	(cal-hebrew, cal-islam): Require when compiling.
	(diary-font-lock-keywords): Adapt for new behaviour of
	`font-lock-diary-date-forms' function.

	* calendar/cal-hebrew.el: Reposition some code so defined before used.
	(calendar-hebrew-month-name-array-common-year)
	(calendar-hebrew-month-name-array-leap-year): Add doc strings.
	(list-hebrew-diary-entries): Adapt for new behaviours of
	`calendar-day-name' and `add-to-diary-list' functions.
	(mark-hebrew-diary-entries): Adapt for new behaviours of
	`diary-name-pattern' and `calendar-make-alist' functions.

	* calendar/cal-islam.el (calendar-islamic-month-name-array):
	Add doc string.
	(list-islamic-diary-entries): Adapt for new behaviours of
	`calendar-day-name' and `add-to-diary-list' functions.
	(mark-islamic-diary-entries): Adapt for new behaviours of
	`diary-name-pattern' and `calendar-make-alist' functions.

	* calendar/cal-menu.el (cal-menu-update): Adapt for new behaviour of
	`calendar-month-name' function.

	* calendar/cal-coptic.el (coptic-name): defvar rather than defconst.

	* calendar/solar.el (solar-seasons-data): Move definition before use.

	* calendar/cal-tex.el (cal-tex-day-name-format): Doc fix.
	(cal-tex-LaTeX-hourbox): Move definition before use.

	* calendar/cal-china.el, cal-hebrew.el, cal-islam.el,
	cal-julian.el, cal-menu.el, cal-move.el, holidays.el,
	lunar.el, solar.el
	(displayed-month, displayed-year): Define for compiler.

2003-08-03  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-mode.el (c-init-language-vars-for): Add argument
	MODE.  Renamed from c-init-c-language-vars'.
	(c-initialize-cc-mode): Change accordingly.
	(c-common-init): Ditto.
	(c-mode): Ditto.
	(c++-mode): Use `c-init-language-vars-for'.
	(objc-mode): Ditto.
	(java-mode): Ditto.
	(idl-mode): Ditto.
	(pike-mode): Ditto.
	(awk-mode): Ditto.

2003-08-03  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-end-of-current-token): Return whether
	or not the point moved.

	(c-search-decl-header-end): Don't trip up on operator identifiers
	in C++ and operators like == in all languages.

	* progmodes/cc-engine.el (c-backward-to-decl-anchor):
	Detect leading labels correctly.

2003-08-02  Andreas Schwab  <schwab@suse.de>

	* textmodes/ispell.el: Don't redo key bindings on loading, put
	them only in loaddefs.el.
	* bookmark.el: Likewise.
	* dabbrev.el: Likewise.
	* emerge.el: Likewise.

	* apropos.el (apropos-words-to-regexp): Only add `wild' if `words'
	has more than one member.

	* progmodes/sh-script.el (sh-mode): Don't set mode-class property.

2003-08-01  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* lpr.el (printify-region): It was ending conversion before the
	expected position.  Reported by Keiichi Suzuki <keiichi@nanap.org>.

2003-07-31  John Paul Wallington  <jpw@gnu.org>

	* net/browse-url.el (browse-url-epiphany): Doc fix.

2003-07-30  Kenichi Handa  <handa@m17n.org>

	* international/fontset.el (setup-default-fontset):
	Change registry names of Akurti fonts.

2003-07-29  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* comint.el (comint-read-noecho): Use `clear-string' instead of
	`fillarray'.

2003-07-29  Thomas W Murphy  <twm@andrew.cmu.edu>  (tiny change)

	* outline.el (outline-mode-hook): Add defvar.

2003-07-28  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-setup-windows, gdb-restore-windows):
	Restore assembler in source window if that is what has been selected.
	(menu): Add gdb-restore-windows to menu.  Make gdba
	specific menus only visible from gdba.

2003-07-28  Tak Ota  <Takaaki.Ota@am.sony.com>  (tiny change)

	* progmodes/compile.el (compilation-environment): New user variable.
	(compile-internal): Respect it.

2003-07-23  Masatake YAMATO  <jet@gyve.org>

	* progmodes/gud.el (gdb-script-font-lock-keywords):
	Put `font-lock-function-name-face' on a symbol which includes
	`-' like `hook-run'.  Put font-lock-variable-name-face
	on a symbol starting with $.

2003-07-27  Markus Rost  <rost@math.ohio-state.edu>

	* files.el (set-visited-file-name): Use truename for buffer-file-name.

2003-07-26  Markus Rost  <rost@math.ohio-state.edu>

	* vc-hooks.el (vc-file-not-found-hook): Doc fix.

2003-07-26  Andre Spiegel  <spiegel@gnu.org>

	* vc-hooks.el (vc-default-registered, vc-make-version-backup):
	Use with-no-warnings.
	(vc-file-not-found-hook): Add this to find-file-not-found-functions,
	rather than to find-file-not-found-hook, which doesn't exist.

2003-07-26  Markus Rost  <rost@math.ohio-state.edu>

	* international/quail.el (quail-translate-key): Fix previous change.

2003-07-25  John Paul Wallington  <jpw@gnu.org>

	* server.el (server-start): Check `server-process' is non-nil
	before killing it to avoid killing current buffer's process.

	* simple.el (choose-completion-string): Use `minibufferp';
	test `completion-reference-buffer' if `buffer' arg is nil.
	(push-mark): Use `when' and `unless'.
	(pop-mark): Use `when'.

	* mouse-sel.el (mouse-sel-get-selection-function):
	Check `x-last-selected-text-primary'.  Don't barf if it or
	`x-last-selected-text' aren't bound.

2003-07-25  Kevin Rodgers  <ihs_4664@yahoo.com>  (tiny change)

	* menu-bar.el (menu-bar-tools-menu): Minor change in strings.

2003-07-23  Stefan Monnier  <monnier@cs.yale.edu>

	* vc-svn.el (vc-svn-diff-switches): Don't default to vc-diff-switches.

2003-07-23  John Paul Wallington  <jpw@gnu.org>

	* tooltip.el (defface tooltip): Inherit from variable-pitch.

2003-07-23  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* emacs-lisp/derived.el (define-derived-mode): Mention hook in doc
	string.  Defvar the derived hook.

	* macros.el (insert-kbd-macro): Escape double quote character.
	From Thomas W Murphy <twm@andrew.cmu.edu>.

2003-07-22  Stefan Monnier  <monnier@cs.yale.edu>

	* textmodes/fill.el (fill-comment-paragraph): Construct a regexp
	to match the specific mark rather than reusing comment-start-skip.

2003-07-22  Thien-Thi Nguyen  <ttn@gnu.org>

	* progmodes/hideshow.el (hs-special-modes-alist):
	Clarify MDATA-SELECTOR doc; nfc.  Thanks to Michael Ernst.

2003-07-21  Markus Rost  <rost@math.ohio-state.edu>

	* progmodes/idlwave.el (idlwave-comment-indent-char): Fix default
	value using ?\s.

2003-07-21  John Paul Wallington  <jpw@gnu.org>

	* subr.el (with-selected-window): Add closing paren.

2003-07-21  Richard M. Stallman  <rms@gnu.org>

	* emacs-lisp/lisp-mode.el (emacs-lisp-mode): Use run-mode-hooks.
	(lisp-mode): Likewise.

	* subr.el (with-selected-window): Copy code form save-selected-window
	so as to call select-window with norecord arg.
	(dynamic-completion-table): Doc fix.
	(lazy-completion-table): Doc fix.

	* international/mule-cmds.el (set-locale-environment):
	langinfo renamed to locale-info.

	* international/mule.el (auto-coding-functions): Doc fix.

2003-07-21  Kenichi Handa  <handa@m17n.org>

	* international/quail.el (quail-translate-key):
	Update quail-current-str correctly.

2003-07-21  Andreas Schwab  <schwab@suse.de>

	* progmodes/sh-script.el (sh-mode-syntax-table): Change syntax of
	?, to "_".

2003-07-20  Kai Gro,A_(Bjohann  <kai.grossjohann@gmx.net>
	Version 2.0.36 of Tramp released.

	* net/tramp.el (tramp-default-password-end-of-line): Rename from
	tramp-password-end-of-line.
	(tramp-password-end-of-line): New method parameter.
	(tramp-get-password-end-of-line): Function to access method
	parameter `tramp-password-end-of-line', or variable
	`tramp-default-password-end-of-line' (default value).
	(tramp-methods): Add entries for new parameter
	tramp-password-end-of-line.
	(tramp-enter-password): Use new function
	`tramp-get-password-end-of-line'.
	(tramp-handle-insert-file-contents): Do not
	unconditionally inhibit the file operation file-local-copy, only
	do that when the inhibit-file-name-operation is currently
	insert-file-contents.  This fixes finding remote CVS-controlled
	files.  (It would barf on inserting the CVS/Entries file
	literally, because the file-local-copy handler wasn't called.)
	(tramp-handle-shell-command): Support optional third arg ERROR-BUFFER.
	(tramp-sh-extra-args): Adapt defcustom type to XEmacs.
	(tramp-initial-commands): New variable.
	(tramp-process-initial-commands): New function, using the variable.
	(tramp-open-connection-setup-interactive-shell): Call the new function.
	(tramp-buffer-name, tramp-debug-buffer-name): Always put the
	method into the buffer name, never use nil.  Reported by Hanak
	David <dhanak@inf.bme.hu>.
	(tramp-open-connection-setup-interactive-shell): Erase buffer
	before sending "stty -onlcr".

	* net/tramp-vc.el (vc-workfile-unchanged-p): Add comment.

2003-07-19  Markus Rost  <rost@math.ohio-state.edu>

	* textmodes/artist.el (artist-erase-char): Fix default value using ?\s.

2003-07-19  John Paul Wallington  <jpw@gnu.org>

	* textmodes/artist.el (artist-butlast-fn, artist-draw-sline)
	(artist-draw-rect, artist-draw-square): Doc fixes.

	* textmodes/enriched.el (enriched-decode-display-prop): Doc fix.

	* textmodes/two-column.el (2C-mode-line-format): Doc fix.

2003-07-19  Kenichi Handa  <handa@m17n.org>

	* international/kkc.el (kkc-show-conversion-list-update):
	Highlight the correct candidate in the message.

2003-07-18  John Paul Wallington  <jpw@gnu.org>

	* simple.el (current-word): Don't include punctuation char when
	`really-word' arg is non-nil.

2003-07-17  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/awk-mode.el: Obsoleted by the AWK support in CC Mode -
	moved to the directory obsolete.

2003-07-16  Stefan Monnier  <monnier@cs.yale.edu>

	* info.el (Info-menu-entry-name-re): Allow newlines in
	menu entry names.

	* emacs-lisp/syntax.el (syntax-ppss-flush-cache): Rename from
	syntax-ppss-after-change-function.
	(syntax-ppss-after-change-function): New alias.  Update uses.
	(syntax-ppss): Catch the case where the buffer is narrowed.

2003-07-16  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-defs.el (c-langelem-sym, c-langelem-pos)
	(c-langelem-2nd-pos): Add accessor functions for syntactic elements.

2003-07-16  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-literal-faces): Declare as a variable
	since it might be modified.

	* progmodes/cc-langs.el (c++-make-template-syntax-table)
	(c-syntactic-ws-start, c-syntactic-ws-end): Give more consistent
	names to these language constants.

2003-07-15  Kim F. Storm  <storm@cua.dk>

	* apropos.el (apropos-sort-by-scores): Rename from apropos-show-scores.
	All uses changed.

2003-07-14  Mark A. Hershberger  <mah@everybody.org>

	* xml.el (xml-parse-tag, xml-parse-file, xml-parse-region):
	Namespace support.

2003-07-13  Juanma Barranquero  <lektu@terra.es>

	* frame.el (modify-all-frames-parameters): Reinstall (copyright
	papers received).

2003-07-13  Karl Eichwalder  <ke@suse.de>

	* textmodes/po.el (po-find-charset): White space at the start of the
	Content-Type field body is non-mandatory.

2003-07-13  Masayuki Ataka  <ataka@milk.freemail.ne.jp>  (tiny change)

	* textmodes/texinfo.el (texinfo-section-list):
	Append appendixsection; a synonym for appendixsec.

2003-07-13  Jari Aalto  <jari.aalto@poboxes.com>

	* man.el (Man-translate-cleanup): New.
	(Man-translate-references): Call `Man-translate-cleanup' to clean
	leading, trailing and middle spaces.

2003-07-13  Lars Hansen  <larsh@math.ku.dk>

	* desktop.el (desktop-buffer-dired-misc-data, desktop-buffer-dired):
	Handle `dired-directory' being a list.

2003-07-13  Jesper Harder  <harder@ifa.au.dk>  (tiny change)

	* mail/smtpmail.el (smtpmail-send-it): Create smtpmail-queue-dir if
	it doesn't exist.

2003-07-12  Richard M. Stallman  <rms@gnu.org>

	* progmodes/cc-engine.el (c-declare-lang-variables): Don't use mapcan.

	* progmodes/cc-defs.el (c-make-keywords-re):
	Don't use delete-duplicates.
	(c-lang-const): Don't use mapcan.

	* apropos.el (apropos-show-scores): Make it customizable.
	Document new meaning.
	(apropos): Compute scores from symbols.
	(apropos-print): Don't sort by scores if apropos-show-scores is nil.

2003-07-11  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-bdf.el: Fix copyright line.
	(bdf-directory-list): Fix initialization code.

2003-07-11  John Paul Wallington  <jpw@gnu.org>

	* emacs-lisp/ring.el (ring-empty-p): Use `zerop'.
	(ring-p, ring-plus1, ring-minus1, ring-length, ring-index)
	(ring-empty-p, ring-size, ring-copy, ring-ref): Doc fixes.

2003-07-11  NAKAJIMA Mikio  <minakaji@namazu.org>  (tiny change)

	* emacs-lisp/ring.el (ring-elements): Doc fix.

2003-07-11  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/timeclock.el (timeclock-relative)
	(timeclock-ask-before-exiting, timeclock-use-display-time):
	Doc changes.
	(timeclock-modeline-display): Give a message if
	`timeclock-use-display-time' is non-nil but `display-time-mode'
	is not active.

2003-07-11  Kenichi Handa  <handa@m17n.org>

	* international/mule-cmds.el (set-language-environment):
	Set current-language-environment to the correct string.

2003-07-10  Vinicius Jose Latorre  <viniciusjl@ig.com.br>

	* ps-print.el: Print line number correctly in a region.  Reported by
	Tim Allen <timallen@ls83.fsnet.co.uk>.
	(ps-print-version): New version number (6.6.2).
	(ps-printing-region): Code fix.

2003-07-10  John Paul Wallington  <jpw@gnu.org>

	* progmodes/etags.el (visit-tags-table-buffer): Add autoload cookie;
	this function can be called from `add-completions-from-tags-table'.

2003-07-10  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* calendar/timeclock.el (timeclock-use-display-time)
	(timeclock-day-over-hook, timeclock-workday-remaining)
	(timeclock-status-string, timeclock-when-to-leave)
	(timeclock-when-to-leave-string, timeclock-log-data)
	(timeclock-find-discrep, timeclock-day-base)
	(timeclock-generate-report, timeclock-visit-timelog): Doc fix.
	(timeclock-modeline-display): Set the variable
	`timeclock-modeline-display'.
	(timeclock-update-modeline): Doc fix.  Respect value of
	`timeclock-relative'.

2003-07-09  Richard M. Stallman  <rms@gnu.org>

	* textmodes/reftex-parse.el (reftex-all-document-files):
	Add autoload cookie.

	* textmodes/reftex.el (reftex-all-document-files): Delete autoload.
	(reftex-scanning-info-available-p): Add autoload cookie.

	* international/mule-cmds.el
	(set-display-table-and-terminal-coding-system): Delete duplicate
	aset on standard-display-table.

	* view.el (view-file): If existing buffer's major mode is special,
	don't go into view mode.

	* dired.el (dired-move-to-filename-regexp): Allow quote in months.

2003-07-08  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el (c-guess-basic-syntax): Do not do hidden
	buffer changes; there's third party code that calls this function
	directly.

2003-07-08  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-fonts.el (javadoc-font-lock-keywords)
	(autodoc-font-lock-keywords): Don't byte compile on font lock
	initialization when running from byte compiled files.

2003-07-08  Alan Mackenzie  <bug-cc-mode@gnu.org>

	* progmodes/cc-engine.el: Fix AWK mode indentation when previous
	statement ends with auto-increment "++".

2003-07-08  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-langs.el, progmodes/cc-styles.el (c-style-alist)
	(c-lang-variable-inits, c-lang-variable-inits-tail): The values of
	these are changed, so declare them as variables and not constants.

2003-07-08  Markus Rost  <rost@math.ohio-state.edu>

	* subr.el (dolist, dotimes): Doc fix.

2003-07-08  Kim F. Storm  <storm@cua.dk>

	* international/mule-cmds.el
	(set-display-table-and-terminal-coding-system): Don't break
	bootstrap if standard-display-table isn't setup yet.

2003-07-07  Richard M. Stallman  <rms@gnu.org>

	* ehelp.el (ehelp-command): Use defalias to define ehelp-command.
	Give it a doc string, and autoload it.

	* desktop.el (desktop-buffer-info, desktop-buffer-mh):
	Use with-no-warnings.

	* info.el (Info-search): If find invisible text, search again.

	* isearch.el (search-whitespace-regexp): Add a shy group around it.

	* man.el (Man-name-regexp): Match + as part of name.

	* simple.el (visible-mode): Rename from vis-mode.
	(vis-mode-saved-buffer-invisibility-spec): Doc fix.

	* simple.el (current-word): New arg REALLY-WORD specifies
	don't include punctuation chars.

	* emacs-lisp/debug.el (debug, debugger-env-macro):
	Use with-no-warnings while accessing and binding unread-command-char.

	* international/mule-cmds.el
	(set-display-table-and-terminal-coding-system): Use explicit loop
	instead of calling standard-display-default.

	* net/ange-ftp.el (ange-ftp-file-symlink-p):
	Use condition-case to catch error in ange-ftp-get-files.

	* net/browse-url.el (browse-url-browser-function):
	Add alternative for Epiphany.
	(browse-url-epiphany-program, browse-url-epiphany-arguments)
	(browse-url-epiphany-startup-arguments)
	(browse-url-epiphany-new-window-is-tab): New variables.
	(browse-url-epiphany, browse-url-epiphany-sentinel): New functions.

	* progmodes/compile.el (compile-auto-highlight): Default now t.
	(compile): Doc fix.
	(compilation-next-error): Fix previous change.

	* textmodes/tex-mode.el (tex-main-file): Use with-no-warnings.

	* textmodes/sgml-mode.el (xml-mode): Add autoload cookie.

2003-07-07  Nick Roberts  <nick@nick.uklinux.net>

	* gdb-ui.el (gdb-source-info): Display current frame when
	attaching to an existing process.
	(gdb-setup-windows, gdb-source-info): Start with gud-comint-buffer
	while laying out windows when attaching to an existing process.

2003-07-07  Stefan Monnier  <monnier@cs.yale.edu>

	* info.el (Info-menu): Use Info-menu-entry-name-re.

2003-07-06  Stefan Monnier  <monnier@cs.yale.edu>

	* vc-hooks.el (vc-stay-local, vc-stay-local-p): Move from vc.el.
	* vc.el (vc-stay-local, vc-stay-local-p): Move to vc-hooks.el.

	* info.el (Info-menu-entry-name-re): Be careful to avoid multiple ways
	to match the same text.

2003-07-06  John Paul Wallington  <jpw@gnu.org>

	* vc.el (vc-annotate-offset): Move defvar up.

2003-07-06  Kim F. Storm  <storm@cua.dk>

	* info.el (Info-menu-entry-name-re): Add `:' to second [] part.
	This should fix the infinite loop when extracting menu names.

2003-07-05  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* files.el (auto-mode-alist, interpreter-mode-alist):
	Remove entries to CC Mode modes to avoid duplicates; they are now added
	with autoload directives in cc-mode.el.

2003-07-05  Martin Stjernholm  <bug-cc-mode@gnu.org>

	* progmodes/cc-langs.el, progmodes/cc-styles.el (c-style-alist)
	(c-lang-variable-inits, c-lang-variable-inits-tail): The values of
	these are changed, so declare them as variables and not constants.

	* progmodes/cc-mode.el: Fix some autoload problems: Try to
	ensure that the entry for ".c" extension comes before the one for
	".C" on `auto-mode-alist', to behave better on case insensitive OS:es.
	Fix incorrect entries that were added to `interpreter-mode-alist'.
	Move the autoload directives for AWK to the top level since they
	aren't recognized anywhere else.  Do not use the new AWK mode doc
	in the autoload form for the old AWK mode.

2003-06-30  Roland Winkler  <Roland.Winkler@physik.uni-erlangen.de>

	* textmodes/bibtex.el (bibtex-sort-entry-class): New entry catch-all.
	(bibtex-sort-ignore-string-entries): Default value t.
	(bibtex-entry-kill-ring-max): Reintroduce as it was removed
	erroneously in previous version.
	(bibtex-string-files): Docstring reflects new parsing scheme.
	(bibtex-autokey-transcriptions): Merge some rewrite entries, fix
	docstring, add # as one of the chars to crush
	(bibtex-autokey-prefix-string, bibtex-autokey-names)
	(bibtex-autokey-names-stretch, bibtex-autokey-additional-names)
	(bibtex-autokey-name-change-strings)
	(bibtex-autokey-name-case-convert, bibtex-autokey-name-length)
	(bibtex-autokey-name-separator, bibtex-autokey-year-length)
	(bibtex-autokey-use-crossref, bibtex-autokey-titlewords)
	(bibtex-autokey-title-terminators)
	(bibtex-autokey-titlewords-stretch)
	(bibtex-autokey-titleword-ignore)
	(bibtex-autokey-titleword-case-convert)
	(bibtex-autokey-titleword-abbrevs)
	(bibtex-autokey-titleword-abbrevs)
	(bibtex-autokey-titleword-change-strings)
	(bibtex-autokey-titleword-length)
	(bibtex-autokey-titleword-separator)
	(bibtex-autokey-name-year-separator)
	(bibtex-autokey-year-title-separator)
	(bibtex-autokey-before-presentation-function)
	(bibtex-entry-type-history, bibtex-entry-maybe-empty-head):
	Fix docstring.
	(bibtex-strings, bibtex-reference-keys):
	Use lazy-completion-table and make-variable-buffer-local.
	(bibtex-sort-entry-class-alist): Use downcase, account for catch-all.
	(bibtex-braced-string-syntax-table)
	(bibtex-quoted-string-syntax-table): New variables.
	(bibtex-parse-nested-braces): Remove.
	(bibtex-parse-field-string): Use syntax table and forward-sexp.
	(bibtex-parse-association): Simplify.
	(bibtex-parse-field-name): Obey bibtex-autoadd-commas.
	(bibtex-parse-field-text): Simplify.
	(bibtex-search-forward-field, bibtex-search-backward-field):
	argument BOUND can take value t.
	(bibtex-start-of-field, bibtex-start-of-name-in-field)
	(bibtex-end-of-name-in-field, bibtex-end-of-field)
	(bibtex-start-of-text-in-field, bibtex-end-of-text-in-field)
	(bibtex-start-of-text-in-string, bibtex-end-of-text-in-string)
	(bibtex-end-of-string, bibtex-type-in-head): Use defsubst.
	(bibtex-skip-to-valid-entry): Return buffer position of beginning
	and ending of entry.  Update for changes of bibtex-search-entry.
	Simplify.
	(bibtex-map-entries): FUN is called with three arguments.
	(bibtex-search-entry): Return a cons pair with buffer positions of
	beginning and end of entry.
	(bibtex-enclosing-field): Simplify.
	(bibtex-format-entry): Use booktitle to set a missing title.
	(bibtex-autokey-get-names): Fiddle with regexps.
	(bibtex-generate-autokey): Use identity.
	(bibtex-parse-keys): Use simplified parsing algorithm if
	bibtex-parse-keys-fast is non-nil.  Simplify.  Change order of
	arguments.  Return alist of keys.
	(bibtex-parse-strings): Simplify.  Return alist of strings.
	(bibtex-complete-string-cleanup): Fix docstring.
	(bibtex-read-key): New function.
	(bibtex-mode): Fix docstring.  Do not parse for keys and
	strings when the mode is entered.  Set fill-paragraph-function to
	bibtex-fill-field.  Setup font-lock-mark-block-function the way
	font-lock intended.
	(bibtex-entry): Use bibtex-read-key.  Obey bibtex-autofill-types.
	(bibtex-parse-entry, bibtex-autofill-entry): New functions.
	(bibtex-print-help-message, bibtex-remove-OPT-or-ALT)
	(bibtex-Preamble): Avoid hard coded constants.
	(bibtex-make-field): Fix docstring.  Simplify.
	(bibtex-beginning-of-entry): Always return new position of point.
	(bibtex-end-of-entry): Rearrange cond clauses.
	(bibtex-count-entries, bibtex-validate, bibtex-reformat):
	Update for changes of bibtex-map-entries.
	(bibtex-ispell-abstract): Do not move point.
	(bibtex-entry-index): Use downcase.  Simplify.
	(bibtex-lessp): Handle catch-all.
	(bibtex-find-crossref): Turn into a command.
	(bibtex-find-entry): Simplify.  Use bibtex-read-key.  Fix regexp.
	(bibtex-clean-entry): Use bibtex-read-key.  Handle string and
	preamble entries.
	(bibtex-fill-field-bounds): New function.
	(bibtex-fill-field): New command.  Bound to fill-paragraph-function.
	(bibtex-fill-entry): Use bibtex-fill-field-bounds
	(bibtex-String): Use bibtex-strings.  Always obey
	bibtex-sort-ignore-string-entries.

2003-07-05  John Paul Wallington  <jpw@gnu.org>

	* cus-theme.el (customize-create-theme):
	Call `customize-create-theme' in Reset widget's notify function.

	* ibuffer.el (ibuffer-backward-line, ibuffer-forward-line)
	(ibuffer-mark-interactive): Use `or' instead of `unless'.
	(define-ibuffer-column name): Add summarizer.
	(define-ibuffer-column size): Likewise.
	(define-ibuffer-column filename): Likewise.
	(define-ibuffer-column process): Likewise.  Change BODY's output too.
	(define-ibuffer-column filename-and-process): Likewise, likewise.
	(ibuffer): Remove local vars `already-in' and `need-update'.

	* ibuf-ext.el: Don't require `derived' at compile-time.

2003-07-05  Kim F. Storm  <storm@cua.dk>

	* info.el: Disable paragraph refilling.
	(Info-refill-paragraphs): New defcustom.
	(Info-fontify-node): Use it.

2003-07-04  Stefan Monnier  <monnier@cs.yale.edu>

	* emacs-lisp/cl-macs.el (cl-transform-lambda): Strip &cl-defs
	thingies from constructors created by defstruct.

	* emacs-lisp/bytecomp.el (byte-compile-defvar): Check and set
	the default value of the variable.
	(byte-code-meter): Move declaration to top level.

	* pcvs-parse.el (cvs-parse-status): Ignore extra fields from CVSNT.

	* info.el (Info-following-node-name-re): New fun.
	(Info-following-node-name): Remove.
	(Info-insert-dir): Use the new fun.
	(Info-extract-pointer): Don't save restriction; use new fun.
	(Info-menu-entry-name-re): New const.
	(Info-menu-entry-name-re): Use it along with new fun.
	(Info-node-spec-re): Use new fun.
	(Info-complete-menu-item, Info-fontify-node): Use new const.
	(Info-goto-node, Info-follow-reference, Info-menu-update):
	Use match-string.
	(Info-follow-reference): Use assoc-string.
	Use a list of strings for the completion table.
	(Info-fontify-node): Use match-string, line-end-position.
	Limit the search for `node:' to the first line.

	* newcomment.el (uncomment-region): Remove padding coming from
	comment-start rather than just from comment-padding.

	* vc-cvs.el (vc-cvs-repository-hostname): New operation.
	(vc-cvs-stay-local-p): Use vc-stay-local-p.
	(vc-cvs-rename-file): Remove (use the default).
	(vc-cvs-register): Register parent dir if needed.
	(vc-cvs-could-register): Return non-nil if parent can be registered.
	(vc-cvs-state, vc-cvs-dir-state, vc-cvs-print-log, vc-cvs-diff)
	(vc-cvs-diff-tree, vc-cvs-make-version-backups-p): Use vc-stay-local-p.

	* vc-svn.el (vc-svn-use-edit): Make it into a const.
	(vc-svn-update): Fix the arguments to `svn'.
	(vc-svn-diff-tree): Just use `vc-svn-diff'.
	(vc-svn-create-snapshot, vc-svn-retrieve-snapshot):
	Simple implementations, assuming `name' is a URL.

	* progmodes/sh-script.el (sh-font-lock-paren): Add [ and ] to the
	set of chars allowed unquoted in a case pattern.

	* font-core.el (font-lock-defaults-alist): Remove obsolete entries.

	* font-lock.el (font-lock-extra-types-widget)
	(c-font-lock-extra-types, c++-font-lock-extra-types)
	(objc-font-lock-extra-types, java-font-lock-extra-types)
	(c-font-lock-keywords-1, c-font-lock-keywords-2, c-font-lock-keywords)
	(c-font-lock-keywords-3, c-font-lock-syntactic-face-function)
	(font-lock-match-c++-style-declaration-item-and-skip-to-next)
	(font-lock-match-c++-structor-declaration)
	(c++-font-lock-keywords-1, c++-font-lock-keywords-2)
	(c++-font-lock-keywords-3, c++-font-lock-keywords)
	(objc-font-lock-keywords-1, objc-font-lock-keywords-2)
	(objc-font-lock-keywords-3, objc-font-lock-keywords)
	(java-font-lock-keywords-1, java-font-lock-keywords-2)
	(java-font-lock-keywords-3, java-font-lock-keywords)
	(java-font-lock-syntactic-face-function): Remove obsolete code
	and constants.  It's all in cc-fonts.el now.

2003-07-04  Glenn Morris  <gmorris@ast.cam.ac.uk>

	* mail/sendmail.el (mail-specify-envelope-from)
	(mail-envelope-from): Doc fix.

2003-07-04  Martin Stjernholm  <mast@lysator.liu.se>

	* generic-x.el: Do away with the dependency on `c-emacs-features'
	when populating `rul-generic-mode-syntax-table'; we already know
	this isn't XEmacs.

See ChangeLog.10 for earlier changes.

;; Local Variables:
;; coding: iso-2022-7bit
;; End:

    Copyright (C) 2001, 02, 04  Free Software Foundation, Inc.
  Copying and distribution of this file, with or without modification,
  are permitted provided the copyright notice and this notice are preserved.

;;; arch-tag: e39939be-dab3-400e-86f5-0e2701a883c1
